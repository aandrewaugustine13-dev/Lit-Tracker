var dN=Object.defineProperty;var zy=e=>{throw TypeError(e)};var fN=(e,t,n)=>t in e?dN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Fn=(e,t,n)=>fN(e,typeof t!="symbol"?t+"":t,n),jy=(e,t,n)=>t.has(e)||zy("Cannot "+n);var Fd=(e,t,n)=>(jy(e,t,"read from private field"),n?n.call(e):t.get(e)),Fy=(e,t,n)=>t.has(e)?zy("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),By=(e,t,n,i)=>(jy(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();var ph=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var em={exports:{}},Bd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qy;function hN(){if(qy)return Bd;qy=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(i,o,a){var l=null;if(a!==void 0&&(l=""+a),o.key!==void 0&&(l=""+o.key),"key"in o){a={};for(var c in o)c!=="key"&&(a[c]=o[c])}else a=o;return o=a.ref,{$$typeof:e,type:i,key:l,ref:o!==void 0?o:null,props:a}}return Bd.Fragment=t,Bd.jsx=n,Bd.jsxs=n,Bd}var Hy;function pN(){return Hy||(Hy=1,em.exports=hN()),em.exports}var p=pN(),tm={exports:{}},en={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gy;function mN(){if(Gy)return en;Gy=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),b=Symbol.iterator;function g(G){return G===null||typeof G!="object"?null:(G=b&&G[b]||G["@@iterator"],typeof G=="function"?G:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,C={};function E(G,O,ee){this.props=G,this.context=O,this.refs=C,this.updater=ee||A}E.prototype.isReactComponent={},E.prototype.setState=function(G,O){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,O,"setState")},E.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function R(){}R.prototype=E.prototype;function k(G,O,ee){this.props=G,this.context=O,this.refs=C,this.updater=ee||A}var M=k.prototype=new R;M.constructor=k,_(M,E.prototype),M.isPureReactComponent=!0;var P=Array.isArray;function W(){}var V={H:null,A:null,T:null,S:null},$=Object.prototype.hasOwnProperty;function j(G,O,ee){var te=ee.ref;return{$$typeof:e,type:G,key:O,ref:te!==void 0?te:null,props:ee}}function X(G,O){return j(G.type,O,G.props)}function z(G){return typeof G=="object"&&G!==null&&G.$$typeof===e}function U(G){var O={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(ee){return O[ee]})}var q=/\/+/g;function I(G,O){return typeof G=="object"&&G!==null&&G.key!=null?U(""+G.key):O.toString(36)}function ie(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(W,W):(G.status="pending",G.then(function(O){G.status==="pending"&&(G.status="fulfilled",G.value=O)},function(O){G.status==="pending"&&(G.status="rejected",G.reason=O)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function J(G,O,ee,te,ce){var ye=typeof G;(ye==="undefined"||ye==="boolean")&&(G=null);var we=!1;if(G===null)we=!0;else switch(ye){case"bigint":case"string":case"number":we=!0;break;case"object":switch(G.$$typeof){case e:case t:we=!0;break;case h:return we=G._init,J(we(G._payload),O,ee,te,ce)}}if(we)return ce=ce(G),we=te===""?"."+I(G,0):te,P(ce)?(ee="",we!=null&&(ee=we.replace(q,"$&/")+"/"),J(ce,O,ee,"",function(De){return De})):ce!=null&&(z(ce)&&(ce=X(ce,ee+(ce.key==null||G&&G.key===ce.key?"":(""+ce.key).replace(q,"$&/")+"/")+we)),O.push(ce)),1;we=0;var Te=te===""?".":te+":";if(P(G))for(var Ce=0;Ce<G.length;Ce++)te=G[Ce],ye=Te+I(te,Ce),we+=J(te,O,ee,ye,ce);else if(Ce=g(G),typeof Ce=="function")for(G=Ce.call(G),Ce=0;!(te=G.next()).done;)te=te.value,ye=Te+I(te,Ce++),we+=J(te,O,ee,ye,ce);else if(ye==="object"){if(typeof G.then=="function")return J(ie(G),O,ee,te,ce);throw O=String(G),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return we}function Y(G,O,ee){if(G==null)return G;var te=[],ce=0;return J(G,te,"","",function(ye){return O.call(ee,ye,ce++)}),te}function le(G){if(G._status===-1){var O=G._result;O=O(),O.then(function(ee){(G._status===0||G._status===-1)&&(G._status=1,G._result=ee)},function(ee){(G._status===0||G._status===-1)&&(G._status=2,G._result=ee)}),G._status===-1&&(G._status=0,G._result=O)}if(G._status===1)return G._result.default;throw G._result}var pe=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)},Ie={map:Y,forEach:function(G,O,ee){Y(G,function(){O.apply(this,arguments)},ee)},count:function(G){var O=0;return Y(G,function(){O++}),O},toArray:function(G){return Y(G,function(O){return O})||[]},only:function(G){if(!z(G))throw Error("React.Children.only expected to receive a single React element child.");return G}};return en.Activity=v,en.Children=Ie,en.Component=E,en.Fragment=n,en.Profiler=o,en.PureComponent=k,en.StrictMode=i,en.Suspense=u,en.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=V,en.__COMPILER_RUNTIME={__proto__:null,c:function(G){return V.H.useMemoCache(G)}},en.cache=function(G){return function(){return G.apply(null,arguments)}},en.cacheSignal=function(){return null},en.cloneElement=function(G,O,ee){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var te=_({},G.props),ce=G.key;if(O!=null)for(ye in O.key!==void 0&&(ce=""+O.key),O)!$.call(O,ye)||ye==="key"||ye==="__self"||ye==="__source"||ye==="ref"&&O.ref===void 0||(te[ye]=O[ye]);var ye=arguments.length-2;if(ye===1)te.children=ee;else if(1<ye){for(var we=Array(ye),Te=0;Te<ye;Te++)we[Te]=arguments[Te+2];te.children=we}return j(G.type,ce,te)},en.createContext=function(G){return G={$$typeof:l,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:a,_context:G},G},en.createElement=function(G,O,ee){var te,ce={},ye=null;if(O!=null)for(te in O.key!==void 0&&(ye=""+O.key),O)$.call(O,te)&&te!=="key"&&te!=="__self"&&te!=="__source"&&(ce[te]=O[te]);var we=arguments.length-2;if(we===1)ce.children=ee;else if(1<we){for(var Te=Array(we),Ce=0;Ce<we;Ce++)Te[Ce]=arguments[Ce+2];ce.children=Te}if(G&&G.defaultProps)for(te in we=G.defaultProps,we)ce[te]===void 0&&(ce[te]=we[te]);return j(G,ye,ce)},en.createRef=function(){return{current:null}},en.forwardRef=function(G){return{$$typeof:c,render:G}},en.isValidElement=z,en.lazy=function(G){return{$$typeof:h,_payload:{_status:-1,_result:G},_init:le}},en.memo=function(G,O){return{$$typeof:d,type:G,compare:O===void 0?null:O}},en.startTransition=function(G){var O=V.T,ee={};V.T=ee;try{var te=G(),ce=V.S;ce!==null&&ce(ee,te),typeof te=="object"&&te!==null&&typeof te.then=="function"&&te.then(W,pe)}catch(ye){pe(ye)}finally{O!==null&&ee.types!==null&&(O.types=ee.types),V.T=O}},en.unstable_useCacheRefresh=function(){return V.H.useCacheRefresh()},en.use=function(G){return V.H.use(G)},en.useActionState=function(G,O,ee){return V.H.useActionState(G,O,ee)},en.useCallback=function(G,O){return V.H.useCallback(G,O)},en.useContext=function(G){return V.H.useContext(G)},en.useDebugValue=function(){},en.useDeferredValue=function(G,O){return V.H.useDeferredValue(G,O)},en.useEffect=function(G,O){return V.H.useEffect(G,O)},en.useEffectEvent=function(G){return V.H.useEffectEvent(G)},en.useId=function(){return V.H.useId()},en.useImperativeHandle=function(G,O,ee){return V.H.useImperativeHandle(G,O,ee)},en.useInsertionEffect=function(G,O){return V.H.useInsertionEffect(G,O)},en.useLayoutEffect=function(G,O){return V.H.useLayoutEffect(G,O)},en.useMemo=function(G,O){return V.H.useMemo(G,O)},en.useOptimistic=function(G,O){return V.H.useOptimistic(G,O)},en.useReducer=function(G,O,ee){return V.H.useReducer(G,O,ee)},en.useRef=function(G){return V.H.useRef(G)},en.useState=function(G){return V.H.useState(G)},en.useSyncExternalStore=function(G,O,ee){return V.H.useSyncExternalStore(G,O,ee)},en.useTransition=function(){return V.H.useTransition()},en.version="19.2.4",en}var Vy;function Pg(){return Vy||(Vy=1,tm.exports=mN()),tm.exports}var de=Pg();const kn=Dg(de);var nm={exports:{}},qd={},im={exports:{}},rm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $y;function gN(){return $y||($y=1,(function(e){function t(J,Y){var le=J.length;J.push(Y);e:for(;0<le;){var pe=le-1>>>1,Ie=J[pe];if(0<o(Ie,Y))J[pe]=Y,J[le]=Ie,le=pe;else break e}}function n(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var Y=J[0],le=J.pop();if(le!==Y){J[0]=le;e:for(var pe=0,Ie=J.length,G=Ie>>>1;pe<G;){var O=2*(pe+1)-1,ee=J[O],te=O+1,ce=J[te];if(0>o(ee,le))te<Ie&&0>o(ce,ee)?(J[pe]=ce,J[te]=le,pe=te):(J[pe]=ee,J[O]=le,pe=O);else if(te<Ie&&0>o(ce,le))J[pe]=ce,J[te]=le,pe=te;else break e}}return Y}function o(J,Y){var le=J.sortIndex-Y.sortIndex;return le!==0?le:J.id-Y.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var u=[],d=[],h=1,v=null,b=3,g=!1,A=!1,_=!1,C=!1,E=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function M(J){for(var Y=n(d);Y!==null;){if(Y.callback===null)i(d);else if(Y.startTime<=J)i(d),Y.sortIndex=Y.expirationTime,t(u,Y);else break;Y=n(d)}}function P(J){if(_=!1,M(J),!A)if(n(u)!==null)A=!0,W||(W=!0,U());else{var Y=n(d);Y!==null&&ie(P,Y.startTime-J)}}var W=!1,V=-1,$=5,j=-1;function X(){return C?!0:!(e.unstable_now()-j<$)}function z(){if(C=!1,W){var J=e.unstable_now();j=J;var Y=!0;try{e:{A=!1,_&&(_=!1,R(V),V=-1),g=!0;var le=b;try{t:{for(M(J),v=n(u);v!==null&&!(v.expirationTime>J&&X());){var pe=v.callback;if(typeof pe=="function"){v.callback=null,b=v.priorityLevel;var Ie=pe(v.expirationTime<=J);if(J=e.unstable_now(),typeof Ie=="function"){v.callback=Ie,M(J),Y=!0;break t}v===n(u)&&i(u),M(J)}else i(u);v=n(u)}if(v!==null)Y=!0;else{var G=n(d);G!==null&&ie(P,G.startTime-J),Y=!1}}break e}finally{v=null,b=le,g=!1}Y=void 0}}finally{Y?U():W=!1}}}var U;if(typeof k=="function")U=function(){k(z)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,I=q.port2;q.port1.onmessage=z,U=function(){I.postMessage(null)}}else U=function(){E(z,0)};function ie(J,Y){V=E(function(){J(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(J){switch(b){case 1:case 2:case 3:var Y=3;break;default:Y=b}var le=b;b=Y;try{return J()}finally{b=le}},e.unstable_requestPaint=function(){C=!0},e.unstable_runWithPriority=function(J,Y){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var le=b;b=J;try{return Y()}finally{b=le}},e.unstable_scheduleCallback=function(J,Y,le){var pe=e.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?pe+le:pe):le=pe,J){case 1:var Ie=-1;break;case 2:Ie=250;break;case 5:Ie=1073741823;break;case 4:Ie=1e4;break;default:Ie=5e3}return Ie=le+Ie,J={id:h++,callback:Y,priorityLevel:J,startTime:le,expirationTime:Ie,sortIndex:-1},le>pe?(J.sortIndex=le,t(d,J),n(u)===null&&J===n(d)&&(_?(R(V),V=-1):_=!0,ie(P,le-pe))):(J.sortIndex=Ie,t(u,J),A||g||(A=!0,W||(W=!0,U()))),J},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(J){var Y=b;return function(){var le=b;b=Y;try{return J.apply(this,arguments)}finally{b=le}}}})(rm)),rm}var Yy;function vN(){return Yy||(Yy=1,im.exports=gN()),im.exports}var om={exports:{}},wr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wy;function yN(){if(Wy)return wr;Wy=1;var e=Pg();function t(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},o=Symbol.for("react.portal");function a(u,d,h){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:v==null?null:""+v,children:u,containerInfo:d,implementation:h}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return wr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,wr.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return a(u,d,null,h)},wr.flushSync=function(u){var d=l.T,h=i.p;try{if(l.T=null,i.p=2,u)return u()}finally{l.T=d,i.p=h,i.d.f()}},wr.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,i.d.C(u,d))},wr.prefetchDNS=function(u){typeof u=="string"&&i.d.D(u)},wr.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,v=c(h,d.crossOrigin),b=typeof d.integrity=="string"?d.integrity:void 0,g=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?i.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:g}):h==="script"&&i.d.X(u,{crossOrigin:v,integrity:b,fetchPriority:g,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},wr.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=c(d.as,d.crossOrigin);i.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&i.d.M(u)},wr.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,v=c(h,d.crossOrigin);i.d.L(u,h,{crossOrigin:v,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},wr.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=c(d.as,d.crossOrigin);i.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else i.d.m(u)},wr.requestFormReset=function(u){i.d.r(u)},wr.unstable_batchedUpdates=function(u,d){return u(d)},wr.useFormState=function(u,d,h){return l.H.useFormState(u,d,h)},wr.useFormStatus=function(){return l.H.useHostTransitionStatus()},wr.version="19.2.4",wr}var Xy;function Xx(){if(Xy)return om.exports;Xy=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),om.exports=yN(),om.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jy;function bN(){if(Jy)return qd;Jy=1;var e=vN(),t=Pg(),n=Xx();function i(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)s+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var s=r,f=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(f=s.return),r=s.return;while(r)}return s.tag===3?f:null}function l(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function c(r){if(r.tag===31){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function u(r){if(a(r)!==r)throw Error(i(188))}function d(r){var s=r.alternate;if(!s){if(s=a(r),s===null)throw Error(i(188));return s!==r?null:r}for(var f=r,m=s;;){var S=f.return;if(S===null)break;var T=S.alternate;if(T===null){if(m=S.return,m!==null){f=m;continue}break}if(S.child===T.child){for(T=S.child;T;){if(T===f)return u(S),r;if(T===m)return u(S),s;T=T.sibling}throw Error(i(188))}if(f.return!==m.return)f=S,m=T;else{for(var H=!1,se=S.child;se;){if(se===f){H=!0,f=S,m=T;break}if(se===m){H=!0,m=S,f=T;break}se=se.sibling}if(!H){for(se=T.child;se;){if(se===f){H=!0,f=T,m=S;break}if(se===m){H=!0,m=T,f=S;break}se=se.sibling}if(!H)throw Error(i(189))}}if(f.alternate!==m)throw Error(i(190))}if(f.tag!==3)throw Error(i(188));return f.stateNode.current===f?r:s}function h(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=h(r),s!==null)return s;r=r.sibling}return null}var v=Object.assign,b=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),k=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),V=Symbol.for("react.memo"),$=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),X=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function U(r){return r===null||typeof r!="object"?null:(r=z&&r[z]||r["@@iterator"],typeof r=="function"?r:null)}var q=Symbol.for("react.client.reference");function I(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===q?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case _:return"Fragment";case E:return"Profiler";case C:return"StrictMode";case P:return"Suspense";case W:return"SuspenseList";case j:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case A:return"Portal";case k:return r.displayName||"Context";case R:return(r._context.displayName||"Context")+".Consumer";case M:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case V:return s=r.displayName||null,s!==null?s:I(r.type)||"Memo";case $:s=r._payload,r=r._init;try{return I(r(s))}catch{}}return null}var ie=Array.isArray,J=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le={pending:!1,data:null,method:null,action:null},pe=[],Ie=-1;function G(r){return{current:r}}function O(r){0>Ie||(r.current=pe[Ie],pe[Ie]=null,Ie--)}function ee(r,s){Ie++,pe[Ie]=r.current,r.current=s}var te=G(null),ce=G(null),ye=G(null),we=G(null);function Te(r,s){switch(ee(ye,s),ee(ce,r),ee(te,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?sy(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=sy(s),r=ly(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}O(te),ee(te,r)}function Ce(){O(te),O(ce),O(ye)}function De(r){r.memoizedState!==null&&ee(we,r);var s=te.current,f=ly(s,r.type);s!==f&&(ee(ce,r),ee(te,f))}function $e(r){ce.current===r&&(O(te),O(ce)),we.current===r&&(O(we),Od._currentValue=le)}var at,st;function B(r){if(at===void 0)try{throw Error()}catch(f){var s=f.stack.trim().match(/\n( *(at )?)/);at=s&&s[1]||"",st=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+at+r+st}var K=!1;function _e(r,s){if(!r||K)return"";K=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(s){var it=function(){throw Error()};if(Object.defineProperty(it.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(it,[])}catch(Ve){var Ge=Ve}Reflect.construct(r,[],it)}else{try{it.call()}catch(Ve){Ge=Ve}r.call(it.prototype)}}else{try{throw Error()}catch(Ve){Ge=Ve}(it=r())&&typeof it.catch=="function"&&it.catch(function(){})}}catch(Ve){if(Ve&&Ge&&typeof Ve.stack=="string")return[Ve.stack,Ge.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=m.DetermineComponentFrameRoot(),H=T[0],se=T[1];if(H&&se){var xe=H.split(`
`),qe=se.split(`
`);for(S=m=0;m<xe.length&&!xe[m].includes("DetermineComponentFrameRoot");)m++;for(;S<qe.length&&!qe[S].includes("DetermineComponentFrameRoot");)S++;if(m===xe.length||S===qe.length)for(m=xe.length-1,S=qe.length-1;1<=m&&0<=S&&xe[m]!==qe[S];)S--;for(;1<=m&&0<=S;m--,S--)if(xe[m]!==qe[S]){if(m!==1||S!==1)do if(m--,S--,0>S||xe[m]!==qe[S]){var Je=`
`+xe[m].replace(" at new "," at ");return r.displayName&&Je.includes("<anonymous>")&&(Je=Je.replace("<anonymous>",r.displayName)),Je}while(1<=m&&0<=S);break}}}finally{K=!1,Error.prepareStackTrace=f}return(f=r?r.displayName||r.name:"")?B(f):""}function he(r,s){switch(r.tag){case 26:case 27:case 5:return B(r.type);case 16:return B("Lazy");case 13:return r.child!==s&&s!==null?B("Suspense Fallback"):B("Suspense");case 19:return B("SuspenseList");case 0:case 15:return _e(r.type,!1);case 11:return _e(r.type.render,!1);case 1:return _e(r.type,!0);case 31:return B("Activity");default:return""}}function ne(r){try{var s="",f=null;do s+=he(r,f),f=r,r=r.return;while(r);return s}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var ae=Object.prototype.hasOwnProperty,be=e.unstable_scheduleCallback,Me=e.unstable_cancelCallback,Se=e.unstable_shouldYield,He=e.unstable_requestPaint,Ne=e.unstable_now,ze=e.unstable_getCurrentPriorityLevel,We=e.unstable_ImmediatePriority,dt=e.unstable_UserBlockingPriority,ft=e.unstable_NormalPriority,ht=e.unstable_LowPriority,Et=e.unstable_IdlePriority,mt=e.log,on=e.unstable_setDisableYieldValue,yt=null,vt=null;function Rt(r){if(typeof mt=="function"&&on(r),vt&&typeof vt.setStrictMode=="function")try{vt.setStrictMode(yt,r)}catch{}}var Ft=Math.clz32?Math.clz32:Qe,Le=Math.log,nt=Math.LN2;function Qe(r){return r>>>=0,r===0?32:31-(Le(r)/nt|0)|0}var ut=256,wt=262144,lt=4194304;function et(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function pt(r,s,f){var m=r.pendingLanes;if(m===0)return 0;var S=0,T=r.suspendedLanes,H=r.pingedLanes;r=r.warmLanes;var se=m&134217727;return se!==0?(m=se&~T,m!==0?S=et(m):(H&=se,H!==0?S=et(H):f||(f=se&~r,f!==0&&(S=et(f))))):(se=m&~T,se!==0?S=et(se):H!==0?S=et(H):f||(f=m&~r,f!==0&&(S=et(f)))),S===0?0:s!==0&&s!==S&&(s&T)===0&&(T=S&-S,f=s&-s,T>=f||T===32&&(f&4194048)!==0)?s:S}function Bt(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function Vt(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zt(){var r=lt;return lt<<=1,(lt&62914560)===0&&(lt=4194304),r}function Jt(r){for(var s=[],f=0;31>f;f++)s.push(r);return s}function bt(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function jt(r,s,f,m,S,T){var H=r.pendingLanes;r.pendingLanes=f,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=f,r.entangledLanes&=f,r.errorRecoveryDisabledLanes&=f,r.shellSuspendCounter=0;var se=r.entanglements,xe=r.expirationTimes,qe=r.hiddenUpdates;for(f=H&~f;0<f;){var Je=31-Ft(f),it=1<<Je;se[Je]=0,xe[Je]=-1;var Ge=qe[Je];if(Ge!==null)for(qe[Je]=null,Je=0;Je<Ge.length;Je++){var Ve=Ge[Je];Ve!==null&&(Ve.lane&=-536870913)}f&=~it}m!==0&&sn(r,m,0),T!==0&&S===0&&r.tag!==0&&(r.suspendedLanes|=T&~(H&~s))}function sn(r,s,f){r.pendingLanes|=s,r.suspendedLanes&=~s;var m=31-Ft(s);r.entangledLanes|=s,r.entanglements[m]=r.entanglements[m]|1073741824|f&261930}function Nn(r,s){var f=r.entangledLanes|=s;for(r=r.entanglements;f;){var m=31-Ft(f),S=1<<m;S&s|r[m]&s&&(r[m]|=s),f&=~S}}function Xn(r,s){var f=s&-s;return f=(f&42)!==0?1:mn(f),(f&(r.suspendedLanes|s))!==0?0:f}function mn(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function rn(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function wn(){var r=Y.p;return r!==0?r:(r=window.event,r===void 0?32:Ry(r.type))}function Qi(r,s){var f=Y.p;try{return Y.p=r,s()}finally{Y.p=f}}var Ii=Math.random().toString(36).slice(2),On="__reactFiber$"+Ii,ti="__reactProps$"+Ii,er="__reactContainer$"+Ii,Cr="__reactEvents$"+Ii,Br="__reactListeners$"+Ii,fs="__reactHandles$"+Ii,co="__reactResources$"+Ii,uo="__reactMarker$"+Ii;function ja(r){delete r[On],delete r[ti],delete r[Cr],delete r[Br],delete r[fs]}function fo(r){var s=r[On];if(s)return s;for(var f=r.parentNode;f;){if(s=f[er]||f[On]){if(f=s.alternate,s.child!==null||f!==null&&f.child!==null)for(r=my(r);r!==null;){if(f=r[On])return f;r=my(r)}return s}r=f,f=r.parentNode}return null}function ho(r){if(r=r[On]||r[er]){var s=r.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return r}return null}function hs(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(i(33))}function Ro(r){var s=r[co];return s||(s=r[co]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function pi(r){r[uo]=!0}var Gl=new Set,Tr={};function po(r,s){ea(r,s),ea(r+"Capture",s)}function ea(r,s){for(Tr[r]=s,r=0;r<s.length;r++)Gl.add(s[r])}var Vl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$l={},Yl={};function Uc(r){return ae.call(Yl,r)?!0:ae.call($l,r)?!1:Vl.test(r)?Yl[r]=!0:($l[r]=!0,!1)}function kr(r,s,f){if(Uc(s))if(f===null)r.removeAttribute(s);else{switch(typeof f){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var m=s.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+f)}}function ta(r,s,f){if(f===null)r.removeAttribute(s);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+f)}}function mo(r,s,f,m){if(m===null)r.removeAttribute(f);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(f);return}r.setAttributeNS(s,f,""+m)}}function An(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Wl(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Lo(r,s,f){var m=Object.getOwnPropertyDescriptor(r.constructor.prototype,s);if(!r.hasOwnProperty(s)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var S=m.get,T=m.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return S.call(this)},set:function(H){f=""+H,T.call(this,H)}}),Object.defineProperty(r,s,{enumerable:m.enumerable}),{getValue:function(){return f},setValue:function(H){f=""+H},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function Fa(r){if(!r._valueTracker){var s=Wl(r)?"checked":"value";r._valueTracker=Lo(r,s,""+r[s])}}function Xl(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var f=s.getValue(),m="";return r&&(m=Wl(r)?r.checked?"true":"false":r.value),r=m,r!==f?(s.setValue(r),!0):!1}function ur(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Ri=/[\n"\\]/g;function wi(r){return r.replace(Ri,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Js(r,s,f,m,S,T,H,se){r.name="",H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?r.type=H:r.removeAttribute("type"),s!=null?H==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+An(s)):r.value!==""+An(s)&&(r.value=""+An(s)):H!=="submit"&&H!=="reset"||r.removeAttribute("value"),s!=null?Jl(r,H,An(s)):f!=null?Jl(r,H,An(f)):m!=null&&r.removeAttribute("value"),S==null&&T!=null&&(r.defaultChecked=!!T),S!=null&&(r.checked=S&&typeof S!="function"&&typeof S!="symbol"),se!=null&&typeof se!="function"&&typeof se!="symbol"&&typeof se!="boolean"?r.name=""+An(se):r.removeAttribute("name")}function zc(r,s,f,m,S,T,H,se){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(r.type=T),s!=null||f!=null){if(!(T!=="submit"&&T!=="reset"||s!=null)){Fa(r);return}f=f!=null?""+An(f):"",s=s!=null?""+An(s):f,se||s===r.value||(r.value=s),r.defaultValue=s}m=m??S,m=typeof m!="function"&&typeof m!="symbol"&&!!m,r.checked=se?r.checked:!!m,r.defaultChecked=!!m,H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"&&(r.name=H),Fa(r)}function Jl(r,s,f){s==="number"&&ur(r.ownerDocument)===r||r.defaultValue===""+f||(r.defaultValue=""+f)}function dr(r,s,f,m){if(r=r.options,s){s={};for(var S=0;S<f.length;S++)s["$"+f[S]]=!0;for(f=0;f<r.length;f++)S=s.hasOwnProperty("$"+r[f].value),r[f].selected!==S&&(r[f].selected=S),S&&m&&(r[f].defaultSelected=!0)}else{for(f=""+An(f),s=null,S=0;S<r.length;S++){if(r[S].value===f){r[S].selected=!0,m&&(r[S].defaultSelected=!0);return}s!==null||r[S].disabled||(s=r[S])}s!==null&&(s.selected=!0)}}function Kl(r,s,f){if(s!=null&&(s=""+An(s),s!==r.value&&(r.value=s),f==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=f!=null?""+An(f):""}function Zl(r,s,f,m){if(s==null){if(m!=null){if(f!=null)throw Error(i(92));if(ie(m)){if(1<m.length)throw Error(i(93));m=m[0]}f=m}f==null&&(f=""),s=f}f=An(s),r.defaultValue=f,m=r.textContent,m===f&&m!==""&&m!==null&&(r.value=m),Fa(r)}function go(r,s){if(s){var f=r.firstChild;if(f&&f===r.lastChild&&f.nodeType===3){f.nodeValue=s;return}}r.textContent=s}var ps=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function jc(r,s,f){var m=s.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?m?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":m?r.setProperty(s,f):typeof f!="number"||f===0||ps.has(s)?s==="float"?r.cssFloat=f:r[s]=(""+f).trim():r[s]=f+"px"}function Fc(r,s,f){if(s!=null&&typeof s!="object")throw Error(i(62));if(r=r.style,f!=null){for(var m in f)!f.hasOwnProperty(m)||s!=null&&s.hasOwnProperty(m)||(m.indexOf("--")===0?r.setProperty(m,""):m==="float"?r.cssFloat="":r[m]="");for(var S in s)m=s[S],s.hasOwnProperty(S)&&f[S]!==m&&jc(r,S,m)}else for(var T in s)s.hasOwnProperty(T)&&jc(r,T,s[T])}function Ql(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ec=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Bc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yr(r){return Bc.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function vo(){}var na=null;function ms(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Ba=null,qt=null;function qc(r){var s=ho(r);if(s&&(r=s.stateNode)){var f=r[ti]||null;e:switch(r=s.stateNode,s.type){case"input":if(Js(r,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),s=f.name,f.type==="radio"&&s!=null){for(f=r;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+wi(""+s)+'"][type="radio"]'),s=0;s<f.length;s++){var m=f[s];if(m!==r&&m.form===r.form){var S=m[ti]||null;if(!S)throw Error(i(90));Js(m,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(s=0;s<f.length;s++)m=f[s],m.form===r.form&&Xl(m)}break e;case"textarea":Kl(r,f.value,f.defaultValue);break e;case"select":s=f.value,s!=null&&dr(r,!!f.multiple,s,!1)}}}var tc=!1;function Hc(r,s,f){if(tc)return r(s,f);tc=!0;try{var m=r(s);return m}finally{if(tc=!1,(Ba!==null||qt!==null)&&($f(),Ba&&(s=Ba,r=qt,qt=Ba=null,qc(s),r)))for(s=0;s<r.length;s++)qc(r[s])}}function Ir(r,s){var f=r.stateNode;if(f===null)return null;var m=f[ti]||null;if(m===null)return null;f=m[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(r=r.type,m=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!m;break e;default:r=!1}if(r)return null;if(f&&typeof f!="function")throw Error(i(231,s,typeof f));return f}var Hi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nc=!1;if(Hi)try{var gs={};Object.defineProperty(gs,"passive",{get:function(){nc=!0}}),window.addEventListener("test",gs,gs),window.removeEventListener("test",gs,gs)}catch{nc=!1}var Rr=null,vs=null,Mo=null;function Gc(){if(Mo)return Mo;var r,s=vs,f=s.length,m,S="value"in Rr?Rr.value:Rr.textContent,T=S.length;for(r=0;r<f&&s[r]===S[r];r++);var H=f-r;for(m=1;m<=H&&s[f-m]===S[T-m];m++);return Mo=S.slice(r,1<m?1-m:void 0)}function qr(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function Ks(){return!0}function Zs(){return!1}function zi(r){function s(f,m,S,T,H){this._reactName=f,this._targetInst=S,this.type=m,this.nativeEvent=T,this.target=H,this.currentTarget=null;for(var se in r)r.hasOwnProperty(se)&&(f=r[se],this[se]=f?f(T):T[se]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Ks:Zs,this.isPropagationStopped=Zs,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Ks)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Ks)},persist:function(){},isPersistent:Ks}),s}var Do={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hr=zi(Do),ia=v({},Do,{view:0,detail:0}),Qs=zi(ia),ys,ra,oa,bs=v({},ia,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$t,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==oa&&(oa&&r.type==="mousemove"?(ys=r.screenX-oa.screenX,ra=r.screenY-oa.screenY):ra=ys=0,oa=r),ys)},movementY:function(r){return"movementY"in r?r.movementY:ra}}),ic=zi(bs),aa=v({},bs,{dataTransfer:0}),sa=zi(aa),Vc=v({},ia,{relatedTarget:0}),la=zi(Vc),$c=v({},Do,{animationName:0,elapsedTime:0,pseudoElement:0}),L=zi($c),Z=v({},Do,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),ve=zi(Z),Ee=v({},Do,{data:0}),Pe=zi(Ee),Ke={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ot={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ct={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Lt(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=Ct[r])?!!s[r]:!1}function $t(){return Lt}var Zt=v({},ia,{key:function(r){if(r.key){var s=Ke[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=qr(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?ot[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$t,charCode:function(r){return r.type==="keypress"?qr(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?qr(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),gn=zi(Zt),ni=v({},bs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mi=zi(ni),Hn=v({},ia,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$t}),Li=zi(Hn),_i=v({},Do,{propertyName:0,elapsedTime:0,pseudoElement:0}),Gi=zi(_i),ca=v({},bs,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),yo=zi(ca),ua=v({},Do,{newState:0,oldState:0}),rc=zi(ua),el=[9,13,27,32],Po=Hi&&"CompositionEvent"in window,bo=null;Hi&&"documentMode"in document&&(bo=document.documentMode);var xs=Hi&&"TextEvent"in window&&!bo,da=Hi&&(!Po||bo&&8<bo&&11>=bo),ji=" ",qa=!1;function Ha(r,s){switch(r){case"keyup":return el.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tl(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Oo=!1;function fr(r,s){switch(r){case"compositionend":return tl(s);case"keypress":return s.which!==32?null:(qa=!0,ji);case"textInput":return r=s.data,r===ji&&qa?null:r;default:return null}}function fa(r,s){if(Oo)return r==="compositionend"||!Po&&Ha(r,s)?(r=Gc(),Mo=vs=Rr=null,Oo=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return da&&s.locale!=="ko"?null:s.data;default:return null}}var nl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function oc(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!nl[r.type]:s==="textarea"}function Lr(r,s,f,m){Ba?qt?qt.push(m):qt=[m]:Ba=m,s=Qf(s,"onChange"),0<s.length&&(f=new Hr("onChange","change",null,f,m),r.push({event:f,listeners:s}))}var xo=null,ha=null;function ac(r){ty(r,0)}function wo(r){var s=hs(r);if(Xl(s))return r}function Ga(r,s){if(r==="change")return s}var br=!1;if(Hi){var hr;if(Hi){var Uo="oninput"in document;if(!Uo){var zo=document.createElement("div");zo.setAttribute("oninput","return;"),Uo=typeof zo.oninput=="function"}hr=Uo}else hr=!1;br=hr&&(!document.documentMode||9<document.documentMode)}function pa(){xo&&(xo.detachEvent("onpropertychange",il),ha=xo=null)}function il(r){if(r.propertyName==="value"&&wo(ha)){var s=[];Lr(s,ha,r,ms(r)),Hc(ac,s)}}function rl(r,s,f){r==="focusin"?(pa(),xo=s,ha=f,xo.attachEvent("onpropertychange",il)):r==="focusout"&&pa()}function gi(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return wo(ha)}function Yc(r,s){if(r==="click")return wo(s)}function jo(r,s){if(r==="input"||r==="change")return wo(s)}function Fo(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Vi=typeof Object.is=="function"?Object.is:Fo;function ma(r,s){if(Vi(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var f=Object.keys(r),m=Object.keys(s);if(f.length!==m.length)return!1;for(m=0;m<f.length;m++){var S=f[m];if(!ae.call(s,S)||!Vi(r[S],s[S]))return!1}return!0}function ol(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function al(r,s){var f=ol(r);r=0;for(var m;f;){if(f.nodeType===3){if(m=r+f.textContent.length,r<=s&&m>=s)return{node:f,offset:s-r};r=m}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=ol(f)}}function ga(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?ga(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function va(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=ur(r.document);s instanceof r.HTMLIFrameElement;){try{var f=typeof s.contentWindow.location.href=="string"}catch{f=!1}if(f)r=s.contentWindow;else break;s=ur(r.document)}return s}function Bo(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var ws=Hi&&"documentMode"in document&&11>=document.documentMode,Mr=null,ya=null,tr=null,Gr=!1;function Cn(r,s,f){var m=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Gr||Mr==null||Mr!==ur(m)||(m=Mr,"selectionStart"in m&&Bo(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),tr&&ma(tr,m)||(tr=m,m=Qf(ya,"onSelect"),0<m.length&&(s=new Hr("onSelect","select",null,s,f),r.push({event:s,listeners:m}),s.target=Mr)))}function vn(r,s){var f={};return f[r.toLowerCase()]=s.toLowerCase(),f["Webkit"+r]="webkit"+s,f["Moz"+r]="moz"+s,f}var Gn={animationend:vn("Animation","AnimationEnd"),animationiteration:vn("Animation","AnimationIteration"),animationstart:vn("Animation","AnimationStart"),transitionrun:vn("Transition","TransitionRun"),transitionstart:vn("Transition","TransitionStart"),transitioncancel:vn("Transition","TransitionCancel"),transitionend:vn("Transition","TransitionEnd")},vi={},qo={};Hi&&(qo=document.createElement("div").style,"AnimationEvent"in window||(delete Gn.animationend.animation,delete Gn.animationiteration.animation,delete Gn.animationstart.animation),"TransitionEvent"in window||delete Gn.transitionend.transition);function _o(r){if(vi[r])return vi[r];if(!Gn[r])return r;var s=Gn[r],f;for(f in s)if(s.hasOwnProperty(f)&&f in qo)return vi[r]=s[f];return r}var _s=_o("animationend"),sc=_o("animationiteration"),od=_o("animationstart"),_f=_o("transitionrun"),Sf=_o("transitionstart"),Ef=_o("transitioncancel"),ad=_o("transitionend"),sd=new Map,Ss="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ss.push("scrollEnd");function Vr(r,s){sd.set(r,s),po(s,[r])}var lc=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Dr=[],Es=0,Wc=0;function cc(){for(var r=Es,s=Wc=Es=0;s<r;){var f=Dr[s];Dr[s++]=null;var m=Dr[s];Dr[s++]=null;var S=Dr[s];Dr[s++]=null;var T=Dr[s];if(Dr[s++]=null,m!==null&&S!==null){var H=m.pending;H===null?S.next=S:(S.next=H.next,H.next=S),m.pending=S}T!==0&&dc(f,S,T)}}function uc(r,s,f,m){Dr[Es++]=r,Dr[Es++]=s,Dr[Es++]=f,Dr[Es++]=m,Wc|=m,r.lanes|=m,r=r.alternate,r!==null&&(r.lanes|=m)}function Xc(r,s,f,m){return uc(r,s,f,m),nr(r)}function ba(r,s){return uc(r,null,null,s),nr(r)}function dc(r,s,f){r.lanes|=f;var m=r.alternate;m!==null&&(m.lanes|=f);for(var S=!1,T=r.return;T!==null;)T.childLanes|=f,m=T.alternate,m!==null&&(m.childLanes|=f),T.tag===22&&(r=T.stateNode,r===null||r._visibility&1||(S=!0)),r=T,T=T.return;return r.tag===3?(T=r.stateNode,S&&s!==null&&(S=31-Ft(f),r=T.hiddenUpdates,m=r[S],m===null?r[S]=[s]:m.push(s),s.lane=f|536870912),T):null}function nr(r){if(50<kd)throw kd=0,E0=null,Error(i(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var $i={};function Jc(r,s,f,m){this.tag=r,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ir(r,s,f,m){return new Jc(r,s,f,m)}function Kc(r){return r=r.prototype,!(!r||!r.isReactComponent)}function $r(r,s){var f=r.alternate;return f===null?(f=ir(r.tag,s,r.key,r.mode),f.elementType=r.elementType,f.type=r.type,f.stateNode=r.stateNode,f.alternate=r,r.alternate=f):(f.pendingProps=s,f.type=r.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=r.flags&65011712,f.childLanes=r.childLanes,f.lanes=r.lanes,f.child=r.child,f.memoizedProps=r.memoizedProps,f.memoizedState=r.memoizedState,f.updateQueue=r.updateQueue,s=r.dependencies,f.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},f.sibling=r.sibling,f.index=r.index,f.ref=r.ref,f.refCleanup=r.refCleanup,f}function fc(r,s){r.flags&=65011714;var f=r.alternate;return f===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=f.childLanes,r.lanes=f.lanes,r.child=f.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=f.memoizedProps,r.memoizedState=f.memoizedState,r.updateQueue=f.updateQueue,r.type=f.type,s=f.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function sl(r,s,f,m,S,T){var H=0;if(m=r,typeof r=="function")Kc(r)&&(H=1);else if(typeof r=="string")H=QE(r,f,te.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case j:return r=ir(31,f,s,S),r.elementType=j,r.lanes=T,r;case _:return Va(f.children,S,T,s);case C:H=8,S|=24;break;case E:return r=ir(12,f,s,S|2),r.elementType=E,r.lanes=T,r;case P:return r=ir(13,f,s,S),r.elementType=P,r.lanes=T,r;case W:return r=ir(19,f,s,S),r.elementType=W,r.lanes=T,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case k:H=10;break e;case R:H=9;break e;case M:H=11;break e;case V:H=14;break e;case $:H=16,m=null;break e}H=29,f=Error(i(130,r===null?"null":typeof r,"")),m=null}return s=ir(H,f,s,S),s.elementType=r,s.type=m,s.lanes=T,s}function Va(r,s,f,m){return r=ir(7,r,m,s),r.lanes=f,r}function hc(r,s,f){return r=ir(6,r,null,s),r.lanes=f,r}function Zc(r){var s=ir(18,null,null,0);return s.stateNode=r,s}function ll(r,s,f){return s=ir(4,r.children!==null?r.children:[],r.key,s),s.lanes=f,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var Qc=new WeakMap;function Yr(r,s){if(typeof r=="object"&&r!==null){var f=Qc.get(r);return f!==void 0?f:(s={value:r,source:s,stack:ne(s)},Qc.set(r,s),s)}return{value:r,source:s,stack:ne(s)}}var cl=[],Ns=0,eu=null,pc=0,Wr=[],Xr=0,$a=null,Jr=1,Kr="";function Pr(r,s){cl[Ns++]=pc,cl[Ns++]=eu,eu=r,pc=s}function Nf(r,s,f){Wr[Xr++]=Jr,Wr[Xr++]=Kr,Wr[Xr++]=$a,$a=r;var m=Jr;r=Kr;var S=32-Ft(m)-1;m&=~(1<<S),f+=1;var T=32-Ft(s)+S;if(30<T){var H=S-S%5;T=(m&(1<<H)-1).toString(32),m>>=H,S-=H,Jr=1<<32-Ft(s)+S|f<<S|m,Kr=T+r}else Jr=1<<T|f<<S|m,Kr=r}function ld(r){r.return!==null&&(Pr(r,1),Nf(r,1,0))}function tu(r){for(;r===eu;)eu=cl[--Ns],cl[Ns]=null,pc=cl[--Ns],cl[Ns]=null;for(;r===$a;)$a=Wr[--Xr],Wr[Xr]=null,Kr=Wr[--Xr],Wr[Xr]=null,Jr=Wr[--Xr],Wr[Xr]=null}function Af(r,s){Wr[Xr++]=Jr,Wr[Xr++]=Kr,Wr[Xr++]=$a,Jr=s.id,Kr=s.overflow,$a=r}var Yi=null,Jn=null,un=!1,pr=null,li=!1,So=Error(i(519));function Ya(r){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ul(Yr(s,r)),So}function cd(r){var s=r.stateNode,f=r.type,m=r.memoizedProps;switch(s[On]=r,s[ti]=m,f){case"dialog":fn("cancel",s),fn("close",s);break;case"iframe":case"object":case"embed":fn("load",s);break;case"video":case"audio":for(f=0;f<Rd.length;f++)fn(Rd[f],s);break;case"source":fn("error",s);break;case"img":case"image":case"link":fn("error",s),fn("load",s);break;case"details":fn("toggle",s);break;case"input":fn("invalid",s),zc(s,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":fn("invalid",s);break;case"textarea":fn("invalid",s),Zl(s,m.value,m.defaultValue,m.children)}f=m.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||s.textContent===""+f||m.suppressHydrationWarning===!0||oy(s.textContent,f)?(m.popover!=null&&(fn("beforetoggle",s),fn("toggle",s)),m.onScroll!=null&&fn("scroll",s),m.onScrollEnd!=null&&fn("scrollend",s),m.onClick!=null&&(s.onclick=vo),s=!0):s=!1,s||Ya(r,!0)}function xa(r){for(Yi=r.return;Yi;)switch(Yi.tag){case 5:case 31:case 13:li=!1;return;case 27:case 3:li=!0;return;default:Yi=Yi.return}}function Wi(r){if(r!==Yi)return!1;if(!un)return xa(r),un=!0,!1;var s=r.tag,f;if((f=s!==3&&s!==27)&&((f=s===5)&&(f=r.type,f=!(f!=="form"&&f!=="button")||j0(r.type,r.memoizedProps)),f=!f),f&&Jn&&Ya(r),xa(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));Jn=py(r)}else if(s===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));Jn=py(r)}else s===27?(s=Jn,El(r.type)?(r=G0,G0=null,Jn=r):Jn=s):Jn=Yi?$o(r.stateNode.nextSibling):null;return!0}function As(){Jn=Yi=null,un=!1}function ud(){var r=pr;return r!==null&&(io===null?io=r:io.push.apply(io,r),pr=null),r}function ul(r){pr===null?pr=[r]:pr.push(r)}var nu=G(null),Wa=null,Ho=null;function Xa(r,s,f){ee(nu,s._currentValue),s._currentValue=f}function Zr(r){r._currentValue=nu.current,O(nu)}function dl(r,s,f){for(;r!==null;){var m=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,m!==null&&(m.childLanes|=s)):m!==null&&(m.childLanes&s)!==s&&(m.childLanes|=s),r===f)break;r=r.return}}function Cs(r,s,f,m){var S=r.child;for(S!==null&&(S.return=r);S!==null;){var T=S.dependencies;if(T!==null){var H=S.child;T=T.firstContext;e:for(;T!==null;){var se=T;T=S;for(var xe=0;xe<s.length;xe++)if(se.context===s[xe]){T.lanes|=f,se=T.alternate,se!==null&&(se.lanes|=f),dl(T.return,f,r),m||(H=null);break e}T=se.next}}else if(S.tag===18){if(H=S.return,H===null)throw Error(i(341));H.lanes|=f,T=H.alternate,T!==null&&(T.lanes|=f),dl(H,f,r),H=null}else H=S.child;if(H!==null)H.return=S;else for(H=S;H!==null;){if(H===r){H=null;break}if(S=H.sibling,S!==null){S.return=H.return,H=S;break}H=H.return}S=H}}function Ja(r,s,f,m){r=null;for(var S=s,T=!1;S!==null;){if(!T){if((S.flags&524288)!==0)T=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var H=S.alternate;if(H===null)throw Error(i(387));if(H=H.memoizedProps,H!==null){var se=S.type;Vi(S.pendingProps.value,H.value)||(r!==null?r.push(se):r=[se])}}else if(S===we.current){if(H=S.alternate,H===null)throw Error(i(387));H.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(r!==null?r.push(Od):r=[Od])}S=S.return}r!==null&&Cs(s,r,f,m),s.flags|=262144}function iu(r){for(r=r.firstContext;r!==null;){if(!Vi(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Ka(r){Wa=r,Ho=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Xi(r){return Cf(Wa,r)}function ru(r,s){return Wa===null&&Ka(r),Cf(r,s)}function Cf(r,s){var f=s._currentValue;if(s={context:s,memoizedValue:f,next:null},Ho===null){if(r===null)throw Error(i(308));Ho=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else Ho=Ho.next=s;return f}var Hp=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(f,m){r.push(m)}};this.abort=function(){s.aborted=!0,r.forEach(function(f){return f()})}},Gp=e.unstable_scheduleCallback,Vp=e.unstable_NormalPriority,yi={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function fl(){return{controller:new Hp,data:new Map,refCount:0}}function mc(r){r.refCount--,r.refCount===0&&Gp(Vp,function(){r.controller.abort()})}var gc=null,ou=0,x=0,N=null;function D(r,s){if(gc===null){var f=gc=[];ou=0,x=I0(),N={status:"pending",value:void 0,then:function(m){f.push(m)}}}return ou++,s.then(F,F),s}function F(){if(--ou===0&&gc!==null){N!==null&&(N.status="fulfilled");var r=gc;gc=null,x=0,N=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function Q(r,s){var f=[],m={status:"pending",value:null,reason:null,then:function(S){f.push(S)}};return r.then(function(){m.status="fulfilled",m.value=s;for(var S=0;S<f.length;S++)(0,f[S])(s)},function(S){for(m.status="rejected",m.reason=S,S=0;S<f.length;S++)(0,f[S])(void 0)}),m}var re=J.S;J.S=function(r,s){kv=Ne(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&D(r,s),re!==null&&re(r,s)};var oe=G(null);function ue(){var r=oe.current;return r!==null?r:Zn.pooledCache}function fe(r,s){s===null?ee(oe,oe.current):ee(oe,s.pool)}function ge(){var r=ue();return r===null?null:{parent:yi._currentValue,pool:r}}var Ae=Error(i(460)),Fe=Error(i(474)),me=Error(i(542)),Re={then:function(){}};function Ue(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Xe(r,s,f){switch(f=r[f],f===void 0?r.push(s):f!==s&&(s.then(vo,vo),s=f),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,ct(r),r;default:if(typeof s.status=="string")s.then(vo,vo);else{if(r=Zn,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=s,r.status="pending",r.then(function(m){if(s.status==="pending"){var S=s;S.status="fulfilled",S.value=m}},function(m){if(s.status==="pending"){var S=s;S.status="rejected",S.reason=m}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,ct(r),r}throw Ye=s,Ae}}function je(r){try{var s=r._init;return s(r._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Ye=f,Ae):f}}var Ye=null;function Ze(){if(Ye===null)throw Error(i(459));var r=Ye;return Ye=null,r}function ct(r){if(r===Ae||r===me)throw Error(i(483))}var rt=null,kt=0;function _t(r){var s=kt;return kt+=1,rt===null&&(rt=[]),Xe(rt,r,s)}function Wt(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function At(r,s){throw s.$$typeof===b?Error(i(525)):(r=Object.prototype.toString.call(s),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function cn(r){function s(Oe,ke){if(r){var Be=Oe.deletions;Be===null?(Oe.deletions=[ke],Oe.flags|=16):Be.push(ke)}}function f(Oe,ke){if(!r)return null;for(;ke!==null;)s(Oe,ke),ke=ke.sibling;return null}function m(Oe){for(var ke=new Map;Oe!==null;)Oe.key!==null?ke.set(Oe.key,Oe):ke.set(Oe.index,Oe),Oe=Oe.sibling;return ke}function S(Oe,ke){return Oe=$r(Oe,ke),Oe.index=0,Oe.sibling=null,Oe}function T(Oe,ke,Be){return Oe.index=Be,r?(Be=Oe.alternate,Be!==null?(Be=Be.index,Be<ke?(Oe.flags|=67108866,ke):Be):(Oe.flags|=67108866,ke)):(Oe.flags|=1048576,ke)}function H(Oe){return r&&Oe.alternate===null&&(Oe.flags|=67108866),Oe}function se(Oe,ke,Be,tt){return ke===null||ke.tag!==6?(ke=hc(Be,Oe.mode,tt),ke.return=Oe,ke):(ke=S(ke,Be),ke.return=Oe,ke)}function xe(Oe,ke,Be,tt){var Ut=Be.type;return Ut===_?Je(Oe,ke,Be.props.children,tt,Be.key):ke!==null&&(ke.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===$&&je(Ut)===ke.type)?(ke=S(ke,Be.props),Wt(ke,Be),ke.return=Oe,ke):(ke=sl(Be.type,Be.key,Be.props,null,Oe.mode,tt),Wt(ke,Be),ke.return=Oe,ke)}function qe(Oe,ke,Be,tt){return ke===null||ke.tag!==4||ke.stateNode.containerInfo!==Be.containerInfo||ke.stateNode.implementation!==Be.implementation?(ke=ll(Be,Oe.mode,tt),ke.return=Oe,ke):(ke=S(ke,Be.children||[]),ke.return=Oe,ke)}function Je(Oe,ke,Be,tt,Ut){return ke===null||ke.tag!==7?(ke=Va(Be,Oe.mode,tt,Ut),ke.return=Oe,ke):(ke=S(ke,Be),ke.return=Oe,ke)}function it(Oe,ke,Be){if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return ke=hc(""+ke,Oe.mode,Be),ke.return=Oe,ke;if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case g:return Be=sl(ke.type,ke.key,ke.props,null,Oe.mode,Be),Wt(Be,ke),Be.return=Oe,Be;case A:return ke=ll(ke,Oe.mode,Be),ke.return=Oe,ke;case $:return ke=je(ke),it(Oe,ke,Be)}if(ie(ke)||U(ke))return ke=Va(ke,Oe.mode,Be,null),ke.return=Oe,ke;if(typeof ke.then=="function")return it(Oe,_t(ke),Be);if(ke.$$typeof===k)return it(Oe,ru(Oe,ke),Be);At(Oe,ke)}return null}function Ge(Oe,ke,Be,tt){var Ut=ke!==null?ke.key:null;if(typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint")return Ut!==null?null:se(Oe,ke,""+Be,tt);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case g:return Be.key===Ut?xe(Oe,ke,Be,tt):null;case A:return Be.key===Ut?qe(Oe,ke,Be,tt):null;case $:return Be=je(Be),Ge(Oe,ke,Be,tt)}if(ie(Be)||U(Be))return Ut!==null?null:Je(Oe,ke,Be,tt,null);if(typeof Be.then=="function")return Ge(Oe,ke,_t(Be),tt);if(Be.$$typeof===k)return Ge(Oe,ke,ru(Oe,Be),tt);At(Oe,Be)}return null}function Ve(Oe,ke,Be,tt,Ut){if(typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint")return Oe=Oe.get(Be)||null,se(ke,Oe,""+tt,Ut);if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case g:return Oe=Oe.get(tt.key===null?Be:tt.key)||null,xe(ke,Oe,tt,Ut);case A:return Oe=Oe.get(tt.key===null?Be:tt.key)||null,qe(ke,Oe,tt,Ut);case $:return tt=je(tt),Ve(Oe,ke,Be,tt,Ut)}if(ie(tt)||U(tt))return Oe=Oe.get(Be)||null,Je(ke,Oe,tt,Ut,null);if(typeof tt.then=="function")return Ve(Oe,ke,Be,_t(tt),Ut);if(tt.$$typeof===k)return Ve(Oe,ke,Be,ru(ke,tt),Ut);At(ke,tt)}return null}function Tt(Oe,ke,Be,tt){for(var Ut=null,In=null,Mt=ke,an=ke=0,pn=null;Mt!==null&&an<Be.length;an++){Mt.index>an?(pn=Mt,Mt=null):pn=Mt.sibling;var Rn=Ge(Oe,Mt,Be[an],tt);if(Rn===null){Mt===null&&(Mt=pn);break}r&&Mt&&Rn.alternate===null&&s(Oe,Mt),ke=T(Rn,ke,an),In===null?Ut=Rn:In.sibling=Rn,In=Rn,Mt=pn}if(an===Be.length)return f(Oe,Mt),un&&Pr(Oe,an),Ut;if(Mt===null){for(;an<Be.length;an++)Mt=it(Oe,Be[an],tt),Mt!==null&&(ke=T(Mt,ke,an),In===null?Ut=Mt:In.sibling=Mt,In=Mt);return un&&Pr(Oe,an),Ut}for(Mt=m(Mt);an<Be.length;an++)pn=Ve(Mt,Oe,an,Be[an],tt),pn!==null&&(r&&pn.alternate!==null&&Mt.delete(pn.key===null?an:pn.key),ke=T(pn,ke,an),In===null?Ut=pn:In.sibling=pn,In=pn);return r&&Mt.forEach(function(kl){return s(Oe,kl)}),un&&Pr(Oe,an),Ut}function Gt(Oe,ke,Be,tt){if(Be==null)throw Error(i(151));for(var Ut=null,In=null,Mt=ke,an=ke=0,pn=null,Rn=Be.next();Mt!==null&&!Rn.done;an++,Rn=Be.next()){Mt.index>an?(pn=Mt,Mt=null):pn=Mt.sibling;var kl=Ge(Oe,Mt,Rn.value,tt);if(kl===null){Mt===null&&(Mt=pn);break}r&&Mt&&kl.alternate===null&&s(Oe,Mt),ke=T(kl,ke,an),In===null?Ut=kl:In.sibling=kl,In=kl,Mt=pn}if(Rn.done)return f(Oe,Mt),un&&Pr(Oe,an),Ut;if(Mt===null){for(;!Rn.done;an++,Rn=Be.next())Rn=it(Oe,Rn.value,tt),Rn!==null&&(ke=T(Rn,ke,an),In===null?Ut=Rn:In.sibling=Rn,In=Rn);return un&&Pr(Oe,an),Ut}for(Mt=m(Mt);!Rn.done;an++,Rn=Be.next())Rn=Ve(Mt,Oe,an,Rn.value,tt),Rn!==null&&(r&&Rn.alternate!==null&&Mt.delete(Rn.key===null?an:Rn.key),ke=T(Rn,ke,an),In===null?Ut=Rn:In.sibling=Rn,In=Rn);return r&&Mt.forEach(function(uN){return s(Oe,uN)}),un&&Pr(Oe,an),Ut}function Wn(Oe,ke,Be,tt){if(typeof Be=="object"&&Be!==null&&Be.type===_&&Be.key===null&&(Be=Be.props.children),typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case g:e:{for(var Ut=Be.key;ke!==null;){if(ke.key===Ut){if(Ut=Be.type,Ut===_){if(ke.tag===7){f(Oe,ke.sibling),tt=S(ke,Be.props.children),tt.return=Oe,Oe=tt;break e}}else if(ke.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===$&&je(Ut)===ke.type){f(Oe,ke.sibling),tt=S(ke,Be.props),Wt(tt,Be),tt.return=Oe,Oe=tt;break e}f(Oe,ke);break}else s(Oe,ke);ke=ke.sibling}Be.type===_?(tt=Va(Be.props.children,Oe.mode,tt,Be.key),tt.return=Oe,Oe=tt):(tt=sl(Be.type,Be.key,Be.props,null,Oe.mode,tt),Wt(tt,Be),tt.return=Oe,Oe=tt)}return H(Oe);case A:e:{for(Ut=Be.key;ke!==null;){if(ke.key===Ut)if(ke.tag===4&&ke.stateNode.containerInfo===Be.containerInfo&&ke.stateNode.implementation===Be.implementation){f(Oe,ke.sibling),tt=S(ke,Be.children||[]),tt.return=Oe,Oe=tt;break e}else{f(Oe,ke);break}else s(Oe,ke);ke=ke.sibling}tt=ll(Be,Oe.mode,tt),tt.return=Oe,Oe=tt}return H(Oe);case $:return Be=je(Be),Wn(Oe,ke,Be,tt)}if(ie(Be))return Tt(Oe,ke,Be,tt);if(U(Be)){if(Ut=U(Be),typeof Ut!="function")throw Error(i(150));return Be=Ut.call(Be),Gt(Oe,ke,Be,tt)}if(typeof Be.then=="function")return Wn(Oe,ke,_t(Be),tt);if(Be.$$typeof===k)return Wn(Oe,ke,ru(Oe,Be),tt);At(Oe,Be)}return typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint"?(Be=""+Be,ke!==null&&ke.tag===6?(f(Oe,ke.sibling),tt=S(ke,Be),tt.return=Oe,Oe=tt):(f(Oe,ke),tt=hc(Be,Oe.mode,tt),tt.return=Oe,Oe=tt),H(Oe)):f(Oe,ke)}return function(Oe,ke,Be,tt){try{kt=0;var Ut=Wn(Oe,ke,Be,tt);return rt=null,Ut}catch(Mt){if(Mt===Ae||Mt===me)throw Mt;var In=ir(29,Mt,null,Oe.mode);return In.lanes=tt,In.return=Oe,In}finally{}}}var Kn=cn(!0),Qt=cn(!1),St=!1;function gt(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ii(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Ht(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function nn(r,s,f){var m=r.updateQueue;if(m===null)return null;if(m=m.shared,(Pn&2)!==0){var S=m.pending;return S===null?s.next=s:(s.next=S.next,S.next=s),m.pending=s,s=nr(r),dc(r,null,f),s}return uc(r,m,s,f),nr(r)}function Mn(r,s,f){if(s=s.updateQueue,s!==null&&(s=s.shared,(f&4194048)!==0)){var m=s.lanes;m&=r.pendingLanes,f|=m,s.lanes=f,Nn(r,f)}}function Mi(r,s){var f=r.updateQueue,m=r.alternate;if(m!==null&&(m=m.updateQueue,f===m)){var S=null,T=null;if(f=f.firstBaseUpdate,f!==null){do{var H={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};T===null?S=T=H:T=T.next=H,f=f.next}while(f!==null);T===null?S=T=s:T=T.next=s}else S=T=s;f={baseState:m.baseState,firstBaseUpdate:S,lastBaseUpdate:T,shared:m.shared,callbacks:m.callbacks},r.updateQueue=f;return}r=f.lastBaseUpdate,r===null?f.firstBaseUpdate=s:r.next=s,f.lastBaseUpdate=s}var Ji=!1;function Vn(){if(Ji){var r=N;if(r!==null)throw r}}function Si(r,s,f,m){Ji=!1;var S=r.updateQueue;St=!1;var T=S.firstBaseUpdate,H=S.lastBaseUpdate,se=S.shared.pending;if(se!==null){S.shared.pending=null;var xe=se,qe=xe.next;xe.next=null,H===null?T=qe:H.next=qe,H=xe;var Je=r.alternate;Je!==null&&(Je=Je.updateQueue,se=Je.lastBaseUpdate,se!==H&&(se===null?Je.firstBaseUpdate=qe:se.next=qe,Je.lastBaseUpdate=xe))}if(T!==null){var it=S.baseState;H=0,Je=qe=xe=null,se=T;do{var Ge=se.lane&-536870913,Ve=Ge!==se.lane;if(Ve?(hn&Ge)===Ge:(m&Ge)===Ge){Ge!==0&&Ge===x&&(Ji=!0),Je!==null&&(Je=Je.next={lane:0,tag:se.tag,payload:se.payload,callback:null,next:null});e:{var Tt=r,Gt=se;Ge=s;var Wn=f;switch(Gt.tag){case 1:if(Tt=Gt.payload,typeof Tt=="function"){it=Tt.call(Wn,it,Ge);break e}it=Tt;break e;case 3:Tt.flags=Tt.flags&-65537|128;case 0:if(Tt=Gt.payload,Ge=typeof Tt=="function"?Tt.call(Wn,it,Ge):Tt,Ge==null)break e;it=v({},it,Ge);break e;case 2:St=!0}}Ge=se.callback,Ge!==null&&(r.flags|=64,Ve&&(r.flags|=8192),Ve=S.callbacks,Ve===null?S.callbacks=[Ge]:Ve.push(Ge))}else Ve={lane:Ge,tag:se.tag,payload:se.payload,callback:se.callback,next:null},Je===null?(qe=Je=Ve,xe=it):Je=Je.next=Ve,H|=Ge;if(se=se.next,se===null){if(se=S.shared.pending,se===null)break;Ve=se,se=Ve.next,Ve.next=null,S.lastBaseUpdate=Ve,S.shared.pending=null}}while(!0);Je===null&&(xe=it),S.baseState=xe,S.firstBaseUpdate=qe,S.lastBaseUpdate=Je,T===null&&(S.shared.lanes=0),bl|=H,r.lanes=H,r.memoizedState=it}}function rr(r,s){if(typeof r!="function")throw Error(i(191,r));r.call(s)}function Ei(r,s){var f=r.callbacks;if(f!==null)for(r.callbacks=null,r=0;r<f.length;r++)rr(f[r],s)}var ln=G(null),_n=G(0);function ri(r,s){r=Us,ee(_n,r),ee(ln,s),Us=r|s.baseLanes}function Tn(){ee(_n,Us),ee(ln,ln.current)}function Di(){Us=_n.current,O(ln),O(_n)}var oi=G(null),Sn=null;function bi(r){var s=r.alternate;ee(yn,yn.current&1),ee(oi,r),Sn===null&&(s===null||ln.current!==null||s.memoizedState!==null)&&(Sn=r)}function Dn(r){ee(yn,yn.current),ee(oi,r),Sn===null&&(Sn=r)}function Ni(r){r.tag===22?(ee(yn,yn.current),ee(oi,r),Sn===null&&(Sn=r)):Ai()}function Ai(){ee(yn,yn.current),ee(oi,oi.current)}function Un(r){O(oi),Sn===r&&(Sn=null),O(yn)}var yn=G(0);function or(r){for(var s=r;s!==null;){if(s.tag===13){var f=s.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||q0(f)||H0(f)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var ci=0,Pt=null,Ot=null,En=null,xr=!1,Qr=!1,mr=!1,Ci=0,Za=0,Qa=null,au=0;function $n(){throw Error(i(321))}function dd(r,s){if(s===null)return!1;for(var f=0;f<s.length&&f<r.length;f++)if(!Vi(r[f],s[f]))return!1;return!0}function fd(r,s,f,m,S,T){return ci=T,Pt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,J.H=r===null||r.memoizedState===null?F1:Qp,mr=!1,T=f(m,S),mr=!1,Qr&&(T=wa(s,f,m,S)),su(r),T}function su(r){J.H=xd;var s=Ot!==null&&Ot.next!==null;if(ci=0,En=Ot=Pt=null,xr=!1,Za=0,Qa=null,s)throw Error(i(300));r===null||Bi||(r=r.dependencies,r!==null&&iu(r)&&(Bi=!0))}function wa(r,s,f,m){Pt=r;var S=0;do{if(Qr&&(Qa=null),Za=0,Qr=!1,25<=S)throw Error(i(301));if(S+=1,En=Ot=null,r.updateQueue!=null){var T=r.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}J.H=B1,T=s(f,m)}while(Qr);return T}function $p(){var r=J.H,s=r.useState()[0];return s=typeof s.then=="function"?es(s):s,r=r.useState()[0],(Ot!==null?Ot.memoizedState:null)!==r&&(Pt.flags|=1024),s}function hd(){var r=Ci!==0;return Ci=0,r}function pd(r,s,f){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~f}function lu(r){if(xr){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}xr=!1}ci=0,En=Ot=Pt=null,Qr=!1,Za=Ci=0,Qa=null}function Fi(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?Pt.memoizedState=En=r:En=En.next=r,En}function ui(){if(Ot===null){var r=Pt.alternate;r=r!==null?r.memoizedState:null}else r=Ot.next;var s=En===null?Pt.memoizedState:En.next;if(s!==null)En=s,Ot=r;else{if(r===null)throw Pt.alternate===null?Error(i(467)):Error(i(310));Ot=r,r={memoizedState:Ot.memoizedState,baseState:Ot.baseState,baseQueue:Ot.baseQueue,queue:Ot.queue,next:null},En===null?Pt.memoizedState=En=r:En=En.next=r}return En}function vc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function es(r){var s=Za;return Za+=1,Qa===null&&(Qa=[]),r=Xe(Qa,r,s),s=Pt,(En===null?s.memoizedState:En.next)===null&&(s=s.alternate,J.H=s===null||s.memoizedState===null?F1:Qp),r}function hl(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return es(r);if(r.$$typeof===k)return Xi(r)}throw Error(i(438,String(r)))}function Ts(r){var s=null,f=Pt.updateQueue;if(f!==null&&(s=f.memoCache),s==null){var m=Pt.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(s={data:m.data.map(function(S){return S.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),f===null&&(f=vc(),Pt.updateQueue=f),f.memoCache=s,f=s.data[s.index],f===void 0)for(f=s.data[s.index]=Array(r),m=0;m<r;m++)f[m]=X;return s.index++,f}function Go(r,s){return typeof s=="function"?s(r):s}function cu(r){var s=ui();return pl(s,Ot,r)}function pl(r,s,f){var m=r.queue;if(m===null)throw Error(i(311));m.lastRenderedReducer=f;var S=r.baseQueue,T=m.pending;if(T!==null){if(S!==null){var H=S.next;S.next=T.next,T.next=H}s.baseQueue=S=T,m.pending=null}if(T=r.baseState,S===null)r.memoizedState=T;else{s=S.next;var se=H=null,xe=null,qe=s,Je=!1;do{var it=qe.lane&-536870913;if(it!==qe.lane?(hn&it)===it:(ci&it)===it){var Ge=qe.revertLane;if(Ge===0)xe!==null&&(xe=xe.next={lane:0,revertLane:0,gesture:null,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null}),it===x&&(Je=!0);else if((ci&Ge)===Ge){qe=qe.next,Ge===x&&(Je=!0);continue}else it={lane:0,revertLane:qe.revertLane,gesture:null,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null},xe===null?(se=xe=it,H=T):xe=xe.next=it,Pt.lanes|=Ge,bl|=Ge;it=qe.action,mr&&f(T,it),T=qe.hasEagerState?qe.eagerState:f(T,it)}else Ge={lane:it,revertLane:qe.revertLane,gesture:qe.gesture,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null},xe===null?(se=xe=Ge,H=T):xe=xe.next=Ge,Pt.lanes|=it,bl|=it;qe=qe.next}while(qe!==null&&qe!==s);if(xe===null?H=T:xe.next=se,!Vi(T,r.memoizedState)&&(Bi=!0,Je&&(f=N,f!==null)))throw f;r.memoizedState=T,r.baseState=H,r.baseQueue=xe,m.lastRenderedState=T}return S===null&&(m.lanes=0),[r.memoizedState,m.dispatch]}function uu(r){var s=ui(),f=s.queue;if(f===null)throw Error(i(311));f.lastRenderedReducer=r;var m=f.dispatch,S=f.pending,T=s.memoizedState;if(S!==null){f.pending=null;var H=S=S.next;do T=r(T,H.action),H=H.next;while(H!==S);Vi(T,s.memoizedState)||(Bi=!0),s.memoizedState=T,s.baseQueue===null&&(s.baseState=T),f.lastRenderedState=T}return[T,m]}function du(r,s,f){var m=Pt,S=ui(),T=un;if(T){if(f===void 0)throw Error(i(407));f=f()}else f=s();var H=!Vi((Ot||S).memoizedState,f);if(H&&(S.memoizedState=f,Bi=!0),S=S.queue,Yp(gd.bind(null,m,S,r),[r]),S.getSnapshot!==s||H||En!==null&&En.memoizedState.tag&1){if(m.flags|=2048,Is(9,{destroy:void 0},md.bind(null,m,S,f,s),null),Zn===null)throw Error(i(349));T||(ci&127)!==0||_a(m,s,f)}return f}function _a(r,s,f){r.flags|=16384,r={getSnapshot:s,value:f},s=Pt.updateQueue,s===null?(s=vc(),Pt.updateQueue=s,s.stores=[r]):(f=s.stores,f===null?s.stores=[r]:f.push(r))}function md(r,s,f,m){s.value=f,s.getSnapshot=m,Tf(s)&&vd(r)}function gd(r,s,f){return f(function(){Tf(s)&&vd(r)})}function Tf(r){var s=r.getSnapshot;r=r.value;try{var f=s();return!Vi(r,f)}catch{return!0}}function vd(r){var s=ba(r,2);s!==null&&ro(s,r,2)}function ts(r){var s=Fi();if(typeof r=="function"){var f=r;if(r=f(),mr){Rt(!0);try{f()}finally{Rt(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Go,lastRenderedState:r},s}function kf(r,s,f,m){return r.baseState=f,pl(r,Ot,typeof m=="function"?m:Go)}function If(r,s,f,m,S){if(Df(r))throw Error(i(485));if(r=s.action,r!==null){var T={payload:S,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(H){T.listeners.push(H)}};J.T!==null?f(!0):T.isTransition=!1,m(T),f=s.pending,f===null?(T.next=s.pending=T,Rf(s,T)):(T.next=f.next,s.pending=f.next=T)}}function Rf(r,s){var f=s.action,m=s.payload,S=r.state;if(s.isTransition){var T=J.T,H={};J.T=H;try{var se=f(S,m),xe=J.S;xe!==null&&xe(H,se),yd(r,s,se)}catch(qe){ks(r,s,qe)}finally{T!==null&&H.types!==null&&(T.types=H.types),J.T=T}}else try{T=f(S,m),yd(r,s,T)}catch(qe){ks(r,s,qe)}}function yd(r,s,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(m){Lf(r,s,m)},function(m){return ks(r,s,m)}):Lf(r,s,f)}function Lf(r,s,f){s.status="fulfilled",s.value=f,fu(s),r.state=f,s=r.pending,s!==null&&(f=s.next,f===s?r.pending=null:(f=f.next,s.next=f,Rf(r,f)))}function ks(r,s,f){var m=r.pending;if(r.pending=null,m!==null){m=m.next;do s.status="rejected",s.reason=f,fu(s),s=s.next;while(s!==m)}r.action=null}function fu(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function yc(r,s){return s}function Vo(r,s){if(un){var f=Zn.formState;if(f!==null){e:{var m=Pt;if(un){if(Jn){t:{for(var S=Jn,T=li;S.nodeType!==8;){if(!T){S=null;break t}if(S=$o(S.nextSibling),S===null){S=null;break t}}T=S.data,S=T==="F!"||T==="F"?S:null}if(S){Jn=$o(S.nextSibling),m=S.data==="F!";break e}}Ya(m)}m=!1}m&&(s=f[0])}}return f=Fi(),f.memoizedState=f.baseState=s,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yc,lastRenderedState:s},f.queue=m,f=U1.bind(null,Pt,m),m.dispatch=f,m=ts(!1),T=Zp.bind(null,Pt,!1,m.queue),m=Fi(),S={state:s,dispatch:null,action:r,pending:null},m.queue=S,f=If.bind(null,Pt,S,T,f),S.dispatch=f,m.memoizedState=r,[s,f,!1]}function Sa(r){var s=ui();return Ea(s,Ot,r)}function Ea(r,s,f){if(s=pl(r,s,yc)[0],r=cu(Go)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var m=es(s)}catch(H){throw H===Ae?me:H}else m=s;s=ui();var S=s.queue,T=S.dispatch;return f!==s.memoizedState&&(Pt.flags|=2048,Is(9,{destroy:void 0},hu.bind(null,S,f),null)),[m,T,r]}function hu(r,s){r.action=s}function pu(r){var s=ui(),f=Ot;if(f!==null)return Ea(s,f,r);ui(),s=s.memoizedState,f=ui();var m=f.queue.dispatch;return f.memoizedState=r,[s,m,!1]}function Is(r,s,f,m){return r={tag:r,create:f,deps:m,inst:s,next:null},s=Pt.updateQueue,s===null&&(s=vc(),Pt.updateQueue=s),f=s.lastEffect,f===null?s.lastEffect=r.next=r:(m=f.next,f.next=r,r.next=m,s.lastEffect=r),r}function Mf(){return ui().memoizedState}function ml(r,s,f,m){var S=Fi();Pt.flags|=r,S.memoizedState=Is(1|s,{destroy:void 0},f,m===void 0?null:m)}function gl(r,s,f,m){var S=ui();m=m===void 0?null:m;var T=S.memoizedState.inst;Ot!==null&&m!==null&&dd(m,Ot.memoizedState.deps)?S.memoizedState=Is(s,T,f,m):(Pt.flags|=r,S.memoizedState=Is(1|s,T,f,m))}function S1(r,s){ml(8390656,8,r,s)}function Yp(r,s){gl(2048,8,r,s)}function rE(r){Pt.flags|=4;var s=Pt.updateQueue;if(s===null)s=vc(),Pt.updateQueue=s,s.events=[r];else{var f=s.events;f===null?s.events=[r]:f.push(r)}}function E1(r){var s=ui().memoizedState;return rE({ref:s,nextImpl:r}),function(){if((Pn&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function N1(r,s){return gl(4,2,r,s)}function A1(r,s){return gl(4,4,r,s)}function C1(r,s){if(typeof s=="function"){r=r();var f=s(r);return function(){typeof f=="function"?f():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function T1(r,s,f){f=f!=null?f.concat([r]):null,gl(4,4,C1.bind(null,s,r),f)}function Wp(){}function k1(r,s){var f=ui();s=s===void 0?null:s;var m=f.memoizedState;return s!==null&&dd(s,m[1])?m[0]:(f.memoizedState=[r,s],r)}function I1(r,s){var f=ui();s=s===void 0?null:s;var m=f.memoizedState;if(s!==null&&dd(s,m[1]))return m[0];if(m=r(),mr){Rt(!0);try{r()}finally{Rt(!1)}}return f.memoizedState=[m,s],m}function Xp(r,s,f){return f===void 0||(ci&1073741824)!==0&&(hn&261930)===0?r.memoizedState=s:(r.memoizedState=f,r=Rv(),Pt.lanes|=r,bl|=r,f)}function R1(r,s,f,m){return Vi(f,s)?f:ln.current!==null?(r=Xp(r,f,m),Vi(r,s)||(Bi=!0),r):(ci&42)===0||(ci&1073741824)!==0&&(hn&261930)===0?(Bi=!0,r.memoizedState=f):(r=Rv(),Pt.lanes|=r,bl|=r,s)}function L1(r,s,f,m,S){var T=Y.p;Y.p=T!==0&&8>T?T:8;var H=J.T,se={};J.T=se,Zp(r,!1,s,f);try{var xe=S(),qe=J.S;if(qe!==null&&qe(se,xe),xe!==null&&typeof xe=="object"&&typeof xe.then=="function"){var Je=Q(xe,m);bd(r,s,Je,Ao(r))}else bd(r,s,m,Ao(r))}catch(it){bd(r,s,{then:function(){},status:"rejected",reason:it},Ao())}finally{Y.p=T,H!==null&&se.types!==null&&(H.types=se.types),J.T=H}}function oE(){}function Jp(r,s,f,m){if(r.tag!==5)throw Error(i(476));var S=M1(r).queue;L1(r,S,s,le,f===null?oE:function(){return D1(r),f(m)})}function M1(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:le,baseState:le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Go,lastRenderedState:le},next:null};var f={};return s.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Go,lastRenderedState:f},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function D1(r){var s=M1(r);s.next===null&&(s=r.alternate.memoizedState),bd(r,s.next.queue,{},Ao())}function Kp(){return Xi(Od)}function P1(){return ui().memoizedState}function O1(){return ui().memoizedState}function aE(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var f=Ao();r=Ht(f);var m=nn(s,r,f);m!==null&&(ro(m,s,f),Mn(m,s,f)),s={cache:fl()},r.payload=s;return}s=s.return}}function sE(r,s,f){var m=Ao();f={lane:m,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Df(r)?z1(s,f):(f=Xc(r,s,f,m),f!==null&&(ro(f,r,m),j1(f,s,m)))}function U1(r,s,f){var m=Ao();bd(r,s,f,m)}function bd(r,s,f,m){var S={lane:m,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Df(r))z1(s,S);else{var T=r.alternate;if(r.lanes===0&&(T===null||T.lanes===0)&&(T=s.lastRenderedReducer,T!==null))try{var H=s.lastRenderedState,se=T(H,f);if(S.hasEagerState=!0,S.eagerState=se,Vi(se,H))return uc(r,s,S,0),Zn===null&&cc(),!1}catch{}finally{}if(f=Xc(r,s,S,m),f!==null)return ro(f,r,m),j1(f,s,m),!0}return!1}function Zp(r,s,f,m){if(m={lane:2,revertLane:I0(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Df(r)){if(s)throw Error(i(479))}else s=Xc(r,f,m,2),s!==null&&ro(s,r,2)}function Df(r){var s=r.alternate;return r===Pt||s!==null&&s===Pt}function z1(r,s){Qr=xr=!0;var f=r.pending;f===null?s.next=s:(s.next=f.next,f.next=s),r.pending=s}function j1(r,s,f){if((f&4194048)!==0){var m=s.lanes;m&=r.pendingLanes,f|=m,s.lanes=f,Nn(r,f)}}var xd={readContext:Xi,use:hl,useCallback:$n,useContext:$n,useEffect:$n,useImperativeHandle:$n,useLayoutEffect:$n,useInsertionEffect:$n,useMemo:$n,useReducer:$n,useRef:$n,useState:$n,useDebugValue:$n,useDeferredValue:$n,useTransition:$n,useSyncExternalStore:$n,useId:$n,useHostTransitionStatus:$n,useFormState:$n,useActionState:$n,useOptimistic:$n,useMemoCache:$n,useCacheRefresh:$n};xd.useEffectEvent=$n;var F1={readContext:Xi,use:hl,useCallback:function(r,s){return Fi().memoizedState=[r,s===void 0?null:s],r},useContext:Xi,useEffect:S1,useImperativeHandle:function(r,s,f){f=f!=null?f.concat([r]):null,ml(4194308,4,C1.bind(null,s,r),f)},useLayoutEffect:function(r,s){return ml(4194308,4,r,s)},useInsertionEffect:function(r,s){ml(4,2,r,s)},useMemo:function(r,s){var f=Fi();s=s===void 0?null:s;var m=r();if(mr){Rt(!0);try{r()}finally{Rt(!1)}}return f.memoizedState=[m,s],m},useReducer:function(r,s,f){var m=Fi();if(f!==void 0){var S=f(s);if(mr){Rt(!0);try{f(s)}finally{Rt(!1)}}}else S=s;return m.memoizedState=m.baseState=S,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:S},m.queue=r,r=r.dispatch=sE.bind(null,Pt,r),[m.memoizedState,r]},useRef:function(r){var s=Fi();return r={current:r},s.memoizedState=r},useState:function(r){r=ts(r);var s=r.queue,f=U1.bind(null,Pt,s);return s.dispatch=f,[r.memoizedState,f]},useDebugValue:Wp,useDeferredValue:function(r,s){var f=Fi();return Xp(f,r,s)},useTransition:function(){var r=ts(!1);return r=L1.bind(null,Pt,r.queue,!0,!1),Fi().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,f){var m=Pt,S=Fi();if(un){if(f===void 0)throw Error(i(407));f=f()}else{if(f=s(),Zn===null)throw Error(i(349));(hn&127)!==0||_a(m,s,f)}S.memoizedState=f;var T={value:f,getSnapshot:s};return S.queue=T,S1(gd.bind(null,m,T,r),[r]),m.flags|=2048,Is(9,{destroy:void 0},md.bind(null,m,T,f,s),null),f},useId:function(){var r=Fi(),s=Zn.identifierPrefix;if(un){var f=Kr,m=Jr;f=(m&~(1<<32-Ft(m)-1)).toString(32)+f,s="_"+s+"R_"+f,f=Ci++,0<f&&(s+="H"+f.toString(32)),s+="_"}else f=au++,s="_"+s+"r_"+f.toString(32)+"_";return r.memoizedState=s},useHostTransitionStatus:Kp,useFormState:Vo,useActionState:Vo,useOptimistic:function(r){var s=Fi();s.memoizedState=s.baseState=r;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=f,s=Zp.bind(null,Pt,!0,f),f.dispatch=s,[r,s]},useMemoCache:Ts,useCacheRefresh:function(){return Fi().memoizedState=aE.bind(null,Pt)},useEffectEvent:function(r){var s=Fi(),f={impl:r};return s.memoizedState=f,function(){if((Pn&2)!==0)throw Error(i(440));return f.impl.apply(void 0,arguments)}}},Qp={readContext:Xi,use:hl,useCallback:k1,useContext:Xi,useEffect:Yp,useImperativeHandle:T1,useInsertionEffect:N1,useLayoutEffect:A1,useMemo:I1,useReducer:cu,useRef:Mf,useState:function(){return cu(Go)},useDebugValue:Wp,useDeferredValue:function(r,s){var f=ui();return R1(f,Ot.memoizedState,r,s)},useTransition:function(){var r=cu(Go)[0],s=ui().memoizedState;return[typeof r=="boolean"?r:es(r),s]},useSyncExternalStore:du,useId:P1,useHostTransitionStatus:Kp,useFormState:Sa,useActionState:Sa,useOptimistic:function(r,s){var f=ui();return kf(f,Ot,r,s)},useMemoCache:Ts,useCacheRefresh:O1};Qp.useEffectEvent=E1;var B1={readContext:Xi,use:hl,useCallback:k1,useContext:Xi,useEffect:Yp,useImperativeHandle:T1,useInsertionEffect:N1,useLayoutEffect:A1,useMemo:I1,useReducer:uu,useRef:Mf,useState:function(){return uu(Go)},useDebugValue:Wp,useDeferredValue:function(r,s){var f=ui();return Ot===null?Xp(f,r,s):R1(f,Ot.memoizedState,r,s)},useTransition:function(){var r=uu(Go)[0],s=ui().memoizedState;return[typeof r=="boolean"?r:es(r),s]},useSyncExternalStore:du,useId:P1,useHostTransitionStatus:Kp,useFormState:pu,useActionState:pu,useOptimistic:function(r,s){var f=ui();return Ot!==null?kf(f,Ot,r,s):(f.baseState=r,[r,f.queue.dispatch])},useMemoCache:Ts,useCacheRefresh:O1};B1.useEffectEvent=E1;function e0(r,s,f,m){s=r.memoizedState,f=f(m,s),f=f==null?s:v({},s,f),r.memoizedState=f,r.lanes===0&&(r.updateQueue.baseState=f)}var t0={enqueueSetState:function(r,s,f){r=r._reactInternals;var m=Ao(),S=Ht(m);S.payload=s,f!=null&&(S.callback=f),s=nn(r,S,m),s!==null&&(ro(s,r,m),Mn(s,r,m))},enqueueReplaceState:function(r,s,f){r=r._reactInternals;var m=Ao(),S=Ht(m);S.tag=1,S.payload=s,f!=null&&(S.callback=f),s=nn(r,S,m),s!==null&&(ro(s,r,m),Mn(s,r,m))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var f=Ao(),m=Ht(f);m.tag=2,s!=null&&(m.callback=s),s=nn(r,m,f),s!==null&&(ro(s,r,f),Mn(s,r,f))}};function q1(r,s,f,m,S,T,H){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(m,T,H):s.prototype&&s.prototype.isPureReactComponent?!ma(f,m)||!ma(S,T):!0}function H1(r,s,f,m){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(f,m),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(f,m),s.state!==r&&t0.enqueueReplaceState(s,s.state,null)}function bc(r,s){var f=s;if("ref"in s){f={};for(var m in s)m!=="ref"&&(f[m]=s[m])}if(r=r.defaultProps){f===s&&(f=v({},f));for(var S in r)f[S]===void 0&&(f[S]=r[S])}return f}function G1(r){lc(r)}function V1(r){console.error(r)}function $1(r){lc(r)}function Pf(r,s){try{var f=r.onUncaughtError;f(s.value,{componentStack:s.stack})}catch(m){setTimeout(function(){throw m})}}function Y1(r,s,f){try{var m=r.onCaughtError;m(f.value,{componentStack:f.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function n0(r,s,f){return f=Ht(f),f.tag=3,f.payload={element:null},f.callback=function(){Pf(r,s)},f}function W1(r){return r=Ht(r),r.tag=3,r}function X1(r,s,f,m){var S=f.type.getDerivedStateFromError;if(typeof S=="function"){var T=m.value;r.payload=function(){return S(T)},r.callback=function(){Y1(s,f,m)}}var H=f.stateNode;H!==null&&typeof H.componentDidCatch=="function"&&(r.callback=function(){Y1(s,f,m),typeof S!="function"&&(xl===null?xl=new Set([this]):xl.add(this));var se=m.stack;this.componentDidCatch(m.value,{componentStack:se!==null?se:""})})}function lE(r,s,f,m,S){if(f.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(s=f.alternate,s!==null&&Ja(s,f,S,!0),f=oi.current,f!==null){switch(f.tag){case 31:case 13:return Sn===null?Yf():f.alternate===null&&Ti===0&&(Ti=3),f.flags&=-257,f.flags|=65536,f.lanes=S,m===Re?f.flags|=16384:(s=f.updateQueue,s===null?f.updateQueue=new Set([m]):s.add(m),C0(r,m,S)),!1;case 22:return f.flags|=65536,m===Re?f.flags|=16384:(s=f.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([m])},f.updateQueue=s):(f=s.retryQueue,f===null?s.retryQueue=new Set([m]):f.add(m)),C0(r,m,S)),!1}throw Error(i(435,f.tag))}return C0(r,m,S),Yf(),!1}if(un)return s=oi.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=S,m!==So&&(r=Error(i(422),{cause:m}),ul(Yr(r,f)))):(m!==So&&(s=Error(i(423),{cause:m}),ul(Yr(s,f))),r=r.current.alternate,r.flags|=65536,S&=-S,r.lanes|=S,m=Yr(m,f),S=n0(r.stateNode,m,S),Mi(r,S),Ti!==4&&(Ti=2)),!1;var T=Error(i(520),{cause:m});if(T=Yr(T,f),Td===null?Td=[T]:Td.push(T),Ti!==4&&(Ti=2),s===null)return!0;m=Yr(m,f),f=s;do{switch(f.tag){case 3:return f.flags|=65536,r=S&-S,f.lanes|=r,r=n0(f.stateNode,m,r),Mi(f,r),!1;case 1:if(s=f.type,T=f.stateNode,(f.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(xl===null||!xl.has(T))))return f.flags|=65536,S&=-S,f.lanes|=S,S=W1(S),X1(S,r,f,m),Mi(f,S),!1}f=f.return}while(f!==null);return!1}var i0=Error(i(461)),Bi=!1;function gr(r,s,f,m){s.child=r===null?Qt(s,null,f,m):Kn(s,r.child,f,m)}function J1(r,s,f,m,S){f=f.render;var T=s.ref;if("ref"in m){var H={};for(var se in m)se!=="ref"&&(H[se]=m[se])}else H=m;return Ka(s),m=fd(r,s,f,H,T,S),se=hd(),r!==null&&!Bi?(pd(r,s,S),Rs(r,s,S)):(un&&se&&ld(s),s.flags|=1,gr(r,s,m,S),s.child)}function K1(r,s,f,m,S){if(r===null){var T=f.type;return typeof T=="function"&&!Kc(T)&&T.defaultProps===void 0&&f.compare===null?(s.tag=15,s.type=T,Z1(r,s,T,m,S)):(r=sl(f.type,null,m,s,s.mode,S),r.ref=s.ref,r.return=s,s.child=r)}if(T=r.child,!d0(r,S)){var H=T.memoizedProps;if(f=f.compare,f=f!==null?f:ma,f(H,m)&&r.ref===s.ref)return Rs(r,s,S)}return s.flags|=1,r=$r(T,m),r.ref=s.ref,r.return=s,s.child=r}function Z1(r,s,f,m,S){if(r!==null){var T=r.memoizedProps;if(ma(T,m)&&r.ref===s.ref)if(Bi=!1,s.pendingProps=m=T,d0(r,S))(r.flags&131072)!==0&&(Bi=!0);else return s.lanes=r.lanes,Rs(r,s,S)}return r0(r,s,f,m,S)}function Q1(r,s,f,m){var S=m.children,T=r!==null?r.memoizedState:null;if(r===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((s.flags&128)!==0){if(T=T!==null?T.baseLanes|f:f,r!==null){for(m=s.child=r.child,S=0;m!==null;)S=S|m.lanes|m.childLanes,m=m.sibling;m=S&~T}else m=0,s.child=null;return ev(r,s,T,f,m)}if((f&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&fe(s,T!==null?T.cachePool:null),T!==null?ri(s,T):Tn(),Ni(s);else return m=s.lanes=536870912,ev(r,s,T!==null?T.baseLanes|f:f,f,m)}else T!==null?(fe(s,T.cachePool),ri(s,T),Ai(),s.memoizedState=null):(r!==null&&fe(s,null),Tn(),Ai());return gr(r,s,S,f),s.child}function wd(r,s){return r!==null&&r.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function ev(r,s,f,m,S){var T=ue();return T=T===null?null:{parent:yi._currentValue,pool:T},s.memoizedState={baseLanes:f,cachePool:T},r!==null&&fe(s,null),Tn(),Ni(s),r!==null&&Ja(r,s,m,!0),s.childLanes=S,null}function Of(r,s){return s=zf({mode:s.mode,children:s.children},r.mode),s.ref=r.ref,r.child=s,s.return=r,s}function tv(r,s,f){return Kn(s,r.child,null,f),r=Of(s,s.pendingProps),r.flags|=2,Un(s),s.memoizedState=null,r}function cE(r,s,f){var m=s.pendingProps,S=(s.flags&128)!==0;if(s.flags&=-129,r===null){if(un){if(m.mode==="hidden")return r=Of(s,m),s.lanes=536870912,wd(null,r);if(Dn(s),(r=Jn)?(r=hy(r,li),r=r!==null&&r.data==="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:$a!==null?{id:Jr,overflow:Kr}:null,retryLane:536870912,hydrationErrors:null},f=Zc(r),f.return=s,s.child=f,Yi=s,Jn=null)):r=null,r===null)throw Ya(s);return s.lanes=536870912,null}return Of(s,m)}var T=r.memoizedState;if(T!==null){var H=T.dehydrated;if(Dn(s),S)if(s.flags&256)s.flags&=-257,s=tv(r,s,f);else if(s.memoizedState!==null)s.child=r.child,s.flags|=128,s=null;else throw Error(i(558));else if(Bi||Ja(r,s,f,!1),S=(f&r.childLanes)!==0,Bi||S){if(m=Zn,m!==null&&(H=Xn(m,f),H!==0&&H!==T.retryLane))throw T.retryLane=H,ba(r,H),ro(m,r,H),i0;Yf(),s=tv(r,s,f)}else r=T.treeContext,Jn=$o(H.nextSibling),Yi=s,un=!0,pr=null,li=!1,r!==null&&Af(s,r),s=Of(s,m),s.flags|=4096;return s}return r=$r(r.child,{mode:m.mode,children:m.children}),r.ref=s.ref,s.child=r,r.return=s,r}function Uf(r,s){var f=s.ref;if(f===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(i(284));(r===null||r.ref!==f)&&(s.flags|=4194816)}}function r0(r,s,f,m,S){return Ka(s),f=fd(r,s,f,m,void 0,S),m=hd(),r!==null&&!Bi?(pd(r,s,S),Rs(r,s,S)):(un&&m&&ld(s),s.flags|=1,gr(r,s,f,S),s.child)}function nv(r,s,f,m,S,T){return Ka(s),s.updateQueue=null,f=wa(s,m,f,S),su(r),m=hd(),r!==null&&!Bi?(pd(r,s,T),Rs(r,s,T)):(un&&m&&ld(s),s.flags|=1,gr(r,s,f,T),s.child)}function iv(r,s,f,m,S){if(Ka(s),s.stateNode===null){var T=$i,H=f.contextType;typeof H=="object"&&H!==null&&(T=Xi(H)),T=new f(m,T),s.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=t0,s.stateNode=T,T._reactInternals=s,T=s.stateNode,T.props=m,T.state=s.memoizedState,T.refs={},gt(s),H=f.contextType,T.context=typeof H=="object"&&H!==null?Xi(H):$i,T.state=s.memoizedState,H=f.getDerivedStateFromProps,typeof H=="function"&&(e0(s,f,H,m),T.state=s.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(H=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),H!==T.state&&t0.enqueueReplaceState(T,T.state,null),Si(s,m,T,S),Vn(),T.state=s.memoizedState),typeof T.componentDidMount=="function"&&(s.flags|=4194308),m=!0}else if(r===null){T=s.stateNode;var se=s.memoizedProps,xe=bc(f,se);T.props=xe;var qe=T.context,Je=f.contextType;H=$i,typeof Je=="object"&&Je!==null&&(H=Xi(Je));var it=f.getDerivedStateFromProps;Je=typeof it=="function"||typeof T.getSnapshotBeforeUpdate=="function",se=s.pendingProps!==se,Je||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(se||qe!==H)&&H1(s,T,m,H),St=!1;var Ge=s.memoizedState;T.state=Ge,Si(s,m,T,S),Vn(),qe=s.memoizedState,se||Ge!==qe||St?(typeof it=="function"&&(e0(s,f,it,m),qe=s.memoizedState),(xe=St||q1(s,f,xe,m,Ge,qe,H))?(Je||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(s.flags|=4194308)):(typeof T.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=m,s.memoizedState=qe),T.props=m,T.state=qe,T.context=H,m=xe):(typeof T.componentDidMount=="function"&&(s.flags|=4194308),m=!1)}else{T=s.stateNode,ii(r,s),H=s.memoizedProps,Je=bc(f,H),T.props=Je,it=s.pendingProps,Ge=T.context,qe=f.contextType,xe=$i,typeof qe=="object"&&qe!==null&&(xe=Xi(qe)),se=f.getDerivedStateFromProps,(qe=typeof se=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(H!==it||Ge!==xe)&&H1(s,T,m,xe),St=!1,Ge=s.memoizedState,T.state=Ge,Si(s,m,T,S),Vn();var Ve=s.memoizedState;H!==it||Ge!==Ve||St||r!==null&&r.dependencies!==null&&iu(r.dependencies)?(typeof se=="function"&&(e0(s,f,se,m),Ve=s.memoizedState),(Je=St||q1(s,f,Je,m,Ge,Ve,xe)||r!==null&&r.dependencies!==null&&iu(r.dependencies))?(qe||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(m,Ve,xe),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(m,Ve,xe)),typeof T.componentDidUpdate=="function"&&(s.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof T.componentDidUpdate!="function"||H===r.memoizedProps&&Ge===r.memoizedState||(s.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||H===r.memoizedProps&&Ge===r.memoizedState||(s.flags|=1024),s.memoizedProps=m,s.memoizedState=Ve),T.props=m,T.state=Ve,T.context=xe,m=Je):(typeof T.componentDidUpdate!="function"||H===r.memoizedProps&&Ge===r.memoizedState||(s.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||H===r.memoizedProps&&Ge===r.memoizedState||(s.flags|=1024),m=!1)}return T=m,Uf(r,s),m=(s.flags&128)!==0,T||m?(T=s.stateNode,f=m&&typeof f.getDerivedStateFromError!="function"?null:T.render(),s.flags|=1,r!==null&&m?(s.child=Kn(s,r.child,null,S),s.child=Kn(s,null,f,S)):gr(r,s,f,S),s.memoizedState=T.state,r=s.child):r=Rs(r,s,S),r}function rv(r,s,f,m){return As(),s.flags|=256,gr(r,s,f,m),s.child}var o0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function a0(r){return{baseLanes:r,cachePool:ge()}}function s0(r,s,f){return r=r!==null?r.childLanes&~f:0,s&&(r|=No),r}function ov(r,s,f){var m=s.pendingProps,S=!1,T=(s.flags&128)!==0,H;if((H=T)||(H=r!==null&&r.memoizedState===null?!1:(yn.current&2)!==0),H&&(S=!0,s.flags&=-129),H=(s.flags&32)!==0,s.flags&=-33,r===null){if(un){if(S?bi(s):Ai(),(r=Jn)?(r=hy(r,li),r=r!==null&&r.data!=="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:$a!==null?{id:Jr,overflow:Kr}:null,retryLane:536870912,hydrationErrors:null},f=Zc(r),f.return=s,s.child=f,Yi=s,Jn=null)):r=null,r===null)throw Ya(s);return H0(r)?s.lanes=32:s.lanes=536870912,null}var se=m.children;return m=m.fallback,S?(Ai(),S=s.mode,se=zf({mode:"hidden",children:se},S),m=Va(m,S,f,null),se.return=s,m.return=s,se.sibling=m,s.child=se,m=s.child,m.memoizedState=a0(f),m.childLanes=s0(r,H,f),s.memoizedState=o0,wd(null,m)):(bi(s),l0(s,se))}var xe=r.memoizedState;if(xe!==null&&(se=xe.dehydrated,se!==null)){if(T)s.flags&256?(bi(s),s.flags&=-257,s=c0(r,s,f)):s.memoizedState!==null?(Ai(),s.child=r.child,s.flags|=128,s=null):(Ai(),se=m.fallback,S=s.mode,m=zf({mode:"visible",children:m.children},S),se=Va(se,S,f,null),se.flags|=2,m.return=s,se.return=s,m.sibling=se,s.child=m,Kn(s,r.child,null,f),m=s.child,m.memoizedState=a0(f),m.childLanes=s0(r,H,f),s.memoizedState=o0,s=wd(null,m));else if(bi(s),H0(se)){if(H=se.nextSibling&&se.nextSibling.dataset,H)var qe=H.dgst;H=qe,m=Error(i(419)),m.stack="",m.digest=H,ul({value:m,source:null,stack:null}),s=c0(r,s,f)}else if(Bi||Ja(r,s,f,!1),H=(f&r.childLanes)!==0,Bi||H){if(H=Zn,H!==null&&(m=Xn(H,f),m!==0&&m!==xe.retryLane))throw xe.retryLane=m,ba(r,m),ro(H,r,m),i0;q0(se)||Yf(),s=c0(r,s,f)}else q0(se)?(s.flags|=192,s.child=r.child,s=null):(r=xe.treeContext,Jn=$o(se.nextSibling),Yi=s,un=!0,pr=null,li=!1,r!==null&&Af(s,r),s=l0(s,m.children),s.flags|=4096);return s}return S?(Ai(),se=m.fallback,S=s.mode,xe=r.child,qe=xe.sibling,m=$r(xe,{mode:"hidden",children:m.children}),m.subtreeFlags=xe.subtreeFlags&65011712,qe!==null?se=$r(qe,se):(se=Va(se,S,f,null),se.flags|=2),se.return=s,m.return=s,m.sibling=se,s.child=m,wd(null,m),m=s.child,se=r.child.memoizedState,se===null?se=a0(f):(S=se.cachePool,S!==null?(xe=yi._currentValue,S=S.parent!==xe?{parent:xe,pool:xe}:S):S=ge(),se={baseLanes:se.baseLanes|f,cachePool:S}),m.memoizedState=se,m.childLanes=s0(r,H,f),s.memoizedState=o0,wd(r.child,m)):(bi(s),f=r.child,r=f.sibling,f=$r(f,{mode:"visible",children:m.children}),f.return=s,f.sibling=null,r!==null&&(H=s.deletions,H===null?(s.deletions=[r],s.flags|=16):H.push(r)),s.child=f,s.memoizedState=null,f)}function l0(r,s){return s=zf({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function zf(r,s){return r=ir(22,r,null,s),r.lanes=0,r}function c0(r,s,f){return Kn(s,r.child,null,f),r=l0(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function av(r,s,f){r.lanes|=s;var m=r.alternate;m!==null&&(m.lanes|=s),dl(r.return,s,f)}function u0(r,s,f,m,S,T){var H=r.memoizedState;H===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:m,tail:f,tailMode:S,treeForkCount:T}:(H.isBackwards=s,H.rendering=null,H.renderingStartTime=0,H.last=m,H.tail=f,H.tailMode=S,H.treeForkCount=T)}function sv(r,s,f){var m=s.pendingProps,S=m.revealOrder,T=m.tail;m=m.children;var H=yn.current,se=(H&2)!==0;if(se?(H=H&1|2,s.flags|=128):H&=1,ee(yn,H),gr(r,s,m,f),m=un?pc:0,!se&&r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&av(r,f,s);else if(r.tag===19)av(r,f,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(S){case"forwards":for(f=s.child,S=null;f!==null;)r=f.alternate,r!==null&&or(r)===null&&(S=f),f=f.sibling;f=S,f===null?(S=s.child,s.child=null):(S=f.sibling,f.sibling=null),u0(s,!1,S,f,T,m);break;case"backwards":case"unstable_legacy-backwards":for(f=null,S=s.child,s.child=null;S!==null;){if(r=S.alternate,r!==null&&or(r)===null){s.child=S;break}r=S.sibling,S.sibling=f,f=S,S=r}u0(s,!0,f,null,T,m);break;case"together":u0(s,!1,null,null,void 0,m);break;default:s.memoizedState=null}return s.child}function Rs(r,s,f){if(r!==null&&(s.dependencies=r.dependencies),bl|=s.lanes,(f&s.childLanes)===0)if(r!==null){if(Ja(r,s,f,!1),(f&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(i(153));if(s.child!==null){for(r=s.child,f=$r(r,r.pendingProps),s.child=f,f.return=s;r.sibling!==null;)r=r.sibling,f=f.sibling=$r(r,r.pendingProps),f.return=s;f.sibling=null}return s.child}function d0(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&iu(r)))}function uE(r,s,f){switch(s.tag){case 3:Te(s,s.stateNode.containerInfo),Xa(s,yi,r.memoizedState.cache),As();break;case 27:case 5:De(s);break;case 4:Te(s,s.stateNode.containerInfo);break;case 10:Xa(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Dn(s),null;break;case 13:var m=s.memoizedState;if(m!==null)return m.dehydrated!==null?(bi(s),s.flags|=128,null):(f&s.child.childLanes)!==0?ov(r,s,f):(bi(s),r=Rs(r,s,f),r!==null?r.sibling:null);bi(s);break;case 19:var S=(r.flags&128)!==0;if(m=(f&s.childLanes)!==0,m||(Ja(r,s,f,!1),m=(f&s.childLanes)!==0),S){if(m)return sv(r,s,f);s.flags|=128}if(S=s.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),ee(yn,yn.current),m)break;return null;case 22:return s.lanes=0,Q1(r,s,f,s.pendingProps);case 24:Xa(s,yi,r.memoizedState.cache)}return Rs(r,s,f)}function lv(r,s,f){if(r!==null)if(r.memoizedProps!==s.pendingProps)Bi=!0;else{if(!d0(r,f)&&(s.flags&128)===0)return Bi=!1,uE(r,s,f);Bi=(r.flags&131072)!==0}else Bi=!1,un&&(s.flags&1048576)!==0&&Nf(s,pc,s.index);switch(s.lanes=0,s.tag){case 16:e:{var m=s.pendingProps;if(r=je(s.elementType),s.type=r,typeof r=="function")Kc(r)?(m=bc(r,m),s.tag=1,s=iv(null,s,r,m,f)):(s.tag=0,s=r0(null,s,r,m,f));else{if(r!=null){var S=r.$$typeof;if(S===M){s.tag=11,s=J1(null,s,r,m,f);break e}else if(S===V){s.tag=14,s=K1(null,s,r,m,f);break e}}throw s=I(r)||r,Error(i(306,s,""))}}return s;case 0:return r0(r,s,s.type,s.pendingProps,f);case 1:return m=s.type,S=bc(m,s.pendingProps),iv(r,s,m,S,f);case 3:e:{if(Te(s,s.stateNode.containerInfo),r===null)throw Error(i(387));m=s.pendingProps;var T=s.memoizedState;S=T.element,ii(r,s),Si(s,m,null,f);var H=s.memoizedState;if(m=H.cache,Xa(s,yi,m),m!==T.cache&&Cs(s,[yi],f,!0),Vn(),m=H.element,T.isDehydrated)if(T={element:m,isDehydrated:!1,cache:H.cache},s.updateQueue.baseState=T,s.memoizedState=T,s.flags&256){s=rv(r,s,m,f);break e}else if(m!==S){S=Yr(Error(i(424)),s),ul(S),s=rv(r,s,m,f);break e}else{switch(r=s.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Jn=$o(r.firstChild),Yi=s,un=!0,pr=null,li=!0,f=Qt(s,null,m,f),s.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(As(),m===S){s=Rs(r,s,f);break e}gr(r,s,m,f)}s=s.child}return s;case 26:return Uf(r,s),r===null?(f=by(s.type,null,s.pendingProps,null))?s.memoizedState=f:un||(f=s.type,r=s.pendingProps,m=eh(ye.current).createElement(f),m[On]=s,m[ti]=r,vr(m,f,r),pi(m),s.stateNode=m):s.memoizedState=by(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return De(s),r===null&&un&&(m=s.stateNode=gy(s.type,s.pendingProps,ye.current),Yi=s,li=!0,S=Jn,El(s.type)?(G0=S,Jn=$o(m.firstChild)):Jn=S),gr(r,s,s.pendingProps.children,f),Uf(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&un&&((S=m=Jn)&&(m=FE(m,s.type,s.pendingProps,li),m!==null?(s.stateNode=m,Yi=s,Jn=$o(m.firstChild),li=!1,S=!0):S=!1),S||Ya(s)),De(s),S=s.type,T=s.pendingProps,H=r!==null?r.memoizedProps:null,m=T.children,j0(S,T)?m=null:H!==null&&j0(S,H)&&(s.flags|=32),s.memoizedState!==null&&(S=fd(r,s,$p,null,null,f),Od._currentValue=S),Uf(r,s),gr(r,s,m,f),s.child;case 6:return r===null&&un&&((r=f=Jn)&&(f=BE(f,s.pendingProps,li),f!==null?(s.stateNode=f,Yi=s,Jn=null,r=!0):r=!1),r||Ya(s)),null;case 13:return ov(r,s,f);case 4:return Te(s,s.stateNode.containerInfo),m=s.pendingProps,r===null?s.child=Kn(s,null,m,f):gr(r,s,m,f),s.child;case 11:return J1(r,s,s.type,s.pendingProps,f);case 7:return gr(r,s,s.pendingProps,f),s.child;case 8:return gr(r,s,s.pendingProps.children,f),s.child;case 12:return gr(r,s,s.pendingProps.children,f),s.child;case 10:return m=s.pendingProps,Xa(s,s.type,m.value),gr(r,s,m.children,f),s.child;case 9:return S=s.type._context,m=s.pendingProps.children,Ka(s),S=Xi(S),m=m(S),s.flags|=1,gr(r,s,m,f),s.child;case 14:return K1(r,s,s.type,s.pendingProps,f);case 15:return Z1(r,s,s.type,s.pendingProps,f);case 19:return sv(r,s,f);case 31:return cE(r,s,f);case 22:return Q1(r,s,f,s.pendingProps);case 24:return Ka(s),m=Xi(yi),r===null?(S=ue(),S===null&&(S=Zn,T=fl(),S.pooledCache=T,T.refCount++,T!==null&&(S.pooledCacheLanes|=f),S=T),s.memoizedState={parent:m,cache:S},gt(s),Xa(s,yi,S)):((r.lanes&f)!==0&&(ii(r,s),Si(s,null,null,f),Vn()),S=r.memoizedState,T=s.memoizedState,S.parent!==m?(S={parent:m,cache:m},s.memoizedState=S,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=S),Xa(s,yi,m)):(m=T.cache,Xa(s,yi,m),m!==S.cache&&Cs(s,[yi],f,!0))),gr(r,s,s.pendingProps.children,f),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function Ls(r){r.flags|=4}function f0(r,s,f,m,S){if((s=(r.mode&32)!==0)&&(s=!1),s){if(r.flags|=16777216,(S&335544128)===S)if(r.stateNode.complete)r.flags|=8192;else if(Pv())r.flags|=8192;else throw Ye=Re,Fe}else r.flags&=-16777217}function cv(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Ey(s))if(Pv())r.flags|=8192;else throw Ye=Re,Fe}function jf(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?zt():536870912,r.lanes|=s,yu|=s)}function _d(r,s){if(!un)switch(r.tailMode){case"hidden":s=r.tail;for(var f=null;s!==null;)s.alternate!==null&&(f=s),s=s.sibling;f===null?r.tail=null:f.sibling=null;break;case"collapsed":f=r.tail;for(var m=null;f!==null;)f.alternate!==null&&(m=f),f=f.sibling;m===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:m.sibling=null}}function ai(r){var s=r.alternate!==null&&r.alternate.child===r.child,f=0,m=0;if(s)for(var S=r.child;S!==null;)f|=S.lanes|S.childLanes,m|=S.subtreeFlags&65011712,m|=S.flags&65011712,S.return=r,S=S.sibling;else for(S=r.child;S!==null;)f|=S.lanes|S.childLanes,m|=S.subtreeFlags,m|=S.flags,S.return=r,S=S.sibling;return r.subtreeFlags|=m,r.childLanes=f,s}function dE(r,s,f){var m=s.pendingProps;switch(tu(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ai(s),null;case 1:return ai(s),null;case 3:return f=s.stateNode,m=null,r!==null&&(m=r.memoizedState.cache),s.memoizedState.cache!==m&&(s.flags|=2048),Zr(yi),Ce(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(r===null||r.child===null)&&(Wi(s)?Ls(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,ud())),ai(s),null;case 26:var S=s.type,T=s.memoizedState;return r===null?(Ls(s),T!==null?(ai(s),cv(s,T)):(ai(s),f0(s,S,null,m,f))):T?T!==r.memoizedState?(Ls(s),ai(s),cv(s,T)):(ai(s),s.flags&=-16777217):(r=r.memoizedProps,r!==m&&Ls(s),ai(s),f0(s,S,r,m,f)),null;case 27:if($e(s),f=ye.current,S=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==m&&Ls(s);else{if(!m){if(s.stateNode===null)throw Error(i(166));return ai(s),null}r=te.current,Wi(s)?cd(s):(r=gy(S,m,f),s.stateNode=r,Ls(s))}return ai(s),null;case 5:if($e(s),S=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==m&&Ls(s);else{if(!m){if(s.stateNode===null)throw Error(i(166));return ai(s),null}if(T=te.current,Wi(s))cd(s);else{var H=eh(ye.current);switch(T){case 1:T=H.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:T=H.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":T=H.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":T=H.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":T=H.createElement("div"),T.innerHTML="<script><\/script>",T=T.removeChild(T.firstChild);break;case"select":T=typeof m.is=="string"?H.createElement("select",{is:m.is}):H.createElement("select"),m.multiple?T.multiple=!0:m.size&&(T.size=m.size);break;default:T=typeof m.is=="string"?H.createElement(S,{is:m.is}):H.createElement(S)}}T[On]=s,T[ti]=m;e:for(H=s.child;H!==null;){if(H.tag===5||H.tag===6)T.appendChild(H.stateNode);else if(H.tag!==4&&H.tag!==27&&H.child!==null){H.child.return=H,H=H.child;continue}if(H===s)break e;for(;H.sibling===null;){if(H.return===null||H.return===s)break e;H=H.return}H.sibling.return=H.return,H=H.sibling}s.stateNode=T;e:switch(vr(T,S,m),S){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&Ls(s)}}return ai(s),f0(s,s.type,r===null?null:r.memoizedProps,s.pendingProps,f),null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==m&&Ls(s);else{if(typeof m!="string"&&s.stateNode===null)throw Error(i(166));if(r=ye.current,Wi(s)){if(r=s.stateNode,f=s.memoizedProps,m=null,S=Yi,S!==null)switch(S.tag){case 27:case 5:m=S.memoizedProps}r[On]=s,r=!!(r.nodeValue===f||m!==null&&m.suppressHydrationWarning===!0||oy(r.nodeValue,f)),r||Ya(s,!0)}else r=eh(r).createTextNode(m),r[On]=s,s.stateNode=r}return ai(s),null;case 31:if(f=s.memoizedState,r===null||r.memoizedState!==null){if(m=Wi(s),f!==null){if(r===null){if(!m)throw Error(i(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[On]=s}else As(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;ai(s),r=!1}else f=ud(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=f),r=!0;if(!r)return s.flags&256?(Un(s),s):(Un(s),null);if((s.flags&128)!==0)throw Error(i(558))}return ai(s),null;case 13:if(m=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(S=Wi(s),m!==null&&m.dehydrated!==null){if(r===null){if(!S)throw Error(i(318));if(S=s.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(i(317));S[On]=s}else As(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;ai(s),S=!1}else S=ud(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=S),S=!0;if(!S)return s.flags&256?(Un(s),s):(Un(s),null)}return Un(s),(s.flags&128)!==0?(s.lanes=f,s):(f=m!==null,r=r!==null&&r.memoizedState!==null,f&&(m=s.child,S=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(S=m.alternate.memoizedState.cachePool.pool),T=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(T=m.memoizedState.cachePool.pool),T!==S&&(m.flags|=2048)),f!==r&&f&&(s.child.flags|=8192),jf(s,s.updateQueue),ai(s),null);case 4:return Ce(),r===null&&D0(s.stateNode.containerInfo),ai(s),null;case 10:return Zr(s.type),ai(s),null;case 19:if(O(yn),m=s.memoizedState,m===null)return ai(s),null;if(S=(s.flags&128)!==0,T=m.rendering,T===null)if(S)_d(m,!1);else{if(Ti!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(T=or(r),T!==null){for(s.flags|=128,_d(m,!1),r=T.updateQueue,s.updateQueue=r,jf(s,r),s.subtreeFlags=0,r=f,f=s.child;f!==null;)fc(f,r),f=f.sibling;return ee(yn,yn.current&1|2),un&&Pr(s,m.treeForkCount),s.child}r=r.sibling}m.tail!==null&&Ne()>Gf&&(s.flags|=128,S=!0,_d(m,!1),s.lanes=4194304)}else{if(!S)if(r=or(T),r!==null){if(s.flags|=128,S=!0,r=r.updateQueue,s.updateQueue=r,jf(s,r),_d(m,!0),m.tail===null&&m.tailMode==="hidden"&&!T.alternate&&!un)return ai(s),null}else 2*Ne()-m.renderingStartTime>Gf&&f!==536870912&&(s.flags|=128,S=!0,_d(m,!1),s.lanes=4194304);m.isBackwards?(T.sibling=s.child,s.child=T):(r=m.last,r!==null?r.sibling=T:s.child=T,m.last=T)}return m.tail!==null?(r=m.tail,m.rendering=r,m.tail=r.sibling,m.renderingStartTime=Ne(),r.sibling=null,f=yn.current,ee(yn,S?f&1|2:f&1),un&&Pr(s,m.treeForkCount),r):(ai(s),null);case 22:case 23:return Un(s),Di(),m=s.memoizedState!==null,r!==null?r.memoizedState!==null!==m&&(s.flags|=8192):m&&(s.flags|=8192),m?(f&536870912)!==0&&(s.flags&128)===0&&(ai(s),s.subtreeFlags&6&&(s.flags|=8192)):ai(s),f=s.updateQueue,f!==null&&jf(s,f.retryQueue),f=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(f=r.memoizedState.cachePool.pool),m=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(m=s.memoizedState.cachePool.pool),m!==f&&(s.flags|=2048),r!==null&&O(oe),null;case 24:return f=null,r!==null&&(f=r.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),Zr(yi),ai(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function fE(r,s){switch(tu(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return Zr(yi),Ce(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return $e(s),null;case 31:if(s.memoizedState!==null){if(Un(s),s.alternate===null)throw Error(i(340));As()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 13:if(Un(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(i(340));As()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return O(yn),null;case 4:return Ce(),null;case 10:return Zr(s.type),null;case 22:case 23:return Un(s),Di(),r!==null&&O(oe),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return Zr(yi),null;case 25:return null;default:return null}}function uv(r,s){switch(tu(s),s.tag){case 3:Zr(yi),Ce();break;case 26:case 27:case 5:$e(s);break;case 4:Ce();break;case 31:s.memoizedState!==null&&Un(s);break;case 13:Un(s);break;case 19:O(yn);break;case 10:Zr(s.type);break;case 22:case 23:Un(s),Di(),r!==null&&O(oe);break;case 24:Zr(yi)}}function Sd(r,s){try{var f=s.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var S=m.next;f=S;do{if((f.tag&r)===r){m=void 0;var T=f.create,H=f.inst;m=T(),H.destroy=m}f=f.next}while(f!==S)}}catch(se){jn(s,s.return,se)}}function vl(r,s,f){try{var m=s.updateQueue,S=m!==null?m.lastEffect:null;if(S!==null){var T=S.next;m=T;do{if((m.tag&r)===r){var H=m.inst,se=H.destroy;if(se!==void 0){H.destroy=void 0,S=s;var xe=f,qe=se;try{qe()}catch(Je){jn(S,xe,Je)}}}m=m.next}while(m!==T)}}catch(Je){jn(s,s.return,Je)}}function dv(r){var s=r.updateQueue;if(s!==null){var f=r.stateNode;try{Ei(s,f)}catch(m){jn(r,r.return,m)}}}function fv(r,s,f){f.props=bc(r.type,r.memoizedProps),f.state=r.memoizedState;try{f.componentWillUnmount()}catch(m){jn(r,s,m)}}function Ed(r,s){try{var f=r.ref;if(f!==null){switch(r.tag){case 26:case 27:case 5:var m=r.stateNode;break;case 30:m=r.stateNode;break;default:m=r.stateNode}typeof f=="function"?r.refCleanup=f(m):f.current=m}}catch(S){jn(r,s,S)}}function ns(r,s){var f=r.ref,m=r.refCleanup;if(f!==null)if(typeof m=="function")try{m()}catch(S){jn(r,s,S)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(S){jn(r,s,S)}else f.current=null}function hv(r){var s=r.type,f=r.memoizedProps,m=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":f.autoFocus&&m.focus();break e;case"img":f.src?m.src=f.src:f.srcSet&&(m.srcset=f.srcSet)}}catch(S){jn(r,r.return,S)}}function h0(r,s,f){try{var m=r.stateNode;DE(m,r.type,f,s),m[ti]=s}catch(S){jn(r,r.return,S)}}function pv(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&El(r.type)||r.tag===4}function p0(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||pv(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&El(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function m0(r,s,f){var m=r.tag;if(m===5||m===6)r=r.stateNode,s?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(r,s):(s=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,s.appendChild(r),f=f._reactRootContainer,f!=null||s.onclick!==null||(s.onclick=vo));else if(m!==4&&(m===27&&El(r.type)&&(f=r.stateNode,s=null),r=r.child,r!==null))for(m0(r,s,f),r=r.sibling;r!==null;)m0(r,s,f),r=r.sibling}function Ff(r,s,f){var m=r.tag;if(m===5||m===6)r=r.stateNode,s?f.insertBefore(r,s):f.appendChild(r);else if(m!==4&&(m===27&&El(r.type)&&(f=r.stateNode),r=r.child,r!==null))for(Ff(r,s,f),r=r.sibling;r!==null;)Ff(r,s,f),r=r.sibling}function mv(r){var s=r.stateNode,f=r.memoizedProps;try{for(var m=r.type,S=s.attributes;S.length;)s.removeAttributeNode(S[0]);vr(s,m,f),s[On]=r,s[ti]=f}catch(T){jn(r,r.return,T)}}var Ms=!1,qi=!1,g0=!1,gv=typeof WeakSet=="function"?WeakSet:Set,ar=null;function hE(r,s){if(r=r.containerInfo,U0=sh,r=va(r),Bo(r)){if("selectionStart"in r)var f={start:r.selectionStart,end:r.selectionEnd};else e:{f=(f=r.ownerDocument)&&f.defaultView||window;var m=f.getSelection&&f.getSelection();if(m&&m.rangeCount!==0){f=m.anchorNode;var S=m.anchorOffset,T=m.focusNode;m=m.focusOffset;try{f.nodeType,T.nodeType}catch{f=null;break e}var H=0,se=-1,xe=-1,qe=0,Je=0,it=r,Ge=null;t:for(;;){for(var Ve;it!==f||S!==0&&it.nodeType!==3||(se=H+S),it!==T||m!==0&&it.nodeType!==3||(xe=H+m),it.nodeType===3&&(H+=it.nodeValue.length),(Ve=it.firstChild)!==null;)Ge=it,it=Ve;for(;;){if(it===r)break t;if(Ge===f&&++qe===S&&(se=H),Ge===T&&++Je===m&&(xe=H),(Ve=it.nextSibling)!==null)break;it=Ge,Ge=it.parentNode}it=Ve}f=se===-1||xe===-1?null:{start:se,end:xe}}else f=null}f=f||{start:0,end:0}}else f=null;for(z0={focusedElem:r,selectionRange:f},sh=!1,ar=s;ar!==null;)if(s=ar,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,ar=r;else for(;ar!==null;){switch(s=ar,T=s.alternate,r=s.flags,s.tag){case 0:if((r&4)!==0&&(r=s.updateQueue,r=r!==null?r.events:null,r!==null))for(f=0;f<r.length;f++)S=r[f],S.ref.impl=S.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&T!==null){r=void 0,f=s,S=T.memoizedProps,T=T.memoizedState,m=f.stateNode;try{var Tt=bc(f.type,S);r=m.getSnapshotBeforeUpdate(Tt,T),m.__reactInternalSnapshotBeforeUpdate=r}catch(Gt){jn(f,f.return,Gt)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,f=r.nodeType,f===9)B0(r);else if(f===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":B0(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=s.sibling,r!==null){r.return=s.return,ar=r;break}ar=s.return}}function vv(r,s,f){var m=f.flags;switch(f.tag){case 0:case 11:case 15:Ps(r,f),m&4&&Sd(5,f);break;case 1:if(Ps(r,f),m&4)if(r=f.stateNode,s===null)try{r.componentDidMount()}catch(H){jn(f,f.return,H)}else{var S=bc(f.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(S,s,r.__reactInternalSnapshotBeforeUpdate)}catch(H){jn(f,f.return,H)}}m&64&&dv(f),m&512&&Ed(f,f.return);break;case 3:if(Ps(r,f),m&64&&(r=f.updateQueue,r!==null)){if(s=null,f.child!==null)switch(f.child.tag){case 27:case 5:s=f.child.stateNode;break;case 1:s=f.child.stateNode}try{Ei(r,s)}catch(H){jn(f,f.return,H)}}break;case 27:s===null&&m&4&&mv(f);case 26:case 5:Ps(r,f),s===null&&m&4&&hv(f),m&512&&Ed(f,f.return);break;case 12:Ps(r,f);break;case 31:Ps(r,f),m&4&&xv(r,f);break;case 13:Ps(r,f),m&4&&wv(r,f),m&64&&(r=f.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(f=_E.bind(null,f),qE(r,f))));break;case 22:if(m=f.memoizedState!==null||Ms,!m){s=s!==null&&s.memoizedState!==null||qi,S=Ms;var T=qi;Ms=m,(qi=s)&&!T?Os(r,f,(f.subtreeFlags&8772)!==0):Ps(r,f),Ms=S,qi=T}break;case 30:break;default:Ps(r,f)}}function yv(r){var s=r.alternate;s!==null&&(r.alternate=null,yv(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&ja(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var di=null,eo=!1;function Ds(r,s,f){for(f=f.child;f!==null;)bv(r,s,f),f=f.sibling}function bv(r,s,f){if(vt&&typeof vt.onCommitFiberUnmount=="function")try{vt.onCommitFiberUnmount(yt,f)}catch{}switch(f.tag){case 26:qi||ns(f,s),Ds(r,s,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:qi||ns(f,s);var m=di,S=eo;El(f.type)&&(di=f.stateNode,eo=!1),Ds(r,s,f),Md(f.stateNode),di=m,eo=S;break;case 5:qi||ns(f,s);case 6:if(m=di,S=eo,di=null,Ds(r,s,f),di=m,eo=S,di!==null)if(eo)try{(di.nodeType===9?di.body:di.nodeName==="HTML"?di.ownerDocument.body:di).removeChild(f.stateNode)}catch(T){jn(f,s,T)}else try{di.removeChild(f.stateNode)}catch(T){jn(f,s,T)}break;case 18:di!==null&&(eo?(r=di,dy(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,f.stateNode),Au(r)):dy(di,f.stateNode));break;case 4:m=di,S=eo,di=f.stateNode.containerInfo,eo=!0,Ds(r,s,f),di=m,eo=S;break;case 0:case 11:case 14:case 15:vl(2,f,s),qi||vl(4,f,s),Ds(r,s,f);break;case 1:qi||(ns(f,s),m=f.stateNode,typeof m.componentWillUnmount=="function"&&fv(f,s,m)),Ds(r,s,f);break;case 21:Ds(r,s,f);break;case 22:qi=(m=qi)||f.memoizedState!==null,Ds(r,s,f),qi=m;break;default:Ds(r,s,f)}}function xv(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Au(r)}catch(f){jn(s,s.return,f)}}}function wv(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Au(r)}catch(f){jn(s,s.return,f)}}function pE(r){switch(r.tag){case 31:case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new gv),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new gv),s;default:throw Error(i(435,r.tag))}}function Bf(r,s){var f=pE(r);s.forEach(function(m){if(!f.has(m)){f.add(m);var S=SE.bind(null,r,m);m.then(S,S)}})}function to(r,s){var f=s.deletions;if(f!==null)for(var m=0;m<f.length;m++){var S=f[m],T=r,H=s,se=H;e:for(;se!==null;){switch(se.tag){case 27:if(El(se.type)){di=se.stateNode,eo=!1;break e}break;case 5:di=se.stateNode,eo=!1;break e;case 3:case 4:di=se.stateNode.containerInfo,eo=!0;break e}se=se.return}if(di===null)throw Error(i(160));bv(T,H,S),di=null,eo=!1,T=S.alternate,T!==null&&(T.return=null),S.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)_v(s,r),s=s.sibling}var Na=null;function _v(r,s){var f=r.alternate,m=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:to(s,r),no(r),m&4&&(vl(3,r,r.return),Sd(3,r),vl(5,r,r.return));break;case 1:to(s,r),no(r),m&512&&(qi||f===null||ns(f,f.return)),m&64&&Ms&&(r=r.updateQueue,r!==null&&(m=r.callbacks,m!==null&&(f=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=f===null?m:f.concat(m))));break;case 26:var S=Na;if(to(s,r),no(r),m&512&&(qi||f===null||ns(f,f.return)),m&4){var T=f!==null?f.memoizedState:null;if(m=r.memoizedState,f===null)if(m===null)if(r.stateNode===null){e:{m=r.type,f=r.memoizedProps,S=S.ownerDocument||S;t:switch(m){case"title":T=S.getElementsByTagName("title")[0],(!T||T[uo]||T[On]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=S.createElement(m),S.head.insertBefore(T,S.querySelector("head > title"))),vr(T,m,f),T[On]=r,pi(T),m=T;break e;case"link":var H=_y("link","href",S).get(m+(f.href||""));if(H){for(var se=0;se<H.length;se++)if(T=H[se],T.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&T.getAttribute("rel")===(f.rel==null?null:f.rel)&&T.getAttribute("title")===(f.title==null?null:f.title)&&T.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){H.splice(se,1);break t}}T=S.createElement(m),vr(T,m,f),S.head.appendChild(T);break;case"meta":if(H=_y("meta","content",S).get(m+(f.content||""))){for(se=0;se<H.length;se++)if(T=H[se],T.getAttribute("content")===(f.content==null?null:""+f.content)&&T.getAttribute("name")===(f.name==null?null:f.name)&&T.getAttribute("property")===(f.property==null?null:f.property)&&T.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&T.getAttribute("charset")===(f.charSet==null?null:f.charSet)){H.splice(se,1);break t}}T=S.createElement(m),vr(T,m,f),S.head.appendChild(T);break;default:throw Error(i(468,m))}T[On]=r,pi(T),m=T}r.stateNode=m}else Sy(S,r.type,r.stateNode);else r.stateNode=wy(S,m,r.memoizedProps);else T!==m?(T===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):T.count--,m===null?Sy(S,r.type,r.stateNode):wy(S,m,r.memoizedProps)):m===null&&r.stateNode!==null&&h0(r,r.memoizedProps,f.memoizedProps)}break;case 27:to(s,r),no(r),m&512&&(qi||f===null||ns(f,f.return)),f!==null&&m&4&&h0(r,r.memoizedProps,f.memoizedProps);break;case 5:if(to(s,r),no(r),m&512&&(qi||f===null||ns(f,f.return)),r.flags&32){S=r.stateNode;try{go(S,"")}catch(Tt){jn(r,r.return,Tt)}}m&4&&r.stateNode!=null&&(S=r.memoizedProps,h0(r,S,f!==null?f.memoizedProps:S)),m&1024&&(g0=!0);break;case 6:if(to(s,r),no(r),m&4){if(r.stateNode===null)throw Error(i(162));m=r.memoizedProps,f=r.stateNode;try{f.nodeValue=m}catch(Tt){jn(r,r.return,Tt)}}break;case 3:if(ih=null,S=Na,Na=th(s.containerInfo),to(s,r),Na=S,no(r),m&4&&f!==null&&f.memoizedState.isDehydrated)try{Au(s.containerInfo)}catch(Tt){jn(r,r.return,Tt)}g0&&(g0=!1,Sv(r));break;case 4:m=Na,Na=th(r.stateNode.containerInfo),to(s,r),no(r),Na=m;break;case 12:to(s,r),no(r);break;case 31:to(s,r),no(r),m&4&&(m=r.updateQueue,m!==null&&(r.updateQueue=null,Bf(r,m)));break;case 13:to(s,r),no(r),r.child.flags&8192&&r.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Hf=Ne()),m&4&&(m=r.updateQueue,m!==null&&(r.updateQueue=null,Bf(r,m)));break;case 22:S=r.memoizedState!==null;var xe=f!==null&&f.memoizedState!==null,qe=Ms,Je=qi;if(Ms=qe||S,qi=Je||xe,to(s,r),qi=Je,Ms=qe,no(r),m&8192)e:for(s=r.stateNode,s._visibility=S?s._visibility&-2:s._visibility|1,S&&(f===null||xe||Ms||qi||xc(r)),f=null,s=r;;){if(s.tag===5||s.tag===26){if(f===null){xe=f=s;try{if(T=xe.stateNode,S)H=T.style,typeof H.setProperty=="function"?H.setProperty("display","none","important"):H.display="none";else{se=xe.stateNode;var it=xe.memoizedProps.style,Ge=it!=null&&it.hasOwnProperty("display")?it.display:null;se.style.display=Ge==null||typeof Ge=="boolean"?"":(""+Ge).trim()}}catch(Tt){jn(xe,xe.return,Tt)}}}else if(s.tag===6){if(f===null){xe=s;try{xe.stateNode.nodeValue=S?"":xe.memoizedProps}catch(Tt){jn(xe,xe.return,Tt)}}}else if(s.tag===18){if(f===null){xe=s;try{var Ve=xe.stateNode;S?fy(Ve,!0):fy(xe.stateNode,!1)}catch(Tt){jn(xe,xe.return,Tt)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;f===s&&(f=null),s=s.return}f===s&&(f=null),s.sibling.return=s.return,s=s.sibling}m&4&&(m=r.updateQueue,m!==null&&(f=m.retryQueue,f!==null&&(m.retryQueue=null,Bf(r,f))));break;case 19:to(s,r),no(r),m&4&&(m=r.updateQueue,m!==null&&(r.updateQueue=null,Bf(r,m)));break;case 30:break;case 21:break;default:to(s,r),no(r)}}function no(r){var s=r.flags;if(s&2){try{for(var f,m=r.return;m!==null;){if(pv(m)){f=m;break}m=m.return}if(f==null)throw Error(i(160));switch(f.tag){case 27:var S=f.stateNode,T=p0(r);Ff(r,T,S);break;case 5:var H=f.stateNode;f.flags&32&&(go(H,""),f.flags&=-33);var se=p0(r);Ff(r,se,H);break;case 3:case 4:var xe=f.stateNode.containerInfo,qe=p0(r);m0(r,qe,xe);break;default:throw Error(i(161))}}catch(Je){jn(r,r.return,Je)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function Sv(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;Sv(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function Ps(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)vv(r,s.alternate,s),s=s.sibling}function xc(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:vl(4,s,s.return),xc(s);break;case 1:ns(s,s.return);var f=s.stateNode;typeof f.componentWillUnmount=="function"&&fv(s,s.return,f),xc(s);break;case 27:Md(s.stateNode);case 26:case 5:ns(s,s.return),xc(s);break;case 22:s.memoizedState===null&&xc(s);break;case 30:xc(s);break;default:xc(s)}r=r.sibling}}function Os(r,s,f){for(f=f&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var m=s.alternate,S=r,T=s,H=T.flags;switch(T.tag){case 0:case 11:case 15:Os(S,T,f),Sd(4,T);break;case 1:if(Os(S,T,f),m=T,S=m.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(qe){jn(m,m.return,qe)}if(m=T,S=m.updateQueue,S!==null){var se=m.stateNode;try{var xe=S.shared.hiddenCallbacks;if(xe!==null)for(S.shared.hiddenCallbacks=null,S=0;S<xe.length;S++)rr(xe[S],se)}catch(qe){jn(m,m.return,qe)}}f&&H&64&&dv(T),Ed(T,T.return);break;case 27:mv(T);case 26:case 5:Os(S,T,f),f&&m===null&&H&4&&hv(T),Ed(T,T.return);break;case 12:Os(S,T,f);break;case 31:Os(S,T,f),f&&H&4&&xv(S,T);break;case 13:Os(S,T,f),f&&H&4&&wv(S,T);break;case 22:T.memoizedState===null&&Os(S,T,f),Ed(T,T.return);break;case 30:break;default:Os(S,T,f)}s=s.sibling}}function v0(r,s){var f=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(f=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==f&&(r!=null&&r.refCount++,f!=null&&mc(f))}function y0(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&mc(r))}function Aa(r,s,f,m){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Ev(r,s,f,m),s=s.sibling}function Ev(r,s,f,m){var S=s.flags;switch(s.tag){case 0:case 11:case 15:Aa(r,s,f,m),S&2048&&Sd(9,s);break;case 1:Aa(r,s,f,m);break;case 3:Aa(r,s,f,m),S&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&mc(r)));break;case 12:if(S&2048){Aa(r,s,f,m),r=s.stateNode;try{var T=s.memoizedProps,H=T.id,se=T.onPostCommit;typeof se=="function"&&se(H,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(xe){jn(s,s.return,xe)}}else Aa(r,s,f,m);break;case 31:Aa(r,s,f,m);break;case 13:Aa(r,s,f,m);break;case 23:break;case 22:T=s.stateNode,H=s.alternate,s.memoizedState!==null?T._visibility&2?Aa(r,s,f,m):Nd(r,s):T._visibility&2?Aa(r,s,f,m):(T._visibility|=2,mu(r,s,f,m,(s.subtreeFlags&10256)!==0||!1)),S&2048&&v0(H,s);break;case 24:Aa(r,s,f,m),S&2048&&y0(s.alternate,s);break;default:Aa(r,s,f,m)}}function mu(r,s,f,m,S){for(S=S&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var T=r,H=s,se=f,xe=m,qe=H.flags;switch(H.tag){case 0:case 11:case 15:mu(T,H,se,xe,S),Sd(8,H);break;case 23:break;case 22:var Je=H.stateNode;H.memoizedState!==null?Je._visibility&2?mu(T,H,se,xe,S):Nd(T,H):(Je._visibility|=2,mu(T,H,se,xe,S)),S&&qe&2048&&v0(H.alternate,H);break;case 24:mu(T,H,se,xe,S),S&&qe&2048&&y0(H.alternate,H);break;default:mu(T,H,se,xe,S)}s=s.sibling}}function Nd(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var f=r,m=s,S=m.flags;switch(m.tag){case 22:Nd(f,m),S&2048&&v0(m.alternate,m);break;case 24:Nd(f,m),S&2048&&y0(m.alternate,m);break;default:Nd(f,m)}s=s.sibling}}var Ad=8192;function gu(r,s,f){if(r.subtreeFlags&Ad)for(r=r.child;r!==null;)Nv(r,s,f),r=r.sibling}function Nv(r,s,f){switch(r.tag){case 26:gu(r,s,f),r.flags&Ad&&r.memoizedState!==null&&eN(f,Na,r.memoizedState,r.memoizedProps);break;case 5:gu(r,s,f);break;case 3:case 4:var m=Na;Na=th(r.stateNode.containerInfo),gu(r,s,f),Na=m;break;case 22:r.memoizedState===null&&(m=r.alternate,m!==null&&m.memoizedState!==null?(m=Ad,Ad=16777216,gu(r,s,f),Ad=m):gu(r,s,f));break;default:gu(r,s,f)}}function Av(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function Cd(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var f=0;f<s.length;f++){var m=s[f];ar=m,Tv(m,r)}Av(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Cv(r),r=r.sibling}function Cv(r){switch(r.tag){case 0:case 11:case 15:Cd(r),r.flags&2048&&vl(9,r,r.return);break;case 3:Cd(r);break;case 12:Cd(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,qf(r)):Cd(r);break;default:Cd(r)}}function qf(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var f=0;f<s.length;f++){var m=s[f];ar=m,Tv(m,r)}Av(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:vl(8,s,s.return),qf(s);break;case 22:f=s.stateNode,f._visibility&2&&(f._visibility&=-3,qf(s));break;default:qf(s)}r=r.sibling}}function Tv(r,s){for(;ar!==null;){var f=ar;switch(f.tag){case 0:case 11:case 15:vl(8,f,s);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var m=f.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:mc(f.memoizedState.cache)}if(m=f.child,m!==null)m.return=f,ar=m;else e:for(f=r;ar!==null;){m=ar;var S=m.sibling,T=m.return;if(yv(m),m===f){ar=null;break e}if(S!==null){S.return=T,ar=S;break e}ar=T}}}var mE={getCacheForType:function(r){var s=Xi(yi),f=s.data.get(r);return f===void 0&&(f=r(),s.data.set(r,f)),f},cacheSignal:function(){return Xi(yi).controller.signal}},gE=typeof WeakMap=="function"?WeakMap:Map,Pn=0,Zn=null,dn=null,hn=0,zn=0,Eo=null,yl=!1,vu=!1,b0=!1,Us=0,Ti=0,bl=0,wc=0,x0=0,No=0,yu=0,Td=null,io=null,w0=!1,Hf=0,kv=0,Gf=1/0,Vf=null,xl=null,Ki=0,wl=null,bu=null,zs=0,_0=0,S0=null,Iv=null,kd=0,E0=null;function Ao(){return(Pn&2)!==0&&hn!==0?hn&-hn:J.T!==null?I0():wn()}function Rv(){if(No===0)if((hn&536870912)===0||un){var r=wt;wt<<=1,(wt&3932160)===0&&(wt=262144),No=r}else No=536870912;return r=oi.current,r!==null&&(r.flags|=32),No}function ro(r,s,f){(r===Zn&&(zn===2||zn===9)||r.cancelPendingCommit!==null)&&(xu(r,0),_l(r,hn,No,!1)),bt(r,f),((Pn&2)===0||r!==Zn)&&(r===Zn&&((Pn&2)===0&&(wc|=f),Ti===4&&_l(r,hn,No,!1)),is(r))}function Lv(r,s,f){if((Pn&6)!==0)throw Error(i(327));var m=!f&&(s&127)===0&&(s&r.expiredLanes)===0||Bt(r,s),S=m?bE(r,s):A0(r,s,!0),T=m;do{if(S===0){vu&&!m&&_l(r,s,0,!1);break}else{if(f=r.current.alternate,T&&!vE(f)){S=A0(r,s,!1),T=!1;continue}if(S===2){if(T=s,r.errorRecoveryDisabledLanes&T)var H=0;else H=r.pendingLanes&-536870913,H=H!==0?H:H&536870912?536870912:0;if(H!==0){s=H;e:{var se=r;S=Td;var xe=se.current.memoizedState.isDehydrated;if(xe&&(xu(se,H).flags|=256),H=A0(se,H,!1),H!==2){if(b0&&!xe){se.errorRecoveryDisabledLanes|=T,wc|=T,S=4;break e}T=io,io=S,T!==null&&(io===null?io=T:io.push.apply(io,T))}S=H}if(T=!1,S!==2)continue}}if(S===1){xu(r,0),_l(r,s,0,!0);break}e:{switch(m=r,T=S,T){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:_l(m,s,No,!yl);break e;case 2:io=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(S=Hf+300-Ne(),10<S)){if(_l(m,s,No,!yl),pt(m,0,!0)!==0)break e;zs=s,m.timeoutHandle=cy(Mv.bind(null,m,f,io,Vf,w0,s,No,wc,yu,yl,T,"Throttled",-0,0),S);break e}Mv(m,f,io,Vf,w0,s,No,wc,yu,yl,T,null,-0,0)}}break}while(!0);is(r)}function Mv(r,s,f,m,S,T,H,se,xe,qe,Je,it,Ge,Ve){if(r.timeoutHandle=-1,it=s.subtreeFlags,it&8192||(it&16785408)===16785408){it={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:vo},Nv(s,T,it);var Tt=(T&62914560)===T?Hf-Ne():(T&4194048)===T?kv-Ne():0;if(Tt=tN(it,Tt),Tt!==null){zs=T,r.cancelPendingCommit=Tt(Bv.bind(null,r,s,T,f,m,S,H,se,xe,Je,it,null,Ge,Ve)),_l(r,T,H,!qe);return}}Bv(r,s,T,f,m,S,H,se,xe)}function vE(r){for(var s=r;;){var f=s.tag;if((f===0||f===11||f===15)&&s.flags&16384&&(f=s.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var m=0;m<f.length;m++){var S=f[m],T=S.getSnapshot;S=S.value;try{if(!Vi(T(),S))return!1}catch{return!1}}if(f=s.child,s.subtreeFlags&16384&&f!==null)f.return=s,s=f;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function _l(r,s,f,m){s&=~x0,s&=~wc,r.suspendedLanes|=s,r.pingedLanes&=~s,m&&(r.warmLanes|=s),m=r.expirationTimes;for(var S=s;0<S;){var T=31-Ft(S),H=1<<T;m[T]=-1,S&=~H}f!==0&&sn(r,f,s)}function $f(){return(Pn&6)===0?(Id(0),!1):!0}function N0(){if(dn!==null){if(zn===0)var r=dn.return;else r=dn,Ho=Wa=null,lu(r),rt=null,kt=0,r=dn;for(;r!==null;)uv(r.alternate,r),r=r.return;dn=null}}function xu(r,s){var f=r.timeoutHandle;f!==-1&&(r.timeoutHandle=-1,UE(f)),f=r.cancelPendingCommit,f!==null&&(r.cancelPendingCommit=null,f()),zs=0,N0(),Zn=r,dn=f=$r(r.current,null),hn=s,zn=0,Eo=null,yl=!1,vu=Bt(r,s),b0=!1,yu=No=x0=wc=bl=Ti=0,io=Td=null,w0=!1,(s&8)!==0&&(s|=s&32);var m=r.entangledLanes;if(m!==0)for(r=r.entanglements,m&=s;0<m;){var S=31-Ft(m),T=1<<S;s|=r[S],m&=~T}return Us=s,cc(),f}function Dv(r,s){Pt=null,J.H=xd,s===Ae||s===me?(s=Ze(),zn=3):s===Fe?(s=Ze(),zn=4):zn=s===i0?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Eo=s,dn===null&&(Ti=1,Pf(r,Yr(s,r.current)))}function Pv(){var r=oi.current;return r===null?!0:(hn&4194048)===hn?Sn===null:(hn&62914560)===hn||(hn&536870912)!==0?r===Sn:!1}function Ov(){var r=J.H;return J.H=xd,r===null?xd:r}function Uv(){var r=J.A;return J.A=mE,r}function Yf(){Ti=4,yl||(hn&4194048)!==hn&&oi.current!==null||(vu=!0),(bl&134217727)===0&&(wc&134217727)===0||Zn===null||_l(Zn,hn,No,!1)}function A0(r,s,f){var m=Pn;Pn|=2;var S=Ov(),T=Uv();(Zn!==r||hn!==s)&&(Vf=null,xu(r,s)),s=!1;var H=Ti;e:do try{if(zn!==0&&dn!==null){var se=dn,xe=Eo;switch(zn){case 8:N0(),H=6;break e;case 3:case 2:case 9:case 6:oi.current===null&&(s=!0);var qe=zn;if(zn=0,Eo=null,wu(r,se,xe,qe),f&&vu){H=0;break e}break;default:qe=zn,zn=0,Eo=null,wu(r,se,xe,qe)}}yE(),H=Ti;break}catch(Je){Dv(r,Je)}while(!0);return s&&r.shellSuspendCounter++,Ho=Wa=null,Pn=m,J.H=S,J.A=T,dn===null&&(Zn=null,hn=0,cc()),H}function yE(){for(;dn!==null;)zv(dn)}function bE(r,s){var f=Pn;Pn|=2;var m=Ov(),S=Uv();Zn!==r||hn!==s?(Vf=null,Gf=Ne()+500,xu(r,s)):vu=Bt(r,s);e:do try{if(zn!==0&&dn!==null){s=dn;var T=Eo;t:switch(zn){case 1:zn=0,Eo=null,wu(r,s,T,1);break;case 2:case 9:if(Ue(T)){zn=0,Eo=null,jv(s);break}s=function(){zn!==2&&zn!==9||Zn!==r||(zn=7),is(r)},T.then(s,s);break e;case 3:zn=7;break e;case 4:zn=5;break e;case 7:Ue(T)?(zn=0,Eo=null,jv(s)):(zn=0,Eo=null,wu(r,s,T,7));break;case 5:var H=null;switch(dn.tag){case 26:H=dn.memoizedState;case 5:case 27:var se=dn;if(H?Ey(H):se.stateNode.complete){zn=0,Eo=null;var xe=se.sibling;if(xe!==null)dn=xe;else{var qe=se.return;qe!==null?(dn=qe,Wf(qe)):dn=null}break t}}zn=0,Eo=null,wu(r,s,T,5);break;case 6:zn=0,Eo=null,wu(r,s,T,6);break;case 8:N0(),Ti=6;break e;default:throw Error(i(462))}}xE();break}catch(Je){Dv(r,Je)}while(!0);return Ho=Wa=null,J.H=m,J.A=S,Pn=f,dn!==null?0:(Zn=null,hn=0,cc(),Ti)}function xE(){for(;dn!==null&&!Se();)zv(dn)}function zv(r){var s=lv(r.alternate,r,Us);r.memoizedProps=r.pendingProps,s===null?Wf(r):dn=s}function jv(r){var s=r,f=s.alternate;switch(s.tag){case 15:case 0:s=nv(f,s,s.pendingProps,s.type,void 0,hn);break;case 11:s=nv(f,s,s.pendingProps,s.type.render,s.ref,hn);break;case 5:lu(s);default:uv(f,s),s=dn=fc(s,Us),s=lv(f,s,Us)}r.memoizedProps=r.pendingProps,s===null?Wf(r):dn=s}function wu(r,s,f,m){Ho=Wa=null,lu(s),rt=null,kt=0;var S=s.return;try{if(lE(r,S,s,f,hn)){Ti=1,Pf(r,Yr(f,r.current)),dn=null;return}}catch(T){if(S!==null)throw dn=S,T;Ti=1,Pf(r,Yr(f,r.current)),dn=null;return}s.flags&32768?(un||m===1?r=!0:vu||(hn&536870912)!==0?r=!1:(yl=r=!0,(m===2||m===9||m===3||m===6)&&(m=oi.current,m!==null&&m.tag===13&&(m.flags|=16384))),Fv(s,r)):Wf(s)}function Wf(r){var s=r;do{if((s.flags&32768)!==0){Fv(s,yl);return}r=s.return;var f=dE(s.alternate,s,Us);if(f!==null){dn=f;return}if(s=s.sibling,s!==null){dn=s;return}dn=s=r}while(s!==null);Ti===0&&(Ti=5)}function Fv(r,s){do{var f=fE(r.alternate,r);if(f!==null){f.flags&=32767,dn=f;return}if(f=r.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!s&&(r=r.sibling,r!==null)){dn=r;return}dn=r=f}while(r!==null);Ti=6,dn=null}function Bv(r,s,f,m,S,T,H,se,xe){r.cancelPendingCommit=null;do Xf();while(Ki!==0);if((Pn&6)!==0)throw Error(i(327));if(s!==null){if(s===r.current)throw Error(i(177));if(T=s.lanes|s.childLanes,T|=Wc,jt(r,f,T,H,se,xe),r===Zn&&(dn=Zn=null,hn=0),bu=s,wl=r,zs=f,_0=T,S0=S,Iv=m,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,EE(ft,function(){return $v(),null})):(r.callbackNode=null,r.callbackPriority=0),m=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||m){m=J.T,J.T=null,S=Y.p,Y.p=2,H=Pn,Pn|=4;try{hE(r,s,f)}finally{Pn=H,Y.p=S,J.T=m}}Ki=1,qv(),Hv(),Gv()}}function qv(){if(Ki===1){Ki=0;var r=wl,s=bu,f=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||f){f=J.T,J.T=null;var m=Y.p;Y.p=2;var S=Pn;Pn|=4;try{_v(s,r);var T=z0,H=va(r.containerInfo),se=T.focusedElem,xe=T.selectionRange;if(H!==se&&se&&se.ownerDocument&&ga(se.ownerDocument.documentElement,se)){if(xe!==null&&Bo(se)){var qe=xe.start,Je=xe.end;if(Je===void 0&&(Je=qe),"selectionStart"in se)se.selectionStart=qe,se.selectionEnd=Math.min(Je,se.value.length);else{var it=se.ownerDocument||document,Ge=it&&it.defaultView||window;if(Ge.getSelection){var Ve=Ge.getSelection(),Tt=se.textContent.length,Gt=Math.min(xe.start,Tt),Wn=xe.end===void 0?Gt:Math.min(xe.end,Tt);!Ve.extend&&Gt>Wn&&(H=Wn,Wn=Gt,Gt=H);var Oe=al(se,Gt),ke=al(se,Wn);if(Oe&&ke&&(Ve.rangeCount!==1||Ve.anchorNode!==Oe.node||Ve.anchorOffset!==Oe.offset||Ve.focusNode!==ke.node||Ve.focusOffset!==ke.offset)){var Be=it.createRange();Be.setStart(Oe.node,Oe.offset),Ve.removeAllRanges(),Gt>Wn?(Ve.addRange(Be),Ve.extend(ke.node,ke.offset)):(Be.setEnd(ke.node,ke.offset),Ve.addRange(Be))}}}}for(it=[],Ve=se;Ve=Ve.parentNode;)Ve.nodeType===1&&it.push({element:Ve,left:Ve.scrollLeft,top:Ve.scrollTop});for(typeof se.focus=="function"&&se.focus(),se=0;se<it.length;se++){var tt=it[se];tt.element.scrollLeft=tt.left,tt.element.scrollTop=tt.top}}sh=!!U0,z0=U0=null}finally{Pn=S,Y.p=m,J.T=f}}r.current=s,Ki=2}}function Hv(){if(Ki===2){Ki=0;var r=wl,s=bu,f=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||f){f=J.T,J.T=null;var m=Y.p;Y.p=2;var S=Pn;Pn|=4;try{vv(r,s.alternate,s)}finally{Pn=S,Y.p=m,J.T=f}}Ki=3}}function Gv(){if(Ki===4||Ki===3){Ki=0,He();var r=wl,s=bu,f=zs,m=Iv;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Ki=5:(Ki=0,bu=wl=null,Vv(r,r.pendingLanes));var S=r.pendingLanes;if(S===0&&(xl=null),rn(f),s=s.stateNode,vt&&typeof vt.onCommitFiberRoot=="function")try{vt.onCommitFiberRoot(yt,s,void 0,(s.current.flags&128)===128)}catch{}if(m!==null){s=J.T,S=Y.p,Y.p=2,J.T=null;try{for(var T=r.onRecoverableError,H=0;H<m.length;H++){var se=m[H];T(se.value,{componentStack:se.stack})}}finally{J.T=s,Y.p=S}}(zs&3)!==0&&Xf(),is(r),S=r.pendingLanes,(f&261930)!==0&&(S&42)!==0?r===E0?kd++:(kd=0,E0=r):kd=0,Id(0)}}function Vv(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,mc(s)))}function Xf(){return qv(),Hv(),Gv(),$v()}function $v(){if(Ki!==5)return!1;var r=wl,s=_0;_0=0;var f=rn(zs),m=J.T,S=Y.p;try{Y.p=32>f?32:f,J.T=null,f=S0,S0=null;var T=wl,H=zs;if(Ki=0,bu=wl=null,zs=0,(Pn&6)!==0)throw Error(i(331));var se=Pn;if(Pn|=4,Cv(T.current),Ev(T,T.current,H,f),Pn=se,Id(0,!1),vt&&typeof vt.onPostCommitFiberRoot=="function")try{vt.onPostCommitFiberRoot(yt,T)}catch{}return!0}finally{Y.p=S,J.T=m,Vv(r,s)}}function Yv(r,s,f){s=Yr(f,s),s=n0(r.stateNode,s,2),r=nn(r,s,2),r!==null&&(bt(r,2),is(r))}function jn(r,s,f){if(r.tag===3)Yv(r,r,f);else for(;s!==null;){if(s.tag===3){Yv(s,r,f);break}else if(s.tag===1){var m=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(xl===null||!xl.has(m))){r=Yr(f,r),f=W1(2),m=nn(s,f,2),m!==null&&(X1(f,m,s,r),bt(m,2),is(m));break}}s=s.return}}function C0(r,s,f){var m=r.pingCache;if(m===null){m=r.pingCache=new gE;var S=new Set;m.set(s,S)}else S=m.get(s),S===void 0&&(S=new Set,m.set(s,S));S.has(f)||(b0=!0,S.add(f),r=wE.bind(null,r,s,f),s.then(r,r))}function wE(r,s,f){var m=r.pingCache;m!==null&&m.delete(s),r.pingedLanes|=r.suspendedLanes&f,r.warmLanes&=~f,Zn===r&&(hn&f)===f&&(Ti===4||Ti===3&&(hn&62914560)===hn&&300>Ne()-Hf?(Pn&2)===0&&xu(r,0):x0|=f,yu===hn&&(yu=0)),is(r)}function Wv(r,s){s===0&&(s=zt()),r=ba(r,s),r!==null&&(bt(r,s),is(r))}function _E(r){var s=r.memoizedState,f=0;s!==null&&(f=s.retryLane),Wv(r,f)}function SE(r,s){var f=0;switch(r.tag){case 31:case 13:var m=r.stateNode,S=r.memoizedState;S!==null&&(f=S.retryLane);break;case 19:m=r.stateNode;break;case 22:m=r.stateNode._retryCache;break;default:throw Error(i(314))}m!==null&&m.delete(s),Wv(r,f)}function EE(r,s){return be(r,s)}var Jf=null,_u=null,T0=!1,Kf=!1,k0=!1,Sl=0;function is(r){r!==_u&&r.next===null&&(_u===null?Jf=_u=r:_u=_u.next=r),Kf=!0,T0||(T0=!0,AE())}function Id(r,s){if(!k0&&Kf){k0=!0;do for(var f=!1,m=Jf;m!==null;){if(r!==0){var S=m.pendingLanes;if(S===0)var T=0;else{var H=m.suspendedLanes,se=m.pingedLanes;T=(1<<31-Ft(42|r)+1)-1,T&=S&~(H&~se),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(f=!0,Zv(m,T))}else T=hn,T=pt(m,m===Zn?T:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(T&3)===0||Bt(m,T)||(f=!0,Zv(m,T));m=m.next}while(f);k0=!1}}function NE(){Xv()}function Xv(){Kf=T0=!1;var r=0;Sl!==0&&OE()&&(r=Sl);for(var s=Ne(),f=null,m=Jf;m!==null;){var S=m.next,T=Jv(m,s);T===0?(m.next=null,f===null?Jf=S:f.next=S,S===null&&(_u=f)):(f=m,(r!==0||(T&3)!==0)&&(Kf=!0)),m=S}Ki!==0&&Ki!==5||Id(r),Sl!==0&&(Sl=0)}function Jv(r,s){for(var f=r.suspendedLanes,m=r.pingedLanes,S=r.expirationTimes,T=r.pendingLanes&-62914561;0<T;){var H=31-Ft(T),se=1<<H,xe=S[H];xe===-1?((se&f)===0||(se&m)!==0)&&(S[H]=Vt(se,s)):xe<=s&&(r.expiredLanes|=se),T&=~se}if(s=Zn,f=hn,f=pt(r,r===s?f:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),m=r.callbackNode,f===0||r===s&&(zn===2||zn===9)||r.cancelPendingCommit!==null)return m!==null&&m!==null&&Me(m),r.callbackNode=null,r.callbackPriority=0;if((f&3)===0||Bt(r,f)){if(s=f&-f,s===r.callbackPriority)return s;switch(m!==null&&Me(m),rn(f)){case 2:case 8:f=dt;break;case 32:f=ft;break;case 268435456:f=Et;break;default:f=ft}return m=Kv.bind(null,r),f=be(f,m),r.callbackPriority=s,r.callbackNode=f,s}return m!==null&&m!==null&&Me(m),r.callbackPriority=2,r.callbackNode=null,2}function Kv(r,s){if(Ki!==0&&Ki!==5)return r.callbackNode=null,r.callbackPriority=0,null;var f=r.callbackNode;if(Xf()&&r.callbackNode!==f)return null;var m=hn;return m=pt(r,r===Zn?m:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),m===0?null:(Lv(r,m,s),Jv(r,Ne()),r.callbackNode!=null&&r.callbackNode===f?Kv.bind(null,r):null)}function Zv(r,s){if(Xf())return null;Lv(r,s,!0)}function AE(){zE(function(){(Pn&6)!==0?be(We,NE):Xv()})}function I0(){if(Sl===0){var r=x;r===0&&(r=ut,ut<<=1,(ut&261888)===0&&(ut=256)),Sl=r}return Sl}function Qv(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:yr(""+r)}function ey(r,s){var f=s.ownerDocument.createElement("input");return f.name=s.name,f.value=s.value,r.id&&f.setAttribute("form",r.id),s.parentNode.insertBefore(f,s),r=new FormData(r),f.parentNode.removeChild(f),r}function CE(r,s,f,m,S){if(s==="submit"&&f&&f.stateNode===S){var T=Qv((S[ti]||null).action),H=m.submitter;H&&(s=(s=H[ti]||null)?Qv(s.formAction):H.getAttribute("formAction"),s!==null&&(T=s,H=null));var se=new Hr("action","action",null,m,S);r.push({event:se,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Sl!==0){var xe=H?ey(S,H):new FormData(S);Jp(f,{pending:!0,data:xe,method:S.method,action:T},null,xe)}}else typeof T=="function"&&(se.preventDefault(),xe=H?ey(S,H):new FormData(S),Jp(f,{pending:!0,data:xe,method:S.method,action:T},T,xe))},currentTarget:S}]})}}for(var R0=0;R0<Ss.length;R0++){var L0=Ss[R0],TE=L0.toLowerCase(),kE=L0[0].toUpperCase()+L0.slice(1);Vr(TE,"on"+kE)}Vr(_s,"onAnimationEnd"),Vr(sc,"onAnimationIteration"),Vr(od,"onAnimationStart"),Vr("dblclick","onDoubleClick"),Vr("focusin","onFocus"),Vr("focusout","onBlur"),Vr(_f,"onTransitionRun"),Vr(Sf,"onTransitionStart"),Vr(Ef,"onTransitionCancel"),Vr(ad,"onTransitionEnd"),ea("onMouseEnter",["mouseout","mouseover"]),ea("onMouseLeave",["mouseout","mouseover"]),ea("onPointerEnter",["pointerout","pointerover"]),ea("onPointerLeave",["pointerout","pointerover"]),po("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),po("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),po("onBeforeInput",["compositionend","keypress","textInput","paste"]),po("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),po("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),po("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),IE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Rd));function ty(r,s){s=(s&4)!==0;for(var f=0;f<r.length;f++){var m=r[f],S=m.event;m=m.listeners;e:{var T=void 0;if(s)for(var H=m.length-1;0<=H;H--){var se=m[H],xe=se.instance,qe=se.currentTarget;if(se=se.listener,xe!==T&&S.isPropagationStopped())break e;T=se,S.currentTarget=qe;try{T(S)}catch(Je){lc(Je)}S.currentTarget=null,T=xe}else for(H=0;H<m.length;H++){if(se=m[H],xe=se.instance,qe=se.currentTarget,se=se.listener,xe!==T&&S.isPropagationStopped())break e;T=se,S.currentTarget=qe;try{T(S)}catch(Je){lc(Je)}S.currentTarget=null,T=xe}}}}function fn(r,s){var f=s[Cr];f===void 0&&(f=s[Cr]=new Set);var m=r+"__bubble";f.has(m)||(ny(s,r,2,!1),f.add(m))}function M0(r,s,f){var m=0;s&&(m|=4),ny(f,r,m,s)}var Zf="_reactListening"+Math.random().toString(36).slice(2);function D0(r){if(!r[Zf]){r[Zf]=!0,Gl.forEach(function(f){f!=="selectionchange"&&(IE.has(f)||M0(f,!1,r),M0(f,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[Zf]||(s[Zf]=!0,M0("selectionchange",!1,s))}}function ny(r,s,f,m){switch(Ry(s)){case 2:var S=rN;break;case 8:S=oN;break;default:S=X0}f=S.bind(null,s,f,r),S=void 0,!nc||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(S=!0),m?S!==void 0?r.addEventListener(s,f,{capture:!0,passive:S}):r.addEventListener(s,f,!0):S!==void 0?r.addEventListener(s,f,{passive:S}):r.addEventListener(s,f,!1)}function P0(r,s,f,m,S){var T=m;if((s&1)===0&&(s&2)===0&&m!==null)e:for(;;){if(m===null)return;var H=m.tag;if(H===3||H===4){var se=m.stateNode.containerInfo;if(se===S)break;if(H===4)for(H=m.return;H!==null;){var xe=H.tag;if((xe===3||xe===4)&&H.stateNode.containerInfo===S)return;H=H.return}for(;se!==null;){if(H=fo(se),H===null)return;if(xe=H.tag,xe===5||xe===6||xe===26||xe===27){m=T=H;continue e}se=se.parentNode}}m=m.return}Hc(function(){var qe=T,Je=ms(f),it=[];e:{var Ge=sd.get(r);if(Ge!==void 0){var Ve=Hr,Tt=r;switch(r){case"keypress":if(qr(f)===0)break e;case"keydown":case"keyup":Ve=gn;break;case"focusin":Tt="focus",Ve=la;break;case"focusout":Tt="blur",Ve=la;break;case"beforeblur":case"afterblur":Ve=la;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ve=ic;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ve=sa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ve=Li;break;case _s:case sc:case od:Ve=L;break;case ad:Ve=Gi;break;case"scroll":case"scrollend":Ve=Qs;break;case"wheel":Ve=yo;break;case"copy":case"cut":case"paste":Ve=ve;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ve=mi;break;case"toggle":case"beforetoggle":Ve=rc}var Gt=(s&4)!==0,Wn=!Gt&&(r==="scroll"||r==="scrollend"),Oe=Gt?Ge!==null?Ge+"Capture":null:Ge;Gt=[];for(var ke=qe,Be;ke!==null;){var tt=ke;if(Be=tt.stateNode,tt=tt.tag,tt!==5&&tt!==26&&tt!==27||Be===null||Oe===null||(tt=Ir(ke,Oe),tt!=null&&Gt.push(Ld(ke,tt,Be))),Wn)break;ke=ke.return}0<Gt.length&&(Ge=new Ve(Ge,Tt,null,f,Je),it.push({event:Ge,listeners:Gt}))}}if((s&7)===0){e:{if(Ge=r==="mouseover"||r==="pointerover",Ve=r==="mouseout"||r==="pointerout",Ge&&f!==na&&(Tt=f.relatedTarget||f.fromElement)&&(fo(Tt)||Tt[er]))break e;if((Ve||Ge)&&(Ge=Je.window===Je?Je:(Ge=Je.ownerDocument)?Ge.defaultView||Ge.parentWindow:window,Ve?(Tt=f.relatedTarget||f.toElement,Ve=qe,Tt=Tt?fo(Tt):null,Tt!==null&&(Wn=a(Tt),Gt=Tt.tag,Tt!==Wn||Gt!==5&&Gt!==27&&Gt!==6)&&(Tt=null)):(Ve=null,Tt=qe),Ve!==Tt)){if(Gt=ic,tt="onMouseLeave",Oe="onMouseEnter",ke="mouse",(r==="pointerout"||r==="pointerover")&&(Gt=mi,tt="onPointerLeave",Oe="onPointerEnter",ke="pointer"),Wn=Ve==null?Ge:hs(Ve),Be=Tt==null?Ge:hs(Tt),Ge=new Gt(tt,ke+"leave",Ve,f,Je),Ge.target=Wn,Ge.relatedTarget=Be,tt=null,fo(Je)===qe&&(Gt=new Gt(Oe,ke+"enter",Tt,f,Je),Gt.target=Be,Gt.relatedTarget=Wn,tt=Gt),Wn=tt,Ve&&Tt)t:{for(Gt=RE,Oe=Ve,ke=Tt,Be=0,tt=Oe;tt;tt=Gt(tt))Be++;tt=0;for(var Ut=ke;Ut;Ut=Gt(Ut))tt++;for(;0<Be-tt;)Oe=Gt(Oe),Be--;for(;0<tt-Be;)ke=Gt(ke),tt--;for(;Be--;){if(Oe===ke||ke!==null&&Oe===ke.alternate){Gt=Oe;break t}Oe=Gt(Oe),ke=Gt(ke)}Gt=null}else Gt=null;Ve!==null&&iy(it,Ge,Ve,Gt,!1),Tt!==null&&Wn!==null&&iy(it,Wn,Tt,Gt,!0)}}e:{if(Ge=qe?hs(qe):window,Ve=Ge.nodeName&&Ge.nodeName.toLowerCase(),Ve==="select"||Ve==="input"&&Ge.type==="file")var In=Ga;else if(oc(Ge))if(br)In=jo;else{In=gi;var Mt=rl}else Ve=Ge.nodeName,!Ve||Ve.toLowerCase()!=="input"||Ge.type!=="checkbox"&&Ge.type!=="radio"?qe&&Ql(qe.elementType)&&(In=Ga):In=Yc;if(In&&(In=In(r,qe))){Lr(it,In,f,Je);break e}Mt&&Mt(r,Ge,qe),r==="focusout"&&qe&&Ge.type==="number"&&qe.memoizedProps.value!=null&&Jl(Ge,"number",Ge.value)}switch(Mt=qe?hs(qe):window,r){case"focusin":(oc(Mt)||Mt.contentEditable==="true")&&(Mr=Mt,ya=qe,tr=null);break;case"focusout":tr=ya=Mr=null;break;case"mousedown":Gr=!0;break;case"contextmenu":case"mouseup":case"dragend":Gr=!1,Cn(it,f,Je);break;case"selectionchange":if(ws)break;case"keydown":case"keyup":Cn(it,f,Je)}var an;if(Po)e:{switch(r){case"compositionstart":var pn="onCompositionStart";break e;case"compositionend":pn="onCompositionEnd";break e;case"compositionupdate":pn="onCompositionUpdate";break e}pn=void 0}else Oo?Ha(r,f)&&(pn="onCompositionEnd"):r==="keydown"&&f.keyCode===229&&(pn="onCompositionStart");pn&&(da&&f.locale!=="ko"&&(Oo||pn!=="onCompositionStart"?pn==="onCompositionEnd"&&Oo&&(an=Gc()):(Rr=Je,vs="value"in Rr?Rr.value:Rr.textContent,Oo=!0)),Mt=Qf(qe,pn),0<Mt.length&&(pn=new Pe(pn,r,null,f,Je),it.push({event:pn,listeners:Mt}),an?pn.data=an:(an=tl(f),an!==null&&(pn.data=an)))),(an=xs?fr(r,f):fa(r,f))&&(pn=Qf(qe,"onBeforeInput"),0<pn.length&&(Mt=new Pe("onBeforeInput","beforeinput",null,f,Je),it.push({event:Mt,listeners:pn}),Mt.data=an)),CE(it,r,qe,f,Je)}ty(it,s)})}function Ld(r,s,f){return{instance:r,listener:s,currentTarget:f}}function Qf(r,s){for(var f=s+"Capture",m=[];r!==null;){var S=r,T=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||T===null||(S=Ir(r,f),S!=null&&m.unshift(Ld(r,S,T)),S=Ir(r,s),S!=null&&m.push(Ld(r,S,T))),r.tag===3)return m;r=r.return}return[]}function RE(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function iy(r,s,f,m,S){for(var T=s._reactName,H=[];f!==null&&f!==m;){var se=f,xe=se.alternate,qe=se.stateNode;if(se=se.tag,xe!==null&&xe===m)break;se!==5&&se!==26&&se!==27||qe===null||(xe=qe,S?(qe=Ir(f,T),qe!=null&&H.unshift(Ld(f,qe,xe))):S||(qe=Ir(f,T),qe!=null&&H.push(Ld(f,qe,xe)))),f=f.return}H.length!==0&&r.push({event:s,listeners:H})}var LE=/\r\n?/g,ME=/\u0000|\uFFFD/g;function ry(r){return(typeof r=="string"?r:""+r).replace(LE,`
`).replace(ME,"")}function oy(r,s){return s=ry(s),ry(r)===s}function Yn(r,s,f,m,S,T){switch(f){case"children":typeof m=="string"?s==="body"||s==="textarea"&&m===""||go(r,m):(typeof m=="number"||typeof m=="bigint")&&s!=="body"&&go(r,""+m);break;case"className":ta(r,"class",m);break;case"tabIndex":ta(r,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":ta(r,f,m);break;case"style":Fc(r,m,T);break;case"data":if(s!=="object"){ta(r,"data",m);break}case"src":case"href":if(m===""&&(s!=="a"||f!=="href")){r.removeAttribute(f);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){r.removeAttribute(f);break}m=yr(""+m),r.setAttribute(f,m);break;case"action":case"formAction":if(typeof m=="function"){r.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(f==="formAction"?(s!=="input"&&Yn(r,s,"name",S.name,S,null),Yn(r,s,"formEncType",S.formEncType,S,null),Yn(r,s,"formMethod",S.formMethod,S,null),Yn(r,s,"formTarget",S.formTarget,S,null)):(Yn(r,s,"encType",S.encType,S,null),Yn(r,s,"method",S.method,S,null),Yn(r,s,"target",S.target,S,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){r.removeAttribute(f);break}m=yr(""+m),r.setAttribute(f,m);break;case"onClick":m!=null&&(r.onclick=vo);break;case"onScroll":m!=null&&fn("scroll",r);break;case"onScrollEnd":m!=null&&fn("scrollend",r);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(i(61));if(f=m.__html,f!=null){if(S.children!=null)throw Error(i(60));r.innerHTML=f}}break;case"multiple":r.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":r.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){r.removeAttribute("xlink:href");break}f=yr(""+m),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?r.setAttribute(f,""+m):r.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?r.setAttribute(f,""):r.removeAttribute(f);break;case"capture":case"download":m===!0?r.setAttribute(f,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?r.setAttribute(f,m):r.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?r.setAttribute(f,m):r.removeAttribute(f);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?r.removeAttribute(f):r.setAttribute(f,m);break;case"popover":fn("beforetoggle",r),fn("toggle",r),kr(r,"popover",m);break;case"xlinkActuate":mo(r,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":mo(r,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":mo(r,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":mo(r,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":mo(r,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":mo(r,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":mo(r,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":mo(r,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":mo(r,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":kr(r,"is",m);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=ec.get(f)||f,kr(r,f,m))}}function O0(r,s,f,m,S,T){switch(f){case"style":Fc(r,m,T);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(i(61));if(f=m.__html,f!=null){if(S.children!=null)throw Error(i(60));r.innerHTML=f}}break;case"children":typeof m=="string"?go(r,m):(typeof m=="number"||typeof m=="bigint")&&go(r,""+m);break;case"onScroll":m!=null&&fn("scroll",r);break;case"onScrollEnd":m!=null&&fn("scrollend",r);break;case"onClick":m!=null&&(r.onclick=vo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Tr.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(S=f.endsWith("Capture"),s=f.slice(2,S?f.length-7:void 0),T=r[ti]||null,T=T!=null?T[f]:null,typeof T=="function"&&r.removeEventListener(s,T,S),typeof m=="function")){typeof T!="function"&&T!==null&&(f in r?r[f]=null:r.hasAttribute(f)&&r.removeAttribute(f)),r.addEventListener(s,m,S);break e}f in r?r[f]=m:m===!0?r.setAttribute(f,""):kr(r,f,m)}}}function vr(r,s,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":fn("error",r),fn("load",r);var m=!1,S=!1,T;for(T in f)if(f.hasOwnProperty(T)){var H=f[T];if(H!=null)switch(T){case"src":m=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Yn(r,s,T,H,f,null)}}S&&Yn(r,s,"srcSet",f.srcSet,f,null),m&&Yn(r,s,"src",f.src,f,null);return;case"input":fn("invalid",r);var se=T=H=S=null,xe=null,qe=null;for(m in f)if(f.hasOwnProperty(m)){var Je=f[m];if(Je!=null)switch(m){case"name":S=Je;break;case"type":H=Je;break;case"checked":xe=Je;break;case"defaultChecked":qe=Je;break;case"value":T=Je;break;case"defaultValue":se=Je;break;case"children":case"dangerouslySetInnerHTML":if(Je!=null)throw Error(i(137,s));break;default:Yn(r,s,m,Je,f,null)}}zc(r,T,se,xe,qe,H,S,!1);return;case"select":fn("invalid",r),m=H=T=null;for(S in f)if(f.hasOwnProperty(S)&&(se=f[S],se!=null))switch(S){case"value":T=se;break;case"defaultValue":H=se;break;case"multiple":m=se;default:Yn(r,s,S,se,f,null)}s=T,f=H,r.multiple=!!m,s!=null?dr(r,!!m,s,!1):f!=null&&dr(r,!!m,f,!0);return;case"textarea":fn("invalid",r),T=S=m=null;for(H in f)if(f.hasOwnProperty(H)&&(se=f[H],se!=null))switch(H){case"value":m=se;break;case"defaultValue":S=se;break;case"children":T=se;break;case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(91));break;default:Yn(r,s,H,se,f,null)}Zl(r,m,S,T);return;case"option":for(xe in f)if(f.hasOwnProperty(xe)&&(m=f[xe],m!=null))switch(xe){case"selected":r.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:Yn(r,s,xe,m,f,null)}return;case"dialog":fn("beforetoggle",r),fn("toggle",r),fn("cancel",r),fn("close",r);break;case"iframe":case"object":fn("load",r);break;case"video":case"audio":for(m=0;m<Rd.length;m++)fn(Rd[m],r);break;case"image":fn("error",r),fn("load",r);break;case"details":fn("toggle",r);break;case"embed":case"source":case"link":fn("error",r),fn("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(qe in f)if(f.hasOwnProperty(qe)&&(m=f[qe],m!=null))switch(qe){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Yn(r,s,qe,m,f,null)}return;default:if(Ql(s)){for(Je in f)f.hasOwnProperty(Je)&&(m=f[Je],m!==void 0&&O0(r,s,Je,m,f,void 0));return}}for(se in f)f.hasOwnProperty(se)&&(m=f[se],m!=null&&Yn(r,s,se,m,f,null))}function DE(r,s,f,m){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,T=null,H=null,se=null,xe=null,qe=null,Je=null;for(Ve in f){var it=f[Ve];if(f.hasOwnProperty(Ve)&&it!=null)switch(Ve){case"checked":break;case"value":break;case"defaultValue":xe=it;default:m.hasOwnProperty(Ve)||Yn(r,s,Ve,null,m,it)}}for(var Ge in m){var Ve=m[Ge];if(it=f[Ge],m.hasOwnProperty(Ge)&&(Ve!=null||it!=null))switch(Ge){case"type":T=Ve;break;case"name":S=Ve;break;case"checked":qe=Ve;break;case"defaultChecked":Je=Ve;break;case"value":H=Ve;break;case"defaultValue":se=Ve;break;case"children":case"dangerouslySetInnerHTML":if(Ve!=null)throw Error(i(137,s));break;default:Ve!==it&&Yn(r,s,Ge,Ve,m,it)}}Js(r,H,se,xe,qe,Je,T,S);return;case"select":Ve=H=se=Ge=null;for(T in f)if(xe=f[T],f.hasOwnProperty(T)&&xe!=null)switch(T){case"value":break;case"multiple":Ve=xe;default:m.hasOwnProperty(T)||Yn(r,s,T,null,m,xe)}for(S in m)if(T=m[S],xe=f[S],m.hasOwnProperty(S)&&(T!=null||xe!=null))switch(S){case"value":Ge=T;break;case"defaultValue":se=T;break;case"multiple":H=T;default:T!==xe&&Yn(r,s,S,T,m,xe)}s=se,f=H,m=Ve,Ge!=null?dr(r,!!f,Ge,!1):!!m!=!!f&&(s!=null?dr(r,!!f,s,!0):dr(r,!!f,f?[]:"",!1));return;case"textarea":Ve=Ge=null;for(se in f)if(S=f[se],f.hasOwnProperty(se)&&S!=null&&!m.hasOwnProperty(se))switch(se){case"value":break;case"children":break;default:Yn(r,s,se,null,m,S)}for(H in m)if(S=m[H],T=f[H],m.hasOwnProperty(H)&&(S!=null||T!=null))switch(H){case"value":Ge=S;break;case"defaultValue":Ve=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:S!==T&&Yn(r,s,H,S,m,T)}Kl(r,Ge,Ve);return;case"option":for(var Tt in f)if(Ge=f[Tt],f.hasOwnProperty(Tt)&&Ge!=null&&!m.hasOwnProperty(Tt))switch(Tt){case"selected":r.selected=!1;break;default:Yn(r,s,Tt,null,m,Ge)}for(xe in m)if(Ge=m[xe],Ve=f[xe],m.hasOwnProperty(xe)&&Ge!==Ve&&(Ge!=null||Ve!=null))switch(xe){case"selected":r.selected=Ge&&typeof Ge!="function"&&typeof Ge!="symbol";break;default:Yn(r,s,xe,Ge,m,Ve)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Gt in f)Ge=f[Gt],f.hasOwnProperty(Gt)&&Ge!=null&&!m.hasOwnProperty(Gt)&&Yn(r,s,Gt,null,m,Ge);for(qe in m)if(Ge=m[qe],Ve=f[qe],m.hasOwnProperty(qe)&&Ge!==Ve&&(Ge!=null||Ve!=null))switch(qe){case"children":case"dangerouslySetInnerHTML":if(Ge!=null)throw Error(i(137,s));break;default:Yn(r,s,qe,Ge,m,Ve)}return;default:if(Ql(s)){for(var Wn in f)Ge=f[Wn],f.hasOwnProperty(Wn)&&Ge!==void 0&&!m.hasOwnProperty(Wn)&&O0(r,s,Wn,void 0,m,Ge);for(Je in m)Ge=m[Je],Ve=f[Je],!m.hasOwnProperty(Je)||Ge===Ve||Ge===void 0&&Ve===void 0||O0(r,s,Je,Ge,m,Ve);return}}for(var Oe in f)Ge=f[Oe],f.hasOwnProperty(Oe)&&Ge!=null&&!m.hasOwnProperty(Oe)&&Yn(r,s,Oe,null,m,Ge);for(it in m)Ge=m[it],Ve=f[it],!m.hasOwnProperty(it)||Ge===Ve||Ge==null&&Ve==null||Yn(r,s,it,Ge,m,Ve)}function ay(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function PE(){if(typeof performance.getEntriesByType=="function"){for(var r=0,s=0,f=performance.getEntriesByType("resource"),m=0;m<f.length;m++){var S=f[m],T=S.transferSize,H=S.initiatorType,se=S.duration;if(T&&se&&ay(H)){for(H=0,se=S.responseEnd,m+=1;m<f.length;m++){var xe=f[m],qe=xe.startTime;if(qe>se)break;var Je=xe.transferSize,it=xe.initiatorType;Je&&ay(it)&&(xe=xe.responseEnd,H+=Je*(xe<se?1:(se-qe)/(xe-qe)))}if(--m,s+=8*(T+H)/(S.duration/1e3),r++,10<r)break}}if(0<r)return s/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var U0=null,z0=null;function eh(r){return r.nodeType===9?r:r.ownerDocument}function sy(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ly(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function j0(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var F0=null;function OE(){var r=window.event;return r&&r.type==="popstate"?r===F0?!1:(F0=r,!0):(F0=null,!1)}var cy=typeof setTimeout=="function"?setTimeout:void 0,UE=typeof clearTimeout=="function"?clearTimeout:void 0,uy=typeof Promise=="function"?Promise:void 0,zE=typeof queueMicrotask=="function"?queueMicrotask:typeof uy<"u"?function(r){return uy.resolve(null).then(r).catch(jE)}:cy;function jE(r){setTimeout(function(){throw r})}function El(r){return r==="head"}function dy(r,s){var f=s,m=0;do{var S=f.nextSibling;if(r.removeChild(f),S&&S.nodeType===8)if(f=S.data,f==="/$"||f==="/&"){if(m===0){r.removeChild(S),Au(s);return}m--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")m++;else if(f==="html")Md(r.ownerDocument.documentElement);else if(f==="head"){f=r.ownerDocument.head,Md(f);for(var T=f.firstChild;T;){var H=T.nextSibling,se=T.nodeName;T[uo]||se==="SCRIPT"||se==="STYLE"||se==="LINK"&&T.rel.toLowerCase()==="stylesheet"||f.removeChild(T),T=H}}else f==="body"&&Md(r.ownerDocument.body);f=S}while(f);Au(s)}function fy(r,s){var f=r;r=0;do{var m=f.nextSibling;if(f.nodeType===1?s?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(s?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),m&&m.nodeType===8)if(f=m.data,f==="/$"){if(r===0)break;r--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||r++;f=m}while(f)}function B0(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var f=s;switch(s=s.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":B0(f),ja(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}r.removeChild(f)}}function FE(r,s,f,m){for(;r.nodeType===1;){var S=f;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!m&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(m){if(!r[uo])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(T=r.getAttribute("rel"),T==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(T!==S.rel||r.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||r.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||r.getAttribute("title")!==(S.title==null?null:S.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(T=r.getAttribute("src"),(T!==(S.src==null?null:S.src)||r.getAttribute("type")!==(S.type==null?null:S.type)||r.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&T&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var T=S.name==null?null:""+S.name;if(S.type==="hidden"&&r.getAttribute("name")===T)return r}else return r;if(r=$o(r.nextSibling),r===null)break}return null}function BE(r,s,f){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!f||(r=$o(r.nextSibling),r===null))return null;return r}function hy(r,s){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!s||(r=$o(r.nextSibling),r===null))return null;return r}function q0(r){return r.data==="$?"||r.data==="$~"}function H0(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function qE(r,s){var f=r.ownerDocument;if(r.data==="$~")r._reactRetry=s;else if(r.data!=="$?"||f.readyState!=="loading")s();else{var m=function(){s(),f.removeEventListener("DOMContentLoaded",m)};f.addEventListener("DOMContentLoaded",m),r._reactRetry=m}}function $o(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return r}var G0=null;function py(r){r=r.nextSibling;for(var s=0;r;){if(r.nodeType===8){var f=r.data;if(f==="/$"||f==="/&"){if(s===0)return $o(r.nextSibling);s--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||s++}r=r.nextSibling}return null}function my(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var f=r.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(s===0)return r;s--}else f!=="/$"&&f!=="/&"||s++}r=r.previousSibling}return null}function gy(r,s,f){switch(s=eh(f),r){case"html":if(r=s.documentElement,!r)throw Error(i(452));return r;case"head":if(r=s.head,!r)throw Error(i(453));return r;case"body":if(r=s.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Md(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);ja(r)}var Yo=new Map,vy=new Set;function th(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var js=Y.d;Y.d={f:HE,r:GE,D:VE,C:$E,L:YE,m:WE,X:JE,S:XE,M:KE};function HE(){var r=js.f(),s=$f();return r||s}function GE(r){var s=ho(r);s!==null&&s.tag===5&&s.type==="form"?D1(s):js.r(r)}var Su=typeof document>"u"?null:document;function yy(r,s,f){var m=Su;if(m&&typeof s=="string"&&s){var S=wi(s);S='link[rel="'+r+'"][href="'+S+'"]',typeof f=="string"&&(S+='[crossorigin="'+f+'"]'),vy.has(S)||(vy.add(S),r={rel:r,crossOrigin:f,href:s},m.querySelector(S)===null&&(s=m.createElement("link"),vr(s,"link",r),pi(s),m.head.appendChild(s)))}}function VE(r){js.D(r),yy("dns-prefetch",r,null)}function $E(r,s){js.C(r,s),yy("preconnect",r,s)}function YE(r,s,f){js.L(r,s,f);var m=Su;if(m&&r&&s){var S='link[rel="preload"][as="'+wi(s)+'"]';s==="image"&&f&&f.imageSrcSet?(S+='[imagesrcset="'+wi(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(S+='[imagesizes="'+wi(f.imageSizes)+'"]')):S+='[href="'+wi(r)+'"]';var T=S;switch(s){case"style":T=Eu(r);break;case"script":T=Nu(r)}Yo.has(T)||(r=v({rel:"preload",href:s==="image"&&f&&f.imageSrcSet?void 0:r,as:s},f),Yo.set(T,r),m.querySelector(S)!==null||s==="style"&&m.querySelector(Dd(T))||s==="script"&&m.querySelector(Pd(T))||(s=m.createElement("link"),vr(s,"link",r),pi(s),m.head.appendChild(s)))}}function WE(r,s){js.m(r,s);var f=Su;if(f&&r){var m=s&&typeof s.as=="string"?s.as:"script",S='link[rel="modulepreload"][as="'+wi(m)+'"][href="'+wi(r)+'"]',T=S;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=Nu(r)}if(!Yo.has(T)&&(r=v({rel:"modulepreload",href:r},s),Yo.set(T,r),f.querySelector(S)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Pd(T)))return}m=f.createElement("link"),vr(m,"link",r),pi(m),f.head.appendChild(m)}}}function XE(r,s,f){js.S(r,s,f);var m=Su;if(m&&r){var S=Ro(m).hoistableStyles,T=Eu(r);s=s||"default";var H=S.get(T);if(!H){var se={loading:0,preload:null};if(H=m.querySelector(Dd(T)))se.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":s},f),(f=Yo.get(T))&&V0(r,f);var xe=H=m.createElement("link");pi(xe),vr(xe,"link",r),xe._p=new Promise(function(qe,Je){xe.onload=qe,xe.onerror=Je}),xe.addEventListener("load",function(){se.loading|=1}),xe.addEventListener("error",function(){se.loading|=2}),se.loading|=4,nh(H,s,m)}H={type:"stylesheet",instance:H,count:1,state:se},S.set(T,H)}}}function JE(r,s){js.X(r,s);var f=Su;if(f&&r){var m=Ro(f).hoistableScripts,S=Nu(r),T=m.get(S);T||(T=f.querySelector(Pd(S)),T||(r=v({src:r,async:!0},s),(s=Yo.get(S))&&$0(r,s),T=f.createElement("script"),pi(T),vr(T,"link",r),f.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},m.set(S,T))}}function KE(r,s){js.M(r,s);var f=Su;if(f&&r){var m=Ro(f).hoistableScripts,S=Nu(r),T=m.get(S);T||(T=f.querySelector(Pd(S)),T||(r=v({src:r,async:!0,type:"module"},s),(s=Yo.get(S))&&$0(r,s),T=f.createElement("script"),pi(T),vr(T,"link",r),f.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},m.set(S,T))}}function by(r,s,f,m){var S=(S=ye.current)?th(S):null;if(!S)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(s=Eu(f.href),f=Ro(S).hoistableStyles,m=f.get(s),m||(m={type:"style",instance:null,count:0,state:null},f.set(s,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){r=Eu(f.href);var T=Ro(S).hoistableStyles,H=T.get(r);if(H||(S=S.ownerDocument||S,H={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(r,H),(T=S.querySelector(Dd(r)))&&!T._p&&(H.instance=T,H.state.loading=5),Yo.has(r)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},Yo.set(r,f),T||ZE(S,r,f,H.state))),s&&m===null)throw Error(i(528,""));return H}if(s&&m!==null)throw Error(i(529,""));return null;case"script":return s=f.async,f=f.src,typeof f=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Nu(f),f=Ro(S).hoistableScripts,m=f.get(s),m||(m={type:"script",instance:null,count:0,state:null},f.set(s,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Eu(r){return'href="'+wi(r)+'"'}function Dd(r){return'link[rel="stylesheet"]['+r+"]"}function xy(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function ZE(r,s,f,m){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?m.loading=1:(s=r.createElement("link"),m.preload=s,s.addEventListener("load",function(){return m.loading|=1}),s.addEventListener("error",function(){return m.loading|=2}),vr(s,"link",f),pi(s),r.head.appendChild(s))}function Nu(r){return'[src="'+wi(r)+'"]'}function Pd(r){return"script[async]"+r}function wy(r,s,f){if(s.count++,s.instance===null)switch(s.type){case"style":var m=r.querySelector('style[data-href~="'+wi(f.href)+'"]');if(m)return s.instance=m,pi(m),m;var S=v({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return m=(r.ownerDocument||r).createElement("style"),pi(m),vr(m,"style",S),nh(m,f.precedence,r),s.instance=m;case"stylesheet":S=Eu(f.href);var T=r.querySelector(Dd(S));if(T)return s.state.loading|=4,s.instance=T,pi(T),T;m=xy(f),(S=Yo.get(S))&&V0(m,S),T=(r.ownerDocument||r).createElement("link"),pi(T);var H=T;return H._p=new Promise(function(se,xe){H.onload=se,H.onerror=xe}),vr(T,"link",m),s.state.loading|=4,nh(T,f.precedence,r),s.instance=T;case"script":return T=Nu(f.src),(S=r.querySelector(Pd(T)))?(s.instance=S,pi(S),S):(m=f,(S=Yo.get(T))&&(m=v({},f),$0(m,S)),r=r.ownerDocument||r,S=r.createElement("script"),pi(S),vr(S,"link",m),r.head.appendChild(S),s.instance=S);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(m=s.instance,s.state.loading|=4,nh(m,f.precedence,r));return s.instance}function nh(r,s,f){for(var m=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=m.length?m[m.length-1]:null,T=S,H=0;H<m.length;H++){var se=m[H];if(se.dataset.precedence===s)T=se;else if(T!==S)break}T?T.parentNode.insertBefore(r,T.nextSibling):(s=f.nodeType===9?f.head:f,s.insertBefore(r,s.firstChild))}function V0(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function $0(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var ih=null;function _y(r,s,f){if(ih===null){var m=new Map,S=ih=new Map;S.set(f,m)}else S=ih,m=S.get(f),m||(m=new Map,S.set(f,m));if(m.has(r))return m;for(m.set(r,null),f=f.getElementsByTagName(r),S=0;S<f.length;S++){var T=f[S];if(!(T[uo]||T[On]||r==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var H=T.getAttribute(s)||"";H=r+H;var se=m.get(H);se?se.push(T):m.set(H,[T])}}return m}function Sy(r,s,f){r=r.ownerDocument||r,r.head.insertBefore(f,s==="title"?r.querySelector("head > title"):null)}function QE(r,s,f){if(f===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return r=s.disabled,typeof s.precedence=="string"&&r==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Ey(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function eN(r,s,f,m){if(f.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var S=Eu(m.href),T=s.querySelector(Dd(S));if(T){s=T._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(r.count++,r=rh.bind(r),s.then(r,r)),f.state.loading|=4,f.instance=T,pi(T);return}T=s.ownerDocument||s,m=xy(m),(S=Yo.get(S))&&V0(m,S),T=T.createElement("link"),pi(T);var H=T;H._p=new Promise(function(se,xe){H.onload=se,H.onerror=xe}),vr(T,"link",m),f.instance=T}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(f,s),(s=f.state.preload)&&(f.state.loading&3)===0&&(r.count++,f=rh.bind(r),s.addEventListener("load",f),s.addEventListener("error",f))}}var Y0=0;function tN(r,s){return r.stylesheets&&r.count===0&&ah(r,r.stylesheets),0<r.count||0<r.imgCount?function(f){var m=setTimeout(function(){if(r.stylesheets&&ah(r,r.stylesheets),r.unsuspend){var T=r.unsuspend;r.unsuspend=null,T()}},6e4+s);0<r.imgBytes&&Y0===0&&(Y0=62500*PE());var S=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&ah(r,r.stylesheets),r.unsuspend)){var T=r.unsuspend;r.unsuspend=null,T()}},(r.imgBytes>Y0?50:800)+s);return r.unsuspend=f,function(){r.unsuspend=null,clearTimeout(m),clearTimeout(S)}}:null}function rh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ah(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var oh=null;function ah(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,oh=new Map,s.forEach(nN,r),oh=null,rh.call(r))}function nN(r,s){if(!(s.state.loading&4)){var f=oh.get(r);if(f)var m=f.get(null);else{f=new Map,oh.set(r,f);for(var S=r.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<S.length;T++){var H=S[T];(H.nodeName==="LINK"||H.getAttribute("media")!=="not all")&&(f.set(H.dataset.precedence,H),m=H)}m&&f.set(null,m)}S=s.instance,H=S.getAttribute("data-precedence"),T=f.get(H)||m,T===m&&f.set(null,S),f.set(H,S),this.count++,m=rh.bind(this),S.addEventListener("load",m),S.addEventListener("error",m),T?T.parentNode.insertBefore(S,T.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(S,r.firstChild)),s.state.loading|=4}}var Od={$$typeof:k,Provider:null,Consumer:null,_currentValue:le,_currentValue2:le,_threadCount:0};function iN(r,s,f,m,S,T,H,se,xe){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Jt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jt(0),this.hiddenUpdates=Jt(null),this.identifierPrefix=m,this.onUncaughtError=S,this.onCaughtError=T,this.onRecoverableError=H,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=xe,this.incompleteTransitions=new Map}function Ny(r,s,f,m,S,T,H,se,xe,qe,Je,it){return r=new iN(r,s,f,H,xe,qe,Je,it,se),s=1,T===!0&&(s|=24),T=ir(3,null,null,s),r.current=T,T.stateNode=r,s=fl(),s.refCount++,r.pooledCache=s,s.refCount++,T.memoizedState={element:m,isDehydrated:f,cache:s},gt(T),r}function Ay(r){return r?(r=$i,r):$i}function Cy(r,s,f,m,S,T){S=Ay(S),m.context===null?m.context=S:m.pendingContext=S,m=Ht(s),m.payload={element:f},T=T===void 0?null:T,T!==null&&(m.callback=T),f=nn(r,m,s),f!==null&&(ro(f,r,s),Mn(f,r,s))}function Ty(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var f=r.retryLane;r.retryLane=f!==0&&f<s?f:s}}function W0(r,s){Ty(r,s),(r=r.alternate)&&Ty(r,s)}function ky(r){if(r.tag===13||r.tag===31){var s=ba(r,67108864);s!==null&&ro(s,r,67108864),W0(r,67108864)}}function Iy(r){if(r.tag===13||r.tag===31){var s=Ao();s=mn(s);var f=ba(r,s);f!==null&&ro(f,r,s),W0(r,s)}}var sh=!0;function rN(r,s,f,m){var S=J.T;J.T=null;var T=Y.p;try{Y.p=2,X0(r,s,f,m)}finally{Y.p=T,J.T=S}}function oN(r,s,f,m){var S=J.T;J.T=null;var T=Y.p;try{Y.p=8,X0(r,s,f,m)}finally{Y.p=T,J.T=S}}function X0(r,s,f,m){if(sh){var S=J0(m);if(S===null)P0(r,s,m,lh,f),Ly(r,m);else if(sN(S,r,s,f,m))m.stopPropagation();else if(Ly(r,m),s&4&&-1<aN.indexOf(r)){for(;S!==null;){var T=ho(S);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var H=et(T.pendingLanes);if(H!==0){var se=T;for(se.pendingLanes|=2,se.entangledLanes|=2;H;){var xe=1<<31-Ft(H);se.entanglements[1]|=xe,H&=~xe}is(T),(Pn&6)===0&&(Gf=Ne()+500,Id(0))}}break;case 31:case 13:se=ba(T,2),se!==null&&ro(se,T,2),$f(),W0(T,2)}if(T=J0(m),T===null&&P0(r,s,m,lh,f),T===S)break;S=T}S!==null&&m.stopPropagation()}else P0(r,s,m,null,f)}}function J0(r){return r=ms(r),K0(r)}var lh=null;function K0(r){if(lh=null,r=fo(r),r!==null){var s=a(r);if(s===null)r=null;else{var f=s.tag;if(f===13){if(r=l(s),r!==null)return r;r=null}else if(f===31){if(r=c(s),r!==null)return r;r=null}else if(f===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return lh=r,null}function Ry(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ze()){case We:return 2;case dt:return 8;case ft:case ht:return 32;case Et:return 268435456;default:return 32}default:return 32}}var Z0=!1,Nl=null,Al=null,Cl=null,Ud=new Map,zd=new Map,Tl=[],aN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ly(r,s){switch(r){case"focusin":case"focusout":Nl=null;break;case"dragenter":case"dragleave":Al=null;break;case"mouseover":case"mouseout":Cl=null;break;case"pointerover":case"pointerout":Ud.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":zd.delete(s.pointerId)}}function jd(r,s,f,m,S,T){return r===null||r.nativeEvent!==T?(r={blockedOn:s,domEventName:f,eventSystemFlags:m,nativeEvent:T,targetContainers:[S]},s!==null&&(s=ho(s),s!==null&&ky(s)),r):(r.eventSystemFlags|=m,s=r.targetContainers,S!==null&&s.indexOf(S)===-1&&s.push(S),r)}function sN(r,s,f,m,S){switch(s){case"focusin":return Nl=jd(Nl,r,s,f,m,S),!0;case"dragenter":return Al=jd(Al,r,s,f,m,S),!0;case"mouseover":return Cl=jd(Cl,r,s,f,m,S),!0;case"pointerover":var T=S.pointerId;return Ud.set(T,jd(Ud.get(T)||null,r,s,f,m,S)),!0;case"gotpointercapture":return T=S.pointerId,zd.set(T,jd(zd.get(T)||null,r,s,f,m,S)),!0}return!1}function My(r){var s=fo(r.target);if(s!==null){var f=a(s);if(f!==null){if(s=f.tag,s===13){if(s=l(f),s!==null){r.blockedOn=s,Qi(r.priority,function(){Iy(f)});return}}else if(s===31){if(s=c(f),s!==null){r.blockedOn=s,Qi(r.priority,function(){Iy(f)});return}}else if(s===3&&f.stateNode.current.memoizedState.isDehydrated){r.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}r.blockedOn=null}function ch(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var f=J0(r.nativeEvent);if(f===null){f=r.nativeEvent;var m=new f.constructor(f.type,f);na=m,f.target.dispatchEvent(m),na=null}else return s=ho(f),s!==null&&ky(s),r.blockedOn=f,!1;s.shift()}return!0}function Dy(r,s,f){ch(r)&&f.delete(s)}function lN(){Z0=!1,Nl!==null&&ch(Nl)&&(Nl=null),Al!==null&&ch(Al)&&(Al=null),Cl!==null&&ch(Cl)&&(Cl=null),Ud.forEach(Dy),zd.forEach(Dy)}function uh(r,s){r.blockedOn===s&&(r.blockedOn=null,Z0||(Z0=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,lN)))}var dh=null;function Py(r){dh!==r&&(dh=r,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){dh===r&&(dh=null);for(var s=0;s<r.length;s+=3){var f=r[s],m=r[s+1],S=r[s+2];if(typeof m!="function"){if(K0(m||f)===null)continue;break}var T=ho(f);T!==null&&(r.splice(s,3),s-=3,Jp(T,{pending:!0,data:S,method:f.method,action:m},m,S))}}))}function Au(r){function s(xe){return uh(xe,r)}Nl!==null&&uh(Nl,r),Al!==null&&uh(Al,r),Cl!==null&&uh(Cl,r),Ud.forEach(s),zd.forEach(s);for(var f=0;f<Tl.length;f++){var m=Tl[f];m.blockedOn===r&&(m.blockedOn=null)}for(;0<Tl.length&&(f=Tl[0],f.blockedOn===null);)My(f),f.blockedOn===null&&Tl.shift();if(f=(r.ownerDocument||r).$$reactFormReplay,f!=null)for(m=0;m<f.length;m+=3){var S=f[m],T=f[m+1],H=S[ti]||null;if(typeof T=="function")H||Py(f);else if(H){var se=null;if(T&&T.hasAttribute("formAction")){if(S=T,H=T[ti]||null)se=H.formAction;else if(K0(S)!==null)continue}else se=H.action;typeof se=="function"?f[m+1]=se:(f.splice(m,3),m-=3),Py(f)}}}function Oy(){function r(T){T.canIntercept&&T.info==="react-transition"&&T.intercept({handler:function(){return new Promise(function(H){return S=H})},focusReset:"manual",scroll:"manual"})}function s(){S!==null&&(S(),S=null),m||setTimeout(f,20)}function f(){if(!m&&!navigation.transition){var T=navigation.currentEntry;T&&T.url!=null&&navigation.navigate(T.url,{state:T.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,S=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(f,100),function(){m=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),S!==null&&(S(),S=null)}}}function Q0(r){this._internalRoot=r}fh.prototype.render=Q0.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(i(409));var f=s.current,m=Ao();Cy(f,m,r,s,null,null)},fh.prototype.unmount=Q0.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;Cy(r.current,2,null,r,null,null),$f(),s[er]=null}};function fh(r){this._internalRoot=r}fh.prototype.unstable_scheduleHydration=function(r){if(r){var s=wn();r={blockedOn:null,target:r,priority:s};for(var f=0;f<Tl.length&&s!==0&&s<Tl[f].priority;f++);Tl.splice(f,0,r),f===0&&My(r)}};var Uy=t.version;if(Uy!=="19.2.4")throw Error(i(527,Uy,"19.2.4"));Y.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=d(s),r=r!==null?h(r):null,r=r===null?null:r.stateNode,r};var cN={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hh.isDisabled&&hh.supportsFiber)try{yt=hh.inject(cN),vt=hh}catch{}}return qd.createRoot=function(r,s){if(!o(r))throw Error(i(299));var f=!1,m="",S=G1,T=V1,H=$1;return s!=null&&(s.unstable_strictMode===!0&&(f=!0),s.identifierPrefix!==void 0&&(m=s.identifierPrefix),s.onUncaughtError!==void 0&&(S=s.onUncaughtError),s.onCaughtError!==void 0&&(T=s.onCaughtError),s.onRecoverableError!==void 0&&(H=s.onRecoverableError)),s=Ny(r,1,!1,null,null,f,m,null,S,T,H,Oy),r[er]=s.current,D0(r),new Q0(s)},qd.hydrateRoot=function(r,s,f){if(!o(r))throw Error(i(299));var m=!1,S="",T=G1,H=V1,se=$1,xe=null;return f!=null&&(f.unstable_strictMode===!0&&(m=!0),f.identifierPrefix!==void 0&&(S=f.identifierPrefix),f.onUncaughtError!==void 0&&(T=f.onUncaughtError),f.onCaughtError!==void 0&&(H=f.onCaughtError),f.onRecoverableError!==void 0&&(se=f.onRecoverableError),f.formState!==void 0&&(xe=f.formState)),s=Ny(r,1,!0,s,f??null,m,S,xe,T,H,se,Oy),s.context=Ay(null),f=s.current,m=Ao(),m=mn(m),S=Ht(m),S.callback=null,nn(f,S,m),f=m,s.current.lanes=f,bt(s,f),is(s),r[er]=s.current,D0(r),new fh(s)},qd.version="19.2.4",qd}var Ky;function xN(){if(Ky)return nm.exports;Ky=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),nm.exports=bN(),nm.exports}var wN=xN();const _N=Dg(wN),Zy=e=>{let t;const n=new Set,i=(d,h)=>{const v=typeof d=="function"?d(t):d;if(!Object.is(v,t)){const b=t;t=h??(typeof v!="object"||v===null)?v:Object.assign({},t,v),n.forEach(g=>g(t,b))}},o=()=>t,c={setState:i,getState:o,getInitialState:()=>u,subscribe:d=>(n.add(d),()=>n.delete(d))},u=t=e(i,o,c);return c},SN=(e=>e?Zy(e):Zy),EN=e=>e;function NN(e,t=EN){const n=kn.useSyncExternalStore(e.subscribe,kn.useCallback(()=>t(e.getState()),[e,t]),kn.useCallback(()=>t(e.getInitialState()),[e,t]));return kn.useDebugValue(n),n}const AN=e=>{const t=SN(e),n=i=>NN(t,i);return Object.assign(n,t),n},CN=(e=>AN);function Jx(e,t){let n;try{n=e()}catch{return}return{getItem:o=>{var a;const l=u=>u===null?null:JSON.parse(u,void 0),c=(a=n.getItem(o))!=null?a:null;return c instanceof Promise?c.then(l):l(c)},setItem:(o,a)=>n.setItem(o,JSON.stringify(a,void 0)),removeItem:o=>n.removeItem(o)}}const Hm=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(i){return Hm(i)(n)},catch(i){return this}}}catch(n){return{then(i){return this},catch(i){return Hm(i)(n)}}}},TN=(e,t)=>(n,i,o)=>{let a={storage:Jx(()=>window.localStorage),partialize:C=>C,version:0,merge:(C,E)=>({...E,...C}),...t},l=!1,c=0;const u=new Set,d=new Set;let h=a.storage;if(!h)return e((...C)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),n(...C)},i,o);const v=()=>{const C=a.partialize({...i()});return h.setItem(a.name,{state:C,version:a.version})},b=o.setState;o.setState=(C,E)=>(b(C,E),v());const g=e((...C)=>(n(...C),v()),i,o);o.getInitialState=()=>g;let A;const _=()=>{var C,E;if(!h)return;const R=++c;l=!1,u.forEach(M=>{var P;return M((P=i())!=null?P:g)});const k=((E=a.onRehydrateStorage)==null?void 0:E.call(a,(C=i())!=null?C:g))||void 0;return Hm(h.getItem.bind(h))(a.name).then(M=>{if(M)if(typeof M.version=="number"&&M.version!==a.version){if(a.migrate){const P=a.migrate(M.state,M.version);return P instanceof Promise?P.then(W=>[!0,W]):[!0,P]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,M.state];return[!1,void 0]}).then(M=>{var P;if(R!==c)return;const[W,V]=M;if(A=a.merge(V,(P=i())!=null?P:g),n(A,!0),W)return v()}).then(()=>{R===c&&(k==null||k(A,void 0),A=i(),l=!0,d.forEach(M=>M(A)))}).catch(M=>{R===c&&(k==null||k(void 0,M))})};return o.persist={setOptions:C=>{a={...a,...C},C.storage&&(h=C.storage)},clearStorage:()=>{h==null||h.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>l,onHydrate:C=>(u.add(C),()=>{u.delete(C)}),onFinishHydration:C=>(d.add(C),()=>{d.delete(C)})},a.skipHydration||_(),A||g},kN=TN,IN=e=>({characters:[],relationships:[],activeCharacterId:null,activeEraId:null,characterView:"grid",isCharacterEditorOpen:!1,isChatOpen:!1,activeChatCharacterId:null,characterSearchTerm:"",addCharacter:t=>e(n=>{var o;const i={...t,id:crypto.randomUUID(),createdAt:Date.now(),updatedAt:Date.now()};return{characters:[i,...n.characters],activeCharacterId:i.id,activeEraId:((o=i.eras[0])==null?void 0:o.id)||null,isCharacterEditorOpen:!0}}),updateCharacter:(t,n)=>e(i=>({characters:i.characters.map(o=>o.id===t?{...o,...n,updatedAt:Date.now()}:o)})),deleteCharacter:t=>e(n=>({characters:n.characters.filter(i=>i.id!==t),relationships:n.relationships.filter(i=>i.fromId!==t&&i.toId!==t),activeCharacterId:n.activeCharacterId===t?null:n.activeCharacterId})),setActiveCharacter:t=>e(n=>{var o;const i=n.characters.find(a=>a.id===t);return{activeCharacterId:t,activeEraId:((o=i==null?void 0:i.eras[0])==null?void 0:o.id)||null}}),setActiveEra:t=>e({activeEraId:t}),setCharacterEditorOpen:t=>e({isCharacterEditorOpen:t}),setCharacterChatOpen:(t,n=null)=>e(i=>({isChatOpen:t,activeChatCharacterId:n!==void 0?n:i.activeChatCharacterId})),setCharacterView:t=>e({characterView:t}),setCharacterSearchTerm:t=>e({characterSearchTerm:t}),addRelationship:t=>e(n=>({relationships:[...n.relationships,{...t,id:crypto.randomUUID()}]})),deleteRelationship:t=>e(n=>({relationships:n.relationships.filter(i=>i.id!==t)})),linkCharacterToLore:(t,n)=>e(i=>({characters:i.characters.map(o=>o.id===t&&!o.loreEntryIds.includes(n)?{...o,loreEntryIds:[...o.loreEntryIds,n],updatedAt:Date.now()}:o)})),unlinkCharacterFromLore:(t,n)=>e(i=>({characters:i.characters.map(o=>o.id===t?{...o,loreEntryIds:o.loreEntryIds.filter(a=>a!==n),updatedAt:Date.now()}:o)}))}),RN=e=>({loreEntries:[],activeLoreEntryId:null,isLoreEditorOpen:!1,loreSearchTerm:"",loreFilterType:"all",addLoreEntry:t=>e(n=>({loreEntries:[t,...n.loreEntries],activeLoreEntryId:t.id,isLoreEditorOpen:!0})),updateLoreEntry:(t,n)=>e(i=>({loreEntries:i.loreEntries.map(o=>o.id===t?{...o,...n,updatedAt:Date.now()}:o)})),deleteLoreEntry:t=>e(n=>({loreEntries:n.loreEntries.filter(i=>i.id!==t),activeLoreEntryId:n.activeLoreEntryId===t?null:n.activeLoreEntryId})),setActiveLoreEntry:t=>e({activeLoreEntryId:t}),setLoreEditorOpen:t=>e({isLoreEditorOpen:t}),setLoreSearchTerm:t=>e({loreSearchTerm:t}),setLoreFilterType:t=>e({loreFilterType:t}),linkLoreToCharacter:(t,n)=>e(i=>({loreEntries:i.loreEntries.map(o=>o.id===t&&!o.characterIds.includes(n)?{...o,characterIds:[...o.characterIds,n],updatedAt:Date.now()}:o)})),unlinkLoreFromCharacter:(t,n)=>e(i=>({loreEntries:i.loreEntries.map(o=>o.id===t?{...o,characterIds:o.characterIds.filter(a=>a!==n),updatedAt:Date.now()}:o)}))}),LN=e=>({activeModule:"characters",isCommandPaletteOpen:!1,syncStatus:"idle",projectName:"Untitled Project",setActiveModule:t=>e({activeModule:t}),setCommandPaletteOpen:t=>e({isCommandPaletteOpen:t}),setSyncStatus:t=>e({syncStatus:t}),setProjectName:t=>e({projectName:t})});var xn=(e=>(e.FACTION="faction",e.LOCATION="location",e.EVENT="event",e.CONCEPT="concept",e.ARTIFACT="artifact",e.RULE="rule",e))(xn||{}),Yt=(e=>(e.WIDE="wide",e.STD="std",e.SQUARE="square",e.TALL="tall",e.PORTRAIT="portrait",e))(Yt||{});const qs=()=>crypto.randomUUID(),MN=e=>{switch(e){case"screenplay":return Yt.WIDE;case"stage-play":return Yt.STD;case"tv-series":return Yt.WIDE;default:return Yt.STD}},DN={"2x2":{panels:[{x:40,y:40,width:360,height:300,aspectRatio:Yt.WIDE},{x:420,y:40,width:360,height:300,aspectRatio:Yt.WIDE},{x:40,y:360,width:360,height:300,aspectRatio:Yt.WIDE},{x:420,y:360,width:360,height:300,aspectRatio:Yt.WIDE}]},"3x3":{panels:[{x:40,y:40,width:240,height:200,aspectRatio:Yt.STD},{x:300,y:40,width:240,height:200,aspectRatio:Yt.STD},{x:560,y:40,width:240,height:200,aspectRatio:Yt.STD},{x:40,y:260,width:240,height:200,aspectRatio:Yt.STD},{x:300,y:260,width:240,height:200,aspectRatio:Yt.STD},{x:560,y:260,width:240,height:200,aspectRatio:Yt.STD},{x:40,y:480,width:240,height:200,aspectRatio:Yt.STD},{x:300,y:480,width:240,height:200,aspectRatio:Yt.STD},{x:560,y:480,width:240,height:200,aspectRatio:Yt.STD}]},"2x3":{panels:[{x:40,y:40,width:360,height:200,aspectRatio:Yt.WIDE},{x:420,y:40,width:360,height:200,aspectRatio:Yt.WIDE},{x:40,y:260,width:360,height:200,aspectRatio:Yt.WIDE},{x:420,y:260,width:360,height:200,aspectRatio:Yt.WIDE},{x:40,y:480,width:360,height:200,aspectRatio:Yt.WIDE},{x:420,y:480,width:360,height:200,aspectRatio:Yt.WIDE}]},"manga-right":{panels:[{x:420,y:40,width:360,height:280,aspectRatio:Yt.STD},{x:40,y:40,width:360,height:180,aspectRatio:Yt.WIDE},{x:40,y:240,width:360,height:180,aspectRatio:Yt.WIDE},{x:40,y:440,width:280,height:220,aspectRatio:Yt.STD},{x:340,y:340,width:440,height:320,aspectRatio:Yt.WIDE}]},"manga-left":{panels:[{x:40,y:40,width:360,height:280,aspectRatio:Yt.STD},{x:420,y:40,width:360,height:180,aspectRatio:Yt.WIDE},{x:420,y:240,width:360,height:180,aspectRatio:Yt.WIDE},{x:500,y:440,width:280,height:220,aspectRatio:Yt.STD},{x:40,y:340,width:440,height:320,aspectRatio:Yt.WIDE}]},single:{panels:[{x:40,y:40,width:720,height:600,aspectRatio:Yt.WIDE}]},"double-wide":{panels:[{x:40,y:40,width:740,height:300,aspectRatio:Yt.WIDE},{x:40,y:360,width:740,height:300,aspectRatio:Yt.WIDE}]}};function Qy(e,t){var i,o,a,l,c,u;let n={...e};switch(t.type){case"HYDRATE":return t.payload;case"SET_ACTIVE_PROJECT":{const d=e.projects.find(h=>h.id===t.id);return{...e,activeProjectId:t.id,activeIssueId:((i=d==null?void 0:d.issues[0])==null?void 0:i.id)||null,activePageId:((a=(o=d==null?void 0:d.issues[0])==null?void 0:o.pages[0])==null?void 0:a.id)||null}}case"ADD_PROJECT":{const d={id:qs(),title:t.title,style:"classic-noir",issueType:"issue",imageProvider:"gemini",projectType:t.projectType||"comic",fluxModel:"fal-ai/flux-pro",issues:[{id:qs(),title:"Issue #1",pages:[{id:qs(),number:1,panels:[]}]}]};return{...e,projects:[...e.projects,d],activeProjectId:d.id,activeIssueId:d.issues[0].id,activePageId:d.issues[0].pages[0].id}}case"UPDATE_PROJECT":n.projects=e.projects.map(d=>d.id===t.id?{...d,...t.updates}:d);break;case"UPDATE_PROJECT_GEMINI_KEY":n.projects=e.projects.map(d=>d.id===t.projectId?{...d,geminiApiKey:t.apiKey}:d);break;case"UPDATE_PROJECT_LEONARDO_KEY":n.projects=e.projects.map(d=>d.id===t.projectId?{...d,leonardoApiKey:t.apiKey}:d);break;case"UPDATE_PROJECT_GROK_KEY":n.projects=e.projects.map(d=>d.id===t.projectId?{...d,grokApiKey:t.apiKey}:d);break;case"UPDATE_PROJECT_FAL_KEY":n.projects=e.projects.map(d=>d.id===t.projectId?{...d,falApiKey:t.apiKey}:d);break;case"UPDATE_PROJECT_SEAART_KEY":n.projects=e.projects.map(d=>d.id===t.projectId?{...d,seaartApiKey:t.apiKey}:d);break;case"UPDATE_PROJECT_OPENAI_KEY":n.projects=e.projects.map(d=>d.id===t.projectId?{...d,openaiApiKey:t.apiKey}:d);break;case"DELETE_PROJECT":{n.projects=e.projects.filter(d=>d.id!==t.id),e.activeProjectId===t.id&&(n.activeProjectId=((l=n.projects[0])==null?void 0:l.id)||null);break}case"ADD_ISSUE":n.projects=e.projects.map(d=>{if(d.id!==t.projectId)return d;const h=d.issueType==="issue"?"Issue":"Chapter",v=d.issues.length+1,b={id:qs(),title:t.title||`${h} #${v}`,pages:[{id:qs(),number:1,panels:[]}]};return n.activeIssueId=b.id,n.activePageId=b.pages[0].id,{...d,issues:[...d.issues,b]}});break;case"UPDATE_ISSUE":n.projects=e.projects.map(d=>({...d,issues:d.issues.map(h=>h.id===t.issueId?{...h,...t.updates}:h)}));break;case"DELETE_ISSUE":n.projects=e.projects.map(d=>{var v,b,g;const h=d.issues.filter(A=>A.id!==t.issueId);return e.activeIssueId===t.issueId&&(n.activeIssueId=((v=h[0])==null?void 0:v.id)||null,n.activePageId=((g=(b=h[0])==null?void 0:b.pages[0])==null?void 0:g.id)||null),{...d,issues:h}});break;case"SET_ACTIVE_ISSUE":{const d=e.projects.find(v=>v.issues.some(b=>b.id===t.id)),h=d==null?void 0:d.issues.find(v=>v.id===t.id);n.activeIssueId=t.id,n.activePageId=((c=h==null?void 0:h.pages[0])==null?void 0:c.id)||null;break}case"ADD_PAGE":n.projects=e.projects.map(d=>({...d,issues:d.issues.map(h=>{if(h.id!==t.issueId)return h;const v={id:qs(),number:h.pages.length+1,panels:[]};return n.activePageId=v.id,{...h,pages:[...h.pages,v]}})}));break;case"SET_ACTIVE_PAGE":n.activePageId=t.id;break;case"ADD_PANEL":n.projects=e.projects.map(d=>({...d,issues:d.issues.map(h=>({...h,pages:h.pages.map(v=>{if(v.id!==t.pageId)return v;const b=v.panels.length,g=b%3,A=Math.floor(b/3),_=MN(d.projectType),C={id:qs(),prompt:"",aspectRatio:_,characterIds:[],textElements:[],x:40+g*400,y:40+A*480,width:360,height:420};return{...v,panels:[...v.panels,C]}})}))}));break;case"UPDATE_PANEL":n.projects=e.projects.map(d=>({...d,issues:d.issues.map(h=>({...h,pages:h.pages.map(v=>({...v,panels:v.panels.map(b=>{if(b.id!==t.panelId)return b;let g={...t.updates};if("prompt"in g&&g.prompt!==b.prompt){const A=b.prompt;if(A!=null&&A.trim()){const C=[...b.promptHistory||[],A].slice(-5);g={...g,promptHistory:C}}}return{...b,...g}})}))}))}));break;case"DELETE_PANEL":n.projects=e.projects.map(d=>({...d,issues:d.issues.map(h=>({...h,pages:h.pages.map(v=>v.id===t.pageId?{...v,panels:v.panels.filter(b=>b.id!==t.panelId)}:v)}))}));break;case"REORDER_PANELS":n.projects=e.projects.map(d=>({...d,issues:d.issues.map(h=>({...h,pages:h.pages.map(v=>v.id===t.pageId?{...v,panels:t.panels}:v)}))}));break;case"REORDER_PAGES":n.projects=e.projects.map(d=>({...d,issues:d.issues.map(h=>{if(h.id!==t.issueId)return h;const v=[...h.pages],[b]=v.splice(t.oldIndex,1);return v.splice(t.newIndex,0,b),{...h,pages:v.map((g,A)=>({...g,number:A+1}))}})}));break;case"ADD_CHARACTER":n.projects=e.projects.map(d=>(d.id!==e.activeProjectId,d));break;case"UPDATE_CHARACTER":break;case"DELETE_CHARACTER":n.projects=e.projects.map(d=>({...d,issues:d.issues.map(h=>({...h,pages:h.pages.map(v=>({...v,panels:v.panels.map(b=>({...b,characterIds:b.characterIds.filter(g=>g!==t.id)}))}))}))}));break;case"ADD_TEXT_ELEMENT":n.projects=e.projects.map(d=>({...d,issues:d.issues.map(h=>({...h,pages:h.pages.map(v=>({...v,panels:v.panels.map(b=>b.id===t.panelId?{...b,textElements:[...b.textElements,t.element]}:b)}))}))}));break;case"UPDATE_TEXT_ELEMENT":n.projects=e.projects.map(d=>({...d,issues:d.issues.map(h=>({...h,pages:h.pages.map(v=>({...v,panels:v.panels.map(b=>b.id===t.panelId?{...b,textElements:b.textElements.map(g=>g.id===t.elementId?{...g,...t.updates}:g)}:b)}))}))}));break;case"DELETE_TEXT_ELEMENT":n.projects=e.projects.map(d=>({...d,issues:d.issues.map(h=>({...h,pages:h.pages.map(v=>({...v,panels:v.panels.map(b=>b.id===t.panelId?{...b,textElements:b.textElements.filter(g=>g.id!==t.elementId)}:b)}))}))}));break;case"IMPORT_ISSUE":n.projects=e.projects.map(d=>d.id!==t.projectId?d:{...d,issues:[...d.issues,t.issue]}),n.activeIssueId=t.issue.id,n.activePageId=((u=t.issue.pages[0])==null?void 0:u.id)||null;break;case"APPLY_PAGE_TEMPLATE":{const d=DN[t.template];if(!d)break;n.projects=e.projects.map(h=>({...h,issues:h.issues.map(v=>({...v,pages:v.pages.map(b=>{if(b.id!==t.pageId)return b;const g=d.panels.map(A=>({id:qs(),prompt:"",aspectRatio:A.aspectRatio,characterIds:[],textElements:[],x:A.x,y:A.y,width:A.width,height:A.height}));return{...b,panels:g}})}))}));break}}return n}const PN=new Set(["HYDRATE","SET_ACTIVE_PROJECT","SET_ACTIVE_ISSUE","SET_ACTIVE_PAGE","UNDO","REDO"]);function ON(e,t){const{past:n,present:i,future:o}=e;switch(t.type){case"HYDRATE":return{past:[],present:Qy(i,t),future:[]};case"UNDO":{if(n.length===0)return e;const a=n[n.length-1];return{past:n.slice(0,-1),present:a,future:[i,...o]}}case"REDO":{if(o.length===0)return e;const a=o[0];return{past:[...n,i],present:a,future:o.slice(1)}}default:{const a=Qy(i,t);return a===i?e:PN.has(t.type)?{past:n,present:a,future:o}:{past:[...n,i].slice(-50),present:a,future:[]}}}}function UN(){const e=localStorage.getItem("ink_tracker_data");if(e)try{const t=JSON.parse(e);if(t!=null&&t.projects)return zN(t)}catch(t){console.error("Failed to load ink_tracker_data:",t)}return{projects:[{id:qs(),title:"New Story",style:"classic-noir",issueType:"issue",imageProvider:"gemini",projectType:"comic",fluxModel:"fal-ai/flux-pro",issues:[{id:"i1",title:"Issue #1",pages:[{id:"pg1",number:1,panels:[]}]}]}],activeProjectId:null,activeIssueId:null,activePageId:null}}function zN(e){return{...e,projects:e.projects.map(t=>({...t,issueType:t.issueType||"issue",imageProvider:t.imageProvider||"gemini",projectType:t.projectType||"comic",fluxModel:t.fluxModel||"fal-ai/flux-pro",panelFrameStyle:t.panelFrameStyle||"opaque-black",textOverlayStyle:t.textOverlayStyle||"opaque",issues:(t.issues||[]).map(n=>({...n,pages:(n.pages||[]).map(i=>({...i,panels:(i.panels||[]).map(o=>({...o,textElements:o.textElements||[],characterIds:o.characterIds||[]}))}))}))}))}}const jN=(e,t)=>{const n=UN();return{inkHistory:{past:[],present:n,future:[]},inkState:n,inkCanUndo:!1,inkCanRedo:!1,inkDispatch:o=>{e(a=>{const l=ON(a.inkHistory,o);return localStorage.setItem("ink_tracker_data",JSON.stringify(l.present)),{inkHistory:l,inkState:l.present,inkCanUndo:l.past.length>0,inkCanRedo:l.future.length>0}})}}},FN=e=>({detailTarget:null,detailHistory:[],openDetail:t=>e(n=>n.detailTarget&&t&&(n.detailTarget.kind!==t.kind||n.detailTarget.id!==t.id)?{detailTarget:t,detailHistory:[...n.detailHistory,n.detailTarget].slice(-20)}:{detailTarget:t,detailHistory:n.detailHistory}),closeDetail:()=>e({detailTarget:null,detailHistory:[]}),goBackDetail:()=>e(t=>t.detailHistory.length===0?{detailTarget:null}:{detailTarget:t.detailHistory[t.detailHistory.length-1],detailHistory:t.detailHistory.slice(0,-1)})}),xi=CN()(kN((...e)=>({...IN(...e),...RN(...e),...LN(...e),...jN(...e),...FN(...e)}),{name:"lit-tracker-v1",storage:Jx(()=>localStorage),partialize:e=>({characters:e.characters,relationships:e.relationships,loreEntries:e.loreEntries,projectName:e.projectName,activeModule:e.activeModule})}));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kx=(...e)=>e.filter((t,n,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BN=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qN=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,i)=>i?i.toUpperCase():n.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e2=e=>{const t=qN(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var HN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GN=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VN=de.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:o="",children:a,iconNode:l,...c},u)=>de.createElement("svg",{ref:u,...HN,width:t,height:t,stroke:e,strokeWidth:i?Number(n)*24/Number(t):n,className:Kx("lucide",o),...!a&&!GN(c)&&{"aria-hidden":"true"},...c},[...l.map(([d,h])=>de.createElement(d,h)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=(e,t)=>{const n=de.forwardRef(({className:i,...o},a)=>de.createElement(VN,{ref:a,iconNode:t,className:Kx(`lucide-${BN(e2(e))}`,`lucide-${e}`,i),...o}));return n.displayName=e2(e),n};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $N=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],YN=Nt("arrow-left",$N);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WN=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Ku=Nt("book-open",WN);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XN=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],JN=Nt("brain-circuit",XN);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],Zx=Nt("brain",KN);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZN=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Qx=Nt("calendar",ZN);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QN=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Gm=Nt("check",QN);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eA=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Wd=Nt("chevron-down",eA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tA=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ew=Nt("chevron-left",tA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nA=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],mf=Nt("chevron-right",nA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iA=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],tw=Nt("chevron-up",iA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rA=[["path",{d:"M11 14h10",key:"1w8e9d"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v1.344",key:"1e62lh"}],["path",{d:"m17 18 4-4-4-4",key:"z2g111"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 1.793-1.113",key:"bjbb7m"}],["rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",key:"ublpy"}]],oA=Nt("clipboard-paste",rA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aA=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],sA=Nt("clock",aA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lA=[["path",{d:"M10.94 5.274A7 7 0 0 1 15.71 10h1.79a4.5 4.5 0 0 1 4.222 6.057",key:"1uxyv8"}],["path",{d:"M18.796 18.81A4.5 4.5 0 0 1 17.5 19H9A7 7 0 0 1 5.79 5.78",key:"99tcn7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],am=Nt("cloud-off",lA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cA=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],Vm=Nt("cloud",cA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uA=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]],t2=Nt("columns-2",uA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dA=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Og=Nt("copy",dA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fA=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]],Pl=Nt("file-image",fA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hA=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ug=Nt("file-text",hA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pA=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],mA=Nt("flame",pA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gA=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],nw=Nt("gem",gA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vA=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 12h18",key:"1i2n21"}],["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",key:"h1oib"}]],yA=Nt("grid-2x2",vA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bA=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],xA=Nt("grid-3x3",bA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wA=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],_A=Nt("grip-vertical",wA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SA=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],EA=Nt("hash",SA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NA=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],$m=Nt("history",NA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AA=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],iw=Nt("image",AA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CA=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],rw=Nt("layers",CA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TA=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],sm=Nt("layout-grid",TA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kA=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],jl=Nt("link-2",kA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IA=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],RA=Nt("loader-circle",IA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LA=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],MA=Nt("lock-open",LA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DA=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],zg=Nt("lock",DA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PA=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],OA=Nt("map-pin",PA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UA=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],ow=Nt("map",UA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zA=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],aw=Nt("message-circle",zA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jA=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],FA=Nt("message-square",jA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BA=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],qA=Nt("mic",BA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HA=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],GA=Nt("move",HA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VA=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],$A=Nt("network",VA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YA=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],WA=Nt("panels-top-left",YA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XA=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],JA=Nt("pause",XA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KA=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],sw=Nt("pen-line",KA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZA=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],jg=Nt("pen-tool",ZA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QA=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],lw=Nt("pen",QA);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],cw=Nt("play",e3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],$u=Nt("plus",t3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]],i3=Nt("rectangle-horizontal",n3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],o3=Nt("redo-2",r3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],n2=Nt("refresh-ccw",a3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],uw=Nt("refresh-cw",s3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Fg=Nt("save",l3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],dw=Nt("search",c3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],d3=Nt("settings-2",u3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],fw=Nt("shield",f3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],p3=Nt("smartphone",h3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],bp=Nt("sparkles",m3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],v3=Nt("square",g3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Bg=Nt("tag",y3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Tc=Nt("trash-2",b3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],w3=Nt("type",x3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],S3=Nt("undo-2",_3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]],N3=Nt("unlink",E3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],i2=Nt("upload",A3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],T3=Nt("user-plus",C3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Yu=Nt("user",k3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ys=Nt("users",I3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Vs=Nt("x",R3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],M3=Nt("zap",L3),D3=[{id:"ink",label:"Storyboard",shortLabel:"INK",description:"Visual layout",icon:p.jsx(jg,{size:18}),accent:"ember"},{id:"characters",label:"Characters",shortLabel:"CHAR",description:"Cast & voices",icon:p.jsx(Ys,{size:18}),accent:"char"},{id:"lore",label:"Lore Tracker",shortLabel:"LORE",description:"Rules & canon",icon:p.jsx(Ku,{size:18}),accent:"lore"}],P3={ember:{active:"text-ember-400",activeBg:"bg-ember-900/40",indicator:"bg-ember-500",iconBg:"bg-ember-500/15 text-ember-400",hoverBg:"hover:bg-ink-800/80"},char:{active:"text-char-400",activeBg:"bg-char-900/40",indicator:"bg-char-500",iconBg:"bg-char-500/15 text-char-400",hoverBg:"hover:bg-ink-800/80"},lore:{active:"text-lore-400",activeBg:"bg-lore-900/40",indicator:"bg-lore-500",iconBg:"bg-lore-500/15 text-lore-400",hoverBg:"hover:bg-ink-800/80"}},O3=()=>{const{activeModule:e,setActiveModule:t,syncStatus:n,projectName:i,characters:o,loreEntries:a,inkState:l}=xi(),c=de.useMemo(()=>{const d=l.projects.reduce((b,g)=>b+g.issues.reduce((A,_)=>A+_.pages.reduce((C,E)=>C+E.panels.length,0),0),0),h=l.projects.reduce((b,g)=>b+g.issues.reduce((A,_)=>A+_.pages.length,0),0),v=l.projects.reduce((b,g)=>b+g.issues.length,0);return{totalPanels:d,totalPages:h,totalIssues:v}},[l.projects]),u={ink:c.totalPanels>0?`${c.totalPanels} panels`:"",characters:o.length>0?`${o.length} cast`:"",lore:a.length>0?`${a.length} entries`:""};return p.jsxs("aside",{className:"w-16 lg:w-60 bg-ink-900 border-r border-ink-750 h-screen flex flex-col flex-shrink-0 transition-all duration-300 z-50",children:[p.jsxs("div",{className:"h-16 flex items-center gap-3 px-3 lg:px-4 border-b border-ink-750 flex-shrink-0",children:[p.jsxs("div",{className:"w-9 h-9 rounded-xl bg-gradient-to-br from-ember-500 to-ember-600 flex items-center justify-center shadow-lg shadow-ember-500/20 flex-shrink-0 relative",children:[p.jsx(mA,{size:16,className:"text-white"}),p.jsx("div",{className:"absolute inset-0 rounded-xl bg-ember-500/20 animate-pulse-glow"})]}),p.jsxs("div",{className:"hidden lg:block min-w-0",children:[p.jsx("h1",{className:"text-sm font-display font-bold text-steel-100 tracking-tight leading-tight truncate",children:"LIT Tracker"}),p.jsx("p",{className:"text-[9px] font-mono text-steel-600 uppercase tracking-[0.15em] truncate mt-0.5",children:i})]})]}),p.jsxs("nav",{className:"flex-1 py-3 overflow-y-auto custom-scrollbar",children:[p.jsx("div",{className:"hidden lg:block px-4 mb-2",children:p.jsx("p",{className:"text-[8px] font-mono text-steel-700 uppercase tracking-[0.25em]",children:"Modules"})}),p.jsx("div",{className:"space-y-0.5 px-2",children:D3.map(d=>{const h=e===d.id,v=P3[d.accent],b=u[d.id];return p.jsxs("button",{onClick:()=>t(d.id),className:`
                  w-full flex items-center gap-3 px-2 lg:px-3 py-2.5 transition-all duration-200 group relative rounded-lg
                  ${h?`${v.activeBg} ${v.active}`:`text-steel-500 ${v.hoverBg} hover:text-steel-300`}
                `,children:[h&&p.jsx("div",{className:`absolute left-0 top-2 bottom-2 w-[3px] rounded-full ${v.indicator}`}),p.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 transition-all duration-200 ${h?v.iconBg:"bg-ink-800/50 text-steel-500 group-hover:bg-ink-750 group-hover:text-steel-300"}`,children:d.icon}),p.jsxs("div",{className:"hidden lg:flex flex-col items-start min-w-0 flex-1",children:[p.jsx("span",{className:"text-[13px] font-semibold truncate leading-tight",children:d.label}),p.jsx("span",{className:`text-[9px] font-mono tracking-wider mt-0.5 ${h?"opacity-60":"text-steel-600"}`,children:b||d.description})]}),h&&p.jsx(mf,{size:14,className:"ml-auto hidden lg:block opacity-40"})]},d.id)})}),p.jsx("div",{className:"sidebar-divider my-4"}),p.jsxs("div",{className:"hidden lg:block px-4 pb-2",children:[p.jsx("p",{className:"text-[8px] font-mono text-steel-700 uppercase tracking-[0.25em] mb-3",children:"Project"}),p.jsx("div",{className:"space-y-2",children:[{icon:p.jsx(rw,{size:12}),label:"Issues",value:c.totalIssues,color:"text-ember-400"},{icon:p.jsx(Ug,{size:12}),label:"Pages",value:c.totalPages,color:"text-ember-400"},{icon:p.jsx(Ys,{size:12}),label:"Cast",value:o.length,color:"text-char-400"},{icon:p.jsx(Ku,{size:12}),label:"Lore",value:a.length,color:"text-lore-400"}].map((d,h)=>p.jsxs("div",{className:"flex items-center gap-2.5",children:[p.jsx("span",{className:"text-steel-600",children:d.icon}),p.jsx("span",{className:"text-[10px] text-steel-500 flex-1",children:d.label}),p.jsx("span",{className:`text-[11px] font-mono font-bold ${d.value>0?d.color:"text-steel-700"}`,children:d.value})]},h))})]})]}),p.jsxs("div",{className:"p-3 lg:px-4 lg:py-3 border-t border-ink-750",children:[p.jsxs("div",{className:"hidden lg:flex items-center gap-2.5",children:[n==="saving"?p.jsx(n2,{size:12,className:"text-ember-400 animate-spin flex-shrink-0"}):n==="synced"?p.jsx(Vm,{size:12,className:"text-emerald-500 flex-shrink-0"}):n==="error"?p.jsx(am,{size:12,className:"text-red-400 flex-shrink-0"}):p.jsx(am,{size:12,className:"text-steel-600 flex-shrink-0"}),p.jsx("span",{className:`text-[9px] font-mono uppercase tracking-wider ${n==="saving"?"text-ember-400":n==="synced"?"text-emerald-500":n==="error"?"text-red-400":"text-steel-600"}`,children:n==="saving"?"Saving...":n==="synced"?"Cloud synced":n==="error"?"Sync error":"Local only"})]}),p.jsx("div",{className:"lg:hidden flex justify-center",children:n==="saving"?p.jsx(n2,{size:14,className:"text-ember-400 animate-spin"}):n==="synced"?p.jsx(Vm,{size:14,className:"text-emerald-500"}):p.jsx(am,{size:14,className:"text-steel-600"})})]})]})},Ia={[xn.FACTION]:{label:"Faction",icon:kn.createElement(Ys,{className:"w-3.5 h-3.5"}),color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200",accentHex:"#3b82f6"},[xn.LOCATION]:{label:"Location",icon:kn.createElement(OA,{className:"w-3.5 h-3.5"}),color:"text-emerald-600",bgColor:"bg-emerald-50",borderColor:"border-emerald-200",accentHex:"#10b981"},[xn.EVENT]:{label:"Event",icon:kn.createElement(M3,{className:"w-3.5 h-3.5"}),color:"text-amber-600",bgColor:"bg-amber-50",borderColor:"border-amber-200",accentHex:"#f59e0b"},[xn.CONCEPT]:{label:"Concept",icon:kn.createElement(Zx,{className:"w-3.5 h-3.5"}),color:"text-purple-600",bgColor:"bg-purple-50",borderColor:"border-purple-200",accentHex:"#8b5cf6"},[xn.ARTIFACT]:{label:"Artifact",icon:kn.createElement(nw,{className:"w-3.5 h-3.5"}),color:"text-rose-600",bgColor:"bg-rose-50",borderColor:"border-rose-200",accentHex:"#f43f5e"},[xn.RULE]:{label:"Canon Rule",icon:kn.createElement(Ku,{className:"w-3.5 h-3.5"}),color:"text-cyan-600",bgColor:"bg-cyan-50",borderColor:"border-cyan-200",accentHex:"#06b6d4"}},ls=()=>crypto.randomUUID(),np=e=>{const t=Math.floor((Date.now()-e)/1e3);if(t<60)return"just now";const n=Math.floor(t/60);if(n<60)return`${n}m ago`;const i=Math.floor(n/60);return i<24?`${i}h ago`:`${Math.floor(i/24)}d ago`},r2=(e,t)=>{const n=e.eras.find(l=>{var c;return l.id===(t||((c=e.eras[0])==null?void 0:c.id))});if(!n)return`${e.name}, ${e.archetype}`;const i=n.name?`[${n.name}]`:"",o=n.age_appearance?`${n.age_appearance}, `:"",a=n.visual_tags.length>0?n.visual_tags.join(", "):"";return`${e.name} ${i}, ${e.archetype}, ${o}${a}`.trim()},Ym=(e="Origin")=>({id:ls(),name:e,visual_tags:[],age_appearance:""});function U3(e,t){const n=[];for(const i of t)for(const o of i.issues)for(const a of o.pages)for(const l of a.panels)l.characterIds.includes(e)&&n.push({panel:l,page:a,issue:o,project:i});return n}const Ml=({title:e,icon:t,count:n,accentColor:i="text-steel-500",children:o})=>p.jsxs("div",{className:"py-4 border-t border-ink-800/60",children:[p.jsxs("div",{className:"flex items-center gap-2 mb-3 px-5",children:[p.jsx("span",{className:i,children:t}),p.jsx("span",{className:"text-[10px] font-mono font-bold text-steel-500 uppercase tracking-[0.15em]",children:e}),n!==void 0&&n>0&&p.jsx("span",{className:"text-[9px] font-mono text-steel-600 bg-ink-800 px-1.5 py-0.5 rounded",children:n})]}),p.jsx("div",{className:"px-5",children:o})]}),ip=({label:e,sublabel:t,icon:n,accentBg:i,accentText:o,onClick:a})=>p.jsxs("button",{onClick:a,className:"group flex items-center gap-2.5 w-full text-left px-3 py-2 rounded-lg border border-ink-800/60 bg-ink-900/40 hover:bg-ink-800 hover:border-ink-700 transition-all",children:[p.jsx("div",{className:`w-7 h-7 rounded-md flex items-center justify-center flex-shrink-0 ${i} ${o}`,children:n}),p.jsxs("div",{className:"min-w-0 flex-1",children:[p.jsx("p",{className:"text-[12px] font-semibold text-steel-200 truncate group-hover:text-steel-100 transition-colors",children:e}),t&&p.jsx("p",{className:"text-[9px] font-mono text-steel-600 truncate",children:t})]}),p.jsx(mf,{size:12,className:"text-steel-700 group-hover:text-steel-500 transition-colors flex-shrink-0"})]}),z3=({appearance:e})=>{const{panel:t,page:n,issue:i}=e;return p.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg bg-ink-900/40 border border-ink-800/60",children:[p.jsx("div",{className:"w-12 h-12 rounded bg-ink-800 flex items-center justify-center flex-shrink-0 overflow-hidden",children:t.imageUrl?p.jsx("img",{src:t.imageUrl.startsWith("idb://")?void 0:t.imageUrl,alt:"",className:"w-full h-full object-cover"}):p.jsx(iw,{size:14,className:"text-steel-700"})}),p.jsxs("div",{className:"min-w-0 flex-1",children:[p.jsx("p",{className:"text-[11px] text-steel-300 truncate",children:t.prompt?t.prompt.slice(0,60)+(t.prompt.length>60?"...":""):"No prompt"}),p.jsxs("p",{className:"text-[9px] font-mono text-steel-600 mt-0.5",children:[i.title,"  Page ",n.number,"  Panel ",n.panels.indexOf(t)+1]})]})]})},j3=({character:e})=>{var g,A;const{loreEntries:t,relationships:n,characters:i,inkState:o,openDetail:a,setActiveCharacter:l,setCharacterEditorOpen:c}=xi(),u=de.useMemo(()=>t.filter(_=>e.loreEntryIds.includes(_.id)),[t,e.loreEntryIds]),d=de.useMemo(()=>n.filter(_=>_.fromId===e.id||_.toId===e.id),[n,e.id]),h=de.useMemo(()=>U3(e.id,o.projects),[e.id,o.projects]),v=()=>{l(e.id),c(!0)},b={Protagonist:"bg-blue-500/15 text-blue-400",Antagonist:"bg-red-500/15 text-red-400",Supporting:"bg-emerald-500/15 text-emerald-400",Minor:"bg-steel-700/30 text-steel-400"};return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"px-5 py-4",children:p.jsxs("div",{className:"flex items-start gap-4",children:[p.jsx("div",{className:"w-16 h-16 rounded-xl bg-ink-800 border border-ink-700 flex items-center justify-center overflow-hidden flex-shrink-0",children:(g=e.gallery)!=null&&g[0]?p.jsx("img",{src:e.gallery[0],alt:e.name,className:"w-full h-full object-cover"}):p.jsx(Yu,{size:24,className:"text-steel-600"})}),p.jsxs("div",{className:"min-w-0 flex-1",children:[p.jsx("h3",{className:"text-xl font-display font-bold text-steel-100 leading-tight",children:e.name}),p.jsx("p",{className:"text-[11px] text-steel-400 mt-0.5",children:e.archetype||"No archetype"}),p.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[p.jsx("span",{className:`text-[9px] uppercase font-bold px-2 py-0.5 rounded ${b[e.role]||b.Minor}`,children:e.role}),((A=e.smart_tags)==null?void 0:A.Faction)&&p.jsx("span",{className:"text-[9px] font-mono text-steel-500 bg-ink-800 px-1.5 py-0.5 rounded",children:e.smart_tags.Faction})]})]}),p.jsx("button",{onClick:v,className:"p-2 text-steel-500 hover:text-char-400 hover:bg-char-900/30 rounded-lg transition-all flex-shrink-0",title:"Edit dossier",children:p.jsx(sw,{size:16})})]})}),e.eras.length>0&&p.jsx(Ml,{title:"Eras",icon:p.jsx(sA,{size:13}),count:e.eras.length,accentColor:"text-ember-400",children:p.jsx("div",{className:"space-y-1.5",children:e.eras.map(_=>p.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg bg-ink-900/40 border border-ink-800/60",children:[p.jsx("div",{className:"w-1.5 h-8 rounded-full bg-ember-500/40 flex-shrink-0"}),p.jsxs("div",{className:"min-w-0 flex-1",children:[p.jsx("p",{className:"text-[12px] font-semibold text-steel-200",children:_.name}),p.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[_.age_appearance&&p.jsx("span",{className:"text-[9px] font-mono text-steel-500",children:_.age_appearance}),_.visual_tags.length>0&&p.jsx("span",{className:"text-[9px] text-steel-600 truncate",children:_.visual_tags.join(", ")})]})]})]},_.id))})}),p.jsx(Ml,{title:"Storyboard",icon:p.jsx(jg,{size:13}),count:h.length,accentColor:"text-ember-400",children:h.length===0?p.jsx("p",{className:"text-[11px] text-steel-600 italic",children:"Not yet placed in any panels"}):p.jsxs("div",{className:"space-y-1.5 max-h-48 overflow-y-auto custom-scrollbar",children:[h.slice(0,20).map((_,C)=>p.jsx(z3,{appearance:_},`${_.panel.id}-${C}`)),h.length>20&&p.jsxs("p",{className:"text-[9px] text-steel-600 font-mono text-center py-1",children:["+",h.length-20," more appearances"]})]})}),p.jsx(Ml,{title:"Lore Connections",icon:p.jsx(Ku,{size:13}),count:u.length,accentColor:"text-lore-400",children:u.length===0?p.jsx("p",{className:"text-[11px] text-steel-600 italic",children:"No lore entries linked"}):p.jsx("div",{className:"space-y-1.5",children:u.map(_=>{const C=Ia[_.type];return p.jsx(ip,{label:_.name,sublabel:C.label,icon:C.icon,accentBg:C.bgColor,accentText:C.color,onClick:()=>a({kind:"lore",id:_.id})},_.id)})})}),d.length>0&&p.jsx(Ml,{title:"Relationships",icon:p.jsx(jl,{size:13}),count:d.length,accentColor:"text-char-400",children:p.jsx("div",{className:"space-y-1.5",children:d.map(_=>{const C=_.fromId===e.id?_.toId:_.fromId,E=i.find(R=>R.id===C);return E?p.jsx(ip,{label:E.name,sublabel:_.label,icon:p.jsx(Yu,{size:13}),accentBg:"bg-char-500/15",accentText:"text-char-400",onClick:()=>a({kind:"character",id:C})},_.id):null})})}),Object.keys(e.smart_tags||{}).length>0&&p.jsx(Ml,{title:"Tags",icon:p.jsx(Bg,{size:13}),accentColor:"text-steel-500",children:p.jsx("div",{className:"flex flex-wrap gap-1.5",children:Object.entries(e.smart_tags).map(([_,C])=>C?p.jsxs("span",{className:"text-[10px] bg-ink-800 border border-ink-700 text-steel-300 px-2 py-1 rounded-md",children:[p.jsxs("span",{className:"text-steel-500",children:[_,":"]})," ",C]},_):null)})}),p.jsx("div",{className:"px-5 py-3 border-t border-ink-800/60",children:p.jsxs("p",{className:"text-[9px] font-mono text-steel-700",children:["Created ",np(e.createdAt),"  Updated ",np(e.updatedAt)]})})]})},F3=({entry:e})=>{const{characters:t,loreEntries:n,openDetail:i}=xi(),o=Ia[e.type],a=de.useMemo(()=>t.filter(h=>e.characterIds.includes(h.id)),[t,e.characterIds]),l=de.useMemo(()=>n.filter(h=>e.relatedEntryIds.includes(h.id)),[n,e.relatedEntryIds]),c=de.useMemo(()=>t.filter(h=>h.loreEntryIds.includes(e.id)&&!e.characterIds.includes(h.id)),[t,e.id,e.characterIds]),u=de.useMemo(()=>{const h=[...a,...c],v=new Set;return h.filter(b=>v.has(b.id)?!1:(v.add(b.id),!0))},[a,c]),d=()=>{const h="flex items-center gap-2 text-[11px]",v="text-steel-500 flex-shrink-0",b="text-steel-300";switch(e.type){case xn.FACTION:{const g=e;return p.jsxs("div",{className:"space-y-2",children:[g.leader&&p.jsxs("div",{className:h,children:[p.jsx(fw,{size:12,className:"text-blue-400"}),p.jsx("span",{className:v,children:"Leader"}),p.jsx("span",{className:b,children:g.leader})]}),g.ideology&&p.jsxs("div",{className:h,children:[p.jsx("span",{className:v,children:"Ideology"}),p.jsx("span",{className:b,children:g.ideology})]}),g.influence&&p.jsxs("div",{className:h,children:[p.jsx("span",{className:v,children:"Influence"}),p.jsx("div",{className:"flex-1 h-1.5 bg-ink-800 rounded-full overflow-hidden",children:p.jsx("div",{className:"h-full bg-blue-400/60 rounded-full",style:{width:`${g.influence/10*100}%`}})}),p.jsxs("span",{className:"text-[9px] font-mono text-steel-600",children:[g.influence,"/10"]})]})]})}case xn.LOCATION:{const g=e;return p.jsxs("div",{className:"space-y-2",children:[g.region&&p.jsxs("div",{className:h,children:[p.jsx(ow,{size:12,className:"text-emerald-400"}),p.jsx("span",{className:v,children:"Region"}),p.jsx("span",{className:b,children:g.region})]}),g.climate&&p.jsxs("div",{className:h,children:[p.jsx("span",{className:v,children:"Climate"}),p.jsx("span",{className:b,children:g.climate})]}),g.importance&&p.jsxs("div",{className:h,children:[p.jsx("span",{className:v,children:"Importance"}),p.jsx("span",{className:b,children:g.importance})]})]})}case xn.EVENT:{const g=e;return p.jsxs("div",{className:"space-y-2",children:[g.date&&p.jsxs("div",{className:h,children:[p.jsx(Qx,{size:12,className:"text-amber-400"}),p.jsx("span",{className:v,children:"Date"}),p.jsx("span",{className:b,children:g.date})]}),g.participants&&p.jsxs("div",{className:h,children:[p.jsx("span",{className:v,children:"Participants"}),p.jsx("span",{className:b,children:g.participants})]}),g.consequences&&p.jsxs("div",{className:h,children:[p.jsx("span",{className:v,children:"Consequences"}),p.jsx("span",{className:b,children:g.consequences})]})]})}case xn.CONCEPT:{const g=e;return p.jsxs("div",{className:"space-y-2",children:[g.origin&&p.jsxs("div",{className:h,children:[p.jsx(Zx,{size:12,className:"text-purple-400"}),p.jsx("span",{className:v,children:"Origin"}),p.jsx("span",{className:b,children:g.origin})]}),g.rules&&p.jsxs("div",{className:h,children:[p.jsx("span",{className:v,children:"Rules"}),p.jsx("span",{className:b,children:g.rules})]})]})}case xn.ARTIFACT:{const g=e;return p.jsxs("div",{className:"space-y-2",children:[g.currentHolder&&p.jsxs("div",{className:h,children:[p.jsx(nw,{size:12,className:"text-rose-400"}),p.jsx("span",{className:v,children:"Holder"}),p.jsx("span",{className:b,children:g.currentHolder})]}),g.origin&&p.jsxs("div",{className:h,children:[p.jsx("span",{className:v,children:"Origin"}),p.jsx("span",{className:b,children:g.origin})]}),g.properties&&p.jsxs("div",{className:h,children:[p.jsx("span",{className:v,children:"Properties"}),p.jsx("span",{className:b,children:g.properties})]})]})}case xn.RULE:{const g=e;return p.jsxs("div",{className:"space-y-2",children:[p.jsxs("div",{className:h,children:[p.jsx(zg,{size:12,className:g.canonLocked?"text-amber-400":"text-steel-600"}),p.jsx("span",{className:g.canonLocked?"text-amber-400 font-bold text-[10px] uppercase":"text-steel-500 text-[10px]",children:g.canonLocked?"Canon Locked":"Unlocked"})]}),g.scope&&p.jsxs("div",{className:h,children:[p.jsx("span",{className:v,children:"Scope"}),p.jsx("span",{className:b,children:g.scope})]}),g.exceptions&&p.jsxs("div",{className:h,children:[p.jsx("span",{className:v,children:"Exceptions"}),p.jsx("span",{className:b,children:g.exceptions})]})]})}default:return null}};return p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"px-5 py-4",children:[p.jsxs("div",{className:"flex items-start gap-3",children:[p.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 ${o.bgColor} ${o.color}`,children:o.icon}),p.jsxs("div",{className:"min-w-0 flex-1",children:[p.jsx("div",{className:`text-[9px] font-bold uppercase tracking-wider mb-1 ${o.color}`,children:o.label}),p.jsx("h3",{className:"text-xl font-display font-bold text-steel-100 leading-tight",children:e.name})]})]}),e.description&&p.jsx("p",{className:"text-[12px] text-steel-300 leading-relaxed mt-3",children:e.description}),e.tags.length>0&&p.jsx("div",{className:"flex flex-wrap gap-1.5 mt-3",children:e.tags.map(h=>p.jsxs("span",{className:"text-[9px] bg-ink-800 border border-ink-700 text-steel-500 px-1.5 py-0.5 rounded uppercase tracking-tighter",children:["#",h]},h))})]}),p.jsx(Ml,{title:"Details",icon:p.jsx(rw,{size:13}),accentColor:o.color,children:d()}),p.jsx(Ml,{title:"Characters",icon:p.jsx(Ys,{size:13}),count:u.length,accentColor:"text-char-400",children:u.length===0?p.jsx("p",{className:"text-[11px] text-steel-600 italic",children:"No characters linked"}):p.jsx("div",{className:"space-y-1.5",children:u.map(h=>p.jsx(ip,{label:h.name,sublabel:`${h.role}  ${h.archetype||"No archetype"}`,icon:p.jsx(Yu,{size:13}),accentBg:"bg-char-500/15",accentText:"text-char-400",onClick:()=>i({kind:"character",id:h.id})},h.id))})}),l.length>0&&p.jsx(Ml,{title:"Related Lore",icon:p.jsx(jl,{size:13}),count:l.length,accentColor:"text-lore-400",children:p.jsx("div",{className:"space-y-1.5",children:l.map(h=>{const v=Ia[h.type];return p.jsx(ip,{label:h.name,sublabel:v.label,icon:v.icon,accentBg:v.bgColor,accentText:v.color,onClick:()=>i({kind:"lore",id:h.id})},h.id)})})}),p.jsx("div",{className:"px-5 py-3 border-t border-ink-800/60",children:p.jsxs("p",{className:"text-[9px] font-mono text-steel-700",children:["Created ",np(e.createdAt),"  Updated ",np(e.updatedAt)]})})]})},B3=()=>{const{detailTarget:e,detailHistory:t,closeDetail:n,goBackDetail:i,characters:o,loreEntries:a}=xi();if(!e)return null;const l=e.kind==="character"?o.find(d=>d.id===e.id):a.find(d=>d.id===e.id);if(!l)return null;const c=t.length>0,u=e.kind==="character"?"char":"lore";return p.jsxs("div",{className:"fixed inset-0 z-[90] flex justify-end pointer-events-none",children:[p.jsx("div",{className:"absolute inset-0 bg-black/15 backdrop-blur-[2px] pointer-events-auto",onClick:n}),p.jsxs("div",{className:"relative w-full max-w-md bg-ink-950 border-l border-ink-700 h-full flex flex-col pointer-events-auto animate-slide-in shadow-2xl",children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-ink-700 bg-ink-900 flex-shrink-0",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[c&&p.jsx("button",{onClick:i,className:"p-1.5 text-steel-500 hover:text-steel-200 hover:bg-ink-800 rounded-lg transition-all",title:"Go back",children:p.jsx(YN,{size:16})}),p.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${u==="char"?"bg-char-500":"bg-lore-500"}`}),p.jsx("span",{className:"text-[10px] font-mono text-steel-500 uppercase tracking-widest",children:e.kind==="character"?"Character":"Lore Entry"})]}),p.jsx("button",{onClick:n,className:"p-1.5 text-steel-500 hover:text-steel-200 hover:bg-ink-800 rounded-lg transition-all",children:p.jsx(Vs,{size:16})})]}),p.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:e.kind==="character"?p.jsx(j3,{character:l}):p.jsx(F3,{entry:l})})]})]})};var Xd=Xx();function q3(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return de.useMemo(()=>i=>{t.forEach(o=>o(i))},t)}const xp=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Zu(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function qg(e){return"nodeType"in e}function so(e){var t,n;return e?Zu(e)?e:qg(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Hg(e){const{Document:t}=so(e);return e instanceof t}function gf(e){return Zu(e)?!1:e instanceof so(e).HTMLElement}function hw(e){return e instanceof so(e).SVGElement}function Qu(e){return e?Zu(e)?e.document:qg(e)?Hg(e)?e:gf(e)||hw(e)?e.ownerDocument:document:document:document}const us=xp?de.useLayoutEffect:de.useEffect;function Gg(e){const t=de.useRef(e);return us(()=>{t.current=e}),de.useCallback(function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return t.current==null?void 0:t.current(...i)},[])}function H3(){const e=de.useRef(null),t=de.useCallback((i,o)=>{e.current=setInterval(i,o)},[]),n=de.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function of(e,t){t===void 0&&(t=[e]);const n=de.useRef(e);return us(()=>{n.current!==e&&(n.current=e)},t),n}function vf(e,t){const n=de.useRef();return de.useMemo(()=>{const i=e(n.current);return n.current=i,i},[...t])}function rp(e){const t=Gg(e),n=de.useRef(null),i=de.useCallback(o=>{o!==n.current&&(t==null||t(o,n.current)),n.current=o},[]);return[n,i]}function Wm(e){const t=de.useRef();return de.useEffect(()=>{t.current=e},[e]),t.current}let lm={};function yf(e,t){return de.useMemo(()=>{if(t)return t;const n=lm[e]==null?0:lm[e]+1;return lm[e]=n,e+"-"+n},[e,t])}function pw(e){return function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return i.reduce((a,l)=>{const c=Object.entries(l);for(const[u,d]of c){const h=a[u];h!=null&&(a[u]=h+e*d)}return a},{...t})}}const ju=pw(1),af=pw(-1);function G3(e){return"clientX"in e&&"clientY"in e}function Vg(e){if(!e)return!1;const{KeyboardEvent:t}=so(e.target);return t&&e instanceof t}function V3(e){if(!e)return!1;const{TouchEvent:t}=so(e.target);return t&&e instanceof t}function Xm(e){if(V3(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return G3(e)?{x:e.clientX,y:e.clientY}:null}const sf=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[sf.Translate.toString(e),sf.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:i}=e;return t+" "+n+"ms "+i}}}),o2="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function $3(e){return e.matches(o2)?e:e.querySelector(o2)}const Y3={display:"none"};function W3(e){let{id:t,value:n}=e;return kn.createElement("div",{id:t,style:Y3},n)}function X3(e){let{id:t,announcement:n,ariaLiveType:i="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return kn.createElement("div",{id:t,style:o,role:"status","aria-live":i,"aria-atomic":!0},n)}function J3(){const[e,t]=de.useState("");return{announce:de.useCallback(i=>{i!=null&&t(i)},[]),announcement:e}}const mw=de.createContext(null);function K3(e){const t=de.useContext(mw);de.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Z3(){const[e]=de.useState(()=>new Set),t=de.useCallback(i=>(e.add(i),()=>e.delete(i)),[e]);return[de.useCallback(i=>{let{type:o,event:a}=i;e.forEach(l=>{var c;return(c=l[o])==null?void 0:c.call(l,a)})},[e]),t]}const Q3={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},e4={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function t4(e){let{announcements:t=e4,container:n,hiddenTextDescribedById:i,screenReaderInstructions:o=Q3}=e;const{announce:a,announcement:l}=J3(),c=yf("DndLiveRegion"),[u,d]=de.useState(!1);if(de.useEffect(()=>{d(!0)},[]),K3(de.useMemo(()=>({onDragStart(v){let{active:b}=v;a(t.onDragStart({active:b}))},onDragMove(v){let{active:b,over:g}=v;t.onDragMove&&a(t.onDragMove({active:b,over:g}))},onDragOver(v){let{active:b,over:g}=v;a(t.onDragOver({active:b,over:g}))},onDragEnd(v){let{active:b,over:g}=v;a(t.onDragEnd({active:b,over:g}))},onDragCancel(v){let{active:b,over:g}=v;a(t.onDragCancel({active:b,over:g}))}}),[a,t])),!u)return null;const h=kn.createElement(kn.Fragment,null,kn.createElement(W3,{id:i,value:o.draggable}),kn.createElement(X3,{id:c,announcement:l}));return n?Xd.createPortal(h,n):h}var Zi;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Zi||(Zi={}));function op(){}function Jm(e,t){return de.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function gw(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return de.useMemo(()=>[...t].filter(i=>i!=null),[...t])}const Da=Object.freeze({x:0,y:0});function vw(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function yw(e,t){let{data:{value:n}}=e,{data:{value:i}}=t;return n-i}function n4(e,t){let{data:{value:n}}=e,{data:{value:i}}=t;return i-n}function a2(e){let{left:t,top:n,height:i,width:o}=e;return[{x:t,y:n},{x:t+o,y:n},{x:t,y:n+i},{x:t+o,y:n+i}]}function bw(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function s2(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const i4=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:i}=e;const o=s2(t,t.left,t.top),a=[];for(const l of i){const{id:c}=l,u=n.get(c);if(u){const d=vw(s2(u),o);a.push({id:c,data:{droppableContainer:l,value:d}})}}return a.sort(yw)},r4=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:i}=e;const o=a2(t),a=[];for(const l of i){const{id:c}=l,u=n.get(c);if(u){const d=a2(u),h=o.reduce((b,g,A)=>b+vw(d[A],g),0),v=Number((h/4).toFixed(4));a.push({id:c,data:{droppableContainer:l,value:v}})}}return a.sort(yw)};function o4(e,t){const n=Math.max(t.top,e.top),i=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),a=Math.min(t.top+t.height,e.top+e.height),l=o-i,c=a-n;if(i<o&&n<a){const u=t.width*t.height,d=e.width*e.height,h=l*c,v=h/(u+d-h);return Number(v.toFixed(4))}return 0}const a4=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:i}=e;const o=[];for(const a of i){const{id:l}=a,c=n.get(l);if(c){const u=o4(c,t);u>0&&o.push({id:l,data:{droppableContainer:a,value:u}})}}return o.sort(n4)};function s4(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function xw(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Da}function l4(e){return function(n){for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return o.reduce((l,c)=>({...l,top:l.top+e*c.y,bottom:l.bottom+e*c.y,left:l.left+e*c.x,right:l.right+e*c.x}),{...n})}}const c4=l4(1);function u4(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function d4(e,t,n){const i=u4(t);if(!i)return e;const{scaleX:o,scaleY:a,x:l,y:c}=i,u=e.left-l-(1-o)*parseFloat(n),d=e.top-c-(1-a)*parseFloat(n.slice(n.indexOf(" ")+1)),h=o?e.width/o:e.width,v=a?e.height/a:e.height;return{width:h,height:v,top:d,right:u+h,bottom:d+v,left:u}}const f4={ignoreTransform:!1};function ed(e,t){t===void 0&&(t=f4);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:h}=so(e).getComputedStyle(e);d&&(n=d4(n,d,h))}const{top:i,left:o,width:a,height:l,bottom:c,right:u}=n;return{top:i,left:o,width:a,height:l,bottom:c,right:u}}function l2(e){return ed(e,{ignoreTransform:!0})}function h4(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function p4(e,t){return t===void 0&&(t=so(e).getComputedStyle(e)),t.position==="fixed"}function m4(e,t){t===void 0&&(t=so(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const a=t[o];return typeof a=="string"?n.test(a):!1})}function wp(e,t){const n=[];function i(o){if(t!=null&&n.length>=t||!o)return n;if(Hg(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!gf(o)||hw(o)||n.includes(o))return n;const a=so(e).getComputedStyle(o);return o!==e&&m4(o,a)&&n.push(o),p4(o,a)?n:i(o.parentNode)}return e?i(e):n}function ww(e){const[t]=wp(e,1);return t??null}function cm(e){return!xp||!e?null:Zu(e)?e:qg(e)?Hg(e)||e===Qu(e).scrollingElement?window:gf(e)?e:null:null}function _w(e){return Zu(e)?e.scrollX:e.scrollLeft}function Sw(e){return Zu(e)?e.scrollY:e.scrollTop}function Km(e){return{x:_w(e),y:Sw(e)}}var sr;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(sr||(sr={}));function Ew(e){return!xp||!e?!1:e===document.scrollingElement}function Nw(e){const t={x:0,y:0},n=Ew(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},i={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,a=e.scrollLeft<=t.x,l=e.scrollTop>=i.y,c=e.scrollLeft>=i.x;return{isTop:o,isLeft:a,isBottom:l,isRight:c,maxScroll:i,minScroll:t}}const g4={x:.2,y:.2};function v4(e,t,n,i,o){let{top:a,left:l,right:c,bottom:u}=n;i===void 0&&(i=10),o===void 0&&(o=g4);const{isTop:d,isBottom:h,isLeft:v,isRight:b}=Nw(e),g={x:0,y:0},A={x:0,y:0},_={height:t.height*o.y,width:t.width*o.x};return!d&&a<=t.top+_.height?(g.y=sr.Backward,A.y=i*Math.abs((t.top+_.height-a)/_.height)):!h&&u>=t.bottom-_.height&&(g.y=sr.Forward,A.y=i*Math.abs((t.bottom-_.height-u)/_.height)),!b&&c>=t.right-_.width?(g.x=sr.Forward,A.x=i*Math.abs((t.right-_.width-c)/_.width)):!v&&l<=t.left+_.width&&(g.x=sr.Backward,A.x=i*Math.abs((t.left+_.width-l)/_.width)),{direction:g,speed:A}}function y4(e){if(e===document.scrollingElement){const{innerWidth:a,innerHeight:l}=window;return{top:0,left:0,right:a,bottom:l,width:a,height:l}}const{top:t,left:n,right:i,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:i,bottom:o,width:e.clientWidth,height:e.clientHeight}}function Aw(e){return e.reduce((t,n)=>ju(t,Km(n)),Da)}function b4(e){return e.reduce((t,n)=>t+_w(n),0)}function x4(e){return e.reduce((t,n)=>t+Sw(n),0)}function w4(e,t){if(t===void 0&&(t=ed),!e)return;const{top:n,left:i,bottom:o,right:a}=t(e);ww(e)&&(o<=0||a<=0||n>=window.innerHeight||i>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const _4=[["x",["left","right"],b4],["y",["top","bottom"],x4]];class $g{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const i=wp(n),o=Aw(i);this.rect={...t},this.width=t.width,this.height=t.height;for(const[a,l,c]of _4)for(const u of l)Object.defineProperty(this,u,{get:()=>{const d=c(i),h=o[a]-d;return this.rect[u]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Kd{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var i;return(i=this.target)==null?void 0:i.removeEventListener(...n)})},this.target=t}add(t,n,i){var o;(o=this.target)==null||o.addEventListener(t,n,i),this.listeners.push([t,n,i])}}function S4(e){const{EventTarget:t}=so(e);return e instanceof t?e:Qu(e)}function um(e,t){const n=Math.abs(e.x),i=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+i**2)>t:"x"in t&&"y"in t?n>t.x&&i>t.y:"x"in t?n>t.x:"y"in t?i>t.y:!1}var Xo;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Xo||(Xo={}));function c2(e){e.preventDefault()}function E4(e){e.stopPropagation()}var bn;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(bn||(bn={}));const Cw={start:[bn.Space,bn.Enter],cancel:[bn.Esc],end:[bn.Space,bn.Enter,bn.Tab]},N4=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case bn.Right:return{...n,x:n.x+25};case bn.Left:return{...n,x:n.x-25};case bn.Down:return{...n,y:n.y+25};case bn.Up:return{...n,y:n.y-25}}};class Yg{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Kd(Qu(n)),this.windowListeners=new Kd(so(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Xo.Resize,this.handleCancel),this.windowListeners.add(Xo.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Xo.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,i=t.node.current;i&&w4(i),n(Da)}handleKeyDown(t){if(Vg(t)){const{active:n,context:i,options:o}=this.props,{keyboardCodes:a=Cw,coordinateGetter:l=N4,scrollBehavior:c="smooth"}=o,{code:u}=t;if(a.end.includes(u)){this.handleEnd(t);return}if(a.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:d}=i.current,h=d?{x:d.left,y:d.top}:Da;this.referenceCoordinates||(this.referenceCoordinates=h);const v=l(t,{active:n,context:i.current,currentCoordinates:h});if(v){const b=af(v,h),g={x:0,y:0},{scrollableAncestors:A}=i.current;for(const _ of A){const C=t.code,{isTop:E,isRight:R,isLeft:k,isBottom:M,maxScroll:P,minScroll:W}=Nw(_),V=y4(_),$={x:Math.min(C===bn.Right?V.right-V.width/2:V.right,Math.max(C===bn.Right?V.left:V.left+V.width/2,v.x)),y:Math.min(C===bn.Down?V.bottom-V.height/2:V.bottom,Math.max(C===bn.Down?V.top:V.top+V.height/2,v.y))},j=C===bn.Right&&!R||C===bn.Left&&!k,X=C===bn.Down&&!M||C===bn.Up&&!E;if(j&&$.x!==v.x){const z=_.scrollLeft+b.x,U=C===bn.Right&&z<=P.x||C===bn.Left&&z>=W.x;if(U&&!b.y){_.scrollTo({left:z,behavior:c});return}U?g.x=_.scrollLeft-z:g.x=C===bn.Right?_.scrollLeft-P.x:_.scrollLeft-W.x,g.x&&_.scrollBy({left:-g.x,behavior:c});break}else if(X&&$.y!==v.y){const z=_.scrollTop+b.y,U=C===bn.Down&&z<=P.y||C===bn.Up&&z>=W.y;if(U&&!b.x){_.scrollTo({top:z,behavior:c});return}U?g.y=_.scrollTop-z:g.y=C===bn.Down?_.scrollTop-P.y:_.scrollTop-W.y,g.y&&_.scrollBy({top:-g.y,behavior:c});break}}this.handleMove(t,ju(af(v,this.referenceCoordinates),g))}}}handleMove(t,n){const{onMove:i}=this.props;t.preventDefault(),i(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Yg.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:i=Cw,onActivation:o}=t,{active:a}=n;const{code:l}=e.nativeEvent;if(i.start.includes(l)){const c=a.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),o==null||o({event:e.nativeEvent}),!0)}return!1}}];function u2(e){return!!(e&&"distance"in e)}function d2(e){return!!(e&&"delay"in e)}class Wg{constructor(t,n,i){var o;i===void 0&&(i=S4(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:a}=t,{target:l}=a;this.props=t,this.events=n,this.document=Qu(l),this.documentListeners=new Kd(this.document),this.listeners=new Kd(i),this.windowListeners=new Kd(so(l)),this.initialCoordinates=(o=Xm(a))!=null?o:Da,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:i}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Xo.Resize,this.handleCancel),this.windowListeners.add(Xo.DragStart,c2),this.windowListeners.add(Xo.VisibilityChange,this.handleCancel),this.windowListeners.add(Xo.ContextMenu,c2),this.documentListeners.add(Xo.Keydown,this.handleKeydown),n){if(i!=null&&i({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(d2(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(u2(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:i,onPending:o}=this.props;o(i,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Xo.Click,E4,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Xo.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:i,initialCoordinates:o,props:a}=this,{onMove:l,options:{activationConstraint:c}}=a;if(!o)return;const u=(n=Xm(t))!=null?n:Da,d=af(o,u);if(!i&&c){if(u2(c)){if(c.tolerance!=null&&um(d,c.tolerance))return this.handleCancel();if(um(d,c.distance))return this.handleStart()}if(d2(c)&&um(d,c.tolerance))return this.handleCancel();this.handlePending(c,d);return}t.cancelable&&t.preventDefault(),l(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===bn.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const A4={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class _p extends Wg{constructor(t){const{event:n}=t,i=Qu(n.target);super(t,A4,i)}}_p.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:i}=t;return!n.isPrimary||n.button!==0?!1:(i==null||i({event:n}),!0)}}];const C4={move:{name:"mousemove"},end:{name:"mouseup"}};var Zm;(function(e){e[e.RightClick=2]="RightClick"})(Zm||(Zm={}));class T4 extends Wg{constructor(t){super(t,C4,Qu(t.event.target))}}T4.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:i}=t;return n.button===Zm.RightClick?!1:(i==null||i({event:n}),!0)}}];const dm={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class k4 extends Wg{constructor(t){super(t,dm)}static setup(){return window.addEventListener(dm.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(dm.move.name,t)};function t(){}}}k4.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:i}=t;const{touches:o}=n;return o.length>1?!1:(i==null||i({event:n}),!0)}}];var Zd;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Zd||(Zd={}));var ap;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(ap||(ap={}));function I4(e){let{acceleration:t,activator:n=Zd.Pointer,canScroll:i,draggingRect:o,enabled:a,interval:l=5,order:c=ap.TreeOrder,pointerCoordinates:u,scrollableAncestors:d,scrollableAncestorRects:h,delta:v,threshold:b}=e;const g=L4({delta:v,disabled:!a}),[A,_]=H3(),C=de.useRef({x:0,y:0}),E=de.useRef({x:0,y:0}),R=de.useMemo(()=>{switch(n){case Zd.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case Zd.DraggableRect:return o}},[n,o,u]),k=de.useRef(null),M=de.useCallback(()=>{const W=k.current;if(!W)return;const V=C.current.x*E.current.x,$=C.current.y*E.current.y;W.scrollBy(V,$)},[]),P=de.useMemo(()=>c===ap.TreeOrder?[...d].reverse():d,[c,d]);de.useEffect(()=>{if(!a||!d.length||!R){_();return}for(const W of P){if((i==null?void 0:i(W))===!1)continue;const V=d.indexOf(W),$=h[V];if(!$)continue;const{direction:j,speed:X}=v4(W,$,R,t,b);for(const z of["x","y"])g[z][j[z]]||(X[z]=0,j[z]=0);if(X.x>0||X.y>0){_(),k.current=W,A(M,l),C.current=X,E.current=j;return}}C.current={x:0,y:0},E.current={x:0,y:0},_()},[t,M,i,_,a,l,JSON.stringify(R),JSON.stringify(g),A,d,P,h,JSON.stringify(b)])}const R4={x:{[sr.Backward]:!1,[sr.Forward]:!1},y:{[sr.Backward]:!1,[sr.Forward]:!1}};function L4(e){let{delta:t,disabled:n}=e;const i=Wm(t);return vf(o=>{if(n||!i||!o)return R4;const a={x:Math.sign(t.x-i.x),y:Math.sign(t.y-i.y)};return{x:{[sr.Backward]:o.x[sr.Backward]||a.x===-1,[sr.Forward]:o.x[sr.Forward]||a.x===1},y:{[sr.Backward]:o.y[sr.Backward]||a.y===-1,[sr.Forward]:o.y[sr.Forward]||a.y===1}}},[n,t,i])}function M4(e,t){const n=t!=null?e.get(t):void 0,i=n?n.node.current:null;return vf(o=>{var a;return t==null?null:(a=i??o)!=null?a:null},[i,t])}function D4(e,t){return de.useMemo(()=>e.reduce((n,i)=>{const{sensor:o}=i,a=o.activators.map(l=>({eventName:l.eventName,handler:t(l.handler,i)}));return[...n,...a]},[]),[e,t])}var lf;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(lf||(lf={}));var Qm;(function(e){e.Optimized="optimized"})(Qm||(Qm={}));const f2=new Map;function P4(e,t){let{dragging:n,dependencies:i,config:o}=t;const[a,l]=de.useState(null),{frequency:c,measure:u,strategy:d}=o,h=de.useRef(e),v=C(),b=of(v),g=de.useCallback(function(E){E===void 0&&(E=[]),!b.current&&l(R=>R===null?E:R.concat(E.filter(k=>!R.includes(k))))},[b]),A=de.useRef(null),_=vf(E=>{if(v&&!n)return f2;if(!E||E===f2||h.current!==e||a!=null){const R=new Map;for(let k of e){if(!k)continue;if(a&&a.length>0&&!a.includes(k.id)&&k.rect.current){R.set(k.id,k.rect.current);continue}const M=k.node.current,P=M?new $g(u(M),M):null;k.rect.current=P,P&&R.set(k.id,P)}return R}return E},[e,a,n,v,u]);return de.useEffect(()=>{h.current=e},[e]),de.useEffect(()=>{v||g()},[n,v]),de.useEffect(()=>{a&&a.length>0&&l(null)},[JSON.stringify(a)]),de.useEffect(()=>{v||typeof c!="number"||A.current!==null||(A.current=setTimeout(()=>{g(),A.current=null},c))},[c,v,g,...i]),{droppableRects:_,measureDroppableContainers:g,measuringScheduled:a!=null};function C(){switch(d){case lf.Always:return!1;case lf.BeforeDragging:return n;default:return!n}}}function Tw(e,t){return vf(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function O4(e,t){return Tw(e,t)}function U4(e){let{callback:t,disabled:n}=e;const i=Gg(t),o=de.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(i)},[i,n]);return de.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function Sp(e){let{callback:t,disabled:n}=e;const i=Gg(t),o=de.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(i)},[n]);return de.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function z4(e){return new $g(ed(e),e)}function h2(e,t,n){t===void 0&&(t=z4);const[i,o]=de.useState(null);function a(){o(u=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=u??n)!=null?d:null}const h=t(e);return JSON.stringify(u)===JSON.stringify(h)?u:h})}const l=U4({callback(u){if(e)for(const d of u){const{type:h,target:v}=d;if(h==="childList"&&v instanceof HTMLElement&&v.contains(e)){a();break}}}}),c=Sp({callback:a});return us(()=>{a(),e?(c==null||c.observe(e),l==null||l.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),l==null||l.disconnect())},[e]),i}function j4(e){const t=Tw(e);return xw(e,t)}const p2=[];function F4(e){const t=de.useRef(e),n=vf(i=>e?i&&i!==p2&&e&&t.current&&e.parentNode===t.current.parentNode?i:wp(e):p2,[e]);return de.useEffect(()=>{t.current=e},[e]),n}function B4(e){const[t,n]=de.useState(null),i=de.useRef(e),o=de.useCallback(a=>{const l=cm(a.target);l&&n(c=>c?(c.set(l,Km(l)),new Map(c)):null)},[]);return de.useEffect(()=>{const a=i.current;if(e!==a){l(a);const c=e.map(u=>{const d=cm(u);return d?(d.addEventListener("scroll",o,{passive:!0}),[d,Km(d)]):null}).filter(u=>u!=null);n(c.length?new Map(c):null),i.current=e}return()=>{l(e),l(a)};function l(c){c.forEach(u=>{const d=cm(u);d==null||d.removeEventListener("scroll",o)})}},[o,e]),de.useMemo(()=>e.length?t?Array.from(t.values()).reduce((a,l)=>ju(a,l),Da):Aw(e):Da,[e,t])}function m2(e,t){t===void 0&&(t=[]);const n=de.useRef(null);return de.useEffect(()=>{n.current=null},t),de.useEffect(()=>{const i=e!==Da;i&&!n.current&&(n.current=e),!i&&n.current&&(n.current=null)},[e]),n.current?af(e,n.current):Da}function q4(e){de.useEffect(()=>{if(!xp)return;const t=e.map(n=>{let{sensor:i}=n;return i.setup==null?void 0:i.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function H4(e,t){return de.useMemo(()=>e.reduce((n,i)=>{let{eventName:o,handler:a}=i;return n[o]=l=>{a(l,t)},n},{}),[e,t])}function kw(e){return de.useMemo(()=>e?h4(e):null,[e])}const g2=[];function G4(e,t){t===void 0&&(t=ed);const[n]=e,i=kw(n?so(n):null),[o,a]=de.useState(g2);function l(){a(()=>e.length?e.map(u=>Ew(u)?i:new $g(t(u),u)):g2)}const c=Sp({callback:l});return us(()=>{c==null||c.disconnect(),l(),e.forEach(u=>c==null?void 0:c.observe(u))},[e]),o}function V4(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return gf(t)?t:e}function $4(e){let{measure:t}=e;const[n,i]=de.useState(null),o=de.useCallback(d=>{for(const{target:h}of d)if(gf(h)){i(v=>{const b=t(h);return v?{...v,width:b.width,height:b.height}:b});break}},[t]),a=Sp({callback:o}),l=de.useCallback(d=>{const h=V4(d);a==null||a.disconnect(),h&&(a==null||a.observe(h)),i(h?t(h):null)},[t,a]),[c,u]=rp(l);return de.useMemo(()=>({nodeRef:c,rect:n,setRef:u}),[n,c,u])}const Y4=[{sensor:_p,options:{}},{sensor:Yg,options:{}}],W4={current:{}},Hh={draggable:{measure:l2},droppable:{measure:l2,strategy:lf.WhileDragging,frequency:Qm.Optimized},dragOverlay:{measure:ed}};class Qd extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,i;return(n=(i=this.get(t))==null?void 0:i.node.current)!=null?n:void 0}}const X4={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Qd,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:op},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Hh,measureDroppableContainers:op,windowRect:null,measuringScheduled:!1},J4={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:op,draggableNodes:new Map,over:null,measureDroppableContainers:op},Ep=de.createContext(J4),Iw=de.createContext(X4);function K4(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Qd}}}function Z4(e,t){switch(t.type){case Zi.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Zi.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Zi.DragEnd:case Zi.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Zi.RegisterDroppable:{const{element:n}=t,{id:i}=n,o=new Qd(e.droppable.containers);return o.set(i,n),{...e,droppable:{...e.droppable,containers:o}}}case Zi.SetDroppableDisabled:{const{id:n,key:i,disabled:o}=t,a=e.droppable.containers.get(n);if(!a||i!==a.key)return e;const l=new Qd(e.droppable.containers);return l.set(n,{...a,disabled:o}),{...e,droppable:{...e.droppable,containers:l}}}case Zi.UnregisterDroppable:{const{id:n,key:i}=t,o=e.droppable.containers.get(n);if(!o||i!==o.key)return e;const a=new Qd(e.droppable.containers);return a.delete(n),{...e,droppable:{...e.droppable,containers:a}}}default:return e}}function Q4(e){let{disabled:t}=e;const{active:n,activatorEvent:i,draggableNodes:o}=de.useContext(Ep),a=Wm(i),l=Wm(n==null?void 0:n.id);return de.useEffect(()=>{if(!t&&!i&&a&&l!=null){if(!Vg(a)||document.activeElement===a.target)return;const c=o.get(l);if(!c)return;const{activatorNode:u,node:d}=c;if(!u.current&&!d.current)return;requestAnimationFrame(()=>{for(const h of[u.current,d.current]){if(!h)continue;const v=$3(h);if(v){v.focus();break}}})}},[i,t,o,l,a]),null}function eC(e,t){let{transform:n,...i}=t;return e!=null&&e.length?e.reduce((o,a)=>a({transform:o,...i}),n):n}function tC(e){return de.useMemo(()=>({draggable:{...Hh.draggable,...e==null?void 0:e.draggable},droppable:{...Hh.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Hh.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function nC(e){let{activeNode:t,measure:n,initialRect:i,config:o=!0}=e;const a=de.useRef(!1),{x:l,y:c}=typeof o=="boolean"?{x:o,y:o}:o;us(()=>{if(!l&&!c||!t){a.current=!1;return}if(a.current||!i)return;const d=t==null?void 0:t.node.current;if(!d||d.isConnected===!1)return;const h=n(d),v=xw(h,i);if(l||(v.x=0),c||(v.y=0),a.current=!0,Math.abs(v.x)>0||Math.abs(v.y)>0){const b=ww(d);b&&b.scrollBy({top:v.y,left:v.x})}},[t,l,c,i,n])}const Rw=de.createContext({...Da,scaleX:1,scaleY:1});var Ll;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Ll||(Ll={}));const Xg=de.memo(function(t){var n,i,o,a;let{id:l,accessibility:c,autoScroll:u=!0,children:d,sensors:h=Y4,collisionDetection:v=a4,measuring:b,modifiers:g,...A}=t;const _=de.useReducer(Z4,void 0,K4),[C,E]=_,[R,k]=Z3(),[M,P]=de.useState(Ll.Uninitialized),W=M===Ll.Initialized,{draggable:{active:V,nodes:$,translate:j},droppable:{containers:X}}=C,z=V!=null?$.get(V):null,U=de.useRef({initial:null,translated:null}),q=de.useMemo(()=>{var lt;return V!=null?{id:V,data:(lt=z==null?void 0:z.data)!=null?lt:W4,rect:U}:null},[V,z]),I=de.useRef(null),[ie,J]=de.useState(null),[Y,le]=de.useState(null),pe=of(A,Object.values(A)),Ie=yf("DndDescribedBy",l),G=de.useMemo(()=>X.getEnabled(),[X]),O=tC(b),{droppableRects:ee,measureDroppableContainers:te,measuringScheduled:ce}=P4(G,{dragging:W,dependencies:[j.x,j.y],config:O.droppable}),ye=M4($,V),we=de.useMemo(()=>Y?Xm(Y):null,[Y]),Te=wt(),Ce=O4(ye,O.draggable.measure);nC({activeNode:V!=null?$.get(V):null,config:Te.layoutShiftCompensation,initialRect:Ce,measure:O.draggable.measure});const De=h2(ye,O.draggable.measure,Ce),$e=h2(ye?ye.parentElement:null),at=de.useRef({activatorEvent:null,active:null,activeNode:ye,collisionRect:null,collisions:null,droppableRects:ee,draggableNodes:$,draggingNode:null,draggingNodeRect:null,droppableContainers:X,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),st=X.getNodeFor((n=at.current.over)==null?void 0:n.id),B=$4({measure:O.dragOverlay.measure}),K=(i=B.nodeRef.current)!=null?i:ye,_e=W?(o=B.rect)!=null?o:De:null,he=!!(B.nodeRef.current&&B.rect),ne=j4(he?null:De),ae=kw(K?so(K):null),be=F4(W?st??ye:null),Me=G4(be),Se=eC(g,{transform:{x:j.x-ne.x,y:j.y-ne.y,scaleX:1,scaleY:1},activatorEvent:Y,active:q,activeNodeRect:De,containerNodeRect:$e,draggingNodeRect:_e,over:at.current.over,overlayNodeRect:B.rect,scrollableAncestors:be,scrollableAncestorRects:Me,windowRect:ae}),He=we?ju(we,j):null,Ne=B4(be),ze=m2(Ne),We=m2(Ne,[De]),dt=ju(Se,ze),ft=_e?c4(_e,Se):null,ht=q&&ft?v({active:q,collisionRect:ft,droppableRects:ee,droppableContainers:G,pointerCoordinates:He}):null,Et=bw(ht,"id"),[mt,on]=de.useState(null),yt=he?Se:ju(Se,We),vt=s4(yt,(a=mt==null?void 0:mt.rect)!=null?a:null,De),Rt=de.useRef(null),Ft=de.useCallback((lt,et)=>{let{sensor:pt,options:Bt}=et;if(I.current==null)return;const Vt=$.get(I.current);if(!Vt)return;const zt=lt.nativeEvent,Jt=new pt({active:I.current,activeNode:Vt,event:zt,options:Bt,context:at,onAbort(jt){if(!$.get(jt))return;const{onDragAbort:Nn}=pe.current,Xn={id:jt};Nn==null||Nn(Xn),R({type:"onDragAbort",event:Xn})},onPending(jt,sn,Nn,Xn){if(!$.get(jt))return;const{onDragPending:rn}=pe.current,wn={id:jt,constraint:sn,initialCoordinates:Nn,offset:Xn};rn==null||rn(wn),R({type:"onDragPending",event:wn})},onStart(jt){const sn=I.current;if(sn==null)return;const Nn=$.get(sn);if(!Nn)return;const{onDragStart:Xn}=pe.current,mn={activatorEvent:zt,active:{id:sn,data:Nn.data,rect:U}};Xd.unstable_batchedUpdates(()=>{Xn==null||Xn(mn),P(Ll.Initializing),E({type:Zi.DragStart,initialCoordinates:jt,active:sn}),R({type:"onDragStart",event:mn}),J(Rt.current),le(zt)})},onMove(jt){E({type:Zi.DragMove,coordinates:jt})},onEnd:bt(Zi.DragEnd),onCancel:bt(Zi.DragCancel)});Rt.current=Jt;function bt(jt){return async function(){const{active:Nn,collisions:Xn,over:mn,scrollAdjustedTranslate:rn}=at.current;let wn=null;if(Nn&&rn){const{cancelDrop:Qi}=pe.current;wn={activatorEvent:zt,active:Nn,collisions:Xn,delta:rn,over:mn},jt===Zi.DragEnd&&typeof Qi=="function"&&await Promise.resolve(Qi(wn))&&(jt=Zi.DragCancel)}I.current=null,Xd.unstable_batchedUpdates(()=>{E({type:jt}),P(Ll.Uninitialized),on(null),J(null),le(null),Rt.current=null;const Qi=jt===Zi.DragEnd?"onDragEnd":"onDragCancel";if(wn){const Ii=pe.current[Qi];Ii==null||Ii(wn),R({type:Qi,event:wn})}})}}},[$]),Le=de.useCallback((lt,et)=>(pt,Bt)=>{const Vt=pt.nativeEvent,zt=$.get(Bt);if(I.current!==null||!zt||Vt.dndKit||Vt.defaultPrevented)return;const Jt={active:zt};lt(pt,et.options,Jt)===!0&&(Vt.dndKit={capturedBy:et.sensor},I.current=Bt,Ft(pt,et))},[$,Ft]),nt=D4(h,Le);q4(h),us(()=>{De&&M===Ll.Initializing&&P(Ll.Initialized)},[De,M]),de.useEffect(()=>{const{onDragMove:lt}=pe.current,{active:et,activatorEvent:pt,collisions:Bt,over:Vt}=at.current;if(!et||!pt)return;const zt={active:et,activatorEvent:pt,collisions:Bt,delta:{x:dt.x,y:dt.y},over:Vt};Xd.unstable_batchedUpdates(()=>{lt==null||lt(zt),R({type:"onDragMove",event:zt})})},[dt.x,dt.y]),de.useEffect(()=>{const{active:lt,activatorEvent:et,collisions:pt,droppableContainers:Bt,scrollAdjustedTranslate:Vt}=at.current;if(!lt||I.current==null||!et||!Vt)return;const{onDragOver:zt}=pe.current,Jt=Bt.get(Et),bt=Jt&&Jt.rect.current?{id:Jt.id,rect:Jt.rect.current,data:Jt.data,disabled:Jt.disabled}:null,jt={active:lt,activatorEvent:et,collisions:pt,delta:{x:Vt.x,y:Vt.y},over:bt};Xd.unstable_batchedUpdates(()=>{on(bt),zt==null||zt(jt),R({type:"onDragOver",event:jt})})},[Et]),us(()=>{at.current={activatorEvent:Y,active:q,activeNode:ye,collisionRect:ft,collisions:ht,droppableRects:ee,draggableNodes:$,draggingNode:K,draggingNodeRect:_e,droppableContainers:X,over:mt,scrollableAncestors:be,scrollAdjustedTranslate:dt},U.current={initial:_e,translated:ft}},[q,ye,ht,ft,$,K,_e,ee,X,mt,be,dt]),I4({...Te,delta:j,draggingRect:ft,pointerCoordinates:He,scrollableAncestors:be,scrollableAncestorRects:Me});const Qe=de.useMemo(()=>({active:q,activeNode:ye,activeNodeRect:De,activatorEvent:Y,collisions:ht,containerNodeRect:$e,dragOverlay:B,draggableNodes:$,droppableContainers:X,droppableRects:ee,over:mt,measureDroppableContainers:te,scrollableAncestors:be,scrollableAncestorRects:Me,measuringConfiguration:O,measuringScheduled:ce,windowRect:ae}),[q,ye,De,Y,ht,$e,B,$,X,ee,mt,te,be,Me,O,ce,ae]),ut=de.useMemo(()=>({activatorEvent:Y,activators:nt,active:q,activeNodeRect:De,ariaDescribedById:{draggable:Ie},dispatch:E,draggableNodes:$,over:mt,measureDroppableContainers:te}),[Y,nt,q,De,E,Ie,$,mt,te]);return kn.createElement(mw.Provider,{value:k},kn.createElement(Ep.Provider,{value:ut},kn.createElement(Iw.Provider,{value:Qe},kn.createElement(Rw.Provider,{value:vt},d)),kn.createElement(Q4,{disabled:(c==null?void 0:c.restoreFocus)===!1})),kn.createElement(t4,{...c,hiddenTextDescribedById:Ie}));function wt(){const lt=(ie==null?void 0:ie.autoScrollEnabled)===!1,et=typeof u=="object"?u.enabled===!1:u===!1,pt=W&&!lt&&!et;return typeof u=="object"?{...u,enabled:pt}:{enabled:pt}}}),iC=de.createContext(null),v2="button",rC="Draggable";function Lw(e){let{id:t,data:n,disabled:i=!1,attributes:o}=e;const a=yf(rC),{activators:l,activatorEvent:c,active:u,activeNodeRect:d,ariaDescribedById:h,draggableNodes:v,over:b}=de.useContext(Ep),{role:g=v2,roleDescription:A="draggable",tabIndex:_=0}=o??{},C=(u==null?void 0:u.id)===t,E=de.useContext(C?Rw:iC),[R,k]=rp(),[M,P]=rp(),W=H4(l,t),V=of(n);us(()=>(v.set(t,{id:t,key:a,node:R,activatorNode:M,data:V}),()=>{const j=v.get(t);j&&j.key===a&&v.delete(t)}),[v,t]);const $=de.useMemo(()=>({role:g,tabIndex:_,"aria-disabled":i,"aria-pressed":C&&g===v2?!0:void 0,"aria-roledescription":A,"aria-describedby":h.draggable}),[i,g,_,C,A,h.draggable]);return{active:u,activatorEvent:c,activeNodeRect:d,attributes:$,isDragging:C,listeners:i?void 0:W,node:R,over:b,setNodeRef:k,setActivatorNodeRef:P,transform:E}}function oC(){return de.useContext(Iw)}const aC="Droppable",sC={timeout:25};function lC(e){let{data:t,disabled:n=!1,id:i,resizeObserverConfig:o}=e;const a=yf(aC),{active:l,dispatch:c,over:u,measureDroppableContainers:d}=de.useContext(Ep),h=de.useRef({disabled:n}),v=de.useRef(!1),b=de.useRef(null),g=de.useRef(null),{disabled:A,updateMeasurementsFor:_,timeout:C}={...sC,...o},E=of(_??i),R=de.useCallback(()=>{if(!v.current){v.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{d(Array.isArray(E.current)?E.current:[E.current]),g.current=null},C)},[C]),k=Sp({callback:R,disabled:A||!l}),M=de.useCallback(($,j)=>{k&&(j&&(k.unobserve(j),v.current=!1),$&&k.observe($))},[k]),[P,W]=rp(M),V=of(t);return de.useEffect(()=>{!k||!P.current||(k.disconnect(),v.current=!1,k.observe(P.current))},[P,k]),de.useEffect(()=>(c({type:Zi.RegisterDroppable,element:{id:i,key:a,disabled:n,node:P,rect:b,data:V}}),()=>c({type:Zi.UnregisterDroppable,key:a,id:i})),[i]),de.useEffect(()=>{n!==h.current.disabled&&(c({type:Zi.SetDroppableDisabled,id:i,key:a,disabled:n}),h.current.disabled=n)},[i,a,n,c]),{active:l,rect:b,isOver:(u==null?void 0:u.id)===i,node:P,over:u,setNodeRef:W}}var Jo=function(e,t){return Number(e.toFixed(t))},cC=function(e,t){return t},hi=function(e,t,n){n&&typeof n=="function"&&n(e,t)},uC=function(e){return-Math.cos(e*Math.PI)/2+.5},dC=function(e){return e},fC=function(e){return e*e},hC=function(e){return e*(2-e)},pC=function(e){return e<.5?2*e*e:-1+(4-2*e)*e},mC=function(e){return e*e*e},gC=function(e){return--e*e*e+1},vC=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},yC=function(e){return e*e*e*e},bC=function(e){return 1- --e*e*e*e},xC=function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},wC=function(e){return e*e*e*e*e},_C=function(e){return 1+--e*e*e*e*e},SC=function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},Mw={easeOut:uC,linear:dC,easeInQuad:fC,easeOutQuad:hC,easeInOutQuad:pC,easeInCubic:mC,easeOutCubic:gC,easeInOutCubic:vC,easeInQuart:yC,easeOutQuart:bC,easeInOutQuart:xC,easeInQuint:wC,easeOutQuint:_C,easeInOutQuint:SC},Dw=function(e){typeof e=="number"&&cancelAnimationFrame(e)},Ta=function(e){e.mounted&&(Dw(e.animation),e.animate=!1,e.animation=null,e.velocity=null)};function Pw(e,t,n,i){if(e.mounted){var o=new Date().getTime(),a=1;Ta(e),e.animation=function(){if(!e.mounted)return Dw(e.animation);var l=new Date().getTime()-o,c=l/n,u=Mw[t],d=u(c);l>=n?(i(a),e.animation=null):e.animation&&(i(d),requestAnimationFrame(e.animation))},requestAnimationFrame(e.animation)}}function EC(e){var t=e.scale,n=e.positionX,i=e.positionY;return!(Number.isNaN(t)||Number.isNaN(n)||Number.isNaN(i))}function ql(e,t,n,i){var o=EC(t);if(!(!e.mounted||!o)){var a=e.setTransformState,l=e.transformState,c=l.scale,u=l.positionX,d=l.positionY,h=t.scale-c,v=t.positionX-u,b=t.positionY-d;n===0?a(t.scale,t.positionX,t.positionY):Pw(e,i,n,function(g){var A=c+h*g,_=u+v*g,C=d+b*g;a(A,_,C)})}}function NC(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=t.offsetWidth,l=t.offsetHeight,c=a*n,u=l*n,d=i-c,h=o-u;return{wrapperWidth:i,wrapperHeight:o,newContentWidth:c,newDiffWidth:d,newContentHeight:u,newDiffHeight:h}}var AC=function(e,t,n,i,o,a,l){var c=e>t?n*(l?1:.5):0,u=i>o?a*(l?1:.5):0,d=e-t-c,h=c,v=i-o-u,b=u;return{minPositionX:d,maxPositionX:h,minPositionY:v,maxPositionY:b}},Jg=function(e,t){var n=e.wrapperComponent,i=e.contentComponent,o=e.setup.centerZoomedOut;if(!n||!i)throw new Error("Components are not mounted");var a=NC(n,i,t),l=a.wrapperWidth,c=a.wrapperHeight,u=a.newContentWidth,d=a.newDiffWidth,h=a.newContentHeight,v=a.newDiffHeight,b=AC(l,u,d,c,h,v,!!o);return b},eg=function(e,t,n,i){return i?e<t?Jo(t,2):e>n?Jo(n,2):Jo(e,2):Jo(e,2)},Ac=function(e,t){var n=Jg(e,t);return e.bounds=n,n};function bf(e,t,n,i,o,a,l){var c=n.minPositionX,u=n.minPositionY,d=n.maxPositionX,h=n.maxPositionY,v=0,b=0;l&&(v=o,b=a);var g=eg(e,c-v,d+v,i),A=eg(t,u-b,h+b,i);return{x:g,y:A}}function Np(e,t,n,i,o,a){var l=e.transformState,c=l.scale,u=l.positionX,d=l.positionY,h=i-c;if(typeof t!="number"||typeof n!="number")return console.error("Mouse X and Y position were not provided!"),{x:u,y:d};var v=u-t*h,b=d-n*h,g=bf(v,b,o,a,0,0,null);return g}function xf(e,t,n,i,o){var a=o?i:0,l=t-a;return!Number.isNaN(n)&&e>=n?n:!Number.isNaN(t)&&e<=l?l:e}var y2=function(e,t){var n=e.setup.panning.excluded,i=e.isInitialized,o=e.wrapperComponent,a=t.target,l="shadowRoot"in a&&"composedPath"in t,c=l?t.composedPath().some(function(h){return h instanceof Element?o==null?void 0:o.contains(h):!1}):o==null?void 0:o.contains(a),u=i&&a&&c;if(!u)return!1;var d=Ap(a,n);return!d},b2=function(e){var t=e.isInitialized,n=e.isPanning,i=e.setup,o=i.panning.disabled,a=t&&n&&!o;return!!a},CC=function(e,t){var n=e.transformState,i=n.positionX,o=n.positionY;e.isPanning=!0;var a=t.clientX,l=t.clientY;e.startCoords={x:a-i,y:l-o}},TC=function(e,t){var n=t.touches,i=e.transformState,o=i.positionX,a=i.positionY;e.isPanning=!0;var l=n.length===1;if(l){var c=n[0].clientX,u=n[0].clientY;e.startCoords={x:c-o,y:u-a}}};function kC(e){var t=e.transformState,n=t.positionX,i=t.positionY,o=t.scale,a=e.setup,l=a.disabled,c=a.limitToBounds,u=a.centerZoomedOut,d=e.wrapperComponent;if(!(l||!d||!e.bounds)){var h=e.bounds,v=h.maxPositionX,b=h.minPositionX,g=h.maxPositionY,A=h.minPositionY,_=n>v||n<b,C=i>g||i<A,E=n>v?d.offsetWidth:e.setup.minPositionX||0,R=i>g?d.offsetHeight:e.setup.minPositionY||0,k=Np(e,E,R,o,e.bounds,c||u),M=k.x,P=k.y;return{scale:o,positionX:_?M:n,positionY:C?P:i}}}function Ow(e,t,n,i,o){var a=e.setup.limitToBounds,l=e.wrapperComponent,c=e.bounds,u=e.transformState,d=u.scale,h=u.positionX,v=u.positionY;if(!(l===null||c===null||t===h&&n===v)){var b=bf(t,n,c,a,i,o,l),g=b.x,A=b.y;e.setTransformState(d,g,A)}}var IC=function(e,t,n){var i=e.startCoords,o=e.transformState,a=e.setup.panning,l=a.lockAxisX,c=a.lockAxisY,u=o.positionX,d=o.positionY;if(!i)return{x:u,y:d};var h=t-i.x,v=n-i.y,b=l?u:h,g=c?d:v;return{x:b,y:g}},Fl=function(e,t){var n=e.setup,i=e.transformState,o=i.scale,a=n.minScale,l=n.disablePadding;return t>0&&o>=a&&!l?t:0},RC=function(e){var t=e.mounted,n=e.setup,i=n.disabled,o=n.velocityAnimation,a=e.transformState.scale,l=o.disabled,c=!l||a>1||!i||t;return!!c},LC=function(e){var t=e.mounted,n=e.velocity,i=e.bounds,o=e.setup,a=o.disabled,l=o.velocityAnimation,c=e.transformState.scale,u=l.disabled,d=!u||c>1||!a||t;return!(!d||!n||!i)};function MC(e,t){var n=e.setup.velocityAnimation,i=n.equalToMove,o=n.animationTime,a=n.sensitivity;return i?o*t*a:o}function x2(e,t,n,i,o,a,l,c,u,d){if(o){if(t>l&&n>l){var h=l+(e-l)*d;return h>u?u:h<l?l:h}if(t<a&&n<a){var h=a+(e-a)*d;return h<c?c:h>a?a:h}}return i?t:eg(e,a,l,o)}function DC(e,t){var n=1;return t?Math.min(n,e.offsetWidth/window.innerWidth):n}function PC(e,t){var n=RC(e);if(n){var i=e.lastMousePosition,o=e.velocityTime,a=e.setup,l=e.wrapperComponent,c=a.velocityAnimation.equalToMove,u=Date.now();if(i&&o&&l){var d=DC(l,c),h=t.x-i.x,v=t.y-i.y,b=h/d,g=v/d,A=u-o,_=h*h+v*v,C=Math.sqrt(_)/A;e.velocity={velocityX:b,velocityY:g,total:C}}e.lastMousePosition=t,e.velocityTime=u}}function OC(e){var t=e.velocity,n=e.bounds,i=e.setup,o=e.wrapperComponent,a=LC(e);if(!(!a||!t||!n||!o)){var l=t.velocityX,c=t.velocityY,u=t.total,d=n.maxPositionX,h=n.minPositionX,v=n.maxPositionY,b=n.minPositionY,g=i.limitToBounds,A=i.alignmentAnimation,_=i.zoomAnimation,C=i.panning,E=C.lockAxisY,R=C.lockAxisX,k=_.animationType,M=A.sizeX,P=A.sizeY,W=A.velocityAlignmentTime,V=W,$=MC(e,u),j=Math.max($,V),X=Fl(e,M),z=Fl(e,P),U=X*o.offsetWidth/100,q=z*o.offsetHeight/100,I=d+U,ie=h-U,J=v+q,Y=b-q,le=e.transformState,pe=new Date().getTime();Pw(e,k,j,function(Ie){var G=e.transformState,O=G.scale,ee=G.positionX,te=G.positionY,ce=new Date().getTime()-pe,ye=ce/V,we=Mw[A.animationType],Te=1-we(Math.min(1,ye)),Ce=1-Ie,De=ee+l*Ce,$e=te+c*Ce,at=x2(De,le.positionX,ee,R,g,h,d,ie,I,Te),st=x2($e,le.positionY,te,E,g,b,v,Y,J,Te);(ee!==De||te!==$e)&&e.setTransformState(O,at,st)})}}function w2(e,t){var n=e.transformState.scale;Ta(e),Ac(e,n),window.TouchEvent!==void 0&&t instanceof TouchEvent?TC(e,t):CC(e,t)}function Kg(e,t){var n=e.transformState.scale,i=e.setup,o=i.minScale,a=i.alignmentAnimation,l=a.disabled,c=a.sizeX,u=a.sizeY,d=a.animationTime,h=a.animationType,v=l||n<o||!c&&!u;if(!v){var b=kC(e);b&&ql(e,b,t??d,h)}}function _2(e,t,n){var i=e.startCoords,o=e.setup,a=o.alignmentAnimation,l=a.sizeX,c=a.sizeY;if(i){var u=IC(e,t,n),d=u.x,h=u.y,v=Fl(e,l),b=Fl(e,c);PC(e,{x:d,y:h}),Ow(e,d,h,v,b)}}function UC(e){if(e.isPanning){var t=e.setup.panning.velocityDisabled,n=e.velocity,i=e.wrapperComponent,o=e.contentComponent;e.isPanning=!1,e.animate=!1,e.animation=null;var a=i==null?void 0:i.getBoundingClientRect(),l=o==null?void 0:o.getBoundingClientRect(),c=(a==null?void 0:a.width)||0,u=(a==null?void 0:a.height)||0,d=(l==null?void 0:l.width)||0,h=(l==null?void 0:l.height)||0,v=c<d||u<h,b=!t&&n&&(n==null?void 0:n.total)>.1&&v;b?OC(e):Kg(e)}}function Zg(e,t,n,i){var o=e.setup,a=o.minScale,l=o.maxScale,c=o.limitToBounds,u=xf(Jo(t,2),a,l,0,!1),d=Ac(e,u),h=Np(e,n,i,u,d,c),v=h.x,b=h.y;return{scale:u,positionX:v,positionY:b}}function Uw(e,t,n){var i=e.transformState.scale,o=e.wrapperComponent,a=e.setup,l=a.minScale,c=a.limitToBounds,u=a.zoomAnimation,d=u.disabled,h=u.animationTime,v=u.animationType,b=d||i>=l;if((i>=1||c)&&Kg(e),!(b||!o||!e.mounted)){var g=t||o.offsetWidth/2,A=n||o.offsetHeight/2,_=Zg(e,l,g,A);_&&ql(e,_,h,v)}}var zl=function(){return zl=Object.assign||function(t){for(var n,i=1,o=arguments.length;i<o;i++){n=arguments[i];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},zl.apply(this,arguments)};function S2(e,t,n){for(var i=0,o=t.length,a;i<o;i++)(a||!(i in t))&&(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}var mh={scale:1,positionX:0,positionY:0},Hd={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},tg={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},zw=function(e){var t,n,i,o;return{previousScale:(t=e.initialScale)!==null&&t!==void 0?t:mh.scale,scale:(n=e.initialScale)!==null&&n!==void 0?n:mh.scale,positionX:(i=e.initialPositionX)!==null&&i!==void 0?i:mh.positionX,positionY:(o=e.initialPositionY)!==null&&o!==void 0?o:mh.positionY}},E2=function(e){var t=zl({},Hd);return Object.keys(e).forEach(function(n){var i=typeof e[n]<"u",o=typeof Hd[n]<"u";if(o&&i){var a=Object.prototype.toString.call(Hd[n]),l=a==="[object Object]",c=a==="[object Array]";l?t[n]=zl(zl({},Hd[n]),e[n]):c?t[n]=S2(S2([],Hd[n],!0),e[n]):t[n]=e[n]}}),t},jw=function(e,t,n){var i=e.transformState.scale,o=e.wrapperComponent,a=e.setup,l=a.maxScale,c=a.minScale,u=a.zoomAnimation,d=a.smooth,h=u.size;if(!o)throw new Error("Wrapper is not mounted");var v=d?i*Math.exp(t*n):i+t*n,b=xf(Jo(v,3),c,l,h,!1);return b};function Fw(e,t,n,i,o){var a=e.wrapperComponent,l=e.transformState,c=l.scale,u=l.positionX,d=l.positionY;if(!a)return console.error("No WrapperComponent found");var h=a.offsetWidth,v=a.offsetHeight,b=(h/2-u)/c,g=(v/2-d)/c,A=jw(e,t,n),_=Zg(e,A,b,g);if(!_)return console.error("Error during zoom event. New transformation state was not calculated.");ql(e,_,i,o)}function Bw(e,t,n,i){var o=e.setup,a=e.wrapperComponent,l=o.limitToBounds,c=zw(e.props),u=e.transformState,d=u.scale,h=u.positionX,v=u.positionY;if(a){var b=Jg(e,c.scale),g=bf(c.positionX,c.positionY,b,l,0,0,a),A={scale:c.scale,positionX:g.x,positionY:g.y};d===c.scale&&h===c.positionX&&v===c.positionY||(i==null||i(),ql(e,A,t,n))}}function zC(e,t,n,i){var o=e.getBoundingClientRect(),a=t.getBoundingClientRect(),l=n.getBoundingClientRect(),c=a.x*i.scale,u=a.y*i.scale;return{x:(o.x-l.x+c)/i.scale,y:(o.y-l.y+u)/i.scale}}function jC(e,t,n){var i=e.wrapperComponent,o=e.contentComponent,a=e.transformState,l=e.setup,c=l.limitToBounds,u=l.minScale,d=l.maxScale;if(!i||!o)return a;var h=i.getBoundingClientRect(),v=t.getBoundingClientRect(),b=zC(t,i,o,a),g=b.x,A=b.y,_=v.width/a.scale,C=v.height/a.scale,E=i.offsetWidth/_,R=i.offsetHeight/C,k=xf(n||Math.min(E,R),u,d,0,!1),M=(h.width-_*k)/2,P=(h.height-C*k)/2,W=(h.left-g)*k+M,V=(h.top-A)*k+P,$=Jg(e,k),j=bf(W,V,$,c,0,0,i),X=j.x,z=j.y;return{positionX:X,positionY:z,scale:k}}var FC=function(e){return function(t,n,i){t===void 0&&(t=.5),n===void 0&&(n=300),i===void 0&&(i="easeOut"),Fw(e,1,t,n,i)}},BC=function(e){return function(t,n,i){t===void 0&&(t=.5),n===void 0&&(n=300),i===void 0&&(i="easeOut"),Fw(e,-1,t,n,i)}},qC=function(e){return function(t,n,i,o,a){o===void 0&&(o=300),a===void 0&&(a="easeOut");var l=e.transformState,c=l.positionX,u=l.positionY,d=l.scale,h=e.wrapperComponent,v=e.contentComponent,b=e.setup.disabled;if(!(b||!h||!v)){var g={positionX:Number.isNaN(t)?c:t,positionY:Number.isNaN(n)?u:n,scale:Number.isNaN(i)?d:i};ql(e,g,o,a)}}},HC=function(e){return function(t,n){t===void 0&&(t=200),n===void 0&&(n="easeOut"),Bw(e,t,n)}},GC=function(e){return function(t,n,i){n===void 0&&(n=200),i===void 0&&(i="easeOut");var o=e.transformState,a=e.wrapperComponent,l=e.contentComponent;if(a&&l){var c=qw(t||o.scale,a,l);ql(e,c,n,i)}}},VC=function(e){return function(t,n,i,o){i===void 0&&(i=600),o===void 0&&(o="easeOut"),Ta(e);var a=e.wrapperComponent,l=typeof t=="string"?document.getElementById(t):t;if(a&&l&&a.contains(l)){var c=jC(e,l,n);ql(e,c,i,o)}}},ng=function(e){return{instance:e,zoomIn:FC(e),zoomOut:BC(e),setTransform:qC(e),resetTransform:HC(e),centerView:GC(e),zoomToElement:VC(e)}},$C=function(e){return{instance:e,state:e.transformState}},ei=function(e){var t={};return Object.assign(t,$C(e)),Object.assign(t,ng(e)),t},fm=!1;function hm(){try{var e={get passive(){return fm=!0,!1}};return e}catch{return fm=!1,fm}}var gh=".".concat(tg.wrapperClass),Ap=function(e,t){return t.some(function(n){return e.matches("".concat(gh," ").concat(n,", ").concat(gh," .").concat(n,", ").concat(gh," ").concat(n," *, ").concat(gh," .").concat(n," *"))})},ig=function(e){e&&clearTimeout(e)},YC=function(e,t,n){return"translate(".concat(e,"px, ").concat(t,"px) scale(").concat(n,")")},qw=function(e,t,n){var i=n.offsetWidth*e,o=n.offsetHeight*e,a=(t.offsetWidth-i)/2,l=(t.offsetHeight-o)/2;return{scale:e,positionX:a,positionY:l}};function WC(e){return function(t){e.forEach(function(n){typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var XC=function(e,t){var n=e.setup.wheel,i=n.disabled,o=n.wheelDisabled,a=n.touchPadDisabled,l=n.excluded,c=e.isInitialized,u=e.isPanning,d=t.target,h=c&&!u&&!i&&d;if(!h||o&&!t.ctrlKey||a&&t.ctrlKey)return!1;var v=Ap(d,l);return!v},JC=function(e){return e?e.deltaY<0?1:-1:0};function KC(e,t){var n=JC(e),i=cC(t,n);return i}function Hw(e,t,n){var i=t.getBoundingClientRect(),o=0,a=0;if("clientX"in e)o=(e.clientX-i.left)/n,a=(e.clientY-i.top)/n;else{var l=e.touches[0];o=(l.clientX-i.left)/n,a=(l.clientY-i.top)/n}return(Number.isNaN(o)||Number.isNaN(a))&&console.error("No mouse or touch offset found"),{x:o,y:a}}var ZC=function(e,t,n,i,o){var a=e.transformState.scale,l=e.wrapperComponent,c=e.setup,u=c.maxScale,d=c.minScale,h=c.zoomAnimation,v=c.disablePadding,b=h.size,g=h.disabled;if(!l)throw new Error("Wrapper is not mounted");var A=a+t*n,_=i?!1:!g,C=xf(Jo(A,3),d,u,b,_&&!v);return C},QC=function(e,t){var n=e.previousWheelEvent,i=e.transformState.scale,o=e.setup,a=o.maxScale,l=o.minScale;return n?i<a||i>l||Math.sign(n.deltaY)!==Math.sign(t.deltaY)||n.deltaY>0&&n.deltaY<t.deltaY||n.deltaY<0&&n.deltaY>t.deltaY||Math.sign(n.deltaY)!==Math.sign(t.deltaY):!1},eT=function(e,t){var n=e.setup.pinch,i=n.disabled,o=n.excluded,a=e.isInitialized,l=t.target,c=a&&!i&&l;if(!c)return!1;var u=Ap(l,o);return!u},tT=function(e){var t=e.setup.pinch.disabled,n=e.isInitialized,i=e.pinchStartDistance,o=n&&!t&&i;return!!o},nT=function(e,t,n){var i=n.getBoundingClientRect(),o=e.touches,a=Jo(o[0].clientX-i.left,5),l=Jo(o[0].clientY-i.top,5),c=Jo(o[1].clientX-i.left,5),u=Jo(o[1].clientY-i.top,5);return{x:(a+c)/2/t,y:(l+u)/2/t}},Gw=function(e){return Math.sqrt(Math.pow(e.touches[0].pageX-e.touches[1].pageX,2)+Math.pow(e.touches[0].pageY-e.touches[1].pageY,2))},iT=function(e,t){var n=e.pinchStartScale,i=e.pinchStartDistance,o=e.setup,a=o.maxScale,l=o.minScale,c=o.zoomAnimation,u=o.disablePadding,d=c.size,h=c.disabled;if(!n||i===null||!t)throw new Error("Pinch touches distance was not provided");if(t<0)return e.transformState.scale;var v=t/i,b=v*n;return xf(Jo(b,2),l,a,d,!h&&!u)},rT=160,oT=100,aT=function(e,t){var n=e.props,i=n.onWheelStart,o=n.onZoomStart;e.wheelStopEventTimer||(Ta(e),hi(ei(e),t,i),hi(ei(e),t,o))},sT=function(e,t){var n=e.props,i=n.onWheel,o=n.onZoom,a=e.contentComponent,l=e.setup,c=e.transformState,u=c.scale,d=l.limitToBounds,h=l.centerZoomedOut,v=l.zoomAnimation,b=l.wheel,g=l.disablePadding,A=l.smooth,_=v.size,C=v.disabled,E=b.step,R=b.smoothStep;if(!a)throw new Error("Component not mounted");t.preventDefault(),t.stopPropagation();var k=KC(t,null),M=A?R*Math.abs(t.deltaY):E,P=ZC(e,k,M,!t.ctrlKey);if(u!==P){var W=Ac(e,P),V=Hw(t,a,u),$=C||_===0||h||g,j=d&&$,X=Np(e,V.x,V.y,P,W,j),z=X.x,U=X.y;e.previousWheelEvent=t,e.setTransformState(P,z,U),hi(ei(e),t,i),hi(ei(e),t,o)}},lT=function(e,t){var n=e.props,i=n.onWheelStop,o=n.onZoomStop;ig(e.wheelAnimationTimer),e.wheelAnimationTimer=setTimeout(function(){e.mounted&&(Uw(e,t.x,t.y),e.wheelAnimationTimer=null)},oT);var a=QC(e,t);a&&(ig(e.wheelStopEventTimer),e.wheelStopEventTimer=setTimeout(function(){e.mounted&&(e.wheelStopEventTimer=null,hi(ei(e),t,i),hi(ei(e),t,o))},rT))},Vw=function(e){for(var t=0,n=0,i=0;i<2;i+=1)t+=e.touches[i].clientX,n+=e.touches[i].clientY;var o=t/2,a=n/2;return{x:o,y:a}},cT=function(e,t){var n=Gw(t);e.pinchStartDistance=n,e.lastDistance=n,e.pinchStartScale=e.transformState.scale,e.isPanning=!1;var i=Vw(t);e.pinchLastCenterX=i.x,e.pinchLastCenterY=i.y,Ta(e)},uT=function(e,t){var n=e.contentComponent,i=e.pinchStartDistance,o=e.wrapperComponent,a=e.transformState.scale,l=e.setup,c=l.limitToBounds,u=l.centerZoomedOut,d=l.zoomAnimation,h=l.alignmentAnimation,v=d.disabled,b=d.size;if(!(i===null||!n)){var g=nT(t,a,n);if(!(!Number.isFinite(g.x)||!Number.isFinite(g.y))){var A=Gw(t),_=iT(e,A),C=Vw(t),E=C.x-(e.pinchLastCenterX||0),R=C.y-(e.pinchLastCenterY||0);if(!(_===a&&E===0&&R===0)){e.pinchLastCenterX=C.x,e.pinchLastCenterY=C.y;var k=Ac(e,_),M=v||b===0||u,P=c&&M,W=Np(e,g.x,g.y,_,k,P),V=W.x,$=W.y;e.pinchMidpoint=g,e.lastDistance=A;var j=h.sizeX,X=h.sizeY,z=Fl(e,j),U=Fl(e,X),q=V+E,I=$+R,ie=bf(q,I,k,c,z,U,o),J=ie.x,Y=ie.y;e.setTransformState(_,J,Y)}}}},dT=function(e){var t=e.pinchMidpoint;e.velocity=null,e.lastDistance=null,e.pinchMidpoint=null,e.pinchStartScale=null,e.pinchStartDistance=null,Uw(e,t==null?void 0:t.x,t==null?void 0:t.y)},$w=function(e,t){var n=e.props.onZoomStop,i=e.setup.doubleClick.animationTime;ig(e.doubleClickStopEventTimer),e.doubleClickStopEventTimer=setTimeout(function(){e.doubleClickStopEventTimer=null,hi(ei(e),t,n)},i)},fT=function(e,t){var n=e.props,i=n.onZoomStart,o=n.onZoom,a=e.setup.doubleClick,l=a.animationTime,c=a.animationType;hi(ei(e),t,i),Bw(e,l,c,function(){return hi(ei(e),t,o)}),$w(e,t)};function hT(e,t){return e==="toggle"?t===1?1:-1:e==="zoomOut"?-1:1}function pT(e,t){var n=e.setup,i=e.doubleClickStopEventTimer,o=e.transformState,a=e.contentComponent,l=o.scale,c=e.props,u=c.onZoomStart,d=c.onZoom,h=n.doubleClick,v=h.disabled,b=h.mode,g=h.step,A=h.animationTime,_=h.animationType;if(!v&&!i){if(b==="reset")return fT(e,t);if(!a)return console.error("No ContentComponent found");var C=hT(b,e.transformState.scale),E=jw(e,C,g);if(l!==E){hi(ei(e),t,u);var R=Hw(t,a,l),k=Zg(e,E,R.x,R.y);if(!k)return console.error("Error during zoom event. New transformation state was not calculated.");hi(ei(e),t,d),ql(e,k,A,_),$w(e,t)}}}var mT=function(e,t){var n=e.isInitialized,i=e.setup,o=e.wrapperComponent,a=i.doubleClick,l=a.disabled,c=a.excluded,u=t.target,d=o==null?void 0:o.contains(u),h=n&&u&&d&&!l;if(!h)return!1;var v=Ap(u,c);return!v},gT=(function(){function e(t){var n=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){n.initializeWindowEvents()},this.unmount=function(){n.cleanupWindowEvents()},this.update=function(i){n.props=i,Ac(n,n.transformState.scale),n.setup=E2(i)},this.initializeWindowEvents=function(){var i,o,a=hm(),l=(i=n.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,c=l==null?void 0:l.defaultView;(o=n.wrapperComponent)===null||o===void 0||o.addEventListener("wheel",n.onWheelPanning,a),c==null||c.addEventListener("mousedown",n.onPanningStart,a),c==null||c.addEventListener("mousemove",n.onPanning,a),c==null||c.addEventListener("mouseup",n.onPanningStop,a),l==null||l.addEventListener("mouseleave",n.clearPanning,a),c==null||c.addEventListener("keyup",n.setKeyUnPressed,a),c==null||c.addEventListener("keydown",n.setKeyPressed,a)},this.cleanupWindowEvents=function(){var i,o,a=hm(),l=(i=n.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,c=l==null?void 0:l.defaultView;c==null||c.removeEventListener("mousedown",n.onPanningStart,a),c==null||c.removeEventListener("mousemove",n.onPanning,a),c==null||c.removeEventListener("mouseup",n.onPanningStop,a),l==null||l.removeEventListener("mouseleave",n.clearPanning,a),c==null||c.removeEventListener("keyup",n.setKeyUnPressed,a),c==null||c.removeEventListener("keydown",n.setKeyPressed,a),document.removeEventListener("mouseleave",n.clearPanning,a),Ta(n),(o=n.observer)===null||o===void 0||o.disconnect()},this.handleInitializeWrapperEvents=function(i){var o=hm();i.addEventListener("wheel",n.onWheelZoom,o),i.addEventListener("dblclick",n.onDoubleClick,o),i.addEventListener("touchstart",n.onTouchPanningStart,o),i.addEventListener("touchmove",n.onTouchPanning,o),i.addEventListener("touchend",n.onTouchPanningStop,o)},this.handleInitialize=function(i,o){var a=!1,l=n.setup.centerOnInit,c=function(u,d){for(var h=0,v=u;h<v.length;h++){var b=v[h];if(b.target===d)return!0}return!1};n.applyTransformation(),n.onInitCallbacks.forEach(function(u){u(ei(n))}),n.observer=new ResizeObserver(function(u){if(c(u,i)||c(u,o))if(l&&!a){var d=o.offsetWidth,h=o.offsetHeight;(d>0||h>0)&&(a=!0,n.setCenter())}else Ta(n),Ac(n,n.transformState.scale),Kg(n,0)}),n.observer.observe(i),n.observer.observe(o)},this.onWheelZoom=function(i){var o=n.setup.disabled;if(!o){var a=XC(n,i);if(a){var l=n.isPressingKeys(n.setup.wheel.activationKeys);l&&(aT(n,i),sT(n,i),lT(n,i))}}},this.onWheelPanning=function(i){var o=n.setup,a=o.disabled,l=o.wheel,c=o.panning;if(!(!n.wrapperComponent||!n.contentComponent||a||!l.wheelDisabled||c.disabled||!c.wheelPanning||i.ctrlKey)){i.preventDefault(),i.stopPropagation();var u=n.transformState,d=u.positionX,h=u.positionY,v=d-i.deltaX,b=h-i.deltaY,g=c.lockAxisX?d:v,A=c.lockAxisY?h:b,_=n.setup.alignmentAnimation,C=_.sizeX,E=_.sizeY,R=Fl(n,C),k=Fl(n,E);g===d&&A===h||Ow(n,g,A,R,k)}},this.onPanningStart=function(i){var o=n.setup.disabled,a=n.props.onPanningStart;if(!o){var l=y2(n,i);if(l){var c=n.isPressingKeys(n.setup.panning.activationKeys);c&&(i.button===0&&!n.setup.panning.allowLeftClickPan||i.button===1&&!n.setup.panning.allowMiddleClickPan||i.button===2&&!n.setup.panning.allowRightClickPan||(i.preventDefault(),i.stopPropagation(),Ta(n),w2(n,i),hi(ei(n),i,a)))}}},this.onPanning=function(i){var o=n.setup.disabled,a=n.props.onPanning;if(!o){var l=b2(n);if(l){var c=n.isPressingKeys(n.setup.panning.activationKeys);c&&(i.preventDefault(),i.stopPropagation(),_2(n,i.clientX,i.clientY),hi(ei(n),i,a))}}},this.onPanningStop=function(i){var o=n.props.onPanningStop;n.isPanning&&(UC(n),hi(ei(n),i,o))},this.onPinchStart=function(i){var o=n.setup.disabled,a=n.props,l=a.onPinchingStart,c=a.onZoomStart;if(!o){var u=eT(n,i);u&&(cT(n,i),Ta(n),hi(ei(n),i,l),hi(ei(n),i,c))}},this.onPinch=function(i){var o=n.setup.disabled,a=n.props,l=a.onPinching,c=a.onZoom;if(!o){var u=tT(n);u&&(i.preventDefault(),i.stopPropagation(),uT(n,i),hi(ei(n),i,l),hi(ei(n),i,c))}},this.onPinchStop=function(i){var o=n.props,a=o.onPinchingStop,l=o.onZoomStop;n.pinchStartScale&&(dT(n),hi(ei(n),i,a),hi(ei(n),i,l))},this.onTouchPanningStart=function(i){var o=n.setup.disabled,a=n.props.onPanningStart;if(!o){var l=y2(n,i);if(l){var c=n.lastTouch&&+new Date-n.lastTouch<200&&i.touches.length===1;if(!c){n.lastTouch=+new Date,Ta(n);var u=i.touches,d=u.length===1,h=u.length===2;d&&(Ta(n),w2(n,i),hi(ei(n),i,a)),h&&n.onPinchStart(i)}}}},this.onTouchPanning=function(i){var o=n.setup.disabled,a=n.props.onPanning;if(n.isPanning&&i.touches.length===1){if(o)return;var l=b2(n);if(!l)return;i.preventDefault(),i.stopPropagation();var c=i.touches[0];_2(n,c.clientX,c.clientY),hi(ei(n),i,a)}else i.touches.length>1&&n.onPinch(i)},this.onTouchPanningStop=function(i){n.onPanningStop(i),n.onPinchStop(i)},this.onDoubleClick=function(i){var o=n.setup.disabled;if(!o){var a=mT(n,i);a&&pT(n,i)}},this.clearPanning=function(i){n.isPanning&&n.onPanningStop(i)},this.setKeyPressed=function(i){n.pressedKeys[i.key]=!0},this.setKeyUnPressed=function(i){n.pressedKeys[i.key]=!1},this.isPressingKeys=function(i){return i.length?!!i.find(function(o){return n.pressedKeys[o]}):!0},this.setTransformState=function(i,o,a){var l=n.props.onTransformed;if(!Number.isNaN(i)&&!Number.isNaN(o)&&!Number.isNaN(a)){i!==n.transformState.scale&&(n.transformState.previousScale=n.transformState.scale,n.transformState.scale=i),n.transformState.positionX=o,n.transformState.positionY=a,n.applyTransformation();var c=ei(n);n.onChangeCallbacks.forEach(function(u){return u(c)}),hi(c,{scale:i,positionX:o,positionY:a},l)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(n.wrapperComponent&&n.contentComponent){var i=qw(n.transformState.scale,n.wrapperComponent,n.contentComponent);n.setTransformState(i.scale,i.positionX,i.positionY)}},this.handleTransformStyles=function(i,o,a){return n.props.customTransform?n.props.customTransform(i,o,a):YC(i,o,a)},this.applyTransformation=function(){if(!(!n.mounted||!n.contentComponent)){var i=n.transformState,o=i.scale,a=i.positionX,l=i.positionY,c=n.handleTransformStyles(a,l,o);n.contentComponent.style.transform=c}},this.getContext=function(){return ei(n)},this.onChange=function(i){return n.onChangeCallbacks.has(i)||n.onChangeCallbacks.add(i),function(){n.onChangeCallbacks.delete(i)}},this.onInit=function(i){return n.onInitCallbacks.has(i)||n.onInitCallbacks.add(i),function(){n.onInitCallbacks.delete(i)}},this.init=function(i,o){n.cleanupWindowEvents(),n.wrapperComponent=i,n.contentComponent=o,Ac(n,n.transformState.scale),n.handleInitializeWrapperEvents(i),n.handleInitialize(i,o),n.initializeWindowEvents(),n.isInitialized=!0;var a=ei(n);hi(a,void 0,n.props.onInit)},this.props=t,this.setup=E2(this.props),this.transformState=zw(this.props)}return e})(),Cp=kn.createContext(null),vT=function(e,t){return typeof e=="function"?e(t):e},yT=kn.forwardRef(function(e,t){var n=de.useRef(new gT(e)).current,i=vT(e.children,ng(n));return de.useImperativeHandle(t,function(){return ng(n)},[n]),de.useEffect(function(){n.update(e)},[n,e]),kn.createElement(Cp.Provider,{value:n},i)});kn.forwardRef(function(e,t){var n=de.useRef(null),i=de.useContext(Cp);return de.useEffect(function(){return i.onChange(function(o){if(n.current){var a=0,l=0;n.current.style.transform=i.handleTransformStyles(a,l,1/o.instance.transformState.scale)}})},[i]),kn.createElement("div",zl({},e,{ref:WC([n,t])}))});function bT(e,t){t===void 0&&(t={});var n=t.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",n==="top"&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}var xT=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,N2={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};bT(xT);var A2=function(e){var t=e.children,n=e.wrapperClass,i=n===void 0?"":n,o=e.contentClass,a=o===void 0?"":o,l=e.wrapperStyle,c=e.contentStyle,u=e.wrapperProps,d=u===void 0?{}:u,h=e.contentProps,v=h===void 0?{}:h,b=de.useContext(Cp),g=b.init,A=b.cleanupWindowEvents,_=de.useRef(null),C=de.useRef(null);return de.useEffect(function(){var E=_.current,R=C.current;return E!==null&&R!==null&&g&&(g==null||g(E,R)),function(){A==null||A()}},[]),kn.createElement("div",zl({},d,{ref:_,className:"".concat(tg.wrapperClass," ").concat(N2.wrapper," ").concat(i),style:l}),kn.createElement("div",zl({},v,{ref:C,className:"".concat(tg.contentClass," ").concat(N2.content," ").concat(a),style:c}),t))},Qg=function(){var e=de.useContext(Cp);if(!e)throw new Error("Transform context must be placed inside TransformWrapper");return e};function vh(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pm={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var C2;function wT(){return C2||(C2=1,(function(e,t){(function(n){e.exports=n()})(function(){return(function n(i,o,a){function l(d,h){if(!o[d]){if(!i[d]){var v=typeof vh=="function"&&vh;if(!h&&v)return v(d,!0);if(c)return c(d,!0);var b=new Error("Cannot find module '"+d+"'");throw b.code="MODULE_NOT_FOUND",b}var g=o[d]={exports:{}};i[d][0].call(g.exports,function(A){var _=i[d][1][A];return l(_||A)},g,g.exports,n,i,o,a)}return o[d].exports}for(var c=typeof vh=="function"&&vh,u=0;u<a.length;u++)l(a[u]);return l})({1:[function(n,i,o){var a=n("./utils"),l=n("./support"),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(u){for(var d,h,v,b,g,A,_,C=[],E=0,R=u.length,k=R,M=a.getTypeOf(u)!=="string";E<u.length;)k=R-E,v=M?(d=u[E++],h=E<R?u[E++]:0,E<R?u[E++]:0):(d=u.charCodeAt(E++),h=E<R?u.charCodeAt(E++):0,E<R?u.charCodeAt(E++):0),b=d>>2,g=(3&d)<<4|h>>4,A=1<k?(15&h)<<2|v>>6:64,_=2<k?63&v:64,C.push(c.charAt(b)+c.charAt(g)+c.charAt(A)+c.charAt(_));return C.join("")},o.decode=function(u){var d,h,v,b,g,A,_=0,C=0,E="data:";if(u.substr(0,E.length)===E)throw new Error("Invalid base64 input, it looks like a data url.");var R,k=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===c.charAt(64)&&k--,u.charAt(u.length-2)===c.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(R=l.uint8array?new Uint8Array(0|k):new Array(0|k);_<u.length;)d=c.indexOf(u.charAt(_++))<<2|(b=c.indexOf(u.charAt(_++)))>>4,h=(15&b)<<4|(g=c.indexOf(u.charAt(_++)))>>2,v=(3&g)<<6|(A=c.indexOf(u.charAt(_++))),R[C++]=d,g!==64&&(R[C++]=h),A!==64&&(R[C++]=v);return R}},{"./support":30,"./utils":32}],2:[function(n,i,o){var a=n("./external"),l=n("./stream/DataWorker"),c=n("./stream/Crc32Probe"),u=n("./stream/DataLengthProbe");function d(h,v,b,g,A){this.compressedSize=h,this.uncompressedSize=v,this.crc32=b,this.compression=g,this.compressedContent=A}d.prototype={getContentWorker:function(){var h=new l(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),v=this;return h.on("end",function(){if(this.streamInfo.data_length!==v.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new l(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(h,v,b){return h.pipe(new c).pipe(new u("uncompressedSize")).pipe(v.compressWorker(b)).pipe(new u("compressedSize")).withStreamInfo("compression",v)},i.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,i,o){var a=n("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},o.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,i,o){var a=n("./utils"),l=(function(){for(var c,u=[],d=0;d<256;d++){c=d;for(var h=0;h<8;h++)c=1&c?3988292384^c>>>1:c>>>1;u[d]=c}return u})();i.exports=function(c,u){return c!==void 0&&c.length?a.getTypeOf(c)!=="string"?(function(d,h,v,b){var g=l,A=b+v;d^=-1;for(var _=b;_<A;_++)d=d>>>8^g[255&(d^h[_])];return-1^d})(0|u,c,c.length,0):(function(d,h,v,b){var g=l,A=b+v;d^=-1;for(var _=b;_<A;_++)d=d>>>8^g[255&(d^h.charCodeAt(_))];return-1^d})(0|u,c,c.length,0):0}},{"./utils":32}],5:[function(n,i,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(n,i,o){var a=null;a=typeof Promise<"u"?Promise:n("lie"),i.exports={Promise:a}},{lie:37}],7:[function(n,i,o){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=n("pako"),c=n("./utils"),u=n("./stream/GenericWorker"),d=a?"uint8array":"array";function h(v,b){u.call(this,"FlateWorker/"+v),this._pako=null,this._pakoAction=v,this._pakoOptions=b,this.meta={}}o.magic="\b\0",c.inherits(h,u),h.prototype.processChunk=function(v){this.meta=v.meta,this._pako===null&&this._createPako(),this._pako.push(c.transformTo(d,v.data),!1)},h.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var v=this;this._pako.onData=function(b){v.push({data:b,meta:v.meta})}},o.compressWorker=function(v){return new h("Deflate",v)},o.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,i,o){function a(g,A){var _,C="";for(_=0;_<A;_++)C+=String.fromCharCode(255&g),g>>>=8;return C}function l(g,A,_,C,E,R){var k,M,P=g.file,W=g.compression,V=R!==d.utf8encode,$=c.transformTo("string",R(P.name)),j=c.transformTo("string",d.utf8encode(P.name)),X=P.comment,z=c.transformTo("string",R(X)),U=c.transformTo("string",d.utf8encode(X)),q=j.length!==P.name.length,I=U.length!==X.length,ie="",J="",Y="",le=P.dir,pe=P.date,Ie={crc32:0,compressedSize:0,uncompressedSize:0};A&&!_||(Ie.crc32=g.crc32,Ie.compressedSize=g.compressedSize,Ie.uncompressedSize=g.uncompressedSize);var G=0;A&&(G|=8),V||!q&&!I||(G|=2048);var O=0,ee=0;le&&(O|=16),E==="UNIX"?(ee=798,O|=(function(ce,ye){var we=ce;return ce||(we=ye?16893:33204),(65535&we)<<16})(P.unixPermissions,le)):(ee=20,O|=(function(ce){return 63&(ce||0)})(P.dosPermissions)),k=pe.getUTCHours(),k<<=6,k|=pe.getUTCMinutes(),k<<=5,k|=pe.getUTCSeconds()/2,M=pe.getUTCFullYear()-1980,M<<=4,M|=pe.getUTCMonth()+1,M<<=5,M|=pe.getUTCDate(),q&&(J=a(1,1)+a(h($),4)+j,ie+="up"+a(J.length,2)+J),I&&(Y=a(1,1)+a(h(z),4)+U,ie+="uc"+a(Y.length,2)+Y);var te="";return te+=`
\0`,te+=a(G,2),te+=W.magic,te+=a(k,2),te+=a(M,2),te+=a(Ie.crc32,4),te+=a(Ie.compressedSize,4),te+=a(Ie.uncompressedSize,4),te+=a($.length,2),te+=a(ie.length,2),{fileRecord:v.LOCAL_FILE_HEADER+te+$+ie,dirRecord:v.CENTRAL_FILE_HEADER+a(ee,2)+te+a(z.length,2)+"\0\0\0\0"+a(O,4)+a(C,4)+$+ie+z}}var c=n("../utils"),u=n("../stream/GenericWorker"),d=n("../utf8"),h=n("../crc32"),v=n("../signature");function b(g,A,_,C){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=A,this.zipPlatform=_,this.encodeFileName=C,this.streamFiles=g,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}c.inherits(b,u),b.prototype.push=function(g){var A=g.meta.percent||0,_=this.entriesCount,C=this._sources.length;this.accumulate?this.contentBuffer.push(g):(this.bytesWritten+=g.data.length,u.prototype.push.call(this,{data:g.data,meta:{currentFile:this.currentFile,percent:_?(A+100*(_-C-1))/_:100}}))},b.prototype.openedSource=function(g){this.currentSourceOffset=this.bytesWritten,this.currentFile=g.file.name;var A=this.streamFiles&&!g.file.dir;if(A){var _=l(g,A,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:_.fileRecord,meta:{percent:0}})}else this.accumulate=!0},b.prototype.closedSource=function(g){this.accumulate=!1;var A=this.streamFiles&&!g.file.dir,_=l(g,A,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(_.dirRecord),A)this.push({data:(function(C){return v.DATA_DESCRIPTOR+a(C.crc32,4)+a(C.compressedSize,4)+a(C.uncompressedSize,4)})(g),meta:{percent:100}});else for(this.push({data:_.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},b.prototype.flush=function(){for(var g=this.bytesWritten,A=0;A<this.dirRecords.length;A++)this.push({data:this.dirRecords[A],meta:{percent:100}});var _=this.bytesWritten-g,C=(function(E,R,k,M,P){var W=c.transformTo("string",P(M));return v.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(E,2)+a(E,2)+a(R,4)+a(k,4)+a(W.length,2)+W})(this.dirRecords.length,_,g,this.zipComment,this.encodeFileName);this.push({data:C,meta:{percent:100}})},b.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},b.prototype.registerPrevious=function(g){this._sources.push(g);var A=this;return g.on("data",function(_){A.processChunk(_)}),g.on("end",function(){A.closedSource(A.previous.streamInfo),A._sources.length?A.prepareNextSource():A.end()}),g.on("error",function(_){A.error(_)}),this},b.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},b.prototype.error=function(g){var A=this._sources;if(!u.prototype.error.call(this,g))return!1;for(var _=0;_<A.length;_++)try{A[_].error(g)}catch{}return!0},b.prototype.lock=function(){u.prototype.lock.call(this);for(var g=this._sources,A=0;A<g.length;A++)g[A].lock()},i.exports=b},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,i,o){var a=n("../compressions"),l=n("./ZipFileWorker");o.generateWorker=function(c,u,d){var h=new l(u.streamFiles,d,u.platform,u.encodeFileName),v=0;try{c.forEach(function(b,g){v++;var A=(function(R,k){var M=R||k,P=a[M];if(!P)throw new Error(M+" is not a valid compression method !");return P})(g.options.compression,u.compression),_=g.options.compressionOptions||u.compressionOptions||{},C=g.dir,E=g.date;g._compressWorker(A,_).withStreamInfo("file",{name:b,dir:C,date:E,comment:g.comment||"",unixPermissions:g.unixPermissions,dosPermissions:g.dosPermissions}).pipe(h)}),h.entriesCount=v}catch(b){h.error(b)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,i,o){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new a;for(var c in this)typeof this[c]!="function"&&(l[c]=this[c]);return l}}(a.prototype=n("./object")).loadAsync=n("./load"),a.support=n("./support"),a.defaults=n("./defaults"),a.version="3.10.1",a.loadAsync=function(l,c){return new a().loadAsync(l,c)},a.external=n("./external"),i.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,i,o){var a=n("./utils"),l=n("./external"),c=n("./utf8"),u=n("./zipEntries"),d=n("./stream/Crc32Probe"),h=n("./nodejsUtils");function v(b){return new l.Promise(function(g,A){var _=b.decompressed.getContentWorker().pipe(new d);_.on("error",function(C){A(C)}).on("end",function(){_.streamInfo.crc32!==b.decompressed.crc32?A(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}i.exports=function(b,g){var A=this;return g=a.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:c.utf8decode}),h.isNode&&h.isStream(b)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",b,!0,g.optimizedBinaryString,g.base64).then(function(_){var C=new u(g);return C.load(_),C}).then(function(_){var C=[l.Promise.resolve(_)],E=_.files;if(g.checkCRC32)for(var R=0;R<E.length;R++)C.push(v(E[R]));return l.Promise.all(C)}).then(function(_){for(var C=_.shift(),E=C.files,R=0;R<E.length;R++){var k=E[R],M=k.fileNameStr,P=a.resolve(k.fileNameStr);A.file(P,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:g.createFolders}),k.dir||(A.file(P).unsafeOriginalName=M)}return C.zipComment.length&&(A.comment=C.zipComment),A})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,i,o){var a=n("../utils"),l=n("../stream/GenericWorker");function c(u,d){l.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(d)}a.inherits(c,l),c.prototype._bindStream=function(u){var d=this;(this._stream=u).pause(),u.on("data",function(h){d.push({data:h,meta:{percent:0}})}).on("error",function(h){d.isPaused?this.generatedError=h:d.error(h)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},c.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},c.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=c},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,i,o){var a=n("readable-stream").Readable;function l(c,u,d){a.call(this,u),this._helper=c;var h=this;c.on("data",function(v,b){h.push(v)||h._helper.pause(),d&&d(b)}).on("error",function(v){h.emit("error",v)}).on("end",function(){h.push(null)})}n("../utils").inherits(l,a),l.prototype._read=function(){this._helper.resume()},i.exports=l},{"../utils":32,"readable-stream":16}],14:[function(n,i,o){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(a,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,l);if(typeof a=="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,l)},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);var l=new Buffer(a);return l.fill(0),l},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on=="function"&&typeof a.pause=="function"&&typeof a.resume=="function"}}},{}],15:[function(n,i,o){function a(P,W,V){var $,j=c.getTypeOf(W),X=c.extend(V||{},h);X.date=X.date||new Date,X.compression!==null&&(X.compression=X.compression.toUpperCase()),typeof X.unixPermissions=="string"&&(X.unixPermissions=parseInt(X.unixPermissions,8)),X.unixPermissions&&16384&X.unixPermissions&&(X.dir=!0),X.dosPermissions&&16&X.dosPermissions&&(X.dir=!0),X.dir&&(P=E(P)),X.createFolders&&($=C(P))&&R.call(this,$,!0);var z=j==="string"&&X.binary===!1&&X.base64===!1;V&&V.binary!==void 0||(X.binary=!z),(W instanceof v&&W.uncompressedSize===0||X.dir||!W||W.length===0)&&(X.base64=!1,X.binary=!0,W="",X.compression="STORE",j="string");var U=null;U=W instanceof v||W instanceof u?W:A.isNode&&A.isStream(W)?new _(P,W):c.prepareContent(P,W,X.binary,X.optimizedBinaryString,X.base64);var q=new b(P,U,X);this.files[P]=q}var l=n("./utf8"),c=n("./utils"),u=n("./stream/GenericWorker"),d=n("./stream/StreamHelper"),h=n("./defaults"),v=n("./compressedObject"),b=n("./zipObject"),g=n("./generate"),A=n("./nodejsUtils"),_=n("./nodejs/NodejsStreamInputAdapter"),C=function(P){P.slice(-1)==="/"&&(P=P.substring(0,P.length-1));var W=P.lastIndexOf("/");return 0<W?P.substring(0,W):""},E=function(P){return P.slice(-1)!=="/"&&(P+="/"),P},R=function(P,W){return W=W!==void 0?W:h.createFolders,P=E(P),this.files[P]||a.call(this,P,null,{dir:!0,createFolders:W}),this.files[P]};function k(P){return Object.prototype.toString.call(P)==="[object RegExp]"}var M={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(P){var W,V,$;for(W in this.files)$=this.files[W],(V=W.slice(this.root.length,W.length))&&W.slice(0,this.root.length)===this.root&&P(V,$)},filter:function(P){var W=[];return this.forEach(function(V,$){P(V,$)&&W.push($)}),W},file:function(P,W,V){if(arguments.length!==1)return P=this.root+P,a.call(this,P,W,V),this;if(k(P)){var $=P;return this.filter(function(X,z){return!z.dir&&$.test(X)})}var j=this.files[this.root+P];return j&&!j.dir?j:null},folder:function(P){if(!P)return this;if(k(P))return this.filter(function(j,X){return X.dir&&P.test(j)});var W=this.root+P,V=R.call(this,W),$=this.clone();return $.root=V.name,$},remove:function(P){P=this.root+P;var W=this.files[P];if(W||(P.slice(-1)!=="/"&&(P+="/"),W=this.files[P]),W&&!W.dir)delete this.files[P];else for(var V=this.filter(function(j,X){return X.name.slice(0,P.length)===P}),$=0;$<V.length;$++)delete this.files[V[$].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(P){var W,V={};try{if((V=c.extend(P||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=V.type.toLowerCase(),V.compression=V.compression.toUpperCase(),V.type==="binarystring"&&(V.type="string"),!V.type)throw new Error("No output type specified.");c.checkSupport(V.type),V.platform!=="darwin"&&V.platform!=="freebsd"&&V.platform!=="linux"&&V.platform!=="sunos"||(V.platform="UNIX"),V.platform==="win32"&&(V.platform="DOS");var $=V.comment||this.comment||"";W=g.generateWorker(this,V,$)}catch(j){(W=new u("error")).error(j)}return new d(W,V.type||"string",V.mimeType)},generateAsync:function(P,W){return this.generateInternalStream(P).accumulate(W)},generateNodeStream:function(P,W){return(P=P||{}).type||(P.type="nodebuffer"),this.generateInternalStream(P).toNodejsStream(W)}};i.exports=M},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,i,o){i.exports=n("stream")},{stream:void 0}],17:[function(n,i,o){var a=n("./DataReader");function l(c){a.call(this,c);for(var u=0;u<this.data.length;u++)c[u]=255&c[u]}n("../utils").inherits(l,a),l.prototype.byteAt=function(c){return this.data[this.zero+c]},l.prototype.lastIndexOfSignature=function(c){for(var u=c.charCodeAt(0),d=c.charCodeAt(1),h=c.charCodeAt(2),v=c.charCodeAt(3),b=this.length-4;0<=b;--b)if(this.data[b]===u&&this.data[b+1]===d&&this.data[b+2]===h&&this.data[b+3]===v)return b-this.zero;return-1},l.prototype.readAndCheckSignature=function(c){var u=c.charCodeAt(0),d=c.charCodeAt(1),h=c.charCodeAt(2),v=c.charCodeAt(3),b=this.readData(4);return u===b[0]&&d===b[1]&&h===b[2]&&v===b[3]},l.prototype.readData=function(c){if(this.checkOffset(c),c===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,u},i.exports=l},{"../utils":32,"./DataReader":18}],18:[function(n,i,o){var a=n("../utils");function l(c){this.data=c,this.length=c.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(c){this.checkIndex(this.index+c)},checkIndex:function(c){if(this.length<this.zero+c||c<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+c+"). Corrupted zip ?")},setIndex:function(c){this.checkIndex(c),this.index=c},skip:function(c){this.setIndex(this.index+c)},byteAt:function(){},readInt:function(c){var u,d=0;for(this.checkOffset(c),u=this.index+c-1;u>=this.index;u--)d=(d<<8)+this.byteAt(u);return this.index+=c,d},readString:function(c){return a.transformTo("string",this.readData(c))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var c=this.readInt(4);return new Date(Date.UTC(1980+(c>>25&127),(c>>21&15)-1,c>>16&31,c>>11&31,c>>5&63,(31&c)<<1))}},i.exports=l},{"../utils":32}],19:[function(n,i,o){var a=n("./Uint8ArrayReader");function l(c){a.call(this,c)}n("../utils").inherits(l,a),l.prototype.readData=function(c){this.checkOffset(c);var u=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,u},i.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,i,o){var a=n("./DataReader");function l(c){a.call(this,c)}n("../utils").inherits(l,a),l.prototype.byteAt=function(c){return this.data.charCodeAt(this.zero+c)},l.prototype.lastIndexOfSignature=function(c){return this.data.lastIndexOf(c)-this.zero},l.prototype.readAndCheckSignature=function(c){return c===this.readData(4)},l.prototype.readData=function(c){this.checkOffset(c);var u=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,u},i.exports=l},{"../utils":32,"./DataReader":18}],21:[function(n,i,o){var a=n("./ArrayReader");function l(c){a.call(this,c)}n("../utils").inherits(l,a),l.prototype.readData=function(c){if(this.checkOffset(c),c===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+c);return this.index+=c,u},i.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(n,i,o){var a=n("../utils"),l=n("../support"),c=n("./ArrayReader"),u=n("./StringReader"),d=n("./NodeBufferReader"),h=n("./Uint8ArrayReader");i.exports=function(v){var b=a.getTypeOf(v);return a.checkSupport(b),b!=="string"||l.uint8array?b==="nodebuffer"?new d(v):l.uint8array?new h(a.transformTo("uint8array",v)):new c(a.transformTo("array",v)):new u(v)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,i,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,i,o){var a=n("./GenericWorker"),l=n("../utils");function c(u){a.call(this,"ConvertWorker to "+u),this.destType=u}l.inherits(c,a),c.prototype.processChunk=function(u){this.push({data:l.transformTo(this.destType,u.data),meta:u.meta})},i.exports=c},{"../utils":32,"./GenericWorker":28}],25:[function(n,i,o){var a=n("./GenericWorker"),l=n("../crc32");function c(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(c,a),c.prototype.processChunk=function(u){this.streamInfo.crc32=l(u.data,this.streamInfo.crc32||0),this.push(u)},i.exports=c},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,i,o){var a=n("../utils"),l=n("./GenericWorker");function c(u){l.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}a.inherits(c,l),c.prototype.processChunk=function(u){if(u){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+u.data.length}l.prototype.processChunk.call(this,u)},i.exports=c},{"../utils":32,"./GenericWorker":28}],27:[function(n,i,o){var a=n("../utils"),l=n("./GenericWorker");function c(u){l.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(h){d.dataIsReady=!0,d.data=h,d.max=h&&h.length||0,d.type=a.getTypeOf(h),d.isPaused||d._tickAndRepeat()},function(h){d.error(h)})}a.inherits(c,l),c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},c.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0)},c.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},c.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,d=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,d);break;case"uint8array":u=this.data.subarray(this.index,d);break;case"array":case"nodebuffer":u=this.data.slice(this.index,d)}return this.index=d,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=c},{"../utils":32,"./GenericWorker":28}],28:[function(n,i,o){function a(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,c){return this._listeners[l].push(c),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,c){if(this._listeners[l])for(var u=0;u<this._listeners[l].length;u++)this._listeners[l][u].call(this,c)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var c=this;return l.on("data",function(u){c.processChunk(u)}),l.on("end",function(){c.end()}),l.on("error",function(u){c.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,c){return this.extraStreamInfo[l]=c,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},i.exports=a},{}],29:[function(n,i,o){var a=n("../utils"),l=n("./ConvertWorker"),c=n("./GenericWorker"),u=n("../base64"),d=n("../support"),h=n("../external"),v=null;if(d.nodestream)try{v=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function b(A,_){return new h.Promise(function(C,E){var R=[],k=A._internalType,M=A._outputType,P=A._mimeType;A.on("data",function(W,V){R.push(W),_&&_(V)}).on("error",function(W){R=[],E(W)}).on("end",function(){try{var W=(function(V,$,j){switch(V){case"blob":return a.newBlob(a.transformTo("arraybuffer",$),j);case"base64":return u.encode($);default:return a.transformTo(V,$)}})(M,(function(V,$){var j,X=0,z=null,U=0;for(j=0;j<$.length;j++)U+=$[j].length;switch(V){case"string":return $.join("");case"array":return Array.prototype.concat.apply([],$);case"uint8array":for(z=new Uint8Array(U),j=0;j<$.length;j++)z.set($[j],X),X+=$[j].length;return z;case"nodebuffer":return Buffer.concat($);default:throw new Error("concat : unsupported type '"+V+"'")}})(k,R),P);C(W)}catch(V){E(V)}R=[]}).resume()})}function g(A,_,C){var E=_;switch(_){case"blob":case"arraybuffer":E="uint8array";break;case"base64":E="string"}try{this._internalType=E,this._outputType=_,this._mimeType=C,a.checkSupport(E),this._worker=A.pipe(new l(E)),A.lock()}catch(R){this._worker=new c("error"),this._worker.error(R)}}g.prototype={accumulate:function(A){return b(this,A)},on:function(A,_){var C=this;return A==="data"?this._worker.on(A,function(E){_.call(C,E.data,E.meta)}):this._worker.on(A,function(){a.delay(_,arguments,C)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(A){if(a.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new v(this,{objectMode:this._outputType!=="nodebuffer"},A)}},i.exports=g},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,i,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var a=new ArrayBuffer(0);try{o.blob=new Blob([a],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(a),o.blob=l.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!n("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(n,i,o){for(var a=n("./utils"),l=n("./support"),c=n("./nodejsUtils"),u=n("./stream/GenericWorker"),d=new Array(256),h=0;h<256;h++)d[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;d[254]=d[254]=1;function v(){u.call(this,"utf-8 decode"),this.leftOver=null}function b(){u.call(this,"utf-8 encode")}o.utf8encode=function(g){return l.nodebuffer?c.newBufferFrom(g,"utf-8"):(function(A){var _,C,E,R,k,M=A.length,P=0;for(R=0;R<M;R++)(64512&(C=A.charCodeAt(R)))==55296&&R+1<M&&(64512&(E=A.charCodeAt(R+1)))==56320&&(C=65536+(C-55296<<10)+(E-56320),R++),P+=C<128?1:C<2048?2:C<65536?3:4;for(_=l.uint8array?new Uint8Array(P):new Array(P),R=k=0;k<P;R++)(64512&(C=A.charCodeAt(R)))==55296&&R+1<M&&(64512&(E=A.charCodeAt(R+1)))==56320&&(C=65536+(C-55296<<10)+(E-56320),R++),C<128?_[k++]=C:(C<2048?_[k++]=192|C>>>6:(C<65536?_[k++]=224|C>>>12:(_[k++]=240|C>>>18,_[k++]=128|C>>>12&63),_[k++]=128|C>>>6&63),_[k++]=128|63&C);return _})(g)},o.utf8decode=function(g){return l.nodebuffer?a.transformTo("nodebuffer",g).toString("utf-8"):(function(A){var _,C,E,R,k=A.length,M=new Array(2*k);for(_=C=0;_<k;)if((E=A[_++])<128)M[C++]=E;else if(4<(R=d[E]))M[C++]=65533,_+=R-1;else{for(E&=R===2?31:R===3?15:7;1<R&&_<k;)E=E<<6|63&A[_++],R--;1<R?M[C++]=65533:E<65536?M[C++]=E:(E-=65536,M[C++]=55296|E>>10&1023,M[C++]=56320|1023&E)}return M.length!==C&&(M.subarray?M=M.subarray(0,C):M.length=C),a.applyFromCharCode(M)})(g=a.transformTo(l.uint8array?"uint8array":"array",g))},a.inherits(v,u),v.prototype.processChunk=function(g){var A=a.transformTo(l.uint8array?"uint8array":"array",g.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var _=A;(A=new Uint8Array(_.length+this.leftOver.length)).set(this.leftOver,0),A.set(_,this.leftOver.length)}else A=this.leftOver.concat(A);this.leftOver=null}var C=(function(R,k){var M;for((k=k||R.length)>R.length&&(k=R.length),M=k-1;0<=M&&(192&R[M])==128;)M--;return M<0||M===0?k:M+d[R[M]]>k?M:k})(A),E=A;C!==A.length&&(l.uint8array?(E=A.subarray(0,C),this.leftOver=A.subarray(C,A.length)):(E=A.slice(0,C),this.leftOver=A.slice(C,A.length))),this.push({data:o.utf8decode(E),meta:g.meta})},v.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=v,a.inherits(b,u),b.prototype.processChunk=function(g){this.push({data:o.utf8encode(g.data),meta:g.meta})},o.Utf8EncodeWorker=b},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,i,o){var a=n("./support"),l=n("./base64"),c=n("./nodejsUtils"),u=n("./external");function d(_){return _}function h(_,C){for(var E=0;E<_.length;++E)C[E]=255&_.charCodeAt(E);return C}n("setimmediate"),o.newBlob=function(_,C){o.checkSupport("blob");try{return new Blob([_],{type:C})}catch{try{var E=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return E.append(_),E.getBlob(C)}catch{throw new Error("Bug : can't construct the Blob.")}}};var v={stringifyByChunk:function(_,C,E){var R=[],k=0,M=_.length;if(M<=E)return String.fromCharCode.apply(null,_);for(;k<M;)C==="array"||C==="nodebuffer"?R.push(String.fromCharCode.apply(null,_.slice(k,Math.min(k+E,M)))):R.push(String.fromCharCode.apply(null,_.subarray(k,Math.min(k+E,M)))),k+=E;return R.join("")},stringifyByChar:function(_){for(var C="",E=0;E<_.length;E++)C+=String.fromCharCode(_[E]);return C},applyCanBeUsed:{uint8array:(function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,c.allocBuffer(1)).length===1}catch{return!1}})()}};function b(_){var C=65536,E=o.getTypeOf(_),R=!0;if(E==="uint8array"?R=v.applyCanBeUsed.uint8array:E==="nodebuffer"&&(R=v.applyCanBeUsed.nodebuffer),R)for(;1<C;)try{return v.stringifyByChunk(_,E,C)}catch{C=Math.floor(C/2)}return v.stringifyByChar(_)}function g(_,C){for(var E=0;E<_.length;E++)C[E]=_[E];return C}o.applyFromCharCode=b;var A={};A.string={string:d,array:function(_){return h(_,new Array(_.length))},arraybuffer:function(_){return A.string.uint8array(_).buffer},uint8array:function(_){return h(_,new Uint8Array(_.length))},nodebuffer:function(_){return h(_,c.allocBuffer(_.length))}},A.array={string:b,array:d,arraybuffer:function(_){return new Uint8Array(_).buffer},uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return c.newBufferFrom(_)}},A.arraybuffer={string:function(_){return b(new Uint8Array(_))},array:function(_){return g(new Uint8Array(_),new Array(_.byteLength))},arraybuffer:d,uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return c.newBufferFrom(new Uint8Array(_))}},A.uint8array={string:b,array:function(_){return g(_,new Array(_.length))},arraybuffer:function(_){return _.buffer},uint8array:d,nodebuffer:function(_){return c.newBufferFrom(_)}},A.nodebuffer={string:b,array:function(_){return g(_,new Array(_.length))},arraybuffer:function(_){return A.nodebuffer.uint8array(_).buffer},uint8array:function(_){return g(_,new Uint8Array(_.length))},nodebuffer:d},o.transformTo=function(_,C){if(C=C||"",!_)return C;o.checkSupport(_);var E=o.getTypeOf(C);return A[E][_](C)},o.resolve=function(_){for(var C=_.split("/"),E=[],R=0;R<C.length;R++){var k=C[R];k==="."||k===""&&R!==0&&R!==C.length-1||(k===".."?E.pop():E.push(k))}return E.join("/")},o.getTypeOf=function(_){return typeof _=="string"?"string":Object.prototype.toString.call(_)==="[object Array]"?"array":a.nodebuffer&&c.isBuffer(_)?"nodebuffer":a.uint8array&&_ instanceof Uint8Array?"uint8array":a.arraybuffer&&_ instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(_){if(!a[_.toLowerCase()])throw new Error(_+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(_){var C,E,R="";for(E=0;E<(_||"").length;E++)R+="\\x"+((C=_.charCodeAt(E))<16?"0":"")+C.toString(16).toUpperCase();return R},o.delay=function(_,C,E){setImmediate(function(){_.apply(E||null,C||[])})},o.inherits=function(_,C){function E(){}E.prototype=C.prototype,_.prototype=new E},o.extend=function(){var _,C,E={};for(_=0;_<arguments.length;_++)for(C in arguments[_])Object.prototype.hasOwnProperty.call(arguments[_],C)&&E[C]===void 0&&(E[C]=arguments[_][C]);return E},o.prepareContent=function(_,C,E,R,k){return u.Promise.resolve(C).then(function(M){return a.blob&&(M instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(M))!==-1)&&typeof FileReader<"u"?new u.Promise(function(P,W){var V=new FileReader;V.onload=function($){P($.target.result)},V.onerror=function($){W($.target.error)},V.readAsArrayBuffer(M)}):M}).then(function(M){var P=o.getTypeOf(M);return P?(P==="arraybuffer"?M=o.transformTo("uint8array",M):P==="string"&&(k?M=l.decode(M):E&&R!==!0&&(M=(function(W){return h(W,a.uint8array?new Uint8Array(W.length):new Array(W.length))})(M))),M):u.Promise.reject(new Error("Can't read the data of '"+_+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,i,o){var a=n("./reader/readerFor"),l=n("./utils"),c=n("./signature"),u=n("./zipEntry"),d=n("./support");function h(v){this.files=[],this.loadOptions=v}h.prototype={checkSignature:function(v){if(!this.reader.readAndCheckSignature(v)){this.reader.index-=4;var b=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(b)+", expected "+l.pretty(v)+")")}},isSignature:function(v,b){var g=this.reader.index;this.reader.setIndex(v);var A=this.reader.readString(4)===b;return this.reader.setIndex(g),A},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var v=this.reader.readData(this.zipCommentLength),b=d.uint8array?"uint8array":"array",g=l.transformTo(b,v);this.zipComment=this.loadOptions.decodeFileName(g)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var v,b,g,A=this.zip64EndOfCentralSize-44;0<A;)v=this.reader.readInt(2),b=this.reader.readInt(4),g=this.reader.readData(b),this.zip64ExtensibleData[v]={id:v,length:b,value:g}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var v,b;for(v=0;v<this.files.length;v++)b=this.files[v],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(c.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var v;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(c.CENTRAL_FILE_HEADER);)(v=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(v);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var v=this.reader.lastIndexOfSignature(c.CENTRAL_DIRECTORY_END);if(v<0)throw this.isSignature(0,c.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(v);var b=v;if(this.checkSignature(c.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(v=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(v),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,c.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var g=this.centralDirOffset+this.centralDirSize;this.zip64&&(g+=20,g+=12+this.zip64EndOfCentralSize);var A=b-g;if(0<A)this.isSignature(b,c.CENTRAL_FILE_HEADER)||(this.reader.zero=A);else if(A<0)throw new Error("Corrupted zip: missing "+Math.abs(A)+" bytes.")},prepareReader:function(v){this.reader=a(v)},load:function(v){this.prepareReader(v),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,i,o){var a=n("./reader/readerFor"),l=n("./utils"),c=n("./compressedObject"),u=n("./crc32"),d=n("./utf8"),h=n("./compressions"),v=n("./support");function b(g,A){this.options=g,this.loadOptions=A}b.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(g){var A,_;if(g.skip(22),this.fileNameLength=g.readInt(2),_=g.readInt(2),this.fileName=g.readData(this.fileNameLength),g.skip(_),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((A=(function(C){for(var E in h)if(Object.prototype.hasOwnProperty.call(h,E)&&h[E].magic===C)return h[E];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new c(this.compressedSize,this.uncompressedSize,this.crc32,A,g.readData(this.compressedSize))},readCentralPart:function(g){this.versionMadeBy=g.readInt(2),g.skip(2),this.bitFlag=g.readInt(2),this.compressionMethod=g.readString(2),this.date=g.readDate(),this.crc32=g.readInt(4),this.compressedSize=g.readInt(4),this.uncompressedSize=g.readInt(4);var A=g.readInt(2);if(this.extraFieldsLength=g.readInt(2),this.fileCommentLength=g.readInt(2),this.diskNumberStart=g.readInt(2),this.internalFileAttributes=g.readInt(2),this.externalFileAttributes=g.readInt(4),this.localHeaderOffset=g.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");g.skip(A),this.readExtraFields(g),this.parseZIP64ExtraField(g),this.fileComment=g.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var g=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),g==0&&(this.dosPermissions=63&this.externalFileAttributes),g==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var g=a(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=g.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=g.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=g.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=g.readInt(4))}},readExtraFields:function(g){var A,_,C,E=g.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});g.index+4<E;)A=g.readInt(2),_=g.readInt(2),C=g.readData(_),this.extraFields[A]={id:A,length:_,value:C};g.setIndex(E)},handleUTF8:function(){var g=v.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var A=this.findExtraFieldUnicodePath();if(A!==null)this.fileNameStr=A;else{var _=l.transformTo(g,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(_)}var C=this.findExtraFieldUnicodeComment();if(C!==null)this.fileCommentStr=C;else{var E=l.transformTo(g,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(E)}}},findExtraFieldUnicodePath:function(){var g=this.extraFields[28789];if(g){var A=a(g.value);return A.readInt(1)!==1||u(this.fileName)!==A.readInt(4)?null:d.utf8decode(A.readData(g.length-5))}return null},findExtraFieldUnicodeComment:function(){var g=this.extraFields[25461];if(g){var A=a(g.value);return A.readInt(1)!==1||u(this.fileComment)!==A.readInt(4)?null:d.utf8decode(A.readData(g.length-5))}return null}},i.exports=b},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,i,o){function a(A,_,C){this.name=A,this.dir=C.dir,this.date=C.date,this.comment=C.comment,this.unixPermissions=C.unixPermissions,this.dosPermissions=C.dosPermissions,this._data=_,this._dataBinary=C.binary,this.options={compression:C.compression,compressionOptions:C.compressionOptions}}var l=n("./stream/StreamHelper"),c=n("./stream/DataWorker"),u=n("./utf8"),d=n("./compressedObject"),h=n("./stream/GenericWorker");a.prototype={internalStream:function(A){var _=null,C="string";try{if(!A)throw new Error("No output type specified.");var E=(C=A.toLowerCase())==="string"||C==="text";C!=="binarystring"&&C!=="text"||(C="string"),_=this._decompressWorker();var R=!this._dataBinary;R&&!E&&(_=_.pipe(new u.Utf8EncodeWorker)),!R&&E&&(_=_.pipe(new u.Utf8DecodeWorker))}catch(k){(_=new h("error")).error(k)}return new l(_,C,"")},async:function(A,_){return this.internalStream(A).accumulate(_)},nodeStream:function(A,_){return this.internalStream(A||"nodebuffer").toNodejsStream(_)},_compressWorker:function(A,_){if(this._data instanceof d&&this._data.compression.magic===A.magic)return this._data.getCompressedWorker();var C=this._decompressWorker();return this._dataBinary||(C=C.pipe(new u.Utf8EncodeWorker)),d.createWorkerFrom(C,A,_)},_decompressWorker:function(){return this._data instanceof d?this._data.getContentWorker():this._data instanceof h?this._data:new c(this._data)}};for(var v=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],b=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},g=0;g<v.length;g++)a.prototype[v[g]]=b;i.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,i,o){(function(a){var l,c,u=a.MutationObserver||a.WebKitMutationObserver;if(u){var d=0,h=new u(A),v=a.document.createTextNode("");h.observe(v,{characterData:!0}),l=function(){v.data=d=++d%2}}else if(a.setImmediate||a.MessageChannel===void 0)l="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var _=a.document.createElement("script");_.onreadystatechange=function(){A(),_.onreadystatechange=null,_.parentNode.removeChild(_),_=null},a.document.documentElement.appendChild(_)}:function(){setTimeout(A,0)};else{var b=new a.MessageChannel;b.port1.onmessage=A,l=function(){b.port2.postMessage(0)}}var g=[];function A(){var _,C;c=!0;for(var E=g.length;E;){for(C=g,g=[],_=-1;++_<E;)C[_]();E=g.length}c=!1}i.exports=function(_){g.push(_)!==1||c||l()}}).call(this,typeof ph<"u"?ph:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,i,o){var a=n("immediate");function l(){}var c={},u=["REJECTED"],d=["FULFILLED"],h=["PENDING"];function v(E){if(typeof E!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,E!==l&&_(this,E)}function b(E,R,k){this.promise=E,typeof R=="function"&&(this.onFulfilled=R,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function g(E,R,k){a(function(){var M;try{M=R(k)}catch(P){return c.reject(E,P)}M===E?c.reject(E,new TypeError("Cannot resolve promise with itself")):c.resolve(E,M)})}function A(E){var R=E&&E.then;if(E&&(typeof E=="object"||typeof E=="function")&&typeof R=="function")return function(){R.apply(E,arguments)}}function _(E,R){var k=!1;function M(V){k||(k=!0,c.reject(E,V))}function P(V){k||(k=!0,c.resolve(E,V))}var W=C(function(){R(P,M)});W.status==="error"&&M(W.value)}function C(E,R){var k={};try{k.value=E(R),k.status="success"}catch(M){k.status="error",k.value=M}return k}(i.exports=v).prototype.finally=function(E){if(typeof E!="function")return this;var R=this.constructor;return this.then(function(k){return R.resolve(E()).then(function(){return k})},function(k){return R.resolve(E()).then(function(){throw k})})},v.prototype.catch=function(E){return this.then(null,E)},v.prototype.then=function(E,R){if(typeof E!="function"&&this.state===d||typeof R!="function"&&this.state===u)return this;var k=new this.constructor(l);return this.state!==h?g(k,this.state===d?E:R,this.outcome):this.queue.push(new b(k,E,R)),k},b.prototype.callFulfilled=function(E){c.resolve(this.promise,E)},b.prototype.otherCallFulfilled=function(E){g(this.promise,this.onFulfilled,E)},b.prototype.callRejected=function(E){c.reject(this.promise,E)},b.prototype.otherCallRejected=function(E){g(this.promise,this.onRejected,E)},c.resolve=function(E,R){var k=C(A,R);if(k.status==="error")return c.reject(E,k.value);var M=k.value;if(M)_(E,M);else{E.state=d,E.outcome=R;for(var P=-1,W=E.queue.length;++P<W;)E.queue[P].callFulfilled(R)}return E},c.reject=function(E,R){E.state=u,E.outcome=R;for(var k=-1,M=E.queue.length;++k<M;)E.queue[k].callRejected(R);return E},v.resolve=function(E){return E instanceof this?E:c.resolve(new this(l),E)},v.reject=function(E){var R=new this(l);return c.reject(R,E)},v.all=function(E){var R=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=E.length,M=!1;if(!k)return this.resolve([]);for(var P=new Array(k),W=0,V=-1,$=new this(l);++V<k;)j(E[V],V);return $;function j(X,z){R.resolve(X).then(function(U){P[z]=U,++W!==k||M||(M=!0,c.resolve($,P))},function(U){M||(M=!0,c.reject($,U))})}},v.race=function(E){var R=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=E.length,M=!1;if(!k)return this.resolve([]);for(var P=-1,W=new this(l);++P<k;)V=E[P],R.resolve(V).then(function($){M||(M=!0,c.resolve(W,$))},function($){M||(M=!0,c.reject(W,$))});var V;return W}},{immediate:36}],38:[function(n,i,o){var a={};(0,n("./lib/utils/common").assign)(a,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),i.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,i,o){var a=n("./zlib/deflate"),l=n("./utils/common"),c=n("./utils/strings"),u=n("./zlib/messages"),d=n("./zlib/zstream"),h=Object.prototype.toString,v=0,b=-1,g=0,A=8;function _(E){if(!(this instanceof _))return new _(E);this.options=l.assign({level:b,method:A,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:""},E||{});var R=this.options;R.raw&&0<R.windowBits?R.windowBits=-R.windowBits:R.gzip&&0<R.windowBits&&R.windowBits<16&&(R.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var k=a.deflateInit2(this.strm,R.level,R.method,R.windowBits,R.memLevel,R.strategy);if(k!==v)throw new Error(u[k]);if(R.header&&a.deflateSetHeader(this.strm,R.header),R.dictionary){var M;if(M=typeof R.dictionary=="string"?c.string2buf(R.dictionary):h.call(R.dictionary)==="[object ArrayBuffer]"?new Uint8Array(R.dictionary):R.dictionary,(k=a.deflateSetDictionary(this.strm,M))!==v)throw new Error(u[k]);this._dict_set=!0}}function C(E,R){var k=new _(R);if(k.push(E,!0),k.err)throw k.msg||u[k.err];return k.result}_.prototype.push=function(E,R){var k,M,P=this.strm,W=this.options.chunkSize;if(this.ended)return!1;M=R===~~R?R:R===!0?4:0,typeof E=="string"?P.input=c.string2buf(E):h.call(E)==="[object ArrayBuffer]"?P.input=new Uint8Array(E):P.input=E,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new l.Buf8(W),P.next_out=0,P.avail_out=W),(k=a.deflate(P,M))!==1&&k!==v)return this.onEnd(k),!(this.ended=!0);P.avail_out!==0&&(P.avail_in!==0||M!==4&&M!==2)||(this.options.to==="string"?this.onData(c.buf2binstring(l.shrinkBuf(P.output,P.next_out))):this.onData(l.shrinkBuf(P.output,P.next_out)))}while((0<P.avail_in||P.avail_out===0)&&k!==1);return M===4?(k=a.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===v):M!==2||(this.onEnd(v),!(P.avail_out=0))},_.prototype.onData=function(E){this.chunks.push(E)},_.prototype.onEnd=function(E){E===v&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=E,this.msg=this.strm.msg},o.Deflate=_,o.deflate=C,o.deflateRaw=function(E,R){return(R=R||{}).raw=!0,C(E,R)},o.gzip=function(E,R){return(R=R||{}).gzip=!0,C(E,R)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,i,o){var a=n("./zlib/inflate"),l=n("./utils/common"),c=n("./utils/strings"),u=n("./zlib/constants"),d=n("./zlib/messages"),h=n("./zlib/zstream"),v=n("./zlib/gzheader"),b=Object.prototype.toString;function g(_){if(!(this instanceof g))return new g(_);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},_||{});var C=this.options;C.raw&&0<=C.windowBits&&C.windowBits<16&&(C.windowBits=-C.windowBits,C.windowBits===0&&(C.windowBits=-15)),!(0<=C.windowBits&&C.windowBits<16)||_&&_.windowBits||(C.windowBits+=32),15<C.windowBits&&C.windowBits<48&&(15&C.windowBits)==0&&(C.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var E=a.inflateInit2(this.strm,C.windowBits);if(E!==u.Z_OK)throw new Error(d[E]);this.header=new v,a.inflateGetHeader(this.strm,this.header)}function A(_,C){var E=new g(C);if(E.push(_,!0),E.err)throw E.msg||d[E.err];return E.result}g.prototype.push=function(_,C){var E,R,k,M,P,W,V=this.strm,$=this.options.chunkSize,j=this.options.dictionary,X=!1;if(this.ended)return!1;R=C===~~C?C:C===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof _=="string"?V.input=c.binstring2buf(_):b.call(_)==="[object ArrayBuffer]"?V.input=new Uint8Array(_):V.input=_,V.next_in=0,V.avail_in=V.input.length;do{if(V.avail_out===0&&(V.output=new l.Buf8($),V.next_out=0,V.avail_out=$),(E=a.inflate(V,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&j&&(W=typeof j=="string"?c.string2buf(j):b.call(j)==="[object ArrayBuffer]"?new Uint8Array(j):j,E=a.inflateSetDictionary(this.strm,W)),E===u.Z_BUF_ERROR&&X===!0&&(E=u.Z_OK,X=!1),E!==u.Z_STREAM_END&&E!==u.Z_OK)return this.onEnd(E),!(this.ended=!0);V.next_out&&(V.avail_out!==0&&E!==u.Z_STREAM_END&&(V.avail_in!==0||R!==u.Z_FINISH&&R!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=c.utf8border(V.output,V.next_out),M=V.next_out-k,P=c.buf2string(V.output,k),V.next_out=M,V.avail_out=$-M,M&&l.arraySet(V.output,V.output,k,M,0),this.onData(P)):this.onData(l.shrinkBuf(V.output,V.next_out)))),V.avail_in===0&&V.avail_out===0&&(X=!0)}while((0<V.avail_in||V.avail_out===0)&&E!==u.Z_STREAM_END);return E===u.Z_STREAM_END&&(R=u.Z_FINISH),R===u.Z_FINISH?(E=a.inflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===u.Z_OK):R!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(V.avail_out=0))},g.prototype.onData=function(_){this.chunks.push(_)},g.prototype.onEnd=function(_){_===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},o.Inflate=g,o.inflate=A,o.inflateRaw=function(_,C){return(C=C||{}).raw=!0,A(_,C)},o.ungzip=A},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,i,o){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(u){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var h=d.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var v in h)h.hasOwnProperty(v)&&(u[v]=h[v])}}return u},o.shrinkBuf=function(u,d){return u.length===d?u:u.subarray?u.subarray(0,d):(u.length=d,u)};var l={arraySet:function(u,d,h,v,b){if(d.subarray&&u.subarray)u.set(d.subarray(h,h+v),b);else for(var g=0;g<v;g++)u[b+g]=d[h+g]},flattenChunks:function(u){var d,h,v,b,g,A;for(d=v=0,h=u.length;d<h;d++)v+=u[d].length;for(A=new Uint8Array(v),d=b=0,h=u.length;d<h;d++)g=u[d],A.set(g,b),b+=g.length;return A}},c={arraySet:function(u,d,h,v,b){for(var g=0;g<v;g++)u[b+g]=d[h+g]},flattenChunks:function(u){return[].concat.apply([],u)}};o.setTyped=function(u){u?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,l)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,c))},o.setTyped(a)},{}],42:[function(n,i,o){var a=n("./common"),l=!0,c=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{c=!1}for(var u=new a.Buf8(256),d=0;d<256;d++)u[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;function h(v,b){if(b<65537&&(v.subarray&&c||!v.subarray&&l))return String.fromCharCode.apply(null,a.shrinkBuf(v,b));for(var g="",A=0;A<b;A++)g+=String.fromCharCode(v[A]);return g}u[254]=u[254]=1,o.string2buf=function(v){var b,g,A,_,C,E=v.length,R=0;for(_=0;_<E;_++)(64512&(g=v.charCodeAt(_)))==55296&&_+1<E&&(64512&(A=v.charCodeAt(_+1)))==56320&&(g=65536+(g-55296<<10)+(A-56320),_++),R+=g<128?1:g<2048?2:g<65536?3:4;for(b=new a.Buf8(R),_=C=0;C<R;_++)(64512&(g=v.charCodeAt(_)))==55296&&_+1<E&&(64512&(A=v.charCodeAt(_+1)))==56320&&(g=65536+(g-55296<<10)+(A-56320),_++),g<128?b[C++]=g:(g<2048?b[C++]=192|g>>>6:(g<65536?b[C++]=224|g>>>12:(b[C++]=240|g>>>18,b[C++]=128|g>>>12&63),b[C++]=128|g>>>6&63),b[C++]=128|63&g);return b},o.buf2binstring=function(v){return h(v,v.length)},o.binstring2buf=function(v){for(var b=new a.Buf8(v.length),g=0,A=b.length;g<A;g++)b[g]=v.charCodeAt(g);return b},o.buf2string=function(v,b){var g,A,_,C,E=b||v.length,R=new Array(2*E);for(g=A=0;g<E;)if((_=v[g++])<128)R[A++]=_;else if(4<(C=u[_]))R[A++]=65533,g+=C-1;else{for(_&=C===2?31:C===3?15:7;1<C&&g<E;)_=_<<6|63&v[g++],C--;1<C?R[A++]=65533:_<65536?R[A++]=_:(_-=65536,R[A++]=55296|_>>10&1023,R[A++]=56320|1023&_)}return h(R,A)},o.utf8border=function(v,b){var g;for((b=b||v.length)>v.length&&(b=v.length),g=b-1;0<=g&&(192&v[g])==128;)g--;return g<0||g===0?b:g+u[v[g]]>b?g:b}},{"./common":41}],43:[function(n,i,o){i.exports=function(a,l,c,u){for(var d=65535&a|0,h=a>>>16&65535|0,v=0;c!==0;){for(c-=v=2e3<c?2e3:c;h=h+(d=d+l[u++]|0)|0,--v;);d%=65521,h%=65521}return d|h<<16|0}},{}],44:[function(n,i,o){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,i,o){var a=(function(){for(var l,c=[],u=0;u<256;u++){l=u;for(var d=0;d<8;d++)l=1&l?3988292384^l>>>1:l>>>1;c[u]=l}return c})();i.exports=function(l,c,u,d){var h=a,v=d+u;l^=-1;for(var b=d;b<v;b++)l=l>>>8^h[255&(l^c[b])];return-1^l}},{}],46:[function(n,i,o){var a,l=n("../utils/common"),c=n("./trees"),u=n("./adler32"),d=n("./crc32"),h=n("./messages"),v=0,b=4,g=0,A=-2,_=-1,C=4,E=2,R=8,k=9,M=286,P=30,W=19,V=2*M+1,$=15,j=3,X=258,z=X+j+1,U=42,q=113,I=1,ie=2,J=3,Y=4;function le(B,K){return B.msg=h[K],K}function pe(B){return(B<<1)-(4<B?9:0)}function Ie(B){for(var K=B.length;0<=--K;)B[K]=0}function G(B){var K=B.state,_e=K.pending;_e>B.avail_out&&(_e=B.avail_out),_e!==0&&(l.arraySet(B.output,K.pending_buf,K.pending_out,_e,B.next_out),B.next_out+=_e,K.pending_out+=_e,B.total_out+=_e,B.avail_out-=_e,K.pending-=_e,K.pending===0&&(K.pending_out=0))}function O(B,K){c._tr_flush_block(B,0<=B.block_start?B.block_start:-1,B.strstart-B.block_start,K),B.block_start=B.strstart,G(B.strm)}function ee(B,K){B.pending_buf[B.pending++]=K}function te(B,K){B.pending_buf[B.pending++]=K>>>8&255,B.pending_buf[B.pending++]=255&K}function ce(B,K){var _e,he,ne=B.max_chain_length,ae=B.strstart,be=B.prev_length,Me=B.nice_match,Se=B.strstart>B.w_size-z?B.strstart-(B.w_size-z):0,He=B.window,Ne=B.w_mask,ze=B.prev,We=B.strstart+X,dt=He[ae+be-1],ft=He[ae+be];B.prev_length>=B.good_match&&(ne>>=2),Me>B.lookahead&&(Me=B.lookahead);do if(He[(_e=K)+be]===ft&&He[_e+be-1]===dt&&He[_e]===He[ae]&&He[++_e]===He[ae+1]){ae+=2,_e++;do;while(He[++ae]===He[++_e]&&He[++ae]===He[++_e]&&He[++ae]===He[++_e]&&He[++ae]===He[++_e]&&He[++ae]===He[++_e]&&He[++ae]===He[++_e]&&He[++ae]===He[++_e]&&He[++ae]===He[++_e]&&ae<We);if(he=X-(We-ae),ae=We-X,be<he){if(B.match_start=K,Me<=(be=he))break;dt=He[ae+be-1],ft=He[ae+be]}}while((K=ze[K&Ne])>Se&&--ne!=0);return be<=B.lookahead?be:B.lookahead}function ye(B){var K,_e,he,ne,ae,be,Me,Se,He,Ne,ze=B.w_size;do{if(ne=B.window_size-B.lookahead-B.strstart,B.strstart>=ze+(ze-z)){for(l.arraySet(B.window,B.window,ze,ze,0),B.match_start-=ze,B.strstart-=ze,B.block_start-=ze,K=_e=B.hash_size;he=B.head[--K],B.head[K]=ze<=he?he-ze:0,--_e;);for(K=_e=ze;he=B.prev[--K],B.prev[K]=ze<=he?he-ze:0,--_e;);ne+=ze}if(B.strm.avail_in===0)break;if(be=B.strm,Me=B.window,Se=B.strstart+B.lookahead,He=ne,Ne=void 0,Ne=be.avail_in,He<Ne&&(Ne=He),_e=Ne===0?0:(be.avail_in-=Ne,l.arraySet(Me,be.input,be.next_in,Ne,Se),be.state.wrap===1?be.adler=u(be.adler,Me,Ne,Se):be.state.wrap===2&&(be.adler=d(be.adler,Me,Ne,Se)),be.next_in+=Ne,be.total_in+=Ne,Ne),B.lookahead+=_e,B.lookahead+B.insert>=j)for(ae=B.strstart-B.insert,B.ins_h=B.window[ae],B.ins_h=(B.ins_h<<B.hash_shift^B.window[ae+1])&B.hash_mask;B.insert&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[ae+j-1])&B.hash_mask,B.prev[ae&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=ae,ae++,B.insert--,!(B.lookahead+B.insert<j)););}while(B.lookahead<z&&B.strm.avail_in!==0)}function we(B,K){for(var _e,he;;){if(B.lookahead<z){if(ye(B),B.lookahead<z&&K===v)return I;if(B.lookahead===0)break}if(_e=0,B.lookahead>=j&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+j-1])&B.hash_mask,_e=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),_e!==0&&B.strstart-_e<=B.w_size-z&&(B.match_length=ce(B,_e)),B.match_length>=j)if(he=c._tr_tally(B,B.strstart-B.match_start,B.match_length-j),B.lookahead-=B.match_length,B.match_length<=B.max_lazy_match&&B.lookahead>=j){for(B.match_length--;B.strstart++,B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+j-1])&B.hash_mask,_e=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart,--B.match_length!=0;);B.strstart++}else B.strstart+=B.match_length,B.match_length=0,B.ins_h=B.window[B.strstart],B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+1])&B.hash_mask;else he=c._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++;if(he&&(O(B,!1),B.strm.avail_out===0))return I}return B.insert=B.strstart<j-1?B.strstart:j-1,K===b?(O(B,!0),B.strm.avail_out===0?J:Y):B.last_lit&&(O(B,!1),B.strm.avail_out===0)?I:ie}function Te(B,K){for(var _e,he,ne;;){if(B.lookahead<z){if(ye(B),B.lookahead<z&&K===v)return I;if(B.lookahead===0)break}if(_e=0,B.lookahead>=j&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+j-1])&B.hash_mask,_e=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),B.prev_length=B.match_length,B.prev_match=B.match_start,B.match_length=j-1,_e!==0&&B.prev_length<B.max_lazy_match&&B.strstart-_e<=B.w_size-z&&(B.match_length=ce(B,_e),B.match_length<=5&&(B.strategy===1||B.match_length===j&&4096<B.strstart-B.match_start)&&(B.match_length=j-1)),B.prev_length>=j&&B.match_length<=B.prev_length){for(ne=B.strstart+B.lookahead-j,he=c._tr_tally(B,B.strstart-1-B.prev_match,B.prev_length-j),B.lookahead-=B.prev_length-1,B.prev_length-=2;++B.strstart<=ne&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+j-1])&B.hash_mask,_e=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),--B.prev_length!=0;);if(B.match_available=0,B.match_length=j-1,B.strstart++,he&&(O(B,!1),B.strm.avail_out===0))return I}else if(B.match_available){if((he=c._tr_tally(B,0,B.window[B.strstart-1]))&&O(B,!1),B.strstart++,B.lookahead--,B.strm.avail_out===0)return I}else B.match_available=1,B.strstart++,B.lookahead--}return B.match_available&&(he=c._tr_tally(B,0,B.window[B.strstart-1]),B.match_available=0),B.insert=B.strstart<j-1?B.strstart:j-1,K===b?(O(B,!0),B.strm.avail_out===0?J:Y):B.last_lit&&(O(B,!1),B.strm.avail_out===0)?I:ie}function Ce(B,K,_e,he,ne){this.good_length=B,this.max_lazy=K,this.nice_length=_e,this.max_chain=he,this.func=ne}function De(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=R,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*V),this.dyn_dtree=new l.Buf16(2*(2*P+1)),this.bl_tree=new l.Buf16(2*(2*W+1)),Ie(this.dyn_ltree),Ie(this.dyn_dtree),Ie(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16($+1),this.heap=new l.Buf16(2*M+1),Ie(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*M+1),Ie(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function $e(B){var K;return B&&B.state?(B.total_in=B.total_out=0,B.data_type=E,(K=B.state).pending=0,K.pending_out=0,K.wrap<0&&(K.wrap=-K.wrap),K.status=K.wrap?U:q,B.adler=K.wrap===2?0:1,K.last_flush=v,c._tr_init(K),g):le(B,A)}function at(B){var K=$e(B);return K===g&&(function(_e){_e.window_size=2*_e.w_size,Ie(_e.head),_e.max_lazy_match=a[_e.level].max_lazy,_e.good_match=a[_e.level].good_length,_e.nice_match=a[_e.level].nice_length,_e.max_chain_length=a[_e.level].max_chain,_e.strstart=0,_e.block_start=0,_e.lookahead=0,_e.insert=0,_e.match_length=_e.prev_length=j-1,_e.match_available=0,_e.ins_h=0})(B.state),K}function st(B,K,_e,he,ne,ae){if(!B)return A;var be=1;if(K===_&&(K=6),he<0?(be=0,he=-he):15<he&&(be=2,he-=16),ne<1||k<ne||_e!==R||he<8||15<he||K<0||9<K||ae<0||C<ae)return le(B,A);he===8&&(he=9);var Me=new De;return(B.state=Me).strm=B,Me.wrap=be,Me.gzhead=null,Me.w_bits=he,Me.w_size=1<<Me.w_bits,Me.w_mask=Me.w_size-1,Me.hash_bits=ne+7,Me.hash_size=1<<Me.hash_bits,Me.hash_mask=Me.hash_size-1,Me.hash_shift=~~((Me.hash_bits+j-1)/j),Me.window=new l.Buf8(2*Me.w_size),Me.head=new l.Buf16(Me.hash_size),Me.prev=new l.Buf16(Me.w_size),Me.lit_bufsize=1<<ne+6,Me.pending_buf_size=4*Me.lit_bufsize,Me.pending_buf=new l.Buf8(Me.pending_buf_size),Me.d_buf=1*Me.lit_bufsize,Me.l_buf=3*Me.lit_bufsize,Me.level=K,Me.strategy=ae,Me.method=_e,at(B)}a=[new Ce(0,0,0,0,function(B,K){var _e=65535;for(_e>B.pending_buf_size-5&&(_e=B.pending_buf_size-5);;){if(B.lookahead<=1){if(ye(B),B.lookahead===0&&K===v)return I;if(B.lookahead===0)break}B.strstart+=B.lookahead,B.lookahead=0;var he=B.block_start+_e;if((B.strstart===0||B.strstart>=he)&&(B.lookahead=B.strstart-he,B.strstart=he,O(B,!1),B.strm.avail_out===0)||B.strstart-B.block_start>=B.w_size-z&&(O(B,!1),B.strm.avail_out===0))return I}return B.insert=0,K===b?(O(B,!0),B.strm.avail_out===0?J:Y):(B.strstart>B.block_start&&(O(B,!1),B.strm.avail_out),I)}),new Ce(4,4,8,4,we),new Ce(4,5,16,8,we),new Ce(4,6,32,32,we),new Ce(4,4,16,16,Te),new Ce(8,16,32,32,Te),new Ce(8,16,128,128,Te),new Ce(8,32,128,256,Te),new Ce(32,128,258,1024,Te),new Ce(32,258,258,4096,Te)],o.deflateInit=function(B,K){return st(B,K,R,15,8,0)},o.deflateInit2=st,o.deflateReset=at,o.deflateResetKeep=$e,o.deflateSetHeader=function(B,K){return B&&B.state?B.state.wrap!==2?A:(B.state.gzhead=K,g):A},o.deflate=function(B,K){var _e,he,ne,ae;if(!B||!B.state||5<K||K<0)return B?le(B,A):A;if(he=B.state,!B.output||!B.input&&B.avail_in!==0||he.status===666&&K!==b)return le(B,B.avail_out===0?-5:A);if(he.strm=B,_e=he.last_flush,he.last_flush=K,he.status===U)if(he.wrap===2)B.adler=0,ee(he,31),ee(he,139),ee(he,8),he.gzhead?(ee(he,(he.gzhead.text?1:0)+(he.gzhead.hcrc?2:0)+(he.gzhead.extra?4:0)+(he.gzhead.name?8:0)+(he.gzhead.comment?16:0)),ee(he,255&he.gzhead.time),ee(he,he.gzhead.time>>8&255),ee(he,he.gzhead.time>>16&255),ee(he,he.gzhead.time>>24&255),ee(he,he.level===9?2:2<=he.strategy||he.level<2?4:0),ee(he,255&he.gzhead.os),he.gzhead.extra&&he.gzhead.extra.length&&(ee(he,255&he.gzhead.extra.length),ee(he,he.gzhead.extra.length>>8&255)),he.gzhead.hcrc&&(B.adler=d(B.adler,he.pending_buf,he.pending,0)),he.gzindex=0,he.status=69):(ee(he,0),ee(he,0),ee(he,0),ee(he,0),ee(he,0),ee(he,he.level===9?2:2<=he.strategy||he.level<2?4:0),ee(he,3),he.status=q);else{var be=R+(he.w_bits-8<<4)<<8;be|=(2<=he.strategy||he.level<2?0:he.level<6?1:he.level===6?2:3)<<6,he.strstart!==0&&(be|=32),be+=31-be%31,he.status=q,te(he,be),he.strstart!==0&&(te(he,B.adler>>>16),te(he,65535&B.adler)),B.adler=1}if(he.status===69)if(he.gzhead.extra){for(ne=he.pending;he.gzindex<(65535&he.gzhead.extra.length)&&(he.pending!==he.pending_buf_size||(he.gzhead.hcrc&&he.pending>ne&&(B.adler=d(B.adler,he.pending_buf,he.pending-ne,ne)),G(B),ne=he.pending,he.pending!==he.pending_buf_size));)ee(he,255&he.gzhead.extra[he.gzindex]),he.gzindex++;he.gzhead.hcrc&&he.pending>ne&&(B.adler=d(B.adler,he.pending_buf,he.pending-ne,ne)),he.gzindex===he.gzhead.extra.length&&(he.gzindex=0,he.status=73)}else he.status=73;if(he.status===73)if(he.gzhead.name){ne=he.pending;do{if(he.pending===he.pending_buf_size&&(he.gzhead.hcrc&&he.pending>ne&&(B.adler=d(B.adler,he.pending_buf,he.pending-ne,ne)),G(B),ne=he.pending,he.pending===he.pending_buf_size)){ae=1;break}ae=he.gzindex<he.gzhead.name.length?255&he.gzhead.name.charCodeAt(he.gzindex++):0,ee(he,ae)}while(ae!==0);he.gzhead.hcrc&&he.pending>ne&&(B.adler=d(B.adler,he.pending_buf,he.pending-ne,ne)),ae===0&&(he.gzindex=0,he.status=91)}else he.status=91;if(he.status===91)if(he.gzhead.comment){ne=he.pending;do{if(he.pending===he.pending_buf_size&&(he.gzhead.hcrc&&he.pending>ne&&(B.adler=d(B.adler,he.pending_buf,he.pending-ne,ne)),G(B),ne=he.pending,he.pending===he.pending_buf_size)){ae=1;break}ae=he.gzindex<he.gzhead.comment.length?255&he.gzhead.comment.charCodeAt(he.gzindex++):0,ee(he,ae)}while(ae!==0);he.gzhead.hcrc&&he.pending>ne&&(B.adler=d(B.adler,he.pending_buf,he.pending-ne,ne)),ae===0&&(he.status=103)}else he.status=103;if(he.status===103&&(he.gzhead.hcrc?(he.pending+2>he.pending_buf_size&&G(B),he.pending+2<=he.pending_buf_size&&(ee(he,255&B.adler),ee(he,B.adler>>8&255),B.adler=0,he.status=q)):he.status=q),he.pending!==0){if(G(B),B.avail_out===0)return he.last_flush=-1,g}else if(B.avail_in===0&&pe(K)<=pe(_e)&&K!==b)return le(B,-5);if(he.status===666&&B.avail_in!==0)return le(B,-5);if(B.avail_in!==0||he.lookahead!==0||K!==v&&he.status!==666){var Me=he.strategy===2?(function(Se,He){for(var Ne;;){if(Se.lookahead===0&&(ye(Se),Se.lookahead===0)){if(He===v)return I;break}if(Se.match_length=0,Ne=c._tr_tally(Se,0,Se.window[Se.strstart]),Se.lookahead--,Se.strstart++,Ne&&(O(Se,!1),Se.strm.avail_out===0))return I}return Se.insert=0,He===b?(O(Se,!0),Se.strm.avail_out===0?J:Y):Se.last_lit&&(O(Se,!1),Se.strm.avail_out===0)?I:ie})(he,K):he.strategy===3?(function(Se,He){for(var Ne,ze,We,dt,ft=Se.window;;){if(Se.lookahead<=X){if(ye(Se),Se.lookahead<=X&&He===v)return I;if(Se.lookahead===0)break}if(Se.match_length=0,Se.lookahead>=j&&0<Se.strstart&&(ze=ft[We=Se.strstart-1])===ft[++We]&&ze===ft[++We]&&ze===ft[++We]){dt=Se.strstart+X;do;while(ze===ft[++We]&&ze===ft[++We]&&ze===ft[++We]&&ze===ft[++We]&&ze===ft[++We]&&ze===ft[++We]&&ze===ft[++We]&&ze===ft[++We]&&We<dt);Se.match_length=X-(dt-We),Se.match_length>Se.lookahead&&(Se.match_length=Se.lookahead)}if(Se.match_length>=j?(Ne=c._tr_tally(Se,1,Se.match_length-j),Se.lookahead-=Se.match_length,Se.strstart+=Se.match_length,Se.match_length=0):(Ne=c._tr_tally(Se,0,Se.window[Se.strstart]),Se.lookahead--,Se.strstart++),Ne&&(O(Se,!1),Se.strm.avail_out===0))return I}return Se.insert=0,He===b?(O(Se,!0),Se.strm.avail_out===0?J:Y):Se.last_lit&&(O(Se,!1),Se.strm.avail_out===0)?I:ie})(he,K):a[he.level].func(he,K);if(Me!==J&&Me!==Y||(he.status=666),Me===I||Me===J)return B.avail_out===0&&(he.last_flush=-1),g;if(Me===ie&&(K===1?c._tr_align(he):K!==5&&(c._tr_stored_block(he,0,0,!1),K===3&&(Ie(he.head),he.lookahead===0&&(he.strstart=0,he.block_start=0,he.insert=0))),G(B),B.avail_out===0))return he.last_flush=-1,g}return K!==b?g:he.wrap<=0?1:(he.wrap===2?(ee(he,255&B.adler),ee(he,B.adler>>8&255),ee(he,B.adler>>16&255),ee(he,B.adler>>24&255),ee(he,255&B.total_in),ee(he,B.total_in>>8&255),ee(he,B.total_in>>16&255),ee(he,B.total_in>>24&255)):(te(he,B.adler>>>16),te(he,65535&B.adler)),G(B),0<he.wrap&&(he.wrap=-he.wrap),he.pending!==0?g:1)},o.deflateEnd=function(B){var K;return B&&B.state?(K=B.state.status)!==U&&K!==69&&K!==73&&K!==91&&K!==103&&K!==q&&K!==666?le(B,A):(B.state=null,K===q?le(B,-3):g):A},o.deflateSetDictionary=function(B,K){var _e,he,ne,ae,be,Me,Se,He,Ne=K.length;if(!B||!B.state||(ae=(_e=B.state).wrap)===2||ae===1&&_e.status!==U||_e.lookahead)return A;for(ae===1&&(B.adler=u(B.adler,K,Ne,0)),_e.wrap=0,Ne>=_e.w_size&&(ae===0&&(Ie(_e.head),_e.strstart=0,_e.block_start=0,_e.insert=0),He=new l.Buf8(_e.w_size),l.arraySet(He,K,Ne-_e.w_size,_e.w_size,0),K=He,Ne=_e.w_size),be=B.avail_in,Me=B.next_in,Se=B.input,B.avail_in=Ne,B.next_in=0,B.input=K,ye(_e);_e.lookahead>=j;){for(he=_e.strstart,ne=_e.lookahead-(j-1);_e.ins_h=(_e.ins_h<<_e.hash_shift^_e.window[he+j-1])&_e.hash_mask,_e.prev[he&_e.w_mask]=_e.head[_e.ins_h],_e.head[_e.ins_h]=he,he++,--ne;);_e.strstart=he,_e.lookahead=j-1,ye(_e)}return _e.strstart+=_e.lookahead,_e.block_start=_e.strstart,_e.insert=_e.lookahead,_e.lookahead=0,_e.match_length=_e.prev_length=j-1,_e.match_available=0,B.next_in=Me,B.input=Se,B.avail_in=be,_e.wrap=ae,g},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,i,o){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,i,o){i.exports=function(a,l){var c,u,d,h,v,b,g,A,_,C,E,R,k,M,P,W,V,$,j,X,z,U,q,I,ie;c=a.state,u=a.next_in,I=a.input,d=u+(a.avail_in-5),h=a.next_out,ie=a.output,v=h-(l-a.avail_out),b=h+(a.avail_out-257),g=c.dmax,A=c.wsize,_=c.whave,C=c.wnext,E=c.window,R=c.hold,k=c.bits,M=c.lencode,P=c.distcode,W=(1<<c.lenbits)-1,V=(1<<c.distbits)-1;e:do{k<15&&(R+=I[u++]<<k,k+=8,R+=I[u++]<<k,k+=8),$=M[R&W];t:for(;;){if(R>>>=j=$>>>24,k-=j,(j=$>>>16&255)===0)ie[h++]=65535&$;else{if(!(16&j)){if((64&j)==0){$=M[(65535&$)+(R&(1<<j)-1)];continue t}if(32&j){c.mode=12;break e}a.msg="invalid literal/length code",c.mode=30;break e}X=65535&$,(j&=15)&&(k<j&&(R+=I[u++]<<k,k+=8),X+=R&(1<<j)-1,R>>>=j,k-=j),k<15&&(R+=I[u++]<<k,k+=8,R+=I[u++]<<k,k+=8),$=P[R&V];n:for(;;){if(R>>>=j=$>>>24,k-=j,!(16&(j=$>>>16&255))){if((64&j)==0){$=P[(65535&$)+(R&(1<<j)-1)];continue n}a.msg="invalid distance code",c.mode=30;break e}if(z=65535&$,k<(j&=15)&&(R+=I[u++]<<k,(k+=8)<j&&(R+=I[u++]<<k,k+=8)),g<(z+=R&(1<<j)-1)){a.msg="invalid distance too far back",c.mode=30;break e}if(R>>>=j,k-=j,(j=h-v)<z){if(_<(j=z-j)&&c.sane){a.msg="invalid distance too far back",c.mode=30;break e}if(q=E,(U=0)===C){if(U+=A-j,j<X){for(X-=j;ie[h++]=E[U++],--j;);U=h-z,q=ie}}else if(C<j){if(U+=A+C-j,(j-=C)<X){for(X-=j;ie[h++]=E[U++],--j;);if(U=0,C<X){for(X-=j=C;ie[h++]=E[U++],--j;);U=h-z,q=ie}}}else if(U+=C-j,j<X){for(X-=j;ie[h++]=E[U++],--j;);U=h-z,q=ie}for(;2<X;)ie[h++]=q[U++],ie[h++]=q[U++],ie[h++]=q[U++],X-=3;X&&(ie[h++]=q[U++],1<X&&(ie[h++]=q[U++]))}else{for(U=h-z;ie[h++]=ie[U++],ie[h++]=ie[U++],ie[h++]=ie[U++],2<(X-=3););X&&(ie[h++]=ie[U++],1<X&&(ie[h++]=ie[U++]))}break}}break}}while(u<d&&h<b);u-=X=k>>3,R&=(1<<(k-=X<<3))-1,a.next_in=u,a.next_out=h,a.avail_in=u<d?d-u+5:5-(u-d),a.avail_out=h<b?b-h+257:257-(h-b),c.hold=R,c.bits=k}},{}],49:[function(n,i,o){var a=n("../utils/common"),l=n("./adler32"),c=n("./crc32"),u=n("./inffast"),d=n("./inftrees"),h=1,v=2,b=0,g=-2,A=1,_=852,C=592;function E(U){return(U>>>24&255)+(U>>>8&65280)+((65280&U)<<8)+((255&U)<<24)}function R(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(U){var q;return U&&U.state?(q=U.state,U.total_in=U.total_out=q.total=0,U.msg="",q.wrap&&(U.adler=1&q.wrap),q.mode=A,q.last=0,q.havedict=0,q.dmax=32768,q.head=null,q.hold=0,q.bits=0,q.lencode=q.lendyn=new a.Buf32(_),q.distcode=q.distdyn=new a.Buf32(C),q.sane=1,q.back=-1,b):g}function M(U){var q;return U&&U.state?((q=U.state).wsize=0,q.whave=0,q.wnext=0,k(U)):g}function P(U,q){var I,ie;return U&&U.state?(ie=U.state,q<0?(I=0,q=-q):(I=1+(q>>4),q<48&&(q&=15)),q&&(q<8||15<q)?g:(ie.window!==null&&ie.wbits!==q&&(ie.window=null),ie.wrap=I,ie.wbits=q,M(U))):g}function W(U,q){var I,ie;return U?(ie=new R,(U.state=ie).window=null,(I=P(U,q))!==b&&(U.state=null),I):g}var V,$,j=!0;function X(U){if(j){var q;for(V=new a.Buf32(512),$=new a.Buf32(32),q=0;q<144;)U.lens[q++]=8;for(;q<256;)U.lens[q++]=9;for(;q<280;)U.lens[q++]=7;for(;q<288;)U.lens[q++]=8;for(d(h,U.lens,0,288,V,0,U.work,{bits:9}),q=0;q<32;)U.lens[q++]=5;d(v,U.lens,0,32,$,0,U.work,{bits:5}),j=!1}U.lencode=V,U.lenbits=9,U.distcode=$,U.distbits=5}function z(U,q,I,ie){var J,Y=U.state;return Y.window===null&&(Y.wsize=1<<Y.wbits,Y.wnext=0,Y.whave=0,Y.window=new a.Buf8(Y.wsize)),ie>=Y.wsize?(a.arraySet(Y.window,q,I-Y.wsize,Y.wsize,0),Y.wnext=0,Y.whave=Y.wsize):(ie<(J=Y.wsize-Y.wnext)&&(J=ie),a.arraySet(Y.window,q,I-ie,J,Y.wnext),(ie-=J)?(a.arraySet(Y.window,q,I-ie,ie,0),Y.wnext=ie,Y.whave=Y.wsize):(Y.wnext+=J,Y.wnext===Y.wsize&&(Y.wnext=0),Y.whave<Y.wsize&&(Y.whave+=J))),0}o.inflateReset=M,o.inflateReset2=P,o.inflateResetKeep=k,o.inflateInit=function(U){return W(U,15)},o.inflateInit2=W,o.inflate=function(U,q){var I,ie,J,Y,le,pe,Ie,G,O,ee,te,ce,ye,we,Te,Ce,De,$e,at,st,B,K,_e,he,ne=0,ae=new a.Buf8(4),be=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!U||!U.state||!U.output||!U.input&&U.avail_in!==0)return g;(I=U.state).mode===12&&(I.mode=13),le=U.next_out,J=U.output,Ie=U.avail_out,Y=U.next_in,ie=U.input,pe=U.avail_in,G=I.hold,O=I.bits,ee=pe,te=Ie,K=b;e:for(;;)switch(I.mode){case A:if(I.wrap===0){I.mode=13;break}for(;O<16;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}if(2&I.wrap&&G===35615){ae[I.check=0]=255&G,ae[1]=G>>>8&255,I.check=c(I.check,ae,2,0),O=G=0,I.mode=2;break}if(I.flags=0,I.head&&(I.head.done=!1),!(1&I.wrap)||(((255&G)<<8)+(G>>8))%31){U.msg="incorrect header check",I.mode=30;break}if((15&G)!=8){U.msg="unknown compression method",I.mode=30;break}if(O-=4,B=8+(15&(G>>>=4)),I.wbits===0)I.wbits=B;else if(B>I.wbits){U.msg="invalid window size",I.mode=30;break}I.dmax=1<<B,U.adler=I.check=1,I.mode=512&G?10:12,O=G=0;break;case 2:for(;O<16;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}if(I.flags=G,(255&I.flags)!=8){U.msg="unknown compression method",I.mode=30;break}if(57344&I.flags){U.msg="unknown header flags set",I.mode=30;break}I.head&&(I.head.text=G>>8&1),512&I.flags&&(ae[0]=255&G,ae[1]=G>>>8&255,I.check=c(I.check,ae,2,0)),O=G=0,I.mode=3;case 3:for(;O<32;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}I.head&&(I.head.time=G),512&I.flags&&(ae[0]=255&G,ae[1]=G>>>8&255,ae[2]=G>>>16&255,ae[3]=G>>>24&255,I.check=c(I.check,ae,4,0)),O=G=0,I.mode=4;case 4:for(;O<16;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}I.head&&(I.head.xflags=255&G,I.head.os=G>>8),512&I.flags&&(ae[0]=255&G,ae[1]=G>>>8&255,I.check=c(I.check,ae,2,0)),O=G=0,I.mode=5;case 5:if(1024&I.flags){for(;O<16;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}I.length=G,I.head&&(I.head.extra_len=G),512&I.flags&&(ae[0]=255&G,ae[1]=G>>>8&255,I.check=c(I.check,ae,2,0)),O=G=0}else I.head&&(I.head.extra=null);I.mode=6;case 6:if(1024&I.flags&&(pe<(ce=I.length)&&(ce=pe),ce&&(I.head&&(B=I.head.extra_len-I.length,I.head.extra||(I.head.extra=new Array(I.head.extra_len)),a.arraySet(I.head.extra,ie,Y,ce,B)),512&I.flags&&(I.check=c(I.check,ie,ce,Y)),pe-=ce,Y+=ce,I.length-=ce),I.length))break e;I.length=0,I.mode=7;case 7:if(2048&I.flags){if(pe===0)break e;for(ce=0;B=ie[Y+ce++],I.head&&B&&I.length<65536&&(I.head.name+=String.fromCharCode(B)),B&&ce<pe;);if(512&I.flags&&(I.check=c(I.check,ie,ce,Y)),pe-=ce,Y+=ce,B)break e}else I.head&&(I.head.name=null);I.length=0,I.mode=8;case 8:if(4096&I.flags){if(pe===0)break e;for(ce=0;B=ie[Y+ce++],I.head&&B&&I.length<65536&&(I.head.comment+=String.fromCharCode(B)),B&&ce<pe;);if(512&I.flags&&(I.check=c(I.check,ie,ce,Y)),pe-=ce,Y+=ce,B)break e}else I.head&&(I.head.comment=null);I.mode=9;case 9:if(512&I.flags){for(;O<16;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}if(G!==(65535&I.check)){U.msg="header crc mismatch",I.mode=30;break}O=G=0}I.head&&(I.head.hcrc=I.flags>>9&1,I.head.done=!0),U.adler=I.check=0,I.mode=12;break;case 10:for(;O<32;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}U.adler=I.check=E(G),O=G=0,I.mode=11;case 11:if(I.havedict===0)return U.next_out=le,U.avail_out=Ie,U.next_in=Y,U.avail_in=pe,I.hold=G,I.bits=O,2;U.adler=I.check=1,I.mode=12;case 12:if(q===5||q===6)break e;case 13:if(I.last){G>>>=7&O,O-=7&O,I.mode=27;break}for(;O<3;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}switch(I.last=1&G,O-=1,3&(G>>>=1)){case 0:I.mode=14;break;case 1:if(X(I),I.mode=20,q!==6)break;G>>>=2,O-=2;break e;case 2:I.mode=17;break;case 3:U.msg="invalid block type",I.mode=30}G>>>=2,O-=2;break;case 14:for(G>>>=7&O,O-=7&O;O<32;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}if((65535&G)!=(G>>>16^65535)){U.msg="invalid stored block lengths",I.mode=30;break}if(I.length=65535&G,O=G=0,I.mode=15,q===6)break e;case 15:I.mode=16;case 16:if(ce=I.length){if(pe<ce&&(ce=pe),Ie<ce&&(ce=Ie),ce===0)break e;a.arraySet(J,ie,Y,ce,le),pe-=ce,Y+=ce,Ie-=ce,le+=ce,I.length-=ce;break}I.mode=12;break;case 17:for(;O<14;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}if(I.nlen=257+(31&G),G>>>=5,O-=5,I.ndist=1+(31&G),G>>>=5,O-=5,I.ncode=4+(15&G),G>>>=4,O-=4,286<I.nlen||30<I.ndist){U.msg="too many length or distance symbols",I.mode=30;break}I.have=0,I.mode=18;case 18:for(;I.have<I.ncode;){for(;O<3;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}I.lens[be[I.have++]]=7&G,G>>>=3,O-=3}for(;I.have<19;)I.lens[be[I.have++]]=0;if(I.lencode=I.lendyn,I.lenbits=7,_e={bits:I.lenbits},K=d(0,I.lens,0,19,I.lencode,0,I.work,_e),I.lenbits=_e.bits,K){U.msg="invalid code lengths set",I.mode=30;break}I.have=0,I.mode=19;case 19:for(;I.have<I.nlen+I.ndist;){for(;Ce=(ne=I.lencode[G&(1<<I.lenbits)-1])>>>16&255,De=65535&ne,!((Te=ne>>>24)<=O);){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}if(De<16)G>>>=Te,O-=Te,I.lens[I.have++]=De;else{if(De===16){for(he=Te+2;O<he;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}if(G>>>=Te,O-=Te,I.have===0){U.msg="invalid bit length repeat",I.mode=30;break}B=I.lens[I.have-1],ce=3+(3&G),G>>>=2,O-=2}else if(De===17){for(he=Te+3;O<he;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}O-=Te,B=0,ce=3+(7&(G>>>=Te)),G>>>=3,O-=3}else{for(he=Te+7;O<he;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}O-=Te,B=0,ce=11+(127&(G>>>=Te)),G>>>=7,O-=7}if(I.have+ce>I.nlen+I.ndist){U.msg="invalid bit length repeat",I.mode=30;break}for(;ce--;)I.lens[I.have++]=B}}if(I.mode===30)break;if(I.lens[256]===0){U.msg="invalid code -- missing end-of-block",I.mode=30;break}if(I.lenbits=9,_e={bits:I.lenbits},K=d(h,I.lens,0,I.nlen,I.lencode,0,I.work,_e),I.lenbits=_e.bits,K){U.msg="invalid literal/lengths set",I.mode=30;break}if(I.distbits=6,I.distcode=I.distdyn,_e={bits:I.distbits},K=d(v,I.lens,I.nlen,I.ndist,I.distcode,0,I.work,_e),I.distbits=_e.bits,K){U.msg="invalid distances set",I.mode=30;break}if(I.mode=20,q===6)break e;case 20:I.mode=21;case 21:if(6<=pe&&258<=Ie){U.next_out=le,U.avail_out=Ie,U.next_in=Y,U.avail_in=pe,I.hold=G,I.bits=O,u(U,te),le=U.next_out,J=U.output,Ie=U.avail_out,Y=U.next_in,ie=U.input,pe=U.avail_in,G=I.hold,O=I.bits,I.mode===12&&(I.back=-1);break}for(I.back=0;Ce=(ne=I.lencode[G&(1<<I.lenbits)-1])>>>16&255,De=65535&ne,!((Te=ne>>>24)<=O);){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}if(Ce&&(240&Ce)==0){for($e=Te,at=Ce,st=De;Ce=(ne=I.lencode[st+((G&(1<<$e+at)-1)>>$e)])>>>16&255,De=65535&ne,!($e+(Te=ne>>>24)<=O);){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}G>>>=$e,O-=$e,I.back+=$e}if(G>>>=Te,O-=Te,I.back+=Te,I.length=De,Ce===0){I.mode=26;break}if(32&Ce){I.back=-1,I.mode=12;break}if(64&Ce){U.msg="invalid literal/length code",I.mode=30;break}I.extra=15&Ce,I.mode=22;case 22:if(I.extra){for(he=I.extra;O<he;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}I.length+=G&(1<<I.extra)-1,G>>>=I.extra,O-=I.extra,I.back+=I.extra}I.was=I.length,I.mode=23;case 23:for(;Ce=(ne=I.distcode[G&(1<<I.distbits)-1])>>>16&255,De=65535&ne,!((Te=ne>>>24)<=O);){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}if((240&Ce)==0){for($e=Te,at=Ce,st=De;Ce=(ne=I.distcode[st+((G&(1<<$e+at)-1)>>$e)])>>>16&255,De=65535&ne,!($e+(Te=ne>>>24)<=O);){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}G>>>=$e,O-=$e,I.back+=$e}if(G>>>=Te,O-=Te,I.back+=Te,64&Ce){U.msg="invalid distance code",I.mode=30;break}I.offset=De,I.extra=15&Ce,I.mode=24;case 24:if(I.extra){for(he=I.extra;O<he;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}I.offset+=G&(1<<I.extra)-1,G>>>=I.extra,O-=I.extra,I.back+=I.extra}if(I.offset>I.dmax){U.msg="invalid distance too far back",I.mode=30;break}I.mode=25;case 25:if(Ie===0)break e;if(ce=te-Ie,I.offset>ce){if((ce=I.offset-ce)>I.whave&&I.sane){U.msg="invalid distance too far back",I.mode=30;break}ye=ce>I.wnext?(ce-=I.wnext,I.wsize-ce):I.wnext-ce,ce>I.length&&(ce=I.length),we=I.window}else we=J,ye=le-I.offset,ce=I.length;for(Ie<ce&&(ce=Ie),Ie-=ce,I.length-=ce;J[le++]=we[ye++],--ce;);I.length===0&&(I.mode=21);break;case 26:if(Ie===0)break e;J[le++]=I.length,Ie--,I.mode=21;break;case 27:if(I.wrap){for(;O<32;){if(pe===0)break e;pe--,G|=ie[Y++]<<O,O+=8}if(te-=Ie,U.total_out+=te,I.total+=te,te&&(U.adler=I.check=I.flags?c(I.check,J,te,le-te):l(I.check,J,te,le-te)),te=Ie,(I.flags?G:E(G))!==I.check){U.msg="incorrect data check",I.mode=30;break}O=G=0}I.mode=28;case 28:if(I.wrap&&I.flags){for(;O<32;){if(pe===0)break e;pe--,G+=ie[Y++]<<O,O+=8}if(G!==(4294967295&I.total)){U.msg="incorrect length check",I.mode=30;break}O=G=0}I.mode=29;case 29:K=1;break e;case 30:K=-3;break e;case 31:return-4;case 32:default:return g}return U.next_out=le,U.avail_out=Ie,U.next_in=Y,U.avail_in=pe,I.hold=G,I.bits=O,(I.wsize||te!==U.avail_out&&I.mode<30&&(I.mode<27||q!==4))&&z(U,U.output,U.next_out,te-U.avail_out)?(I.mode=31,-4):(ee-=U.avail_in,te-=U.avail_out,U.total_in+=ee,U.total_out+=te,I.total+=te,I.wrap&&te&&(U.adler=I.check=I.flags?c(I.check,J,te,U.next_out-te):l(I.check,J,te,U.next_out-te)),U.data_type=I.bits+(I.last?64:0)+(I.mode===12?128:0)+(I.mode===20||I.mode===15?256:0),(ee==0&&te===0||q===4)&&K===b&&(K=-5),K)},o.inflateEnd=function(U){if(!U||!U.state)return g;var q=U.state;return q.window&&(q.window=null),U.state=null,b},o.inflateGetHeader=function(U,q){var I;return U&&U.state?(2&(I=U.state).wrap)==0?g:((I.head=q).done=!1,b):g},o.inflateSetDictionary=function(U,q){var I,ie=q.length;return U&&U.state?(I=U.state).wrap!==0&&I.mode!==11?g:I.mode===11&&l(1,q,ie,0)!==I.check?-3:z(U,q,ie,ie)?(I.mode=31,-4):(I.havedict=1,b):g},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,i,o){var a=n("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],c=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(h,v,b,g,A,_,C,E){var R,k,M,P,W,V,$,j,X,z=E.bits,U=0,q=0,I=0,ie=0,J=0,Y=0,le=0,pe=0,Ie=0,G=0,O=null,ee=0,te=new a.Buf16(16),ce=new a.Buf16(16),ye=null,we=0;for(U=0;U<=15;U++)te[U]=0;for(q=0;q<g;q++)te[v[b+q]]++;for(J=z,ie=15;1<=ie&&te[ie]===0;ie--);if(ie<J&&(J=ie),ie===0)return A[_++]=20971520,A[_++]=20971520,E.bits=1,0;for(I=1;I<ie&&te[I]===0;I++);for(J<I&&(J=I),U=pe=1;U<=15;U++)if(pe<<=1,(pe-=te[U])<0)return-1;if(0<pe&&(h===0||ie!==1))return-1;for(ce[1]=0,U=1;U<15;U++)ce[U+1]=ce[U]+te[U];for(q=0;q<g;q++)v[b+q]!==0&&(C[ce[v[b+q]]++]=q);if(V=h===0?(O=ye=C,19):h===1?(O=l,ee-=257,ye=c,we-=257,256):(O=u,ye=d,-1),U=I,W=_,le=q=G=0,M=-1,P=(Ie=1<<(Y=J))-1,h===1&&852<Ie||h===2&&592<Ie)return 1;for(;;){for($=U-le,X=C[q]<V?(j=0,C[q]):C[q]>V?(j=ye[we+C[q]],O[ee+C[q]]):(j=96,0),R=1<<U-le,I=k=1<<Y;A[W+(G>>le)+(k-=R)]=$<<24|j<<16|X|0,k!==0;);for(R=1<<U-1;G&R;)R>>=1;if(R!==0?(G&=R-1,G+=R):G=0,q++,--te[U]==0){if(U===ie)break;U=v[b+C[q]]}if(J<U&&(G&P)!==M){for(le===0&&(le=J),W+=I,pe=1<<(Y=U-le);Y+le<ie&&!((pe-=te[Y+le])<=0);)Y++,pe<<=1;if(Ie+=1<<Y,h===1&&852<Ie||h===2&&592<Ie)return 1;A[M=G&P]=J<<24|Y<<16|W-_|0}}return G!==0&&(A[W+G]=U-le<<24|64<<16|0),E.bits=J,0}},{"../utils/common":41}],51:[function(n,i,o){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,i,o){var a=n("../utils/common"),l=0,c=1;function u(ne){for(var ae=ne.length;0<=--ae;)ne[ae]=0}var d=0,h=29,v=256,b=v+1+h,g=30,A=19,_=2*b+1,C=15,E=16,R=7,k=256,M=16,P=17,W=18,V=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],$=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=new Array(2*(b+2));u(z);var U=new Array(2*g);u(U);var q=new Array(512);u(q);var I=new Array(256);u(I);var ie=new Array(h);u(ie);var J,Y,le,pe=new Array(g);function Ie(ne,ae,be,Me,Se){this.static_tree=ne,this.extra_bits=ae,this.extra_base=be,this.elems=Me,this.max_length=Se,this.has_stree=ne&&ne.length}function G(ne,ae){this.dyn_tree=ne,this.max_code=0,this.stat_desc=ae}function O(ne){return ne<256?q[ne]:q[256+(ne>>>7)]}function ee(ne,ae){ne.pending_buf[ne.pending++]=255&ae,ne.pending_buf[ne.pending++]=ae>>>8&255}function te(ne,ae,be){ne.bi_valid>E-be?(ne.bi_buf|=ae<<ne.bi_valid&65535,ee(ne,ne.bi_buf),ne.bi_buf=ae>>E-ne.bi_valid,ne.bi_valid+=be-E):(ne.bi_buf|=ae<<ne.bi_valid&65535,ne.bi_valid+=be)}function ce(ne,ae,be){te(ne,be[2*ae],be[2*ae+1])}function ye(ne,ae){for(var be=0;be|=1&ne,ne>>>=1,be<<=1,0<--ae;);return be>>>1}function we(ne,ae,be){var Me,Se,He=new Array(C+1),Ne=0;for(Me=1;Me<=C;Me++)He[Me]=Ne=Ne+be[Me-1]<<1;for(Se=0;Se<=ae;Se++){var ze=ne[2*Se+1];ze!==0&&(ne[2*Se]=ye(He[ze]++,ze))}}function Te(ne){var ae;for(ae=0;ae<b;ae++)ne.dyn_ltree[2*ae]=0;for(ae=0;ae<g;ae++)ne.dyn_dtree[2*ae]=0;for(ae=0;ae<A;ae++)ne.bl_tree[2*ae]=0;ne.dyn_ltree[2*k]=1,ne.opt_len=ne.static_len=0,ne.last_lit=ne.matches=0}function Ce(ne){8<ne.bi_valid?ee(ne,ne.bi_buf):0<ne.bi_valid&&(ne.pending_buf[ne.pending++]=ne.bi_buf),ne.bi_buf=0,ne.bi_valid=0}function De(ne,ae,be,Me){var Se=2*ae,He=2*be;return ne[Se]<ne[He]||ne[Se]===ne[He]&&Me[ae]<=Me[be]}function $e(ne,ae,be){for(var Me=ne.heap[be],Se=be<<1;Se<=ne.heap_len&&(Se<ne.heap_len&&De(ae,ne.heap[Se+1],ne.heap[Se],ne.depth)&&Se++,!De(ae,Me,ne.heap[Se],ne.depth));)ne.heap[be]=ne.heap[Se],be=Se,Se<<=1;ne.heap[be]=Me}function at(ne,ae,be){var Me,Se,He,Ne,ze=0;if(ne.last_lit!==0)for(;Me=ne.pending_buf[ne.d_buf+2*ze]<<8|ne.pending_buf[ne.d_buf+2*ze+1],Se=ne.pending_buf[ne.l_buf+ze],ze++,Me===0?ce(ne,Se,ae):(ce(ne,(He=I[Se])+v+1,ae),(Ne=V[He])!==0&&te(ne,Se-=ie[He],Ne),ce(ne,He=O(--Me),be),(Ne=$[He])!==0&&te(ne,Me-=pe[He],Ne)),ze<ne.last_lit;);ce(ne,k,ae)}function st(ne,ae){var be,Me,Se,He=ae.dyn_tree,Ne=ae.stat_desc.static_tree,ze=ae.stat_desc.has_stree,We=ae.stat_desc.elems,dt=-1;for(ne.heap_len=0,ne.heap_max=_,be=0;be<We;be++)He[2*be]!==0?(ne.heap[++ne.heap_len]=dt=be,ne.depth[be]=0):He[2*be+1]=0;for(;ne.heap_len<2;)He[2*(Se=ne.heap[++ne.heap_len]=dt<2?++dt:0)]=1,ne.depth[Se]=0,ne.opt_len--,ze&&(ne.static_len-=Ne[2*Se+1]);for(ae.max_code=dt,be=ne.heap_len>>1;1<=be;be--)$e(ne,He,be);for(Se=We;be=ne.heap[1],ne.heap[1]=ne.heap[ne.heap_len--],$e(ne,He,1),Me=ne.heap[1],ne.heap[--ne.heap_max]=be,ne.heap[--ne.heap_max]=Me,He[2*Se]=He[2*be]+He[2*Me],ne.depth[Se]=(ne.depth[be]>=ne.depth[Me]?ne.depth[be]:ne.depth[Me])+1,He[2*be+1]=He[2*Me+1]=Se,ne.heap[1]=Se++,$e(ne,He,1),2<=ne.heap_len;);ne.heap[--ne.heap_max]=ne.heap[1],(function(ft,ht){var Et,mt,on,yt,vt,Rt,Ft=ht.dyn_tree,Le=ht.max_code,nt=ht.stat_desc.static_tree,Qe=ht.stat_desc.has_stree,ut=ht.stat_desc.extra_bits,wt=ht.stat_desc.extra_base,lt=ht.stat_desc.max_length,et=0;for(yt=0;yt<=C;yt++)ft.bl_count[yt]=0;for(Ft[2*ft.heap[ft.heap_max]+1]=0,Et=ft.heap_max+1;Et<_;Et++)lt<(yt=Ft[2*Ft[2*(mt=ft.heap[Et])+1]+1]+1)&&(yt=lt,et++),Ft[2*mt+1]=yt,Le<mt||(ft.bl_count[yt]++,vt=0,wt<=mt&&(vt=ut[mt-wt]),Rt=Ft[2*mt],ft.opt_len+=Rt*(yt+vt),Qe&&(ft.static_len+=Rt*(nt[2*mt+1]+vt)));if(et!==0){do{for(yt=lt-1;ft.bl_count[yt]===0;)yt--;ft.bl_count[yt]--,ft.bl_count[yt+1]+=2,ft.bl_count[lt]--,et-=2}while(0<et);for(yt=lt;yt!==0;yt--)for(mt=ft.bl_count[yt];mt!==0;)Le<(on=ft.heap[--Et])||(Ft[2*on+1]!==yt&&(ft.opt_len+=(yt-Ft[2*on+1])*Ft[2*on],Ft[2*on+1]=yt),mt--)}})(ne,ae),we(He,dt,ne.bl_count)}function B(ne,ae,be){var Me,Se,He=-1,Ne=ae[1],ze=0,We=7,dt=4;for(Ne===0&&(We=138,dt=3),ae[2*(be+1)+1]=65535,Me=0;Me<=be;Me++)Se=Ne,Ne=ae[2*(Me+1)+1],++ze<We&&Se===Ne||(ze<dt?ne.bl_tree[2*Se]+=ze:Se!==0?(Se!==He&&ne.bl_tree[2*Se]++,ne.bl_tree[2*M]++):ze<=10?ne.bl_tree[2*P]++:ne.bl_tree[2*W]++,He=Se,dt=(ze=0)===Ne?(We=138,3):Se===Ne?(We=6,3):(We=7,4))}function K(ne,ae,be){var Me,Se,He=-1,Ne=ae[1],ze=0,We=7,dt=4;for(Ne===0&&(We=138,dt=3),Me=0;Me<=be;Me++)if(Se=Ne,Ne=ae[2*(Me+1)+1],!(++ze<We&&Se===Ne)){if(ze<dt)for(;ce(ne,Se,ne.bl_tree),--ze!=0;);else Se!==0?(Se!==He&&(ce(ne,Se,ne.bl_tree),ze--),ce(ne,M,ne.bl_tree),te(ne,ze-3,2)):ze<=10?(ce(ne,P,ne.bl_tree),te(ne,ze-3,3)):(ce(ne,W,ne.bl_tree),te(ne,ze-11,7));He=Se,dt=(ze=0)===Ne?(We=138,3):Se===Ne?(We=6,3):(We=7,4)}}u(pe);var _e=!1;function he(ne,ae,be,Me){te(ne,(d<<1)+(Me?1:0),3),(function(Se,He,Ne,ze){Ce(Se),ee(Se,Ne),ee(Se,~Ne),a.arraySet(Se.pending_buf,Se.window,He,Ne,Se.pending),Se.pending+=Ne})(ne,ae,be)}o._tr_init=function(ne){_e||((function(){var ae,be,Me,Se,He,Ne=new Array(C+1);for(Se=Me=0;Se<h-1;Se++)for(ie[Se]=Me,ae=0;ae<1<<V[Se];ae++)I[Me++]=Se;for(I[Me-1]=Se,Se=He=0;Se<16;Se++)for(pe[Se]=He,ae=0;ae<1<<$[Se];ae++)q[He++]=Se;for(He>>=7;Se<g;Se++)for(pe[Se]=He<<7,ae=0;ae<1<<$[Se]-7;ae++)q[256+He++]=Se;for(be=0;be<=C;be++)Ne[be]=0;for(ae=0;ae<=143;)z[2*ae+1]=8,ae++,Ne[8]++;for(;ae<=255;)z[2*ae+1]=9,ae++,Ne[9]++;for(;ae<=279;)z[2*ae+1]=7,ae++,Ne[7]++;for(;ae<=287;)z[2*ae+1]=8,ae++,Ne[8]++;for(we(z,b+1,Ne),ae=0;ae<g;ae++)U[2*ae+1]=5,U[2*ae]=ye(ae,5);J=new Ie(z,V,v+1,b,C),Y=new Ie(U,$,0,g,C),le=new Ie(new Array(0),j,0,A,R)})(),_e=!0),ne.l_desc=new G(ne.dyn_ltree,J),ne.d_desc=new G(ne.dyn_dtree,Y),ne.bl_desc=new G(ne.bl_tree,le),ne.bi_buf=0,ne.bi_valid=0,Te(ne)},o._tr_stored_block=he,o._tr_flush_block=function(ne,ae,be,Me){var Se,He,Ne=0;0<ne.level?(ne.strm.data_type===2&&(ne.strm.data_type=(function(ze){var We,dt=4093624447;for(We=0;We<=31;We++,dt>>>=1)if(1&dt&&ze.dyn_ltree[2*We]!==0)return l;if(ze.dyn_ltree[18]!==0||ze.dyn_ltree[20]!==0||ze.dyn_ltree[26]!==0)return c;for(We=32;We<v;We++)if(ze.dyn_ltree[2*We]!==0)return c;return l})(ne)),st(ne,ne.l_desc),st(ne,ne.d_desc),Ne=(function(ze){var We;for(B(ze,ze.dyn_ltree,ze.l_desc.max_code),B(ze,ze.dyn_dtree,ze.d_desc.max_code),st(ze,ze.bl_desc),We=A-1;3<=We&&ze.bl_tree[2*X[We]+1]===0;We--);return ze.opt_len+=3*(We+1)+5+5+4,We})(ne),Se=ne.opt_len+3+7>>>3,(He=ne.static_len+3+7>>>3)<=Se&&(Se=He)):Se=He=be+5,be+4<=Se&&ae!==-1?he(ne,ae,be,Me):ne.strategy===4||He===Se?(te(ne,2+(Me?1:0),3),at(ne,z,U)):(te(ne,4+(Me?1:0),3),(function(ze,We,dt,ft){var ht;for(te(ze,We-257,5),te(ze,dt-1,5),te(ze,ft-4,4),ht=0;ht<ft;ht++)te(ze,ze.bl_tree[2*X[ht]+1],3);K(ze,ze.dyn_ltree,We-1),K(ze,ze.dyn_dtree,dt-1)})(ne,ne.l_desc.max_code+1,ne.d_desc.max_code+1,Ne+1),at(ne,ne.dyn_ltree,ne.dyn_dtree)),Te(ne),Me&&Ce(ne)},o._tr_tally=function(ne,ae,be){return ne.pending_buf[ne.d_buf+2*ne.last_lit]=ae>>>8&255,ne.pending_buf[ne.d_buf+2*ne.last_lit+1]=255&ae,ne.pending_buf[ne.l_buf+ne.last_lit]=255&be,ne.last_lit++,ae===0?ne.dyn_ltree[2*be]++:(ne.matches++,ae--,ne.dyn_ltree[2*(I[be]+v+1)]++,ne.dyn_dtree[2*O(ae)]++),ne.last_lit===ne.lit_bufsize-1},o._tr_align=function(ne){te(ne,2,3),ce(ne,k,z),(function(ae){ae.bi_valid===16?(ee(ae,ae.bi_buf),ae.bi_buf=0,ae.bi_valid=0):8<=ae.bi_valid&&(ae.pending_buf[ae.pending++]=255&ae.bi_buf,ae.bi_buf>>=8,ae.bi_valid-=8)})(ne)}},{"../utils/common":41}],53:[function(n,i,o){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,i,o){(function(a){(function(l,c){if(!l.setImmediate){var u,d,h,v,b=1,g={},A=!1,_=l.document,C=Object.getPrototypeOf&&Object.getPrototypeOf(l);C=C&&C.setTimeout?C:l,u={}.toString.call(l.process)==="[object process]"?function(M){process.nextTick(function(){R(M)})}:(function(){if(l.postMessage&&!l.importScripts){var M=!0,P=l.onmessage;return l.onmessage=function(){M=!1},l.postMessage("","*"),l.onmessage=P,M}})()?(v="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",k,!1):l.attachEvent("onmessage",k),function(M){l.postMessage(v+M,"*")}):l.MessageChannel?((h=new MessageChannel).port1.onmessage=function(M){R(M.data)},function(M){h.port2.postMessage(M)}):_&&"onreadystatechange"in _.createElement("script")?(d=_.documentElement,function(M){var P=_.createElement("script");P.onreadystatechange=function(){R(M),P.onreadystatechange=null,d.removeChild(P),P=null},d.appendChild(P)}):function(M){setTimeout(R,0,M)},C.setImmediate=function(M){typeof M!="function"&&(M=new Function(""+M));for(var P=new Array(arguments.length-1),W=0;W<P.length;W++)P[W]=arguments[W+1];var V={callback:M,args:P};return g[b]=V,u(b),b++},C.clearImmediate=E}function E(M){delete g[M]}function R(M){if(A)setTimeout(R,0,M);else{var P=g[M];if(P){A=!0;try{(function(W){var V=W.callback,$=W.args;switch($.length){case 0:V();break;case 1:V($[0]);break;case 2:V($[0],$[1]);break;case 3:V($[0],$[1],$[2]);break;default:V.apply(c,$)}})(P)}finally{E(M),A=!1}}}}function k(M){M.source===l&&typeof M.data=="string"&&M.data.indexOf(v)===0&&R(+M.data.slice(v.length))}})(typeof self>"u"?a===void 0?this:a:self)}).call(this,typeof ph<"u"?ph:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(pm)),pm.exports}var _T=wT();const T2=Dg(_T),ST="modulepreload",ET=function(e){return"/"+e},k2={},mm=function(t,n,i){let o=Promise.resolve();if(n&&n.length>0){let l=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));o=l(n.map(d=>{if(d=ET(d),d in k2)return;k2[d]=!0;const h=d.endsWith(".css"),v=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${v}`))return;const b=document.createElement("link");if(b.rel=h?"stylesheet":ST,h||(b.as="script"),b.crossOrigin="",b.href=d,u&&b.setAttribute("nonce",u),document.head.appendChild(b),h)return new Promise((g,A)=>{b.addEventListener("load",g),b.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return o.then(l=>{for(const c of l||[])c.status==="rejected"&&a(c.reason);return t().catch(a)})};function qn(e){"@babel/helpers - typeof";return qn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qn(e)}var Pa=Uint8Array,Io=Uint16Array,e1=Int32Array,t1=new Pa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),n1=new Pa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),I2=new Pa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Yw=function(e,t){for(var n=new Io(31),i=0;i<31;++i)n[i]=t+=1<<e[i-1];for(var o=new e1(n[30]),i=1;i<30;++i)for(var a=n[i];a<n[i+1];++a)o[a]=a-n[i]<<5|i;return{b:n,r:o}},Ww=Yw(t1,2),NT=Ww.b,rg=Ww.r;NT[28]=258,rg[258]=28;var AT=Yw(n1,0),R2=AT.r,og=new Io(32768);for(var si=0;si<32768;++si){var Il=(si&43690)>>1|(si&21845)<<1;Il=(Il&52428)>>2|(Il&13107)<<2,Il=(Il&61680)>>4|(Il&3855)<<4,og[si]=((Il&65280)>>8|(Il&255)<<8)>>1}var ef=(function(e,t,n){for(var i=e.length,o=0,a=new Io(t);o<i;++o)e[o]&&++a[e[o]-1];var l=new Io(t);for(o=1;o<t;++o)l[o]=l[o-1]+a[o-1]<<1;var c;if(n){c=new Io(1<<t);var u=15-t;for(o=0;o<i;++o)if(e[o])for(var d=o<<4|e[o],h=t-e[o],v=l[e[o]-1]++<<h,b=v|(1<<h)-1;v<=b;++v)c[og[v]>>u]=d}else for(c=new Io(i),o=0;o<i;++o)e[o]&&(c[o]=og[l[e[o]-1]++]>>15-e[o]);return c}),kc=new Pa(288);for(var si=0;si<144;++si)kc[si]=8;for(var si=144;si<256;++si)kc[si]=9;for(var si=256;si<280;++si)kc[si]=7;for(var si=280;si<288;++si)kc[si]=8;var sp=new Pa(32);for(var si=0;si<32;++si)sp[si]=5;var CT=ef(kc,9,0),TT=ef(sp,5,0),Xw=function(e){return(e+7)/8|0},kT=function(e,t,n){return(n==null||n>e.length)&&(n=e.length),new Pa(e.subarray(t,n))},Fs=function(e,t,n){n<<=t&7;var i=t/8|0;e[i]|=n,e[i+1]|=n>>8},Gd=function(e,t,n){n<<=t&7;var i=t/8|0;e[i]|=n,e[i+1]|=n>>8,e[i+2]|=n>>16},gm=function(e,t){for(var n=[],i=0;i<e.length;++i)e[i]&&n.push({s:i,f:e[i]});var o=n.length,a=n.slice();if(!o)return{t:Kw,l:0};if(o==1){var l=new Pa(n[0].s+1);return l[n[0].s]=1,{t:l,l:1}}n.sort(function(P,W){return P.f-W.f}),n.push({s:-1,f:25001});var c=n[0],u=n[1],d=0,h=1,v=2;for(n[0]={s:-1,f:c.f+u.f,l:c,r:u};h!=o-1;)c=n[n[d].f<n[v].f?d++:v++],u=n[d!=h&&n[d].f<n[v].f?d++:v++],n[h++]={s:-1,f:c.f+u.f,l:c,r:u};for(var b=a[0].s,i=1;i<o;++i)a[i].s>b&&(b=a[i].s);var g=new Io(b+1),A=ag(n[h-1],g,0);if(A>t){var i=0,_=0,C=A-t,E=1<<C;for(a.sort(function(W,V){return g[V.s]-g[W.s]||W.f-V.f});i<o;++i){var R=a[i].s;if(g[R]>t)_+=E-(1<<A-g[R]),g[R]=t;else break}for(_>>=C;_>0;){var k=a[i].s;g[k]<t?_-=1<<t-g[k]++-1:++i}for(;i>=0&&_;--i){var M=a[i].s;g[M]==t&&(--g[M],++_)}A=t}return{t:new Pa(g),l:A}},ag=function(e,t,n){return e.s==-1?Math.max(ag(e.l,t,n+1),ag(e.r,t,n+1)):t[e.s]=n},L2=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new Io(++t),i=0,o=e[0],a=1,l=function(u){n[i++]=u},c=1;c<=t;++c)if(e[c]==o&&c!=t)++a;else{if(!o&&a>2){for(;a>138;a-=138)l(32754);a>2&&(l(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(l(o),--a;a>6;a-=6)l(8304);a>2&&(l(a-3<<5|8208),a=0)}for(;a--;)l(o);a=1,o=e[c]}return{c:n.subarray(0,i),n:t}},Vd=function(e,t){for(var n=0,i=0;i<t.length;++i)n+=e[i]*t[i];return n},Jw=function(e,t,n){var i=n.length,o=Xw(t+2);e[o]=i&255,e[o+1]=i>>8,e[o+2]=e[o]^255,e[o+3]=e[o+1]^255;for(var a=0;a<i;++a)e[o+a+4]=n[a];return(o+4+i)*8},M2=function(e,t,n,i,o,a,l,c,u,d,h){Fs(t,h++,n),++o[256];for(var v=gm(o,15),b=v.t,g=v.l,A=gm(a,15),_=A.t,C=A.l,E=L2(b),R=E.c,k=E.n,M=L2(_),P=M.c,W=M.n,V=new Io(19),$=0;$<R.length;++$)++V[R[$]&31];for(var $=0;$<P.length;++$)++V[P[$]&31];for(var j=gm(V,7),X=j.t,z=j.l,U=19;U>4&&!X[I2[U-1]];--U);var q=d+5<<3,I=Vd(o,kc)+Vd(a,sp)+l,ie=Vd(o,b)+Vd(a,_)+l+14+3*U+Vd(V,X)+2*V[16]+3*V[17]+7*V[18];if(u>=0&&q<=I&&q<=ie)return Jw(t,h,e.subarray(u,u+d));var J,Y,le,pe;if(Fs(t,h,1+(ie<I)),h+=2,ie<I){J=ef(b,g,0),Y=b,le=ef(_,C,0),pe=_;var Ie=ef(X,z,0);Fs(t,h,k-257),Fs(t,h+5,W-1),Fs(t,h+10,U-4),h+=14;for(var $=0;$<U;++$)Fs(t,h+3*$,X[I2[$]]);h+=3*U;for(var G=[R,P],O=0;O<2;++O)for(var ee=G[O],$=0;$<ee.length;++$){var te=ee[$]&31;Fs(t,h,Ie[te]),h+=X[te],te>15&&(Fs(t,h,ee[$]>>5&127),h+=ee[$]>>12)}}else J=CT,Y=kc,le=TT,pe=sp;for(var $=0;$<c;++$){var ce=i[$];if(ce>255){var te=ce>>18&31;Gd(t,h,J[te+257]),h+=Y[te+257],te>7&&(Fs(t,h,ce>>23&31),h+=t1[te]);var ye=ce&31;Gd(t,h,le[ye]),h+=pe[ye],ye>3&&(Gd(t,h,ce>>5&8191),h+=n1[ye])}else Gd(t,h,J[ce]),h+=Y[ce]}return Gd(t,h,J[256]),h+Y[256]},IT=new e1([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Kw=new Pa(0),RT=function(e,t,n,i,o,a){var l=a.z||e.length,c=new Pa(i+l+5*(1+Math.ceil(l/7e3))+o),u=c.subarray(i,c.length-o),d=a.l,h=(a.r||0)&7;if(t){h&&(u[0]=a.r>>3);for(var v=IT[t-1],b=v>>13,g=v&8191,A=(1<<n)-1,_=a.p||new Io(32768),C=a.h||new Io(A+1),E=Math.ceil(n/3),R=2*E,k=function(B){return(e[B]^e[B+1]<<E^e[B+2]<<R)&A},M=new e1(25e3),P=new Io(288),W=new Io(32),V=0,$=0,j=a.i||0,X=0,z=a.w||0,U=0;j+2<l;++j){var q=k(j),I=j&32767,ie=C[q];if(_[I]=ie,C[q]=I,z<=j){var J=l-j;if((V>7e3||X>24576)&&(J>423||!d)){h=M2(e,u,0,M,P,W,$,X,U,j-U,h),X=V=$=0,U=j;for(var Y=0;Y<286;++Y)P[Y]=0;for(var Y=0;Y<30;++Y)W[Y]=0}var le=2,pe=0,Ie=g,G=I-ie&32767;if(J>2&&q==k(j-G))for(var O=Math.min(b,J)-1,ee=Math.min(32767,j),te=Math.min(258,J);G<=ee&&--Ie&&I!=ie;){if(e[j+le]==e[j+le-G]){for(var ce=0;ce<te&&e[j+ce]==e[j+ce-G];++ce);if(ce>le){if(le=ce,pe=G,ce>O)break;for(var ye=Math.min(G,ce-2),we=0,Y=0;Y<ye;++Y){var Te=j-G+Y&32767,Ce=_[Te],De=Te-Ce&32767;De>we&&(we=De,ie=Te)}}}I=ie,ie=_[I],G+=I-ie&32767}if(pe){M[X++]=268435456|rg[le]<<18|R2[pe];var $e=rg[le]&31,at=R2[pe]&31;$+=t1[$e]+n1[at],++P[257+$e],++W[at],z=j+le,++V}else M[X++]=e[j],++P[e[j]]}}for(j=Math.max(j,z);j<l;++j)M[X++]=e[j],++P[e[j]];h=M2(e,u,d,M,P,W,$,X,U,j-U,h),d||(a.r=h&7|u[h/8|0]<<3,h-=7,a.h=C,a.p=_,a.i=j,a.w=z)}else{for(var j=a.w||0;j<l+d;j+=65535){var st=j+65535;st>=l&&(u[h/8|0]=d,st=l),h=Jw(u,h+1,e.subarray(j,st))}a.i=l}return kT(c,0,i+Xw(h)+o)},Zw=function(){var e=1,t=0;return{p:function(n){for(var i=e,o=t,a=n.length|0,l=0;l!=a;){for(var c=Math.min(l+2655,a);l<c;++l)o+=i+=n[l];i=(i&65535)+15*(i>>16),o=(o&65535)+15*(o>>16)}e=i,t=o},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},LT=function(e,t,n,i,o){if(!o&&(o={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),l=new Pa(a.length+e.length);l.set(a),l.set(e,a.length),e=l,o.w=a.length}return RT(e,t.level==null?6:t.level,t.mem==null?o.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,n,i,o)},Qw=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},MT=function(e,t){var n=t.level,i=n==0?0:n<6?1:n==9?3:2;if(e[0]=120,e[1]=i<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var o=Zw();o.p(t.dictionary),Qw(e,2,o.d())}};function sg(e,t){t||(t={});var n=Zw();n.p(e);var i=LT(e,t,t.dictionary?6:2,4);return MT(i,t),Qw(i,i.length-4,n.d()),i}var DT=typeof TextDecoder<"u"&&new TextDecoder,PT=0;try{DT.decode(Kw,{stream:!0}),PT=1}catch{}function OT(e){if(Array.isArray(e))return e}function UT(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,a,l,c=[],u=!0,d=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(u=(i=a.call(n)).done)&&(c.push(i.value),c.length!==t);u=!0);}catch(h){d=!0,o=h}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(d)throw o}}return c}}function D2(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function zT(e,t){if(e){if(typeof e=="string")return D2(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D2(e,t):void 0}}function jT(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P2(e,t){return OT(e)||UT(e,t)||zT(e,t)||jT()}function O2(e,t="utf8"){return new TextDecoder(t).decode(e)}const FT=new TextEncoder;function BT(e){return FT.encode(e)}const qT=1024*8,HT=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),vm={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class i1{constructor(t=qT,n={}){Fn(this,"buffer");Fn(this,"byteLength");Fn(this,"byteOffset");Fn(this,"length");Fn(this,"offset");Fn(this,"lastWrittenByte");Fn(this,"littleEndian");Fn(this,"_data");Fn(this,"_mark");Fn(this,"_marks");let i=!1;typeof t=="number"?t=new ArrayBuffer(t):(i=!0,this.lastWrittenByte=t.byteLength);const o=n.offset?n.offset>>>0:0,a=t.byteLength-o;let l=o;(ArrayBuffer.isView(t)||t instanceof i1)&&(t.byteLength!==t.buffer.byteLength&&(l=t.byteOffset+o),t=t.buffer),i?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=t,this.length=a,this.byteLength=a,this.byteOffset=l,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,l,a),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const i=(this.offset+t)*2,o=new Uint8Array(i);o.set(new Uint8Array(this.buffer)),this.buffer=o.buffer,this.length=i,this.byteLength=i,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,n){const i=vm[n].BYTES_PER_ELEMENT*t,o=this.byteOffset+this.offset,a=this.buffer.slice(o,o+i);if(this.littleEndian===HT&&n!=="uint8"&&n!=="int8"){const c=new Uint8Array(this.buffer.slice(o,o+i));c.reverse();const u=new vm[n](c.buffer);return this.offset+=i,u.reverse(),u}const l=new vm[n](a);return this.offset+=i,l}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let n="";for(let i=0;i<t;i++)n+=this.readChar();return n}readUtf8(t=1){return O2(this.readBytes(t))}decodeText(t=1,n="utf8"){return O2(this.readBytes(t),n)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let n=0;n<t.length;n++)this._data.setUint8(this.offset++,t[n]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let n=0;n<t.length;n++)this.writeUint8(t.charCodeAt(n));return this}writeUtf8(t){return this.writeBytes(BT(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function td(e){let t=e.length;for(;--t>=0;)e[t]=0}const GT=3,VT=258,e_=29,$T=256,YT=$T+1+e_,t_=30,WT=512,XT=new Array((YT+2)*2);td(XT);const JT=new Array(t_*2);td(JT);const KT=new Array(WT);td(KT);const ZT=new Array(VT-GT+1);td(ZT);const QT=new Array(e_);td(QT);const ek=new Array(t_);td(ek);const tk=(e,t,n,i)=>{let o=e&65535|0,a=e>>>16&65535|0,l=0;for(;n!==0;){l=n>2e3?2e3:n,n-=l;do o=o+t[i++]|0,a=a+o|0;while(--l);o%=65521,a%=65521}return o|a<<16|0};var lg=tk;const nk=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},ik=new Uint32Array(nk()),rk=(e,t,n,i)=>{const o=ik,a=i+n;e^=-1;for(let l=i;l<a;l++)e=e>>>8^o[(e^t[l])&255];return e^-1};var rs=rk,cg={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},n_={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const ok=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var ak=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const i in n)ok(n,i)&&(e[i]=n[i])}}return e},sk=e=>{let t=0;for(let i=0,o=e.length;i<o;i++)t+=e[i].length;const n=new Uint8Array(t);for(let i=0,o=0,a=e.length;i<a;i++){let l=e[i];n.set(l,o),o+=l.length}return n},i_={assign:ak,flattenChunks:sk};let r_=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{r_=!1}const cf=new Uint8Array(256);for(let e=0;e<256;e++)cf[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;cf[254]=cf[254]=1;var lk=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,n,i,o,a,l=e.length,c=0;for(o=0;o<l;o++)n=e.charCodeAt(o),(n&64512)===55296&&o+1<l&&(i=e.charCodeAt(o+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),o++)),c+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(c),a=0,o=0;a<c;o++)n=e.charCodeAt(o),(n&64512)===55296&&o+1<l&&(i=e.charCodeAt(o+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),o++)),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|n&63):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|n&63):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|n&63);return t};const ck=(e,t)=>{if(t<65534&&e.subarray&&r_)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n};var uk=(e,t)=>{const n=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let i,o;const a=new Array(n*2);for(o=0,i=0;i<n;){let l=e[i++];if(l<128){a[o++]=l;continue}let c=cf[l];if(c>4){a[o++]=65533,i+=c-1;continue}for(l&=c===2?31:c===3?15:7;c>1&&i<n;)l=l<<6|e[i++]&63,c--;if(c>1){a[o++]=65533;continue}l<65536?a[o++]=l:(l-=65536,a[o++]=55296|l>>10&1023,a[o++]=56320|l&1023)}return ck(a,o)},dk=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+cf[e[n]]>t?n:t},ug={string2buf:lk,buf2string:uk,utf8border:dk};function fk(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var hk=fk;const yh=16209,pk=16191;var mk=function(t,n){let i,o,a,l,c,u,d,h,v,b,g,A,_,C,E,R,k,M,P,W,V,$,j,X;const z=t.state;i=t.next_in,j=t.input,o=i+(t.avail_in-5),a=t.next_out,X=t.output,l=a-(n-t.avail_out),c=a+(t.avail_out-257),u=z.dmax,d=z.wsize,h=z.whave,v=z.wnext,b=z.window,g=z.hold,A=z.bits,_=z.lencode,C=z.distcode,E=(1<<z.lenbits)-1,R=(1<<z.distbits)-1;e:do{A<15&&(g+=j[i++]<<A,A+=8,g+=j[i++]<<A,A+=8),k=_[g&E];t:for(;;){if(M=k>>>24,g>>>=M,A-=M,M=k>>>16&255,M===0)X[a++]=k&65535;else if(M&16){P=k&65535,M&=15,M&&(A<M&&(g+=j[i++]<<A,A+=8),P+=g&(1<<M)-1,g>>>=M,A-=M),A<15&&(g+=j[i++]<<A,A+=8,g+=j[i++]<<A,A+=8),k=C[g&R];n:for(;;){if(M=k>>>24,g>>>=M,A-=M,M=k>>>16&255,M&16){if(W=k&65535,M&=15,A<M&&(g+=j[i++]<<A,A+=8,A<M&&(g+=j[i++]<<A,A+=8)),W+=g&(1<<M)-1,W>u){t.msg="invalid distance too far back",z.mode=yh;break e}if(g>>>=M,A-=M,M=a-l,W>M){if(M=W-M,M>h&&z.sane){t.msg="invalid distance too far back",z.mode=yh;break e}if(V=0,$=b,v===0){if(V+=d-M,M<P){P-=M;do X[a++]=b[V++];while(--M);V=a-W,$=X}}else if(v<M){if(V+=d+v-M,M-=v,M<P){P-=M;do X[a++]=b[V++];while(--M);if(V=0,v<P){M=v,P-=M;do X[a++]=b[V++];while(--M);V=a-W,$=X}}}else if(V+=v-M,M<P){P-=M;do X[a++]=b[V++];while(--M);V=a-W,$=X}for(;P>2;)X[a++]=$[V++],X[a++]=$[V++],X[a++]=$[V++],P-=3;P&&(X[a++]=$[V++],P>1&&(X[a++]=$[V++]))}else{V=a-W;do X[a++]=X[V++],X[a++]=X[V++],X[a++]=X[V++],P-=3;while(P>2);P&&(X[a++]=X[V++],P>1&&(X[a++]=X[V++]))}}else if((M&64)===0){k=C[(k&65535)+(g&(1<<M)-1)];continue n}else{t.msg="invalid distance code",z.mode=yh;break e}break}}else if((M&64)===0){k=_[(k&65535)+(g&(1<<M)-1)];continue t}else if(M&32){z.mode=pk;break e}else{t.msg="invalid literal/length code",z.mode=yh;break e}break}}while(i<o&&a<c);P=A>>3,i-=P,A-=P<<3,g&=(1<<A)-1,t.next_in=i,t.next_out=a,t.avail_in=i<o?5+(o-i):5-(i-o),t.avail_out=a<c?257+(c-a):257-(a-c),z.hold=g,z.bits=A};const Cu=15,U2=852,z2=592,j2=0,ym=1,F2=2,gk=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),vk=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),yk=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),bk=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),xk=(e,t,n,i,o,a,l,c)=>{const u=c.bits;let d=0,h=0,v=0,b=0,g=0,A=0,_=0,C=0,E=0,R=0,k,M,P,W,V,$=null,j;const X=new Uint16Array(Cu+1),z=new Uint16Array(Cu+1);let U=null,q,I,ie;for(d=0;d<=Cu;d++)X[d]=0;for(h=0;h<i;h++)X[t[n+h]]++;for(g=u,b=Cu;b>=1&&X[b]===0;b--);if(g>b&&(g=b),b===0)return o[a++]=1<<24|64<<16|0,o[a++]=1<<24|64<<16|0,c.bits=1,0;for(v=1;v<b&&X[v]===0;v++);for(g<v&&(g=v),C=1,d=1;d<=Cu;d++)if(C<<=1,C-=X[d],C<0)return-1;if(C>0&&(e===j2||b!==1))return-1;for(z[1]=0,d=1;d<Cu;d++)z[d+1]=z[d]+X[d];for(h=0;h<i;h++)t[n+h]!==0&&(l[z[t[n+h]]++]=h);if(e===j2?($=U=l,j=20):e===ym?($=gk,U=vk,j=257):($=yk,U=bk,j=0),R=0,h=0,d=v,V=a,A=g,_=0,P=-1,E=1<<g,W=E-1,e===ym&&E>U2||e===F2&&E>z2)return 1;for(;;){q=d-_,l[h]+1<j?(I=0,ie=l[h]):l[h]>=j?(I=U[l[h]-j],ie=$[l[h]-j]):(I=96,ie=0),k=1<<d-_,M=1<<A,v=M;do M-=k,o[V+(R>>_)+M]=q<<24|I<<16|ie|0;while(M!==0);for(k=1<<d-1;R&k;)k>>=1;if(k!==0?(R&=k-1,R+=k):R=0,h++,--X[d]===0){if(d===b)break;d=t[n+l[h]]}if(d>g&&(R&W)!==P){for(_===0&&(_=g),V+=v,A=d-_,C=1<<A;A+_<b&&(C-=X[A+_],!(C<=0));)A++,C<<=1;if(E+=1<<A,e===ym&&E>U2||e===F2&&E>z2)return 1;P=R&W,o[P]=g<<24|A<<16|V-a|0}}return R!==0&&(o[V+R]=d-_<<24|64<<16|0),c.bits=g,0};var tf=xk;const wk=0,o_=1,a_=2,{Z_FINISH:B2,Z_BLOCK:_k,Z_TREES:bh,Z_OK:Ic,Z_STREAM_END:Sk,Z_NEED_DICT:Ek,Z_STREAM_ERROR:Zo,Z_DATA_ERROR:s_,Z_MEM_ERROR:l_,Z_BUF_ERROR:Nk,Z_DEFLATED:q2}=n_,Tp=16180,H2=16181,G2=16182,V2=16183,$2=16184,Y2=16185,W2=16186,X2=16187,J2=16188,K2=16189,lp=16190,Bs=16191,bm=16192,Z2=16193,xm=16194,Q2=16195,e5=16196,t5=16197,n5=16198,xh=16199,wh=16200,i5=16201,r5=16202,o5=16203,a5=16204,s5=16205,wm=16206,l5=16207,c5=16208,fi=16209,c_=16210,u_=16211,Ak=852,Ck=592,Tk=15,kk=Tk,u5=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function Ik(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Mc=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Tp||t.mode>u_?1:0},d_=e=>{if(Mc(e))return Zo;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Tp,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(Ak),t.distcode=t.distdyn=new Int32Array(Ck),t.sane=1,t.back=-1,Ic},f_=e=>{if(Mc(e))return Zo;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,d_(e)},h_=(e,t)=>{let n;if(Mc(e))return Zo;const i=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Zo:(i.window!==null&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,f_(e))},p_=(e,t)=>{if(!e)return Zo;const n=new Ik;e.state=n,n.strm=e,n.window=null,n.mode=Tp;const i=h_(e,t);return i!==Ic&&(e.state=null),i},Rk=e=>p_(e,kk);let d5=!0,_m,Sm;const Lk=e=>{if(d5){_m=new Int32Array(512),Sm=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(tf(o_,e.lens,0,288,_m,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;tf(a_,e.lens,0,32,Sm,0,e.work,{bits:5}),d5=!1}e.lencode=_m,e.lenbits=9,e.distcode=Sm,e.distbits=5},m_=(e,t,n,i)=>{let o;const a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),i>=a.wsize?(a.window.set(t.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(o=a.wsize-a.wnext,o>i&&(o=i),a.window.set(t.subarray(n-i,n-i+o),a.wnext),i-=o,i?(a.window.set(t.subarray(n-i,n),0),a.wnext=i,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0},Mk=(e,t)=>{let n,i,o,a,l,c,u,d,h,v,b,g,A,_,C=0,E,R,k,M,P,W,V,$;const j=new Uint8Array(4);let X,z;const U=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Mc(e)||!e.output||!e.input&&e.avail_in!==0)return Zo;n=e.state,n.mode===Bs&&(n.mode=bm),l=e.next_out,o=e.output,u=e.avail_out,a=e.next_in,i=e.input,c=e.avail_in,d=n.hold,h=n.bits,v=c,b=u,$=Ic;e:for(;;)switch(n.mode){case Tp:if(n.wrap===0){n.mode=bm;break}for(;h<16;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}if(n.wrap&2&&d===35615){n.wbits===0&&(n.wbits=15),n.check=0,j[0]=d&255,j[1]=d>>>8&255,n.check=rs(n.check,j,2,0),d=0,h=0,n.mode=H2;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((d&255)<<8)+(d>>8))%31){e.msg="incorrect header check",n.mode=fi;break}if((d&15)!==q2){e.msg="unknown compression method",n.mode=fi;break}if(d>>>=4,h-=4,V=(d&15)+8,n.wbits===0&&(n.wbits=V),V>15||V>n.wbits){e.msg="invalid window size",n.mode=fi;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=d&512?K2:Bs,d=0,h=0;break;case H2:for(;h<16;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}if(n.flags=d,(n.flags&255)!==q2){e.msg="unknown compression method",n.mode=fi;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=fi;break}n.head&&(n.head.text=d>>8&1),n.flags&512&&n.wrap&4&&(j[0]=d&255,j[1]=d>>>8&255,n.check=rs(n.check,j,2,0)),d=0,h=0,n.mode=G2;case G2:for(;h<32;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}n.head&&(n.head.time=d),n.flags&512&&n.wrap&4&&(j[0]=d&255,j[1]=d>>>8&255,j[2]=d>>>16&255,j[3]=d>>>24&255,n.check=rs(n.check,j,4,0)),d=0,h=0,n.mode=V2;case V2:for(;h<16;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}n.head&&(n.head.xflags=d&255,n.head.os=d>>8),n.flags&512&&n.wrap&4&&(j[0]=d&255,j[1]=d>>>8&255,n.check=rs(n.check,j,2,0)),d=0,h=0,n.mode=$2;case $2:if(n.flags&1024){for(;h<16;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}n.length=d,n.head&&(n.head.extra_len=d),n.flags&512&&n.wrap&4&&(j[0]=d&255,j[1]=d>>>8&255,n.check=rs(n.check,j,2,0)),d=0,h=0}else n.head&&(n.head.extra=null);n.mode=Y2;case Y2:if(n.flags&1024&&(g=n.length,g>c&&(g=c),g&&(n.head&&(V=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(a,a+g),V)),n.flags&512&&n.wrap&4&&(n.check=rs(n.check,i,g,a)),c-=g,a+=g,n.length-=g),n.length))break e;n.length=0,n.mode=W2;case W2:if(n.flags&2048){if(c===0)break e;g=0;do V=i[a+g++],n.head&&V&&n.length<65536&&(n.head.name+=String.fromCharCode(V));while(V&&g<c);if(n.flags&512&&n.wrap&4&&(n.check=rs(n.check,i,g,a)),c-=g,a+=g,V)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=X2;case X2:if(n.flags&4096){if(c===0)break e;g=0;do V=i[a+g++],n.head&&V&&n.length<65536&&(n.head.comment+=String.fromCharCode(V));while(V&&g<c);if(n.flags&512&&n.wrap&4&&(n.check=rs(n.check,i,g,a)),c-=g,a+=g,V)break e}else n.head&&(n.head.comment=null);n.mode=J2;case J2:if(n.flags&512){for(;h<16;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}if(n.wrap&4&&d!==(n.check&65535)){e.msg="header crc mismatch",n.mode=fi;break}d=0,h=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Bs;break;case K2:for(;h<32;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}e.adler=n.check=u5(d),d=0,h=0,n.mode=lp;case lp:if(n.havedict===0)return e.next_out=l,e.avail_out=u,e.next_in=a,e.avail_in=c,n.hold=d,n.bits=h,Ek;e.adler=n.check=1,n.mode=Bs;case Bs:if(t===_k||t===bh)break e;case bm:if(n.last){d>>>=h&7,h-=h&7,n.mode=wm;break}for(;h<3;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}switch(n.last=d&1,d>>>=1,h-=1,d&3){case 0:n.mode=Z2;break;case 1:if(Lk(n),n.mode=xh,t===bh){d>>>=2,h-=2;break e}break;case 2:n.mode=e5;break;case 3:e.msg="invalid block type",n.mode=fi}d>>>=2,h-=2;break;case Z2:for(d>>>=h&7,h-=h&7;h<32;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}if((d&65535)!==(d>>>16^65535)){e.msg="invalid stored block lengths",n.mode=fi;break}if(n.length=d&65535,d=0,h=0,n.mode=xm,t===bh)break e;case xm:n.mode=Q2;case Q2:if(g=n.length,g){if(g>c&&(g=c),g>u&&(g=u),g===0)break e;o.set(i.subarray(a,a+g),l),c-=g,a+=g,u-=g,l+=g,n.length-=g;break}n.mode=Bs;break;case e5:for(;h<14;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}if(n.nlen=(d&31)+257,d>>>=5,h-=5,n.ndist=(d&31)+1,d>>>=5,h-=5,n.ncode=(d&15)+4,d>>>=4,h-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=fi;break}n.have=0,n.mode=t5;case t5:for(;n.have<n.ncode;){for(;h<3;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}n.lens[U[n.have++]]=d&7,d>>>=3,h-=3}for(;n.have<19;)n.lens[U[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,X={bits:n.lenbits},$=tf(wk,n.lens,0,19,n.lencode,0,n.work,X),n.lenbits=X.bits,$){e.msg="invalid code lengths set",n.mode=fi;break}n.have=0,n.mode=n5;case n5:for(;n.have<n.nlen+n.ndist;){for(;C=n.lencode[d&(1<<n.lenbits)-1],E=C>>>24,R=C>>>16&255,k=C&65535,!(E<=h);){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}if(k<16)d>>>=E,h-=E,n.lens[n.have++]=k;else{if(k===16){for(z=E+2;h<z;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}if(d>>>=E,h-=E,n.have===0){e.msg="invalid bit length repeat",n.mode=fi;break}V=n.lens[n.have-1],g=3+(d&3),d>>>=2,h-=2}else if(k===17){for(z=E+3;h<z;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}d>>>=E,h-=E,V=0,g=3+(d&7),d>>>=3,h-=3}else{for(z=E+7;h<z;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}d>>>=E,h-=E,V=0,g=11+(d&127),d>>>=7,h-=7}if(n.have+g>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=fi;break}for(;g--;)n.lens[n.have++]=V}}if(n.mode===fi)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=fi;break}if(n.lenbits=9,X={bits:n.lenbits},$=tf(o_,n.lens,0,n.nlen,n.lencode,0,n.work,X),n.lenbits=X.bits,$){e.msg="invalid literal/lengths set",n.mode=fi;break}if(n.distbits=6,n.distcode=n.distdyn,X={bits:n.distbits},$=tf(a_,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,X),n.distbits=X.bits,$){e.msg="invalid distances set",n.mode=fi;break}if(n.mode=xh,t===bh)break e;case xh:n.mode=wh;case wh:if(c>=6&&u>=258){e.next_out=l,e.avail_out=u,e.next_in=a,e.avail_in=c,n.hold=d,n.bits=h,mk(e,b),l=e.next_out,o=e.output,u=e.avail_out,a=e.next_in,i=e.input,c=e.avail_in,d=n.hold,h=n.bits,n.mode===Bs&&(n.back=-1);break}for(n.back=0;C=n.lencode[d&(1<<n.lenbits)-1],E=C>>>24,R=C>>>16&255,k=C&65535,!(E<=h);){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}if(R&&(R&240)===0){for(M=E,P=R,W=k;C=n.lencode[W+((d&(1<<M+P)-1)>>M)],E=C>>>24,R=C>>>16&255,k=C&65535,!(M+E<=h);){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}d>>>=M,h-=M,n.back+=M}if(d>>>=E,h-=E,n.back+=E,n.length=k,R===0){n.mode=s5;break}if(R&32){n.back=-1,n.mode=Bs;break}if(R&64){e.msg="invalid literal/length code",n.mode=fi;break}n.extra=R&15,n.mode=i5;case i5:if(n.extra){for(z=n.extra;h<z;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}n.length+=d&(1<<n.extra)-1,d>>>=n.extra,h-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=r5;case r5:for(;C=n.distcode[d&(1<<n.distbits)-1],E=C>>>24,R=C>>>16&255,k=C&65535,!(E<=h);){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}if((R&240)===0){for(M=E,P=R,W=k;C=n.distcode[W+((d&(1<<M+P)-1)>>M)],E=C>>>24,R=C>>>16&255,k=C&65535,!(M+E<=h);){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}d>>>=M,h-=M,n.back+=M}if(d>>>=E,h-=E,n.back+=E,R&64){e.msg="invalid distance code",n.mode=fi;break}n.offset=k,n.extra=R&15,n.mode=o5;case o5:if(n.extra){for(z=n.extra;h<z;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}n.offset+=d&(1<<n.extra)-1,d>>>=n.extra,h-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=fi;break}n.mode=a5;case a5:if(u===0)break e;if(g=b-u,n.offset>g){if(g=n.offset-g,g>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=fi;break}g>n.wnext?(g-=n.wnext,A=n.wsize-g):A=n.wnext-g,g>n.length&&(g=n.length),_=n.window}else _=o,A=l-n.offset,g=n.length;g>u&&(g=u),u-=g,n.length-=g;do o[l++]=_[A++];while(--g);n.length===0&&(n.mode=wh);break;case s5:if(u===0)break e;o[l++]=n.length,u--,n.mode=wh;break;case wm:if(n.wrap){for(;h<32;){if(c===0)break e;c--,d|=i[a++]<<h,h+=8}if(b-=u,e.total_out+=b,n.total+=b,n.wrap&4&&b&&(e.adler=n.check=n.flags?rs(n.check,o,b,l-b):lg(n.check,o,b,l-b)),b=u,n.wrap&4&&(n.flags?d:u5(d))!==n.check){e.msg="incorrect data check",n.mode=fi;break}d=0,h=0}n.mode=l5;case l5:if(n.wrap&&n.flags){for(;h<32;){if(c===0)break e;c--,d+=i[a++]<<h,h+=8}if(n.wrap&4&&d!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=fi;break}d=0,h=0}n.mode=c5;case c5:$=Sk;break e;case fi:$=s_;break e;case c_:return l_;case u_:default:return Zo}return e.next_out=l,e.avail_out=u,e.next_in=a,e.avail_in=c,n.hold=d,n.bits=h,(n.wsize||b!==e.avail_out&&n.mode<fi&&(n.mode<wm||t!==B2))&&m_(e,e.output,e.next_out,b-e.avail_out),v-=e.avail_in,b-=e.avail_out,e.total_in+=v,e.total_out+=b,n.total+=b,n.wrap&4&&b&&(e.adler=n.check=n.flags?rs(n.check,o,b,e.next_out-b):lg(n.check,o,b,e.next_out-b)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Bs?128:0)+(n.mode===xh||n.mode===xm?256:0),(v===0&&b===0||t===B2)&&$===Ic&&($=Nk),$},Dk=e=>{if(Mc(e))return Zo;let t=e.state;return t.window&&(t.window=null),e.state=null,Ic},Pk=(e,t)=>{if(Mc(e))return Zo;const n=e.state;return(n.wrap&2)===0?Zo:(n.head=t,t.done=!1,Ic)},Ok=(e,t)=>{const n=t.length;let i,o,a;return Mc(e)||(i=e.state,i.wrap!==0&&i.mode!==lp)?Zo:i.mode===lp&&(o=1,o=lg(o,t,n,0),o!==i.check)?s_:(a=m_(e,t,n,n),a?(i.mode=c_,l_):(i.havedict=1,Ic))};var Uk=f_,zk=h_,jk=d_,Fk=Rk,Bk=p_,qk=Mk,Hk=Dk,Gk=Pk,Vk=Ok,$k="pako inflate (from Nodeca project)",Hs={inflateReset:Uk,inflateReset2:zk,inflateResetKeep:jk,inflateInit:Fk,inflateInit2:Bk,inflate:qk,inflateEnd:Hk,inflateGetHeader:Gk,inflateSetDictionary:Vk,inflateInfo:$k};function Yk(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Wk=Yk;const g_=Object.prototype.toString,{Z_NO_FLUSH:Xk,Z_FINISH:Jk,Z_OK:uf,Z_STREAM_END:Em,Z_NEED_DICT:Nm,Z_STREAM_ERROR:Kk,Z_DATA_ERROR:f5,Z_MEM_ERROR:Zk}=n_;function wf(e){this.options=i_.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new hk,this.strm.avail_out=0;let n=Hs.inflateInit2(this.strm,t.windowBits);if(n!==uf)throw new Error(cg[n]);if(this.header=new Wk,Hs.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=ug.string2buf(t.dictionary):g_.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Hs.inflateSetDictionary(this.strm,t.dictionary),n!==uf)))throw new Error(cg[n])}wf.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize,o=this.options.dictionary;let a,l,c;if(this.ended)return!1;for(t===~~t?l=t:l=t===!0?Jk:Xk,g_.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),a=Hs.inflate(n,l),a===Nm&&o&&(a=Hs.inflateSetDictionary(n,o),a===uf?a=Hs.inflate(n,l):a===f5&&(a=Nm));n.avail_in>0&&a===Em&&n.state.wrap>0&&e[n.next_in]!==0;)Hs.inflateReset(n),a=Hs.inflate(n,l);switch(a){case Kk:case f5:case Nm:case Zk:return this.onEnd(a),this.ended=!0,!1}if(c=n.avail_out,n.next_out&&(n.avail_out===0||a===Em))if(this.options.to==="string"){let u=ug.utf8border(n.output,n.next_out),d=n.next_out-u,h=ug.buf2string(n.output,u);n.next_out=d,n.avail_out=i-d,d&&n.output.set(n.output.subarray(u,u+d),0),this.onData(h)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(a===uf&&c===0)){if(a===Em)return a=Hs.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};wf.prototype.onData=function(e){this.chunks.push(e)};wf.prototype.onEnd=function(e){e===uf&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i_.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Qk(e,t){const n=new wf(t);if(n.push(e),n.err)throw n.msg||cg[n.err];return n.result}var e6=wf,t6=Qk,n6={Inflate:e6,inflate:t6};const{Inflate:i6,inflate:r6}=n6;var h5=i6,o6=r6;const v_=[];for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t&1?t=3988292384^t>>>1:t=t>>>1;v_[e]=t}const p5=4294967295;function a6(e,t,n){let i=e;for(let o=0;o<n;o++)i=v_[(i^t[o])&255]^i>>>8;return i}function s6(e,t){return(a6(p5,e,t)^p5)>>>0}function m5(e,t,n){const i=e.readUint32(),o=s6(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(o!==i)throw new Error(`CRC mismatch for chunk ${n}. Expected ${i}, found ${o}`)}function y_(e,t,n){for(let i=0;i<n;i++)t[i]=e[i]}function b_(e,t,n,i){let o=0;for(;o<i;o++)t[o]=e[o];for(;o<n;o++)t[o]=e[o]+t[o-i]&255}function x_(e,t,n,i){let o=0;if(n.length===0)for(;o<i;o++)t[o]=e[o];else for(;o<i;o++)t[o]=e[o]+n[o]&255}function w_(e,t,n,i,o){let a=0;if(n.length===0){for(;a<o;a++)t[a]=e[a];for(;a<i;a++)t[a]=e[a]+(t[a-o]>>1)&255}else{for(;a<o;a++)t[a]=e[a]+(n[a]>>1)&255;for(;a<i;a++)t[a]=e[a]+(t[a-o]+n[a]>>1)&255}}function __(e,t,n,i,o){let a=0;if(n.length===0){for(;a<o;a++)t[a]=e[a];for(;a<i;a++)t[a]=e[a]+t[a-o]&255}else{for(;a<o;a++)t[a]=e[a]+n[a]&255;for(;a<i;a++)t[a]=e[a]+l6(t[a-o],n[a],n[a-o])&255}}function l6(e,t,n){const i=e+t-n,o=Math.abs(i-e),a=Math.abs(i-t),l=Math.abs(i-n);return o<=a&&o<=l?e:a<=l?t:n}function c6(e,t,n,i,o,a){switch(e){case 0:y_(t,n,o);break;case 1:b_(t,n,o,a);break;case 2:x_(t,n,i,o);break;case 3:w_(t,n,i,o,a);break;case 4:__(t,n,i,o,a);break;default:throw new Error(`Unsupported filter: ${e}`)}}const u6=new Uint16Array([255]),d6=new Uint8Array(u6.buffer),f6=d6[0]===255;function h6(e){const{data:t,width:n,height:i,channels:o,depth:a}=e,l=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],c=Math.ceil(a/8)*o,u=new Uint8Array(i*n*c);let d=0;for(let h=0;h<7;h++){const v=l[h],b=Math.ceil((n-v.x)/v.xStep),g=Math.ceil((i-v.y)/v.yStep);if(b<=0||g<=0)continue;const A=b*c,_=new Uint8Array(A);for(let C=0;C<g;C++){const E=t[d++],R=t.subarray(d,d+A);d+=A;const k=new Uint8Array(A);c6(E,R,k,_,A,c),_.set(k);for(let M=0;M<b;M++){const P=v.x+M*v.xStep,W=v.y+C*v.yStep;if(!(P>=n||W>=i))for(let V=0;V<c;V++)u[(W*n+P)*c+V]=k[M*c+V]}}}if(a===16){const h=new Uint16Array(u.buffer);if(f6)for(let v=0;v<h.length;v++)h[v]=p6(h[v]);return h}else return u}function p6(e){return(e&255)<<8|e>>8&255}const m6=new Uint16Array([255]),g6=new Uint8Array(m6.buffer),v6=g6[0]===255,y6=new Uint8Array(0);function g5(e){const{data:t,width:n,height:i,channels:o,depth:a}=e,l=Math.ceil(a/8)*o,c=Math.ceil(a/8*o*n),u=new Uint8Array(i*c);let d=y6,h=0,v,b;for(let g=0;g<i;g++){switch(v=t.subarray(h+1,h+1+c),b=u.subarray(g*c,(g+1)*c),t[h]){case 0:y_(v,b,c);break;case 1:b_(v,b,c,l);break;case 2:x_(v,b,d,c);break;case 3:w_(v,b,d,c,l);break;case 4:__(v,b,d,c,l);break;default:throw new Error(`Unsupported filter: ${t[h]}`)}d=b,h+=c+1}if(a===16){const g=new Uint16Array(u.buffer);if(v6)for(let A=0;A<g.length;A++)g[A]=b6(g[A]);return g}else return u}function b6(e){return(e&255)<<8|e>>8&255}const Gh=Uint8Array.of(137,80,78,71,13,10,26,10);function v5(e){if(!x6(e.readBytes(Gh.length)))throw new Error("wrong PNG signature")}function x6(e){if(e.length<Gh.length)return!1;for(let t=0;t<Gh.length;t++)if(e[t]!==Gh[t])return!1;return!0}const w6="tEXt",_6=0,S_=new TextDecoder("latin1");function S6(e){if(N6(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const E6=/^[\u0000-\u00FF]*$/;function N6(e){if(!E6.test(e))throw new Error("invalid latin1 text")}function A6(e,t,n){const i=E_(t);e[i]=C6(t,n-i.length-1)}function E_(e){for(e.mark();e.readByte()!==_6;);const t=e.offset;e.reset();const n=S_.decode(e.readBytes(t-e.offset-1));return e.skip(1),S6(n),n}function C6(e,t){return S_.decode(e.readBytes(t))}const Co={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Am={UNKNOWN:-1,DEFLATE:0},y5={UNKNOWN:-1,ADAPTIVE:0},Cm={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},_h={NONE:0,BACKGROUND:1,PREVIOUS:2},Tm={SOURCE:0,OVER:1};class T6 extends i1{constructor(n,i={}){super(n);Fn(this,"_checkCrc");Fn(this,"_inflator");Fn(this,"_png");Fn(this,"_apng");Fn(this,"_end");Fn(this,"_hasPalette");Fn(this,"_palette");Fn(this,"_hasTransparency");Fn(this,"_transparency");Fn(this,"_compressionMethod");Fn(this,"_filterMethod");Fn(this,"_interlaceMethod");Fn(this,"_colorType");Fn(this,"_isAnimated");Fn(this,"_numberOfFrames");Fn(this,"_numberOfPlays");Fn(this,"_frames");Fn(this,"_writingDataChunks");const{checkCrc:o=!1}=i;this._checkCrc=o,this._inflator=new h5,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Am.UNKNOWN,this._filterMethod=y5.UNKNOWN,this._interlaceMethod=Cm.UNKNOWN,this._colorType=Co.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(v5(this);!this._end;){const n=this.readUint32(),i=this.readChars(4);this.decodeChunk(n,i)}return this.decodeImage(),this._png}decodeApng(){for(v5(this);!this._end;){const n=this.readUint32(),i=this.readChars(4);this.decodeApngChunk(n,i)}return this.decodeApngImage(),this._apng}decodeChunk(n,i){const o=this.offset;switch(i){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(n);break;case"IDAT":this.decodeIDAT(n);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(n);break;case"iCCP":this.decodeiCCP(n);break;case w6:A6(this._png.text,this,n);break;case"pHYs":this.decodepHYs();break;default:this.skip(n);break}if(this.offset-o!==n)throw new Error(`Length mismatch while decoding chunk ${i}`);this._checkCrc?m5(this,n+4,i):this.skip(4)}decodeApngChunk(n,i){const o=this.offset;switch(i!=="fdAT"&&i!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),i){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(n);break;default:this.decodeChunk(n,i),this.offset=o+n;break}if(this.offset-o!==n)throw new Error(`Length mismatch while decoding chunk ${i}`);this._checkCrc?m5(this,n+4,i):this.skip(4)}decodeIHDR(){const n=this._png;n.width=this.readUint32(),n.height=this.readUint32(),n.depth=k6(this.readUint8());const i=this.readUint8();this._colorType=i;let o;switch(i){case Co.GREYSCALE:o=1;break;case Co.TRUECOLOUR:o=3;break;case Co.INDEXED_COLOUR:o=1;break;case Co.GREYSCALE_ALPHA:o=2;break;case Co.TRUECOLOUR_ALPHA:o=4;break;case Co.UNKNOWN:default:throw new Error(`Unknown color type: ${i}`)}if(this._png.channels=o,this._compressionMethod=this.readUint8(),this._compressionMethod!==Am.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const n={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(n)}decodePLTE(n){if(n%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${n}`);const i=n/3;this._hasPalette=!0;const o=[];this._palette=o;for(let a=0;a<i;a++)o.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(n){this._writingDataChunks=!0;const i=n,o=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,o,i)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodeFDAT(n){this._writingDataChunks=!0;let i=n,o=this.offset+this.byteOffset;if(o+=4,i-=4,this._inflator.push(new Uint8Array(this.buffer,o,i)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodetRNS(n){switch(this._colorType){case Co.GREYSCALE:case Co.TRUECOLOUR:{if(n%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${n}`);if(n/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${n/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(n/2);for(let i=0;i<n/2;i++)this._transparency[i]=this.readUint16();break}case Co.INDEXED_COLOUR:{if(n>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${n} vs ${this._palette.length})`);let i=0;for(;i<n;i++){const o=this.readByte();this._palette[i].push(o)}for(;i<this._palette.length;i++)this._palette[i].push(255);break}case Co.UNKNOWN:case Co.GREYSCALE_ALPHA:case Co.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(n){const i=E_(this),o=this.readUint8();if(o!==Am.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${o}`);const a=this.readBytes(n-i.length-2);this._png.iccEmbeddedProfile={name:i,profile:o6(a)}}decodepHYs(){const n=this.readUint32(),i=this.readUint32(),o=this.readByte();this._png.resolution={x:n,y:i,unit:o}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let n=0;n<this._numberOfFrames;n++){const i={sequenceNumber:this._frames[n].sequenceNumber,delayNumber:this._frames[n].delayNumber,delayDenominator:this._frames[n].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},o=this._frames.at(n);if(o){if(o.data=g5({data:o.data,width:o.width,height:o.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),n===0||o.xOffset===0&&o.yOffset===0&&o.width===this._png.width&&o.height===this._png.height)i.data=o.data;else{const a=this._apng.frames.at(n-1);this.disposeFrame(o,a,i),this.addFrameDataToCanvas(i,o)}this._apng.frames.push(i)}}return this._apng}disposeFrame(n,i,o){switch(n.disposeOp){case _h.NONE:break;case _h.BACKGROUND:for(let a=0;a<this._png.height;a++)for(let l=0;l<this._png.width;l++){const c=(a*n.width+l)*this._png.channels;for(let u=0;u<this._png.channels;u++)o.data[c+u]=0}break;case _h.PREVIOUS:o.data.set(i.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(n,i){const o=1<<this._png.depth,a=(l,c)=>{const u=((l+i.yOffset)*this._png.width+i.xOffset+c)*this._png.channels,d=(l*i.width+c)*this._png.channels;return{index:u,frameIndex:d}};switch(i.blendOp){case Tm.SOURCE:for(let l=0;l<i.height;l++)for(let c=0;c<i.width;c++){const{index:u,frameIndex:d}=a(l,c);for(let h=0;h<this._png.channels;h++)n.data[u+h]=i.data[d+h]}break;case Tm.OVER:for(let l=0;l<i.height;l++)for(let c=0;c<i.width;c++){const{index:u,frameIndex:d}=a(l,c);for(let h=0;h<this._png.channels;h++){const v=i.data[d+this._png.channels-1]/o,b=h%(this._png.channels-1)===0?1:i.data[d+h],g=Math.floor(v*b+(1-v)*n.data[u+h]);n.data[u+h]+=g}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var i;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const n=this._isAnimated?((i=this._frames)==null?void 0:i.at(0)).data:this._inflator.result;if(this._filterMethod!==y5.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Cm.NO_INTERLACE)this._png.data=g5({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Cm.ADAM7)this._png.data=h6({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const n=this._inflator.result,i=this._frames.at(-1);i?i.data=n:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:_h.NONE,blendOp:Tm.SOURCE,data:n}),this._inflator=new h5,this._writingDataChunks=!1}}function k6(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var b5;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(b5||(b5={}));function I6(e,t){return new T6(e,t).decode()}var Xt=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function km(){Xt.console&&typeof Xt.console.log=="function"&&Xt.console.log.apply(Xt.console,arguments)}var Qn={log:km,warn:function(e){Xt.console&&(typeof Xt.console.warn=="function"?Xt.console.warn.apply(Xt.console,arguments):km.call(null,arguments))},error:function(e){Xt.console&&(typeof Xt.console.error=="function"?Xt.console.error.apply(Xt.console,arguments):km(e))}};function Im(e,t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){Sc(i.response,t,n)},i.onerror=function(){Qn.error("could not download file")},i.send()}function x5(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Sh(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Sc=Xt.saveAs||((typeof window>"u"?"undefined":qn(window))!=="object"||window!==Xt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var i=Xt.URL||Xt.webkitURL,o=document.createElement("a");t=t||e.name||"download",o.download=t,o.rel="noopener",typeof e=="string"?(o.href=e,o.origin!==location.origin?x5(o.href)?Im(e,t,n):Sh(o,o.target="_blank"):Sh(o)):(o.href=i.createObjectURL(e),setTimeout(function(){i.revokeObjectURL(o.href)},4e4),setTimeout(function(){Sh(o)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download",typeof e=="string")if(x5(e))Im(e,t,n);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout(function(){Sh(i)})}else navigator.msSaveOrOpenBlob((function(o,a){return a===void 0?a={autoBom:!1}:qn(a)!=="object"&&(Qn.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o})(e,n),t)}:function(e,t,n,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof e=="string")return Im(e,t,n);var o=e.type==="application/octet-stream",a=/constructor/i.test(Xt.HTMLElement)||Xt.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||o&&a)&&(typeof FileReader>"u"?"undefined":qn(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var h=c.result;h=l?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=h:location=h,i=null},c.readAsDataURL(e)}else{var u=Xt.URL||Xt.webkitURL,d=u.createObjectURL(e);i?i.location=d:location.href=d,i=null,setTimeout(function(){u.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function N_(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],i=0;i<n.length;i++){var o=n[i].re,a=n[i].process,l=o.exec(e);l&&(t=a(l),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),u=this.g.toString(16),d=this.b.toString(16);return c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),d.length==1&&(d="0"+d),"#"+c+u+d}}var Vh=Xt.atob.bind(Xt),w5=Xt.btoa.bind(Xt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Rm(e,t){var n=e[0],i=e[1],o=e[2],a=e[3];n=_r(n,i,o,a,t[0],7,-680876936),a=_r(a,n,i,o,t[1],12,-389564586),o=_r(o,a,n,i,t[2],17,606105819),i=_r(i,o,a,n,t[3],22,-1044525330),n=_r(n,i,o,a,t[4],7,-176418897),a=_r(a,n,i,o,t[5],12,1200080426),o=_r(o,a,n,i,t[6],17,-1473231341),i=_r(i,o,a,n,t[7],22,-45705983),n=_r(n,i,o,a,t[8],7,1770035416),a=_r(a,n,i,o,t[9],12,-1958414417),o=_r(o,a,n,i,t[10],17,-42063),i=_r(i,o,a,n,t[11],22,-1990404162),n=_r(n,i,o,a,t[12],7,1804603682),a=_r(a,n,i,o,t[13],12,-40341101),o=_r(o,a,n,i,t[14],17,-1502002290),n=Sr(n,i=_r(i,o,a,n,t[15],22,1236535329),o,a,t[1],5,-165796510),a=Sr(a,n,i,o,t[6],9,-1069501632),o=Sr(o,a,n,i,t[11],14,643717713),i=Sr(i,o,a,n,t[0],20,-373897302),n=Sr(n,i,o,a,t[5],5,-701558691),a=Sr(a,n,i,o,t[10],9,38016083),o=Sr(o,a,n,i,t[15],14,-660478335),i=Sr(i,o,a,n,t[4],20,-405537848),n=Sr(n,i,o,a,t[9],5,568446438),a=Sr(a,n,i,o,t[14],9,-1019803690),o=Sr(o,a,n,i,t[3],14,-187363961),i=Sr(i,o,a,n,t[8],20,1163531501),n=Sr(n,i,o,a,t[13],5,-1444681467),a=Sr(a,n,i,o,t[2],9,-51403784),o=Sr(o,a,n,i,t[7],14,1735328473),n=Er(n,i=Sr(i,o,a,n,t[12],20,-1926607734),o,a,t[5],4,-378558),a=Er(a,n,i,o,t[8],11,-2022574463),o=Er(o,a,n,i,t[11],16,1839030562),i=Er(i,o,a,n,t[14],23,-35309556),n=Er(n,i,o,a,t[1],4,-1530992060),a=Er(a,n,i,o,t[4],11,1272893353),o=Er(o,a,n,i,t[7],16,-155497632),i=Er(i,o,a,n,t[10],23,-1094730640),n=Er(n,i,o,a,t[13],4,681279174),a=Er(a,n,i,o,t[0],11,-358537222),o=Er(o,a,n,i,t[3],16,-722521979),i=Er(i,o,a,n,t[6],23,76029189),n=Er(n,i,o,a,t[9],4,-640364487),a=Er(a,n,i,o,t[12],11,-421815835),o=Er(o,a,n,i,t[15],16,530742520),n=Nr(n,i=Er(i,o,a,n,t[2],23,-995338651),o,a,t[0],6,-198630844),a=Nr(a,n,i,o,t[7],10,1126891415),o=Nr(o,a,n,i,t[14],15,-1416354905),i=Nr(i,o,a,n,t[5],21,-57434055),n=Nr(n,i,o,a,t[12],6,1700485571),a=Nr(a,n,i,o,t[3],10,-1894986606),o=Nr(o,a,n,i,t[10],15,-1051523),i=Nr(i,o,a,n,t[1],21,-2054922799),n=Nr(n,i,o,a,t[8],6,1873313359),a=Nr(a,n,i,o,t[15],10,-30611744),o=Nr(o,a,n,i,t[6],15,-1560198380),i=Nr(i,o,a,n,t[13],21,1309151649),n=Nr(n,i,o,a,t[4],6,-145523070),a=Nr(a,n,i,o,t[11],10,-1120210379),o=Nr(o,a,n,i,t[2],15,718787259),i=Nr(i,o,a,n,t[9],21,-343485551),e[0]=Ol(n,e[0]),e[1]=Ol(i,e[1]),e[2]=Ol(o,e[2]),e[3]=Ol(a,e[3])}function kp(e,t,n,i,o,a){return t=Ol(Ol(t,e),Ol(i,a)),Ol(t<<o|t>>>32-o,n)}function _r(e,t,n,i,o,a,l){return kp(t&n|~t&i,e,t,o,a,l)}function Sr(e,t,n,i,o,a,l){return kp(t&i|n&~i,e,t,o,a,l)}function Er(e,t,n,i,o,a,l){return kp(t^n^i,e,t,o,a,l)}function Nr(e,t,n,i,o,a,l){return kp(n^(t|~i),e,t,o,a,l)}function A_(e){var t,n=e.length,i=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Rm(i,R6(e.substring(t-64,t)));e=e.substring(t-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)o[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(Rm(i,o),t=0;t<16;t++)o[t]=0;return o[14]=8*n,Rm(i,o),i}function R6(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}var _5="0123456789abcdef".split("");function L6(e){for(var t="",n=0;n<4;n++)t+=_5[e>>8*n+4&15]+_5[e>>8*n&15];return t}function M6(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function dg(e){return A_(e).map(M6).join("")}var D6=(function(e){for(var t=0;t<e.length;t++)e[t]=L6(e[t]);return e.join("")})(A_("hello"))!="5d41402abc4b2a76b9719d911017c592";function Ol(e,t){if(D6){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function fg(e,t){var n,i,o,a;if(e!==n){for(var l=(o=e,a=1+(256/e.length|0),new Array(a+1).join(o)),c=[],u=0;u<256;u++)c[u]=u;var d=0;for(u=0;u<256;u++){var h=c[u];d=(d+h+l.charCodeAt(u))%256,c[u]=c[d],c[d]=h}n=e,i=c}else c=i;var v=t.length,b=0,g=0,A="";for(u=0;u<v;u++)g=(g+(h=c[b=(b+1)%256]))%256,c[b]=c[g],c[g]=h,l=c[(c[b]+c[g])%256],A+=String.fromCharCode(t.charCodeAt(u)^l);return A}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var S5={print:4,modify:8,copy:16,"annot-forms":32};function Lu(e,t,n,i){this.v=1,this.r=2;var o=192;e.forEach(function(c){if(S5.perm!==void 0)throw new Error("Invalid permission: "+c);o+=S5[c]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(t+this.padding).substr(0,32),l=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,l),this.P=-(1+(255^o)),this.encryptionKey=dg(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=fg(this.encryptionKey,this.padding)}function Mu(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,i=0;i<n;i++){var o=e.charCodeAt(i);t+=o<33||o===35||o===37||o===40||o===41||o===47||o===60||o===62||o===91||o===93||o===123||o===125||o>126?"#"+("0"+o.toString(16)).slice(-2):e[i]}return t}function E5(e){if(qn(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(n,i,o){if(o=o||!1,typeof n!="string"||typeof i!="function"||typeof o!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(n)||(t[n]={});var a=Math.random().toString(35);return t[n][a]=[i,!!o],a},this.unsubscribe=function(n){for(var i in t)if(t[i][n])return delete t[i][n],Object.keys(t[i]).length===0&&delete t[i],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var i=Array.prototype.slice.call(arguments,1),o=[];for(var a in t[n]){var l=t[n][a];try{l[0].apply(e,i)}catch(c){Xt.console&&Qn.error("jsPDF PubSub Error",c.message,c)}l[1]&&o.push(a)}o.length&&o.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function cp(e){if(!(this instanceof cp))return new cp(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function C_(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Nc(e,t,n,i,o){if(!(this instanceof Nc))return new Nc(e,t,n,i,o);this.type=e==="axial"?2:3,this.coords=t,this.colors=n,C_.call(this,i,o)}function Pu(e,t,n,i,o){if(!(this instanceof Pu))return new Pu(e,t,n,i,o);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,C_.call(this,i,o)}function Dt(e){var t,n=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],o=arguments[2],a=arguments[3],l=[],c=1,u=16,d="S",h=null;qn(e=e||{})==="object"&&(n=e.orientation,i=e.unit||i,o=e.format||o,a=e.compress||e.compressPdf||a,(h=e.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),c=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(u=e.floatPrecision),d=e.defaultPathOperation||"S"),l=e.filters||(a===!0?["FlateEncode"]:l),i=i||"mm",n=(""+(n||"P")).toLowerCase();var v=e.putOnlyUsedFonts||!1,b={},g={internal:{},__private__:{}};g.__private__.PubSub=E5;var A="1.3",_=g.__private__.getPdfVersion=function(){return A};g.__private__.setPdfVersion=function(L){A=L};var C={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return C};var E=g.__private__.getPageFormat=function(L){return C[L]};o=o||"a4";var R="compat",k="advanced",M=R;function P(){this.saveGraphicsState(),K(new bt(Et,0,0,-Et,0,la()*Et).toString()+" cm"),this.setFontSize(this.getFontSize()/Et),d="n",M=k}function W(){this.restoreGraphicsState(),d="S",M=R}var V=g.__private__.combineFontStyleAndFontWeight=function(L,Z){if(L=="bold"&&Z=="normal"||L=="bold"&&Z==400||L=="normal"&&Z=="italic"||L=="bold"&&Z=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Z&&(L=Z==400||Z==="normal"?L==="italic"?"italic":"normal":Z!=700&&Z!=="bold"||L!=="normal"?(Z==700?"bold":Z)+""+L:"bold"),L};g.advancedAPI=function(L){var Z=M===R;return Z&&P.call(this),typeof L!="function"||(L(this),Z&&W.call(this)),this},g.compatAPI=function(L){var Z=M===k;return Z&&W.call(this),typeof L!="function"||(L(this),Z&&P.call(this)),this},g.isAdvancedAPI=function(){return M===k};var $,j=function(L){if(M!==k)throw new Error(L+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},X=g.roundToPrecision=g.__private__.roundToPrecision=function(L,Z){var ve=t||Z;if(isNaN(L)||isNaN(ve))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return L.toFixed(ve).replace(/0+$/,"")};$=g.hpf=g.__private__.hpf=typeof u=="number"?function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.hpf");return X(L,u)}:u==="smart"?function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.hpf");return X(L,L>-1&&L<1?16:5)}:function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.hpf");return X(L,16)};var z=g.f2=g.__private__.f2=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.f2");return X(L,2)},U=g.__private__.f3=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.f3");return X(L,3)},q=g.scale=g.__private__.scale=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.scale");return M===R?L*Et:M===k?L:void 0},I=function(L){return q((function(Z){return M===R?la()-Z:M===k?Z:void 0})(L))};g.__private__.setPrecision=g.setPrecision=function(L){typeof parseInt(L,10)=="number"&&(t=parseInt(L,10))};var ie,J="00000000000000000000000000000000",Y=g.__private__.getFileId=function(){return J},le=g.__private__.setFileId=function(L){return J=L!==void 0&&/^[a-fA-F0-9]{32}$/.test(L)?L.toUpperCase():J.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(Ri=new Lu(h.userPermissions,h.userPassword,h.ownerPassword,J)),J};g.setFileId=function(L){return le(L),this},g.getFileId=function(){return Y()};var pe=g.__private__.convertDateToPDFDate=function(L){var Z=L.getTimezoneOffset(),ve=Z<0?"+":"-",Ee=Math.floor(Math.abs(Z/60)),Pe=Math.abs(Z%60),Ke=[ve,te(Ee),"'",te(Pe),"'"].join("");return["D:",L.getFullYear(),te(L.getMonth()+1),te(L.getDate()),te(L.getHours()),te(L.getMinutes()),te(L.getSeconds()),Ke].join("")},Ie=g.__private__.convertPDFDateToDate=function(L){var Z=parseInt(L.substr(2,4),10),ve=parseInt(L.substr(6,2),10)-1,Ee=parseInt(L.substr(8,2),10),Pe=parseInt(L.substr(10,2),10),Ke=parseInt(L.substr(12,2),10),ot=parseInt(L.substr(14,2),10);return new Date(Z,ve,Ee,Pe,Ke,ot,0)},G=g.__private__.setCreationDate=function(L){var Z;if(L===void 0&&(L=new Date),L instanceof Date)Z=pe(L);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(L))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Z=L}return ie=Z},O=g.__private__.getCreationDate=function(L){var Z=ie;return L==="jsDate"&&(Z=Ie(ie)),Z};g.setCreationDate=function(L){return G(L),this},g.getCreationDate=function(L){return O(L)};var ee,te=g.__private__.padd2=function(L){return("0"+parseInt(L)).slice(-2)},ce=g.__private__.padd2Hex=function(L){return("00"+(L=L.toString())).substr(L.length)},ye=0,we=[],Te=[],Ce=0,De=[],$e=[],at=!1,st=Te;g.__private__.setCustomOutputDestination=function(L){at=!0,st=L};var B=function(L){at||(st=L)};g.__private__.resetCustomOutputDestination=function(){at=!1,st=Te};var K=g.__private__.out=function(L){return L=L.toString(),Ce+=L.length+1,st.push(L),st},_e=g.__private__.write=function(L){return K(arguments.length===1?L.toString():Array.prototype.join.call(arguments," "))},he=g.__private__.getArrayBuffer=function(L){for(var Z=L.length,ve=new ArrayBuffer(Z),Ee=new Uint8Array(ve);Z--;)Ee[Z]=L.charCodeAt(Z);return ve},ne=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return ne};var ae=e.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(L){return ae=M===k?L/Et:L,this};var be,Me=g.__private__.getFontSize=g.getFontSize=function(){return M===R?ae:ae*Et},Se=e.R2L||!1;g.__private__.setR2L=g.setR2L=function(L){return Se=L,this},g.__private__.getR2L=g.getR2L=function(){return Se};var He,Ne=g.__private__.setZoomMode=function(L){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(L))be=L;else if(isNaN(L)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(L)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+L+'" is not recognized.');be=L}else be=parseInt(L,10)};g.__private__.getZoomMode=function(){return be};var ze,We=g.__private__.setPageMode=function(L){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(L)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+L+'" is not recognized.');He=L};g.__private__.getPageMode=function(){return He};var dt=g.__private__.setLayoutMode=function(L){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(L)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+L+'" is not recognized.');ze=L};g.__private__.getLayoutMode=function(){return ze},g.__private__.setDisplayMode=g.setDisplayMode=function(L,Z,ve){return Ne(L),dt(Z),We(ve),this};var ft={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(L){if(Object.keys(ft).indexOf(L)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ft[L]},g.__private__.getDocumentProperties=function(){return ft},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(L){for(var Z in ft)ft.hasOwnProperty(Z)&&L[Z]&&(ft[Z]=L[Z]);return this},g.__private__.setDocumentProperty=function(L,Z){if(Object.keys(ft).indexOf(L)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ft[L]=Z};var ht,Et,mt,on,yt,vt={},Rt={},Ft=[],Le={},nt={},Qe={},ut={},wt=null,lt=0,et=[],pt=new E5(g),Bt=e.hotfixes||[],Vt={},zt={},Jt=[],bt=function L(Z,ve,Ee,Pe,Ke,ot){if(!(this instanceof L))return new L(Z,ve,Ee,Pe,Ke,ot);isNaN(Z)&&(Z=1),isNaN(ve)&&(ve=0),isNaN(Ee)&&(Ee=0),isNaN(Pe)&&(Pe=1),isNaN(Ke)&&(Ke=0),isNaN(ot)&&(ot=0),this._matrix=[Z,ve,Ee,Pe,Ke,ot]};Object.defineProperty(bt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(L){this._matrix[0]=L}}),Object.defineProperty(bt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(L){this._matrix[1]=L}}),Object.defineProperty(bt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(L){this._matrix[2]=L}}),Object.defineProperty(bt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(L){this._matrix[3]=L}}),Object.defineProperty(bt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(L){this._matrix[4]=L}}),Object.defineProperty(bt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(L){this._matrix[5]=L}}),Object.defineProperty(bt.prototype,"a",{get:function(){return this._matrix[0]},set:function(L){this._matrix[0]=L}}),Object.defineProperty(bt.prototype,"b",{get:function(){return this._matrix[1]},set:function(L){this._matrix[1]=L}}),Object.defineProperty(bt.prototype,"c",{get:function(){return this._matrix[2]},set:function(L){this._matrix[2]=L}}),Object.defineProperty(bt.prototype,"d",{get:function(){return this._matrix[3]},set:function(L){this._matrix[3]=L}}),Object.defineProperty(bt.prototype,"e",{get:function(){return this._matrix[4]},set:function(L){this._matrix[4]=L}}),Object.defineProperty(bt.prototype,"f",{get:function(){return this._matrix[5]},set:function(L){this._matrix[5]=L}}),Object.defineProperty(bt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(bt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(bt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(bt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),bt.prototype.join=function(L){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map($).join(L)},bt.prototype.multiply=function(L){var Z=L.sx*this.sx+L.shy*this.shx,ve=L.sx*this.shy+L.shy*this.sy,Ee=L.shx*this.sx+L.sy*this.shx,Pe=L.shx*this.shy+L.sy*this.sy,Ke=L.tx*this.sx+L.ty*this.shx+this.tx,ot=L.tx*this.shy+L.ty*this.sy+this.ty;return new bt(Z,ve,Ee,Pe,Ke,ot)},bt.prototype.decompose=function(){var L=this.sx,Z=this.shy,ve=this.shx,Ee=this.sy,Pe=this.tx,Ke=this.ty,ot=Math.sqrt(L*L+Z*Z),Ct=(L/=ot)*ve+(Z/=ot)*Ee;ve-=L*Ct,Ee-=Z*Ct;var Lt=Math.sqrt(ve*ve+Ee*Ee);return Ct/=Lt,L*(Ee/=Lt)<Z*(ve/=Lt)&&(L=-L,Z=-Z,Ct=-Ct,ot=-ot),{scale:new bt(ot,0,0,Lt,0,0),translate:new bt(1,0,0,1,Pe,Ke),rotate:new bt(L,Z,-Z,L,0,0),skew:new bt(1,0,Ct,1,0,0)}},bt.prototype.toString=function(L){return this.join(" ")},bt.prototype.inversed=function(){var L=this.sx,Z=this.shy,ve=this.shx,Ee=this.sy,Pe=this.tx,Ke=this.ty,ot=1/(L*Ee-Z*ve),Ct=Ee*ot,Lt=-Z*ot,$t=-ve*ot,Zt=L*ot;return new bt(Ct,Lt,$t,Zt,-Ct*Pe-$t*Ke,-Lt*Pe-Zt*Ke)},bt.prototype.applyToPoint=function(L){var Z=L.x*this.sx+L.y*this.shx+this.tx,ve=L.x*this.shy+L.y*this.sy+this.ty;return new Hr(Z,ve)},bt.prototype.applyToRectangle=function(L){var Z=this.applyToPoint(L),ve=this.applyToPoint(new Hr(L.x+L.w,L.y+L.h));return new ia(Z.x,Z.y,ve.x-Z.x,ve.y-Z.y)},bt.prototype.clone=function(){var L=this.sx,Z=this.shy,ve=this.shx,Ee=this.sy,Pe=this.tx,Ke=this.ty;return new bt(L,Z,ve,Ee,Pe,Ke)},g.Matrix=bt;var jt=g.matrixMult=function(L,Z){return Z.multiply(L)},sn=new bt(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=sn;var Nn=function(L,Z){if(!nt[L]){var ve=(Z instanceof Nc?"Sh":"P")+(Object.keys(Le).length+1).toString(10);Z.id=ve,nt[L]=ve,Le[ve]=Z,pt.publish("addPattern",Z)}};g.ShadingPattern=Nc,g.TilingPattern=Pu,g.addShadingPattern=function(L,Z){return j("addShadingPattern()"),Nn(L,Z),this},g.beginTilingPattern=function(L){j("beginTilingPattern()"),ys(L.boundingBox[0],L.boundingBox[1],L.boundingBox[2]-L.boundingBox[0],L.boundingBox[3]-L.boundingBox[1],L.matrix)},g.endTilingPattern=function(L,Z){j("endTilingPattern()"),Z.stream=$e[ee].join(`
`),Nn(L,Z),pt.publish("endTilingPattern",Z),Jt.pop().restore()};var Xn,mn=g.__private__.newObject=function(){var L=rn();return wn(L,!0),L},rn=g.__private__.newObjectDeferred=function(){return ye++,we[ye]=function(){return Ce},ye},wn=function(L,Z){return Z=typeof Z=="boolean"&&Z,we[L]=Ce,Z&&K(L+" 0 obj"),L},Qi=g.__private__.newAdditionalObject=function(){var L={objId:rn(),content:""};return De.push(L),L},Ii=rn(),On=rn(),ti=g.__private__.decodeColorString=function(L){var Z=L.split(" ");if(Z.length!==2||Z[1]!=="g"&&Z[1]!=="G")Z.length!==5||Z[4]!=="k"&&Z[4]!=="K"||(Z=[(1-Z[0])*(1-Z[3]),(1-Z[1])*(1-Z[3]),(1-Z[2])*(1-Z[3]),"r"]);else{var ve=parseFloat(Z[0]);Z=[ve,ve,ve,"r"]}for(var Ee="#",Pe=0;Pe<3;Pe++)Ee+=("0"+Math.floor(255*parseFloat(Z[Pe])).toString(16)).slice(-2);return Ee},er=g.__private__.encodeColorString=function(L){var Z;typeof L=="string"&&(L={ch1:L});var ve=L.ch1,Ee=L.ch2,Pe=L.ch3,Ke=L.ch4,ot=L.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ve=="string"&&ve.charAt(0)!=="#"){var Ct=new N_(ve);if(Ct.ok)ve=Ct.toHex();else if(!/^\d*\.?\d*$/.test(ve))throw new Error('Invalid color "'+ve+'" passed to jsPDF.encodeColorString.')}if(typeof ve=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ve)&&(ve="#"+ve[1]+ve[1]+ve[2]+ve[2]+ve[3]+ve[3]),typeof ve=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ve)){var Lt=parseInt(ve.substr(1),16);ve=Lt>>16&255,Ee=Lt>>8&255,Pe=255&Lt}if(Ee===void 0||Ke===void 0&&ve===Ee&&Ee===Pe)Z=typeof ve=="string"?ve+" "+ot[0]:L.precision===2?z(ve/255)+" "+ot[0]:U(ve/255)+" "+ot[0];else if(Ke===void 0||qn(Ke)==="object"){if(Ke&&!isNaN(Ke.a)&&Ke.a===0)return["1.","1.","1.",ot[1]].join(" ");Z=typeof ve=="string"?[ve,Ee,Pe,ot[1]].join(" "):L.precision===2?[z(ve/255),z(Ee/255),z(Pe/255),ot[1]].join(" "):[U(ve/255),U(Ee/255),U(Pe/255),ot[1]].join(" ")}else Z=typeof ve=="string"?[ve,Ee,Pe,Ke,ot[2]].join(" "):L.precision===2?[z(ve),z(Ee),z(Pe),z(Ke),ot[2]].join(" "):[U(ve),U(Ee),U(Pe),U(Ke),ot[2]].join(" ");return Z},Cr=g.__private__.getFilters=function(){return l},Br=g.__private__.putStream=function(L){var Z=(L=L||{}).data||"",ve=L.filters||Cr(),Ee=L.alreadyAppliedFilters||[],Pe=L.addLength1||!1,Ke=Z.length,ot=L.objectId,Ct=function(Li){return Li};if(h!==null&&ot===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(Ct=Ri.encryptor(ot,0));var Lt={};ve===!0&&(ve=["FlateEncode"]);var $t=L.additionalKeyValues||[],Zt=(Lt=Dt.API.processDataByFilters!==void 0?Dt.API.processDataByFilters(Z,ve):{data:Z,reverseChain:[]}).reverseChain+(Array.isArray(Ee)?Ee.join(" "):Ee.toString());if(Lt.data.length!==0&&($t.push({key:"Length",value:Lt.data.length}),Pe===!0&&$t.push({key:"Length1",value:Ke})),Zt.length!=0)if(Zt.split("/").length-1==1)$t.push({key:"Filter",value:Zt});else{$t.push({key:"Filter",value:"["+Zt+"]"});for(var gn=0;gn<$t.length;gn+=1)if($t[gn].key==="DecodeParms"){for(var ni=[],mi=0;mi<Lt.reverseChain.split("/").length-1;mi+=1)ni.push("null");ni.push($t[gn].value),$t[gn].value="["+ni.join(" ")+"]"}}K("<<");for(var Hn=0;Hn<$t.length;Hn++)K("/"+$t[Hn].key+" "+$t[Hn].value);K(">>"),Lt.data.length!==0&&(K("stream"),K(Ct(Lt.data)),K("endstream"))},fs=g.__private__.putPage=function(L){var Z=L.number,ve=L.data,Ee=L.objId,Pe=L.contentsObjId;wn(Ee,!0),K("<</Type /Page"),K("/Parent "+L.rootDictionaryObjId+" 0 R"),K("/Resources "+L.resourceDictionaryObjId+" 0 R"),K("/MediaBox ["+parseFloat($(L.mediaBox.bottomLeftX))+" "+parseFloat($(L.mediaBox.bottomLeftY))+" "+$(L.mediaBox.topRightX)+" "+$(L.mediaBox.topRightY)+"]"),L.cropBox!==null&&K("/CropBox ["+$(L.cropBox.bottomLeftX)+" "+$(L.cropBox.bottomLeftY)+" "+$(L.cropBox.topRightX)+" "+$(L.cropBox.topRightY)+"]"),L.bleedBox!==null&&K("/BleedBox ["+$(L.bleedBox.bottomLeftX)+" "+$(L.bleedBox.bottomLeftY)+" "+$(L.bleedBox.topRightX)+" "+$(L.bleedBox.topRightY)+"]"),L.trimBox!==null&&K("/TrimBox ["+$(L.trimBox.bottomLeftX)+" "+$(L.trimBox.bottomLeftY)+" "+$(L.trimBox.topRightX)+" "+$(L.trimBox.topRightY)+"]"),L.artBox!==null&&K("/ArtBox ["+$(L.artBox.bottomLeftX)+" "+$(L.artBox.bottomLeftY)+" "+$(L.artBox.topRightX)+" "+$(L.artBox.topRightY)+"]"),typeof L.userUnit=="number"&&L.userUnit!==1&&K("/UserUnit "+L.userUnit),pt.publish("putPage",{objId:Ee,pageContext:et[Z],pageNumber:Z,page:ve}),K("/Contents "+Pe+" 0 R"),K(">>"),K("endobj");var Ke=ve.join(`
`);return M===k&&(Ke+=`
Q`),wn(Pe,!0),Br({data:Ke,filters:Cr(),objectId:Pe}),K("endobj"),Ee},co=g.__private__.putPages=function(){var L,Z,ve=[];for(L=1;L<=lt;L++)et[L].objId=rn(),et[L].contentsObjId=rn();for(L=1;L<=lt;L++)ve.push(fs({number:L,data:$e[L],objId:et[L].objId,contentsObjId:et[L].contentsObjId,mediaBox:et[L].mediaBox,cropBox:et[L].cropBox,bleedBox:et[L].bleedBox,trimBox:et[L].trimBox,artBox:et[L].artBox,userUnit:et[L].userUnit,rootDictionaryObjId:Ii,resourceDictionaryObjId:On}));wn(Ii,!0),K("<</Type /Pages");var Ee="/Kids [";for(Z=0;Z<lt;Z++)Ee+=ve[Z]+" 0 R ";K(Ee+"]"),K("/Count "+lt),K(">>"),K("endobj"),pt.publish("postPutPages")},uo=function(L){pt.publish("putFont",{font:L,out:K,newObject:mn,putStream:Br}),L.isAlreadyPutted!==!0&&(L.objectNumber=mn(),K("<<"),K("/Type /Font"),K("/BaseFont /"+Mu(L.postScriptName)),K("/Subtype /Type1"),typeof L.encoding=="string"&&K("/Encoding /"+L.encoding),K("/FirstChar 32"),K("/LastChar 255"),K(">>"),K("endobj"))},ja=function(L){L.objectNumber=mn();var Z=[];Z.push({key:"Type",value:"/XObject"}),Z.push({key:"Subtype",value:"/Form"}),Z.push({key:"BBox",value:"["+[$(L.x),$(L.y),$(L.x+L.width),$(L.y+L.height)].join(" ")+"]"}),Z.push({key:"Matrix",value:"["+L.matrix.toString()+"]"});var ve=L.pages[1].join(`
`);Br({data:ve,additionalKeyValues:Z,objectId:L.objectNumber}),K("endobj")},fo=function(L,Z){Z||(Z=21);var ve=mn(),Ee=(function(ot,Ct){var Lt,$t=[],Zt=1/(Ct-1);for(Lt=0;Lt<1;Lt+=Zt)$t.push(Lt);if($t.push(1),ot[0].offset!=0){var gn={offset:0,color:ot[0].color};ot.unshift(gn)}if(ot[ot.length-1].offset!=1){var ni={offset:1,color:ot[ot.length-1].color};ot.push(ni)}for(var mi="",Hn=0,Li=0;Li<$t.length;Li++){for(Lt=$t[Li];Lt>ot[Hn+1].offset;)Hn++;var _i=ot[Hn].offset,Gi=(Lt-_i)/(ot[Hn+1].offset-_i),ca=ot[Hn].color,yo=ot[Hn+1].color;mi+=ce(Math.round((1-Gi)*ca[0]+Gi*yo[0]).toString(16))+ce(Math.round((1-Gi)*ca[1]+Gi*yo[1]).toString(16))+ce(Math.round((1-Gi)*ca[2]+Gi*yo[2]).toString(16))}return mi.trim()})(L.colors,Z),Pe=[];Pe.push({key:"FunctionType",value:"0"}),Pe.push({key:"Domain",value:"[0.0 1.0]"}),Pe.push({key:"Size",value:"["+Z+"]"}),Pe.push({key:"BitsPerSample",value:"8"}),Pe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Pe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Br({data:Ee,additionalKeyValues:Pe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ve}),K("endobj"),L.objectNumber=mn(),K("<< /ShadingType "+L.type),K("/ColorSpace /DeviceRGB");var Ke="/Coords ["+$(parseFloat(L.coords[0]))+" "+$(parseFloat(L.coords[1]))+" ";L.type===2?Ke+=$(parseFloat(L.coords[2]))+" "+$(parseFloat(L.coords[3])):Ke+=$(parseFloat(L.coords[2]))+" "+$(parseFloat(L.coords[3]))+" "+$(parseFloat(L.coords[4]))+" "+$(parseFloat(L.coords[5])),K(Ke+="]"),L.matrix&&K("/Matrix ["+L.matrix.toString()+"]"),K("/Function "+ve+" 0 R"),K("/Extend [true true]"),K(">>"),K("endobj")},ho=function(L,Z){var ve=rn(),Ee=mn();Z.push({resourcesOid:ve,objectOid:Ee}),L.objectNumber=Ee;var Pe=[];Pe.push({key:"Type",value:"/Pattern"}),Pe.push({key:"PatternType",value:"1"}),Pe.push({key:"PaintType",value:"1"}),Pe.push({key:"TilingType",value:"1"}),Pe.push({key:"BBox",value:"["+L.boundingBox.map($).join(" ")+"]"}),Pe.push({key:"XStep",value:$(L.xStep)}),Pe.push({key:"YStep",value:$(L.yStep)}),Pe.push({key:"Resources",value:ve+" 0 R"}),L.matrix&&Pe.push({key:"Matrix",value:"["+L.matrix.toString()+"]"}),Br({data:L.stream,additionalKeyValues:Pe,objectId:L.objectNumber}),K("endobj")},hs=function(L){for(var Z in L.objectNumber=mn(),K("<<"),L)switch(Z){case"opacity":K("/ca "+z(L[Z]));break;case"stroke-opacity":K("/CA "+z(L[Z]))}K(">>"),K("endobj")},Ro=function(L){wn(L.resourcesOid,!0),K("<<"),K("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var Z in K("/Font <<"),vt)vt.hasOwnProperty(Z)&&(v===!1||v===!0&&b.hasOwnProperty(Z))&&K("/"+Z+" "+vt[Z].objectNumber+" 0 R");K(">>")})(),(function(){if(Object.keys(Le).length>0){for(var Z in K("/Shading <<"),Le)Le.hasOwnProperty(Z)&&Le[Z]instanceof Nc&&Le[Z].objectNumber>=0&&K("/"+Z+" "+Le[Z].objectNumber+" 0 R");pt.publish("putShadingPatternDict"),K(">>")}})(),(function(Z){if(Object.keys(Le).length>0){for(var ve in K("/Pattern <<"),Le)Le.hasOwnProperty(ve)&&Le[ve]instanceof g.TilingPattern&&Le[ve].objectNumber>=0&&Le[ve].objectNumber<Z&&K("/"+ve+" "+Le[ve].objectNumber+" 0 R");pt.publish("putTilingPatternDict"),K(">>")}})(L.objectOid),(function(){if(Object.keys(Qe).length>0){var Z;for(Z in K("/ExtGState <<"),Qe)Qe.hasOwnProperty(Z)&&Qe[Z].objectNumber>=0&&K("/"+Z+" "+Qe[Z].objectNumber+" 0 R");pt.publish("putGStateDict"),K(">>")}})(),(function(){for(var Z in K("/XObject <<"),Vt)Vt.hasOwnProperty(Z)&&Vt[Z].objectNumber>=0&&K("/"+Z+" "+Vt[Z].objectNumber+" 0 R");pt.publish("putXobjectDict"),K(">>")})(),K(">>"),K("endobj")},pi=function(L){Rt[L.fontName]=Rt[L.fontName]||{},Rt[L.fontName][L.fontStyle]=L.id},Gl=function(L,Z,ve,Ee,Pe){var Ke={id:"F"+(Object.keys(vt).length+1).toString(10),postScriptName:L,fontName:Z,fontStyle:ve,encoding:Ee,isStandardFont:Pe||!1,metadata:{}};return pt.publish("addFont",{font:Ke,instance:this}),vt[Ke.id]=Ke,pi(Ke),Ke.id},Tr=g.__private__.pdfEscape=g.pdfEscape=function(L,Z){return(function(ve,Ee){var Pe,Ke,ot,Ct,Lt,$t,Zt,gn,ni;if(ot=(Ee=Ee||{}).sourceEncoding||"Unicode",Lt=Ee.outputEncoding,(Ee.autoencode||Lt)&&vt[ht].metadata&&vt[ht].metadata[ot]&&vt[ht].metadata[ot].encoding&&(Ct=vt[ht].metadata[ot].encoding,!Lt&&vt[ht].encoding&&(Lt=vt[ht].encoding),!Lt&&Ct.codePages&&(Lt=Ct.codePages[0]),typeof Lt=="string"&&(Lt=Ct[Lt]),Lt)){for(Zt=!1,$t=[],Pe=0,Ke=ve.length;Pe<Ke;Pe++)(gn=Lt[ve.charCodeAt(Pe)])?$t.push(String.fromCharCode(gn)):$t.push(ve[Pe]),$t[Pe].charCodeAt(0)>>8&&(Zt=!0);ve=$t.join("")}for(Pe=ve.length;Zt===void 0&&Pe!==0;)ve.charCodeAt(Pe-1)>>8&&(Zt=!0),Pe--;if(!Zt)return ve;for($t=Ee.noBOM?[]:[254,255],Pe=0,Ke=ve.length;Pe<Ke;Pe++){if((ni=(gn=ve.charCodeAt(Pe))>>8)>>8)throw new Error("Character at position "+Pe+" of string '"+ve+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");$t.push(ni),$t.push(gn-(ni<<8))}return String.fromCharCode.apply(void 0,$t)})(L,Z).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},po=g.__private__.beginPage=function(L){$e[++lt]=[],et[lt]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(L[0]),topRightY:Number(L[1])}},$l(lt),B($e[ee])},ea=function(L,Z){var ve,Ee,Pe;switch(n=Z||n,typeof L=="string"&&(ve=E(L.toLowerCase()),Array.isArray(ve)&&(Ee=ve[0],Pe=ve[1])),Array.isArray(L)&&(Ee=L[0]*Et,Pe=L[1]*Et),isNaN(Ee)&&(Ee=o[0],Pe=o[1]),(Ee>14400||Pe>14400)&&(Qn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ee=Math.min(14400,Ee),Pe=Math.min(14400,Pe)),o=[Ee,Pe],n.substr(0,1)){case"l":Pe>Ee&&(o=[Pe,Ee]);break;case"p":Ee>Pe&&(o=[Pe,Ee])}po(o),qt(ms),K(Rr),Zs!==0&&K(Zs+" J"),zi!==0&&K(zi+" j"),pt.publish("addPage",{pageNumber:lt})},Vl=function(L){L>0&&L<=lt&&($e.splice(L,1),et.splice(L,1),lt--,ee>lt&&(ee=lt),this.setPage(ee))},$l=function(L){L>0&&L<=lt&&(ee=L)},Yl=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return $e.length-1},Uc=function(L,Z,ve){var Ee,Pe=void 0;return ve=ve||{},L=L!==void 0?L:vt[ht].fontName,Z=Z!==void 0?Z:vt[ht].fontStyle,Ee=L.toLowerCase(),Rt[Ee]!==void 0&&Rt[Ee][Z]!==void 0?Pe=Rt[Ee][Z]:Rt[L]!==void 0&&Rt[L][Z]!==void 0?Pe=Rt[L][Z]:ve.disableWarning===!1&&Qn.warn("Unable to look up font label for font '"+L+"', '"+Z+"'. Refer to getFontList() for available fonts."),Pe||ve.noFallback||(Pe=Rt.times[Z])==null&&(Pe=Rt.times.normal),Pe},kr=g.__private__.putInfo=function(){var L=mn(),Z=function(Ee){return Ee};for(var ve in h!==null&&(Z=Ri.encryptor(L,0)),K("<<"),K("/Producer ("+Tr(Z("jsPDF "+Dt.version))+")"),ft)ft.hasOwnProperty(ve)&&ft[ve]&&K("/"+ve.substr(0,1).toUpperCase()+ve.substr(1)+" ("+Tr(Z(ft[ve]))+")");K("/CreationDate ("+Tr(Z(ie))+")"),K(">>"),K("endobj")},ta=g.__private__.putCatalog=function(L){var Z=(L=L||{}).rootDictionaryObjId||Ii;switch(mn(),K("<<"),K("/Type /Catalog"),K("/Pages "+Z+" 0 R"),be||(be="fullwidth"),be){case"fullwidth":K("/OpenAction [3 0 R /FitH null]");break;case"fullheight":K("/OpenAction [3 0 R /FitV null]");break;case"fullpage":K("/OpenAction [3 0 R /Fit]");break;case"original":K("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ve=""+be;ve.substr(ve.length-1)==="%"&&(be=parseInt(be)/100),typeof be=="number"&&K("/OpenAction [3 0 R /XYZ null null "+z(be)+"]")}switch(ze||(ze="continuous"),ze){case"continuous":K("/PageLayout /OneColumn");break;case"single":K("/PageLayout /SinglePage");break;case"two":case"twoleft":K("/PageLayout /TwoColumnLeft");break;case"tworight":K("/PageLayout /TwoColumnRight")}He&&K("/PageMode /"+He),pt.publish("putCatalog"),K(">>"),K("endobj")},mo=g.__private__.putTrailer=function(){K("trailer"),K("<<"),K("/Size "+(ye+1)),K("/Root "+ye+" 0 R"),K("/Info "+(ye-1)+" 0 R"),h!==null&&K("/Encrypt "+Ri.oid+" 0 R"),K("/ID [ <"+J+"> <"+J+"> ]"),K(">>")},An=g.__private__.putHeader=function(){K("%PDF-"+A),K("%")},Wl=g.__private__.putXRef=function(){var L="0000000000";K("xref"),K("0 "+(ye+1)),K("0000000000 65535 f ");for(var Z=1;Z<=ye;Z++)typeof we[Z]=="function"?K((L+we[Z]()).slice(-10)+" 00000 n "):we[Z]!==void 0?K((L+we[Z]).slice(-10)+" 00000 n "):K("0000000000 00000 n ")},Lo=g.__private__.buildDocument=function(){var L;ye=0,Ce=0,Te=[],we=[],De=[],Ii=rn(),On=rn(),B(Te),pt.publish("buildDocument"),An(),co(),(function(){pt.publish("putAdditionalObjects");for(var ve=0;ve<De.length;ve++){var Ee=De[ve];wn(Ee.objId,!0),K(Ee.content),K("endobj")}pt.publish("postPutAdditionalObjects")})(),L=[],(function(){for(var ve in vt)vt.hasOwnProperty(ve)&&(v===!1||v===!0&&b.hasOwnProperty(ve))&&uo(vt[ve])})(),(function(){var ve;for(ve in Qe)Qe.hasOwnProperty(ve)&&hs(Qe[ve])})(),(function(){for(var ve in Vt)Vt.hasOwnProperty(ve)&&ja(Vt[ve])})(),(function(ve){var Ee;for(Ee in Le)Le.hasOwnProperty(Ee)&&(Le[Ee]instanceof Nc?fo(Le[Ee]):Le[Ee]instanceof Pu&&ho(Le[Ee],ve))})(L),pt.publish("putResources"),L.forEach(Ro),Ro({resourcesOid:On,objectOid:Number.MAX_SAFE_INTEGER}),pt.publish("postPutResources"),h!==null&&(Ri.oid=mn(),K("<<"),K("/Filter /Standard"),K("/V "+Ri.v),K("/R "+Ri.r),K("/U <"+Ri.toHexString(Ri.U)+">"),K("/O <"+Ri.toHexString(Ri.O)+">"),K("/P "+Ri.P),K(">>"),K("endobj")),kr(),ta();var Z=Ce;return Wl(),mo(),K("startxref"),K(""+Z),K("%%EOF"),B($e[ee]),Te.join(`
`)},Fa=g.__private__.getBlob=function(L){return new Blob([he(L)],{type:"application/pdf"})},Xl=g.output=g.__private__.output=(Xn=function(L,Z){switch(typeof(Z=Z||{})=="string"?Z={filename:Z}:Z.filename=Z.filename||"generated.pdf",L){case void 0:return Lo();case"save":g.save(Z.filename);break;case"arraybuffer":return he(Lo());case"blob":return Fa(Lo());case"bloburi":case"bloburl":if(Xt.URL!==void 0&&typeof Xt.URL.createObjectURL=="function")return Xt.URL&&Xt.URL.createObjectURL(Fa(Lo()))||void 0;Qn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ve="",Ee=Lo();try{ve=w5(Ee)}catch{ve=w5(unescape(encodeURIComponent(Ee)))}return"data:application/pdf;filename="+Z.filename+";base64,"+ve;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Xt)==="[object Window]"){var Pe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ke=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Z.pdfObjectUrl&&(Pe=Z.pdfObjectUrl,Ke="");var ot='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Pe+'"'+Ke+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Z)+");<\/script></body></html>",Ct=Xt.open();return Ct!==null&&Ct.document.write(ot),Ct}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Xt)==="[object Window]"){var Lt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Z.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Z.filename+'" width="500px" height="400px" /></body></html>',$t=Xt.open();if($t!==null){$t.document.write(Lt);var Zt=this;$t.document.documentElement.querySelector("#pdfViewer").onload=function(){$t.document.title=Z.filename,$t.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Zt.output("bloburl"))}}return $t}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Xt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var gn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Z)+'"></iframe></body></html>',ni=Xt.open();if(ni!==null&&(ni.document.write(gn),ni.document.title=Z.filename),ni||typeof safari>"u")return ni;break;case"datauri":case"dataurl":return Xt.document.location.href=this.output("datauristring",Z);default:return null}},Xn.foo=function(){try{return Xn.apply(this,arguments)}catch(ve){var L=ve.stack||"";~L.indexOf(" at ")&&(L=L.split(" at ")[1]);var Z="Error in function "+L.split(`
`)[0].split("<")[0]+": "+ve.message;if(!Xt.console)throw new Error(Z);Xt.console.error(Z,ve),Xt.alert&&alert(Z)}},Xn.foo.bar=Xn,Xn.foo),ur=function(L){return Array.isArray(Bt)===!0&&Bt.indexOf(L)>-1};switch(i){case"pt":Et=1;break;case"mm":Et=72/25.4;break;case"cm":Et=72/2.54;break;case"in":Et=72;break;case"px":Et=ur("px_scaling")==1?.75:96/72;break;case"pc":case"em":Et=12;break;case"ex":Et=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);Et=i}var Ri=null;G(),le();var wi=g.__private__.getPageInfo=g.getPageInfo=function(L){if(isNaN(L)||L%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:et[L].objId,pageNumber:L,pageContext:et[L]}},Js=g.__private__.getPageInfoByObjId=function(L){if(isNaN(L)||L%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Z in et)if(et[Z].objId===L)break;return wi(Z)},zc=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:et[ee].objId,pageNumber:ee,pageContext:et[ee]}};g.addPage=function(){return ea.apply(this,arguments),this},g.setPage=function(){return $l.apply(this,arguments),B.call(this,$e[ee]),this},g.insertPage=function(L){return this.addPage(),this.movePage(ee,L),this},g.movePage=function(L,Z){var ve,Ee;if(L>Z){ve=$e[L],Ee=et[L];for(var Pe=L;Pe>Z;Pe--)$e[Pe]=$e[Pe-1],et[Pe]=et[Pe-1];$e[Z]=ve,et[Z]=Ee,this.setPage(Z)}else if(L<Z){ve=$e[L],Ee=et[L];for(var Ke=L;Ke<Z;Ke++)$e[Ke]=$e[Ke+1],et[Ke]=et[Ke+1];$e[Z]=ve,et[Z]=Ee,this.setPage(Z)}return this},g.deletePage=function(){return Vl.apply(this,arguments),this},g.__private__.text=g.text=function(L,Z,ve,Ee,Pe){var Ke,ot,Ct,Lt,$t,Zt,gn,ni,mi,Hn=(Ee=Ee||{}).scope||this;if(typeof L=="number"&&typeof Z=="number"&&(typeof ve=="string"||Array.isArray(ve))){var Li=ve;ve=Z,Z=L,L=Li}if(arguments[3]instanceof bt==0?(Ct=arguments[4],Lt=arguments[5],qn(gn=arguments[3])==="object"&&gn!==null||(typeof Ct=="string"&&(Lt=Ct,Ct=null),typeof gn=="string"&&(Lt=gn,gn=null),typeof gn=="number"&&(Ct=gn,gn=null),Ee={flags:gn,angle:Ct,align:Lt})):(j("The transform parameter of text() with a Matrix value"),mi=Pe),isNaN(Z)||isNaN(ve)||L==null)throw new Error("Invalid arguments passed to jsPDF.text");if(L.length===0)return Hn;var _i,Gi="",ca=typeof Ee.lineHeightFactor=="number"?Ee.lineHeightFactor:na,yo=Hn.internal.scaleFactor;function ua(Cn){return Cn=Cn.split("	").join(Array(Ee.TabLen||9).join(" ")),Tr(Cn,gn)}function rc(Cn){for(var vn,Gn=Cn.concat(),vi=[],qo=Gn.length;qo--;)typeof(vn=Gn.shift())=="string"?vi.push(vn):Array.isArray(Cn)&&(vn.length===1||vn[1]===void 0&&vn[2]===void 0)?vi.push(vn[0]):vi.push([vn[0],vn[1],vn[2]]);return vi}function el(Cn,vn){var Gn;if(typeof Cn=="string")Gn=vn(Cn)[0];else if(Array.isArray(Cn)){for(var vi,qo,_o=Cn.concat(),_s=[],sc=_o.length;sc--;)typeof(vi=_o.shift())=="string"?_s.push(vn(vi)[0]):Array.isArray(vi)&&typeof vi[0]=="string"&&(qo=vn(vi[0],vi[1],vi[2]),_s.push([qo[0],qo[1],qo[2]]));Gn=_s}return Gn}var Po=!1,bo=!0;if(typeof L=="string")Po=!0;else if(Array.isArray(L)){var xs=L.concat();ot=[];for(var da,ji=xs.length;ji--;)(typeof(da=xs.shift())!="string"||Array.isArray(da)&&typeof da[0]!="string")&&(bo=!1);Po=bo}if(Po===!1)throw new Error('Type of text must be string or Array. "'+L+'" is not recognized.');typeof L=="string"&&(L=L.match(/[\r?\n]/)?L.split(/\r\n|\r|\n/g):[L]);var qa=ae/Hn.internal.scaleFactor,Ha=qa*(ca-1);switch(Ee.baseline){case"bottom":ve-=Ha;break;case"top":ve+=qa-Ha;break;case"hanging":ve+=qa-2*Ha;break;case"middle":ve+=qa/2-Ha}if((Zt=Ee.maxWidth||0)>0&&(typeof L=="string"?L=Hn.splitTextToSize(L,Zt):Object.prototype.toString.call(L)==="[object Array]"&&(L=L.reduce(function(Cn,vn){return Cn.concat(Hn.splitTextToSize(vn,Zt))},[]))),Ke={text:L,x:Z,y:ve,options:Ee,mutex:{pdfEscape:Tr,activeFontKey:ht,fonts:vt,activeFontSize:ae}},pt.publish("preProcessText",Ke),L=Ke.text,Ct=(Ee=Ke.options).angle,mi instanceof bt==0&&Ct&&typeof Ct=="number"){Ct*=Math.PI/180,Ee.rotationDirection===0&&(Ct=-Ct),M===k&&(Ct=-Ct);var tl=Math.cos(Ct),Oo=Math.sin(Ct);mi=new bt(tl,Oo,-Oo,tl,0,0)}else Ct&&Ct instanceof bt&&(mi=Ct);M!==k||mi||(mi=sn),($t=Ee.charSpace||qr)!==void 0&&(Gi+=$(q($t))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ni=Ee.horizontalScale)!==void 0&&(Gi+=$(100*ni)+` Tz
`),Ee.lang;var fr=-1,fa=Ee.renderingMode!==void 0?Ee.renderingMode:Ee.stroke,nl=Hn.internal.getCurrentPageInfo().pageContext;switch(fa){case 0:case!1:case"fill":fr=0;break;case 1:case!0:case"stroke":fr=1;break;case 2:case"fillThenStroke":fr=2;break;case 3:case"invisible":fr=3;break;case 4:case"fillAndAddForClipping":fr=4;break;case 5:case"strokeAndAddPathForClipping":fr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":fr=6;break;case 7:case"addToPathForClipping":fr=7}var oc=nl.usedRenderingMode!==void 0?nl.usedRenderingMode:-1;fr!==-1?Gi+=fr+` Tr
`:oc!==-1&&(Gi+=`0 Tr
`),fr!==-1&&(nl.usedRenderingMode=fr),Lt=Ee.align||"left";var Lr,xo=ae*ca,ha=Hn.internal.pageSize.getWidth(),ac=vt[ht];$t=Ee.charSpace||qr,Zt=Ee.maxWidth||0,gn=Object.assign({autoencode:!0,noBOM:!0},Ee.flags);var wo=[],Ga=function(Cn){return Hn.getStringUnitWidth(Cn,{font:ac,charSpace:$t,fontSize:ae,doKerning:!1})*ae/yo};if(Object.prototype.toString.call(L)==="[object Array]"){var br;ot=rc(L),Lt!=="left"&&(Lr=ot.map(Ga));var hr,Uo=0;if(Lt==="right"){Z-=Lr[0],L=[],ji=ot.length;for(var zo=0;zo<ji;zo++)zo===0?(hr=Ir(Z),br=Hi(ve)):(hr=q(Uo-Lr[zo]),br=-xo),L.push([ot[zo],hr,br]),Uo=Lr[zo]}else if(Lt==="center"){Z-=Lr[0]/2,L=[],ji=ot.length;for(var pa=0;pa<ji;pa++)pa===0?(hr=Ir(Z),br=Hi(ve)):(hr=q((Uo-Lr[pa])/2),br=-xo),L.push([ot[pa],hr,br]),Uo=Lr[pa]}else if(Lt==="left"){L=[],ji=ot.length;for(var il=0;il<ji;il++)L.push(ot[il])}else if(Lt==="justify"&&ac.encoding==="Identity-H"){L=[],ji=ot.length,Zt=Zt!==0?Zt:ha;for(var rl=0,gi=0;gi<ji;gi++)if(br=gi===0?Hi(ve):-xo,hr=gi===0?Ir(Z):rl,gi<ji-1){var Yc=q((Zt-Lr[gi])/(ot[gi].split(" ").length-1)),jo=ot[gi].split(" ");L.push([jo[0]+" ",hr,br]),rl=0;for(var Fo=1;Fo<jo.length;Fo++){var Vi=(Ga(jo[Fo-1]+" "+jo[Fo])-Ga(jo[Fo]))*yo+Yc;Fo==jo.length-1?L.push([jo[Fo],Vi,0]):L.push([jo[Fo]+" ",Vi,0]),rl-=Vi}}else L.push([ot[gi],hr,br]);L.push(["",rl,0])}else{if(Lt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(L=[],ji=ot.length,Zt=Zt!==0?Zt:ha,gi=0;gi<ji;gi++){br=gi===0?Hi(ve):-xo,hr=gi===0?Ir(Z):0;var ma=ot[gi].split(" ").length-1,ol=ma>0?(Zt-Lr[gi])/ma:0;gi<ji-1?wo.push($(q(ol))):wo.push(0),L.push([ot[gi],hr,br])}}}(typeof Ee.R2L=="boolean"?Ee.R2L:Se)===!0&&(L=el(L,function(Cn,vn,Gn){return[Cn.split("").reverse().join(""),vn,Gn]})),Ke={text:L,x:Z,y:ve,options:Ee,mutex:{pdfEscape:Tr,activeFontKey:ht,fonts:vt,activeFontSize:ae}},pt.publish("postProcessText",Ke),L=Ke.text,_i=Ke.mutex.isHex||!1;var al=vt[ht].encoding;al!=="WinAnsiEncoding"&&al!=="StandardEncoding"||(L=el(L,function(Cn,vn,Gn){return[ua(Cn),vn,Gn]})),ot=rc(L),L=[];for(var ga,va,Bo,ws=Array.isArray(ot[0])?1:0,Mr="",ya=function(Cn,vn,Gn){var vi="";return Gn instanceof bt?(Gn=typeof Ee.angle=="number"?jt(Gn,new bt(1,0,0,1,Cn,vn)):jt(new bt(1,0,0,1,Cn,vn),Gn),M===k&&(Gn=jt(new bt(1,0,0,-1,0,0),Gn)),vi=Gn.join(" ")+` Tm
`):vi=$(Cn)+" "+$(vn)+` Td
`,vi},tr=0;tr<ot.length;tr++){switch(Mr="",ws){case 1:Bo=(_i?"<":"(")+ot[tr][0]+(_i?">":")"),ga=parseFloat(ot[tr][1]),va=parseFloat(ot[tr][2]);break;case 0:Bo=(_i?"<":"(")+ot[tr]+(_i?">":")"),ga=Ir(Z),va=Hi(ve)}wo!==void 0&&wo[tr]!==void 0&&(Mr=wo[tr]+` Tw
`),tr===0?L.push(Mr+ya(ga,va,mi)+Bo):ws===0?L.push(Mr+Bo):ws===1&&L.push(Mr+ya(ga,va,mi)+Bo)}L=ws===0?L.join(` Tj
T* `):L.join(` Tj
`),L+=` Tj
`;var Gr=`BT
/`;return Gr+=ht+" "+ae+` Tf
`,Gr+=$(ae*ca)+` TL
`,Gr+=Mo+`
`,Gr+=Gi,Gr+=L,K(Gr+="ET"),b[ht]=!0,Hn};var Jl=g.__private__.clip=g.clip=function(L){return K(L==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return Jl("evenodd")},g.__private__.discardPath=g.discardPath=function(){return K("n"),this};var dr=g.__private__.isValidStyle=function(L){var Z=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(L)!==-1&&(Z=!0),Z};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(L){return dr(L)&&(d=L),this};var Kl=g.__private__.getStyle=g.getStyle=function(L){var Z=d;switch(L){case"D":case"S":Z="S";break;case"F":Z="f";break;case"FD":case"DF":Z="B";break;case"f":case"f*":case"B":case"B*":Z=L}return Z},Zl=g.close=function(){return K("h"),this};g.stroke=function(){return K("S"),this},g.fill=function(L){return go("f",L),this},g.fillEvenOdd=function(L){return go("f*",L),this},g.fillStroke=function(L){return go("B",L),this},g.fillStrokeEvenOdd=function(L){return go("B*",L),this};var go=function(L,Z){qn(Z)==="object"?Fc(Z,L):K(L)},ps=function(L){L===null||M===k&&L===void 0||(L=Kl(L),K(L))};function jc(L,Z,ve,Ee,Pe){var Ke=new Pu(Z||this.boundingBox,ve||this.xStep,Ee||this.yStep,this.gState,Pe||this.matrix);Ke.stream=this.stream;var ot=L+"$$"+this.cloneIndex+++"$$";return Nn(ot,Ke),Ke}var Fc=function(L,Z){var ve=nt[L.key],Ee=Le[ve];if(Ee instanceof Nc)K("q"),K(Ql(Z)),Ee.gState&&g.setGState(Ee.gState),K(L.matrix.toString()+" cm"),K("/"+ve+" sh"),K("Q");else if(Ee instanceof Pu){var Pe=new bt(1,0,0,-1,0,la());L.matrix&&(Pe=Pe.multiply(L.matrix||sn),ve=jc.call(Ee,L.key,L.boundingBox,L.xStep,L.yStep,Pe).id),K("q"),K("/Pattern cs"),K("/"+ve+" scn"),Ee.gState&&g.setGState(Ee.gState),K(Z),K("Q")}},Ql=function(L){switch(L){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},ec=g.moveTo=function(L,Z){return K($(q(L))+" "+$(I(Z))+" m"),this},Bc=g.lineTo=function(L,Z){return K($(q(L))+" "+$(I(Z))+" l"),this},yr=g.curveTo=function(L,Z,ve,Ee,Pe,Ke){return K([$(q(L)),$(I(Z)),$(q(ve)),$(I(Ee)),$(q(Pe)),$(I(Ke)),"c"].join(" ")),this};g.__private__.line=g.line=function(L,Z,ve,Ee,Pe){if(isNaN(L)||isNaN(Z)||isNaN(ve)||isNaN(Ee)||!dr(Pe))throw new Error("Invalid arguments passed to jsPDF.line");return M===R?this.lines([[ve-L,Ee-Z]],L,Z,[1,1],Pe||"S"):this.lines([[ve-L,Ee-Z]],L,Z,[1,1]).stroke()},g.__private__.lines=g.lines=function(L,Z,ve,Ee,Pe,Ke){var ot,Ct,Lt,$t,Zt,gn,ni,mi,Hn,Li,_i,Gi;if(typeof L=="number"&&(Gi=ve,ve=Z,Z=L,L=Gi),Ee=Ee||[1,1],Ke=Ke||!1,isNaN(Z)||isNaN(ve)||!Array.isArray(L)||!Array.isArray(Ee)||!dr(Pe)||typeof Ke!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(ec(Z,ve),ot=Ee[0],Ct=Ee[1],$t=L.length,Li=Z,_i=ve,Lt=0;Lt<$t;Lt++)(Zt=L[Lt]).length===2?(Li=Zt[0]*ot+Li,_i=Zt[1]*Ct+_i,Bc(Li,_i)):(gn=Zt[0]*ot+Li,ni=Zt[1]*Ct+_i,mi=Zt[2]*ot+Li,Hn=Zt[3]*Ct+_i,Li=Zt[4]*ot+Li,_i=Zt[5]*Ct+_i,yr(gn,ni,mi,Hn,Li,_i));return Ke&&Zl(),ps(Pe),this},g.path=function(L){for(var Z=0;Z<L.length;Z++){var ve=L[Z],Ee=ve.c;switch(ve.op){case"m":ec(Ee[0],Ee[1]);break;case"l":Bc(Ee[0],Ee[1]);break;case"c":yr.apply(this,Ee);break;case"h":Zl()}}return this},g.__private__.rect=g.rect=function(L,Z,ve,Ee,Pe){if(isNaN(L)||isNaN(Z)||isNaN(ve)||isNaN(Ee)||!dr(Pe))throw new Error("Invalid arguments passed to jsPDF.rect");return M===R&&(Ee=-Ee),K([$(q(L)),$(I(Z)),$(q(ve)),$(q(Ee)),"re"].join(" ")),ps(Pe),this},g.__private__.triangle=g.triangle=function(L,Z,ve,Ee,Pe,Ke,ot){if(isNaN(L)||isNaN(Z)||isNaN(ve)||isNaN(Ee)||isNaN(Pe)||isNaN(Ke)||!dr(ot))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ve-L,Ee-Z],[Pe-ve,Ke-Ee],[L-Pe,Z-Ke]],L,Z,[1,1],ot,!0),this},g.__private__.roundedRect=g.roundedRect=function(L,Z,ve,Ee,Pe,Ke,ot){if(isNaN(L)||isNaN(Z)||isNaN(ve)||isNaN(Ee)||isNaN(Pe)||isNaN(Ke)||!dr(ot))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ct=4/3*(Math.SQRT2-1);return Pe=Math.min(Pe,.5*ve),Ke=Math.min(Ke,.5*Ee),this.lines([[ve-2*Pe,0],[Pe*Ct,0,Pe,Ke-Ke*Ct,Pe,Ke],[0,Ee-2*Ke],[0,Ke*Ct,-Pe*Ct,Ke,-Pe,Ke],[2*Pe-ve,0],[-Pe*Ct,0,-Pe,-Ke*Ct,-Pe,-Ke],[0,2*Ke-Ee],[0,-Ke*Ct,Pe*Ct,-Ke,Pe,-Ke]],L+Pe,Z,[1,1],ot,!0),this},g.__private__.ellipse=g.ellipse=function(L,Z,ve,Ee,Pe){if(isNaN(L)||isNaN(Z)||isNaN(ve)||isNaN(Ee)||!dr(Pe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ke=4/3*(Math.SQRT2-1)*ve,ot=4/3*(Math.SQRT2-1)*Ee;return ec(L+ve,Z),yr(L+ve,Z-ot,L+Ke,Z-Ee,L,Z-Ee),yr(L-Ke,Z-Ee,L-ve,Z-ot,L-ve,Z),yr(L-ve,Z+ot,L-Ke,Z+Ee,L,Z+Ee),yr(L+Ke,Z+Ee,L+ve,Z+ot,L+ve,Z),ps(Pe),this},g.__private__.circle=g.circle=function(L,Z,ve,Ee){if(isNaN(L)||isNaN(Z)||isNaN(ve)||!dr(Ee))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(L,Z,ve,ve,Ee)},g.setFont=function(L,Z,ve){return ve&&(Z=V(Z,ve)),ht=Uc(L,Z,{disableWarning:!1}),this};var vo=g.__private__.getFont=g.getFont=function(){return vt[Uc.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var L,Z,ve={};for(L in Rt)if(Rt.hasOwnProperty(L))for(Z in ve[L]=[],Rt[L])Rt[L].hasOwnProperty(Z)&&ve[L].push(Z);return ve},g.addFont=function(L,Z,ve,Ee,Pe){var Ke=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ke.indexOf(arguments[3])!==-1?Pe=arguments[3]:arguments[3]&&Ke.indexOf(arguments[3])==-1&&(ve=V(ve,Ee)),Gl.call(this,L,Z,ve,Pe=Pe||"Identity-H")};var na,ms=e.lineWidth||.200025,Ba=g.__private__.getLineWidth=g.getLineWidth=function(){return ms},qt=g.__private__.setLineWidth=g.setLineWidth=function(L){return ms=L,K($(q(L))+" w"),this};g.__private__.setLineDash=Dt.API.setLineDash=Dt.API.setLineDashPattern=function(L,Z){if(L=L||[],Z=Z||0,isNaN(Z)||!Array.isArray(L))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return L=L.map(function(ve){return $(q(ve))}).join(" "),Z=$(q(Z)),K("["+L+"] "+Z+" d"),this};var qc=g.__private__.getLineHeight=g.getLineHeight=function(){return ae*na};g.__private__.getLineHeight=g.getLineHeight=function(){return ae*na};var tc=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(L){return typeof(L=L||1.15)=="number"&&(na=L),this},Hc=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return na};tc(e.lineHeight);var Ir=g.__private__.getHorizontalCoordinate=function(L){return q(L)},Hi=g.__private__.getVerticalCoordinate=function(L){return M===k?L:et[ee].mediaBox.topRightY-et[ee].mediaBox.bottomLeftY-q(L)},nc=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(L){return $(Ir(L))},gs=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(L){return $(Hi(L))},Rr=e.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return ti(Rr)},g.__private__.setStrokeColor=g.setDrawColor=function(L,Z,ve,Ee){return Rr=er({ch1:L,ch2:Z,ch3:ve,ch4:Ee,pdfColorType:"draw",precision:2}),K(Rr),this};var vs=e.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return ti(vs)},g.__private__.setFillColor=g.setFillColor=function(L,Z,ve,Ee){return vs=er({ch1:L,ch2:Z,ch3:ve,ch4:Ee,pdfColorType:"fill",precision:2}),K(vs),this};var Mo=e.textColor||"0 g",Gc=g.__private__.getTextColor=g.getTextColor=function(){return ti(Mo)};g.__private__.setTextColor=g.setTextColor=function(L,Z,ve,Ee){return Mo=er({ch1:L,ch2:Z,ch3:ve,ch4:Ee,pdfColorType:"text",precision:3}),this};var qr=e.charSpace,Ks=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(qr||0)};g.__private__.setCharSpace=g.setCharSpace=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return qr=L,this};var Zs=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(L){var Z=g.CapJoinStyles[L];if(Z===void 0)throw new Error("Line cap style of '"+L+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Zs=Z,K(Z+" J"),this};var zi=0;g.__private__.setLineJoin=g.setLineJoin=function(L){var Z=g.CapJoinStyles[L];if(Z===void 0)throw new Error("Line join style of '"+L+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return zi=Z,K(Z+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(L){if(L=L||0,isNaN(L))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return K($(q(L))+" M"),this},g.GState=cp,g.setGState=function(L){(L=typeof L=="string"?Qe[ut[L]]:Do(null,L)).equals(wt)||(K("/"+L.id+" gs"),wt=L)};var Do=function(L,Z){if(!L||!ut[L]){var ve=!1;for(var Ee in Qe)if(Qe.hasOwnProperty(Ee)&&Qe[Ee].equals(Z)){ve=!0;break}if(ve)Z=Qe[Ee];else{var Pe="GS"+(Object.keys(Qe).length+1).toString(10);Qe[Pe]=Z,Z.id=Pe}return L&&(ut[L]=Z.id),pt.publish("addGState",Z),Z}};g.addGState=function(L,Z){return Do(L,Z),this},g.saveGraphicsState=function(){return K("q"),Ft.push({key:ht,size:ae,color:Mo}),this},g.restoreGraphicsState=function(){K("Q");var L=Ft.pop();return ht=L.key,ae=L.size,Mo=L.color,wt=null,this},g.setCurrentTransformationMatrix=function(L){return K(L.toString()+" cm"),this},g.comment=function(L){return K("#"+L),this};var Hr=function(L,Z){var ve=L||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ve},set:function(Ke){isNaN(Ke)||(ve=parseFloat(Ke))}});var Ee=Z||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ee},set:function(Ke){isNaN(Ke)||(Ee=parseFloat(Ke))}});var Pe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Pe},set:function(Ke){Pe=Ke.toString()}}),this},ia=function(L,Z,ve,Ee){Hr.call(this,L,Z),this.type="rect";var Pe=ve||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Pe},set:function(ot){isNaN(ot)||(Pe=parseFloat(ot))}});var Ke=Ee||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ke},set:function(ot){isNaN(ot)||(Ke=parseFloat(ot))}}),this},Qs=function(){this.page=lt,this.currentPage=ee,this.pages=$e.slice(0),this.pagesContext=et.slice(0),this.x=mt,this.y=on,this.matrix=yt,this.width=oa(ee),this.height=ic(ee),this.outputDestination=st,this.id="",this.objectNumber=-1};Qs.prototype.restore=function(){lt=this.page,ee=this.currentPage,et=this.pagesContext,$e=this.pages,mt=this.x,on=this.y,yt=this.matrix,bs(ee,this.width),aa(ee,this.height),st=this.outputDestination};var ys=function(L,Z,ve,Ee,Pe){Jt.push(new Qs),lt=ee=0,$e=[],mt=L,on=Z,yt=Pe,po([ve,Ee])};for(var ra in g.beginFormObject=function(L,Z,ve,Ee,Pe){return ys(L,Z,ve,Ee,Pe),this},g.endFormObject=function(L){return(function(Z){if(zt[Z])Jt.pop().restore();else{var ve=new Qs,Ee="Xo"+(Object.keys(Vt).length+1).toString(10);ve.id=Ee,zt[Z]=Ee,Vt[Ee]=ve,pt.publish("addFormObject",ve),Jt.pop().restore()}})(L),this},g.doFormObject=function(L,Z){var ve=Vt[zt[L]];return K("q"),K(Z.toString()+" cm"),K("/"+ve.id+" Do"),K("Q"),this},g.getFormObject=function(L){var Z=Vt[zt[L]];return{x:Z.x,y:Z.y,width:Z.width,height:Z.height,matrix:Z.matrix}},g.save=function(L,Z){return L=L||"generated.pdf",(Z=Z||{}).returnPromise=Z.returnPromise||!1,Z.returnPromise===!1?(Sc(Fa(Lo()),L),typeof Sc.unload=="function"&&Xt.setTimeout&&setTimeout(Sc.unload,911),this):new Promise(function(ve,Ee){try{var Pe=Sc(Fa(Lo()),L);typeof Sc.unload=="function"&&Xt.setTimeout&&setTimeout(Sc.unload,911),ve(Pe)}catch(Ke){Ee(Ke.message)}})},Dt.API)Dt.API.hasOwnProperty(ra)&&(ra==="events"&&Dt.API.events.length?(function(L,Z){var ve,Ee,Pe;for(Pe=Z.length-1;Pe!==-1;Pe--)ve=Z[Pe][0],Ee=Z[Pe][1],L.subscribe.apply(L,[ve].concat(typeof Ee=="function"?[Ee]:Ee))})(pt,Dt.API.events):g[ra]=Dt.API[ra]);function oa(L){return et[L].mediaBox.topRightX-et[L].mediaBox.bottomLeftX}function bs(L,Z){et[L].mediaBox.topRightX=Z+et[L].mediaBox.bottomLeftX}function ic(L){return et[L].mediaBox.topRightY-et[L].mediaBox.bottomLeftY}function aa(L,Z){et[L].mediaBox.topRightY=Z+et[L].mediaBox.bottomLeftY}var sa=g.getPageWidth=function(L){return oa(L=L||ee)/Et},Vc=g.setPageWidth=function(L,Z){bs(L,Z*Et)},la=g.getPageHeight=function(L){return ic(L=L||ee)/Et},$c=g.setPageHeight=function(L,Z){aa(L,Z*Et)};return g.internal={pdfEscape:Tr,getStyle:Kl,getFont:vo,getFontSize:Me,getCharSpace:Ks,getTextColor:Gc,getLineHeight:qc,getLineHeightFactor:Hc,getLineWidth:Ba,write:_e,getHorizontalCoordinate:Ir,getVerticalCoordinate:Hi,getCoordinateString:nc,getVerticalCoordinateString:gs,collections:{},newObject:mn,newAdditionalObject:Qi,newObjectDeferred:rn,newObjectDeferredBegin:wn,getFilters:Cr,putStream:Br,events:pt,scaleFactor:Et,pageSize:{getWidth:function(){return sa(ee)},setWidth:function(L){Vc(ee,L)},getHeight:function(){return la(ee)},setHeight:function(L){$c(ee,L)}},encryptionOptions:h,encryption:Ri,getEncryptor:function(L){return h!==null?Ri.encryptor(L,0):function(Z){return Z}},output:Xl,getNumberOfPages:Yl,get pages(){return $e},out:K,f2:z,f3:U,getPageInfo:wi,getPageInfoByObjId:Js,getCurrentPageInfo:zc,getPDFVersion:_,Point:Hr,Rectangle:ia,Matrix:bt,hasHotfix:ur},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return sa(ee)},set:function(L){Vc(ee,L)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return la(ee)},set:function(L){$c(ee,L)},enumerable:!0,configurable:!0}),(function(L){for(var Z=0,ve=ne.length;Z<ve;Z++){var Ee=Gl.call(this,L[Z][0],L[Z][1],L[Z][2],ne[Z][3],!0);v===!1&&(b[Ee]=!0);var Pe=L[Z][0].split("-");pi({id:Ee,fontName:Pe[0],fontStyle:Pe[1]||""})}pt.publish("addFonts",{fonts:vt,dictionary:Rt})}).call(g,ne),ht="F1",ea(o,n),pt.publish("initialized"),g}Lu.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Lu.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Lu.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},Lu.prototype.processOwnerPassword=function(e,t){return fg(dg(t).substr(0,5),e)},Lu.prototype.encryptor=function(e,t){var n=dg(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(i){return fg(n,i)}},cp.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||qn(e)!==qn(this))return!1;var i=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;i++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&i--;return i===0},Dt.API={events:[]},Dt.version="4.1.0";var ki=Dt.API,r1=1,Dc=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Tu=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},up=function(e){return e.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(t){var n=t.charCodeAt(0).toString(16).toUpperCase();return"#"+(n.length===1?"0"+n:n)})},tn=function(e){return e.toFixed(2)},Rl=function(e){return e.toFixed(5)};ki.__acroform__={};var lo=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},N5=function(e){return e*r1},os=function(e){var t=new k_,n=It.internal.getHeight(e)||0,i=It.internal.getWidth(e)||0;return t.BBox=[0,0,Number(tn(i)),Number(tn(n))],t},P6=ki.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},O6=ki.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},U6=ki.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Pi=ki.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return U6(e,t-1)},Oi=ki.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return P6(e,t-1)},Ui=ki.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return O6(e,t-1)},z6=ki.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,i=t.internal.getVerticalCoordinate,o=e[0],a=e[1],l=e[2],c=e[3],u={};return u.lowerLeft_X=n(o)||0,u.lowerLeft_Y=i(a+c)||0,u.upperRight_X=n(o+l)||0,u.upperRight_Y=i(a)||0,[Number(tn(u.lowerLeft_X)),Number(tn(u.lowerLeft_Y)),Number(tn(u.upperRight_X)),Number(tn(u.upperRight_Y))]},j6=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,i=hg(e,n),o=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+o+" "+tn(i.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(i.text),t.push("ET"),t.push("Q"),t.push("EMC");var a=os(e);return a.scope=e.scope,a.stream=t.join(`
`),a}},hg=function(e,t){var n=e.fontSize===0?e.maxFontSize:e.fontSize,i={text:"",fontSize:""},o=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");o=e.multiline?o.map(function(z){return z.split(`
`)}):o.map(function(z){return[z]});var a=n,l=It.internal.getHeight(e)||0;l=l<0?-l:l;var c=It.internal.getWidth(e)||0;c=c<0?-c:c;var u=function(z,U,q){if(z+1<o.length){var I=U+" "+o[z+1][0];return Eh(I,e,q).width<=c-4}return!1};a++;e:for(;a>0;){t="",a--;var d,h,v=Eh("3",e,a).height,b=e.multiline?l-a:(l-v)/2,g=b+=2,A=0,_=0,C=0;if(a<=0){t=`(...) Tj
`,t+="% Width of Text: "+Eh(t,e,a=12).width+", FieldWidth:"+c+`
`;break}for(var E="",R=0,k=0;k<o.length;k++)if(o.hasOwnProperty(k)){var M=!1;if(o[k].length!==1&&C!==o[k].length-1){if((v+2)*(R+2)+2>l)continue e;E+=o[k][C],M=!0,_=k,k--}else{E=(E+=o[k][C]+" ").substr(E.length-1)==" "?E.substr(0,E.length-1):E;var P=parseInt(k),W=u(P,E,a),V=k>=o.length-1;if(W&&!V){E+=" ",C=0;continue}if(W||V){if(V)_=P;else if(e.multiline&&(v+2)*(R+2)+2>l)continue e}else{if(!e.multiline||(v+2)*(R+2)+2>l)continue e;_=P}}for(var $="",j=A;j<=_;j++){var X=o[j];if(e.multiline){if(j===_){$+=X[C]+" ",C=(C+1)%X.length;continue}if(j===A){$+=X[X.length-1]+" ";continue}}$+=X[0]+" "}switch($=$.substr($.length-1)==" "?$.substr(0,$.length-1):$,h=Eh($,e,a).width,e.textAlign){case"right":d=c-h-2;break;case"center":d=(c-h)/2;break;default:d=2}t+=tn(d)+" "+tn(g)+` Td
`,t+="("+Dc($)+`) Tj
`,t+=-tn(d)+` 0 Td
`,g=-(a+2),h=0,A=M?_:_+1,R++,E=""}break}return i.text=t,i.fontSize=a,i},Eh=function(e,t,n){var i=t.scope.internal.getFont(t.fontName,t.fontStyle),o=t.scope.getStringUnitWidth(e,{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:o}},F6={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},B6=function(e,t){var n={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(i){return i.type===n.type&&i.object===n.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},q6=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Oa.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(F6)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");r1=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new I_,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];a.objId=void 0,a.hasAnnotation&&B6(a,n)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(n){(function(i,o){var a=!i;for(var l in i||(o.internal.newObjectDeferredBegin(o.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),o.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||o.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(l)){var c=i[l],u=[],d=c.Rect;if(c.Rect&&(c.Rect=z6(c.Rect,o)),o.internal.newObjectDeferredBegin(c.objId,!0),c.DA=It.createDefaultAppearanceStream(c),qn(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(u=c.getKeyValueListForStream()),c.Rect=d,c.hasAppearanceStream&&!c.appearanceStreamContent){var h=j6(c);u.push({key:"AP",value:"<</N "+h+">>"}),o.internal.acroformPlugin.xForms.push(h)}if(c.appearanceStreamContent){var v="";for(var b in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(b)){var g=c.appearanceStreamContent[b];if(v+="/"+b+" ",v+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var l in g)if(g.hasOwnProperty(l)){var A=g[l];typeof A=="function"&&(A=A.call(o,c)),v+="/"+l+" "+A+" ",o.internal.acroformPlugin.xForms.indexOf(A)>=0||o.internal.acroformPlugin.xForms.push(A)}}else typeof(A=g)=="function"&&(A=A.call(o,c)),v+="/"+l+" "+A,o.internal.acroformPlugin.xForms.indexOf(A)>=0||o.internal.acroformPlugin.xForms.push(A);v+=">>"}u.push({key:"AP",value:`<<
`+v+">>"})}o.internal.putStream({additionalKeyValues:u,objectId:c.objId}),o.internal.out("endobj")}a&&(function(_,C){for(var E in _)if(_.hasOwnProperty(E)){var R=E,k=_[E];C.internal.newObjectDeferredBegin(k.objId,!0),qn(k)==="object"&&typeof k.putStream=="function"&&k.putStream(),delete _[R]}})(o.internal.acroformPlugin.xForms,o)})(n,e)}),e.internal.acroformPlugin.isInitialized=!0}},T_=ki.__acroform__.arrayToPdfArray=function(e,t,n){var i=function(l){return l};if(Array.isArray(e)){for(var o="[",a=0;a<e.length;a++)switch(a!==0&&(o+=" "),qn(e[a])){case"boolean":case"number":case"object":o+=e[a].toString();break;case"string":e[a].substr(0,1)==="/"?o+="/"+up(e[a].substr(1)):(t!==void 0&&n&&(i=n.internal.getEncryptor(t)),o+="("+Dc(i(e[a].toString()))+")")}return o+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Lm=function(e,t,n){var i=function(o){return o};return t!==void 0&&n&&(i=n.internal.getEncryptor(t)),(e=e||"").toString(),"("+Dc(i(e))+")"},cs=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};cs.prototype.toString=function(){return this.objId+" 0 R"},cs.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},cs.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var n in t)if(Object.getOwnPropertyDescriptor(this,t[n]).configurable===!1){var i=t[n],o=this[i];o&&(Array.isArray(o)?e.push({key:i,value:T_(o,this.objId,this.scope)}):o instanceof cs?(o.scope=this.scope,e.push({key:i,value:o.objId+" 0 R"})):typeof o!="function"&&e.push({key:i,value:o}))}return e};var k_=function(){cs.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){e=n.trim()},get:function(){return e||null}})};lo(k_,cs);var I_=function(){cs.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var n=function(i){return i};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Dc(n(e))+")"}},set:function(n){e=n}})};lo(I_,cs);var Oa=function e(){cs.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute F supplied.');t=E}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Pi(t,3)},set:function(E){E?this.F=Oi(t,3):this.F=Ui(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute Ff supplied.');n=E}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(E){i=E!==void 0?E:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(E){i[0]=E}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(E){i[1]=E}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(E){i[2]=E}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(E){i[3]=E}});var o="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return o},set:function(E){switch(E){case"/Btn":case"/Tx":case"/Ch":case"/Sig":o=E;break;default:throw new Error('Invalid value "'+E+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof dp)return;a="FieldObject"+e.FieldNum++}var E=function(R){return R};return this.scope&&(E=this.scope.internal.getEncryptor(this.objId)),"("+Dc(E(a))+")"},set:function(E){a=E.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(E){a=E}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(E){l=E}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(E){c=E}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(E){u=E}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/r1:d},set:function(E){d=E}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(E){h=E}});var v="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!v||this instanceof dp||this instanceof Cc))return Lm(v,this.objId,this.scope)},set:function(E){E=E.toString(),v=E}});var b=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(b)return this instanceof lr==0?Lm(b,this.objId,this.scope):b},set:function(E){E=E.toString(),b=this instanceof lr==0?E.substr(0,1)==="("?Tu(E.substr(1,E.length-2)):Tu(E):E}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof lr==1?Tu(b.substr(1,b.length-1)):b},set:function(E){E=E.toString(),b=this instanceof lr==1?"/"+up(E):E}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(E){this.V=E}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof lr==0?Lm(g,this.objId,this.scope):g},set:function(E){E=E.toString(),g=this instanceof lr==0?E.substr(0,1)==="("?Tu(E.substr(1,E.length-2)):Tu(E):E}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof lr==1?Tu(g.substr(1,g.length-1)):g},set:function(E){E=E.toString(),g=this instanceof lr==1?"/"+up(E):E}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var A,_=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return _},set:function(E){E=!!E,_=E}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(A)return A},set:function(E){A=E}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,1)},set:function(E){E?this.Ff=Oi(this.Ff,1):this.Ff=Ui(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,2)},set:function(E){E?this.Ff=Oi(this.Ff,2):this.Ff=Ui(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,3)},set:function(E){E?this.Ff=Oi(this.Ff,3):this.Ff=Ui(this.Ff,3)}});var C=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(C!==null)return C},set:function(E){if([0,1,2].indexOf(E)===-1)throw new Error('Invalid value "'+E+'" for attribute Q supplied.');C=E}}),Object.defineProperty(this,"textAlign",{get:function(){var E;switch(C){case 0:default:E="left";break;case 1:E="center";break;case 2:E="right"}return E},configurable:!0,enumerable:!0,set:function(E){switch(E){case"right":case 2:C=2;break;case"center":case 1:C=1;break;default:C=0}}})};lo(Oa,cs);var Fu=function(){Oa.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(n){e=n}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return T_(t,this.objId,this.scope)},set:function(n){var i,o;o=[],typeof(i=n)=="string"&&(o=(function(a,l,c){c||(c=1);for(var u,d=[];u=l.exec(a);)d.push(u[c]);return d})(i,/\((.*?)\)/g)),t=o}}),this.getOptions=function(){return t},this.setOptions=function(n){t=n,this.sort&&t.sort()},this.addOption=function(n){n=(n=n||"").toString(),t.push(n),this.sort&&t.sort()},this.removeOption=function(n,i){for(i=i||!1,n=(n=n||"").toString();t.indexOf(n)!==-1&&(t.splice(t.indexOf(n),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,18)},set:function(n){n?this.Ff=Oi(this.Ff,18):this.Ff=Ui(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=Oi(this.Ff,19):this.Ff=Ui(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,20)},set:function(n){n?(this.Ff=Oi(this.Ff,20),t.sort()):this.Ff=Ui(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,22)},set:function(n){n?this.Ff=Oi(this.Ff,22):this.Ff=Ui(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,23)},set:function(n){n?this.Ff=Oi(this.Ff,23):this.Ff=Ui(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,27)},set:function(n){n?this.Ff=Oi(this.Ff,27):this.Ff=Ui(this.Ff,27)}}),this.hasAppearanceStream=!1};lo(Fu,Oa);var Bu=function(){Fu.call(this),this.fontName="helvetica",this.combo=!1};lo(Bu,Fu);var qu=function(){Bu.call(this),this.combo=!0};lo(qu,Bu);var $h=function(){qu.call(this),this.edit=!0};lo($h,qu);var lr=function(){Oa.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,15)},set:function(n){n?this.Ff=Oi(this.Ff,15):this.Ff=Ui(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,16)},set:function(n){n?this.Ff=Oi(this.Ff,16):this.Ff=Ui(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,17)},set:function(n){n?this.Ff=Oi(this.Ff,17):this.Ff=Ui(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,26)},set:function(n){n?this.Ff=Oi(this.Ff,26):this.Ff=Ui(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(a){return a};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var i,o=[];for(i in o.push("<<"),t)o.push("/"+i+" ("+Dc(n(t[i]))+")");return o.push(">>"),o.join(`
`)}},set:function(n){qn(n)==="object"&&(t=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(n){typeof n=="string"&&(t.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(n){e="/"+up(n)}})};lo(lr,Oa);var Yh=function(){lr.call(this),this.pushButton=!0};lo(Yh,lr);var Hu=function(){lr.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};lo(Hu,lr);var dp=function(){var e,t;Oa.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(o){e=o}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(o){t=o}});var n,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var o=function(c){return c};this.scope&&(o=this.scope.internal.getEncryptor(this.objId));var a,l=[];for(a in l.push("<<"),i)l.push("/"+a+" ("+Dc(o(i[a]))+")");return l.push(">>"),l.join(`
`)},set:function(o){qn(o)==="object"&&(i=o)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(o){typeof o=="string"&&(i.CA=o)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(o){n=o}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(o){n="/"+o}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=It.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};lo(dp,Oa),Hu.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},Hu.prototype.createOption=function(e){var t=new dp;return t.Parent=this,t.optionName=e,this.Kids.push(t),H6.call(this.scope,t),t};var Wh=function(){lr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=It.CheckBox.createAppearanceStream()};lo(Wh,lr);var Cc=function(){Oa.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,13)},set:function(t){t?this.Ff=Oi(this.Ff,13):this.Ff=Ui(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,21)},set:function(t){t?this.Ff=Oi(this.Ff,21):this.Ff=Ui(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,23)},set:function(t){t?this.Ff=Oi(this.Ff,23):this.Ff=Ui(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,24)},set:function(t){t?this.Ff=Oi(this.Ff,24):this.Ff=Ui(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,25)},set:function(t){t?this.Ff=Oi(this.Ff,25):this.Ff=Ui(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,26)},set:function(t){t?this.Ff=Oi(this.Ff,26):this.Ff=Ui(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};lo(Cc,Oa);var Xh=function(){Cc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Pi(this.Ff,14)},set:function(e){e?this.Ff=Oi(this.Ff,14):this.Ff=Ui(this.Ff,14)}}),this.password=!0};lo(Xh,Cc);var It={CheckBox:{createAppearanceStream:function(){return{N:{On:It.CheckBox.YesNormal},D:{On:It.CheckBox.YesPushDown,Off:It.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=os(e);t.scope=e.scope;var n=[],i=e.scope.internal.getFont(e.fontName,e.fontStyle).id,o=e.scope.__private__.encodeColorString(e.color),a=hg(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+tn(It.internal.getWidth(e))+" "+tn(It.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+i+" "+tn(a.fontSize)+" Tf "+o),n.push("BT"),n.push(a.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join(`
`),t},YesNormal:function(e){var t=os(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),o=[],a=It.internal.getHeight(e),l=It.internal.getWidth(e),c=hg(e,e.caption);return o.push("1 g"),o.push("0 0 "+tn(l)+" "+tn(a)+" re"),o.push("f"),o.push("q"),o.push("0 0 1 rg"),o.push("0 0 "+tn(l-1)+" "+tn(a-1)+" re"),o.push("W"),o.push("n"),o.push("0 g"),o.push("BT"),o.push("/"+n+" "+tn(c.fontSize)+" Tf "+i),o.push(c.text),o.push("ET"),o.push("Q"),t.stream=o.join(`
`),t},OffPushDown:function(e){var t=os(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+tn(It.internal.getWidth(e))+" "+tn(It.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:It.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=It.RadioButton.Circle.YesNormal,t.D[e]=It.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=os(e);t.scope=e.scope;var n=[],i=It.internal.getWidth(e)<=It.internal.getHeight(e)?It.internal.getWidth(e)/4:It.internal.getHeight(e)/4;i=Number((.9*i).toFixed(5));var o=It.internal.Bezier_C,a=Number((i*o).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Rl(It.internal.getWidth(e)/2)+" "+Rl(It.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),n.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),n.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),n.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=os(e);t.scope=e.scope;var n=[],i=It.internal.getWidth(e)<=It.internal.getHeight(e)?It.internal.getWidth(e)/4:It.internal.getHeight(e)/4;i=Number((.9*i).toFixed(5));var o=Number((2*i).toFixed(5)),a=Number((o*It.internal.Bezier_C).toFixed(5)),l=Number((i*It.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Rl(It.internal.getWidth(e)/2)+" "+Rl(It.internal.getHeight(e)/2)+" cm"),n.push(o+" 0 m"),n.push(o+" "+a+" "+a+" "+o+" 0 "+o+" c"),n.push("-"+a+" "+o+" -"+o+" "+a+" -"+o+" 0 c"),n.push("-"+o+" -"+a+" -"+a+" -"+o+" 0 -"+o+" c"),n.push(a+" -"+o+" "+o+" -"+a+" "+o+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Rl(It.internal.getWidth(e)/2)+" "+Rl(It.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+l+" "+l+" "+i+" 0 "+i+" c"),n.push("-"+l+" "+i+" -"+i+" "+l+" -"+i+" 0 c"),n.push("-"+i+" -"+l+" -"+l+" -"+i+" 0 -"+i+" c"),n.push(l+" -"+i+" "+i+" -"+l+" "+i+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=os(e);t.scope=e.scope;var n=[],i=It.internal.getWidth(e)<=It.internal.getHeight(e)?It.internal.getWidth(e)/4:It.internal.getHeight(e)/4;i=Number((.9*i).toFixed(5));var o=Number((2*i).toFixed(5)),a=Number((o*It.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Rl(It.internal.getWidth(e)/2)+" "+Rl(It.internal.getHeight(e)/2)+" cm"),n.push(o+" 0 m"),n.push(o+" "+a+" "+a+" "+o+" 0 "+o+" c"),n.push("-"+a+" "+o+" -"+o+" "+a+" -"+o+" 0 c"),n.push("-"+o+" -"+a+" -"+a+" -"+o+" 0 -"+o+" c"),n.push(a+" -"+o+" "+o+" -"+a+" "+o+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:It.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=It.RadioButton.Cross.YesNormal,t.D[e]=It.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=os(e);t.scope=e.scope;var n=[],i=It.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+tn(It.internal.getWidth(e)-2)+" "+tn(It.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(tn(i.x1.x)+" "+tn(i.x1.y)+" m"),n.push(tn(i.x2.x)+" "+tn(i.x2.y)+" l"),n.push(tn(i.x4.x)+" "+tn(i.x4.y)+" m"),n.push(tn(i.x3.x)+" "+tn(i.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=os(e);t.scope=e.scope;var n=It.internal.calculateCross(e),i=[];return i.push("0.749023 g"),i.push("0 0 "+tn(It.internal.getWidth(e))+" "+tn(It.internal.getHeight(e))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+tn(It.internal.getWidth(e)-2)+" "+tn(It.internal.getHeight(e)-2)+" re"),i.push("W"),i.push("n"),i.push(tn(n.x1.x)+" "+tn(n.x1.y)+" m"),i.push(tn(n.x2.x)+" "+tn(n.x2.y)+" l"),i.push(tn(n.x4.x)+" "+tn(n.x4.y)+" m"),i.push(tn(n.x3.x)+" "+tn(n.x3.y)+" l"),i.push("s"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=os(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+tn(It.internal.getWidth(e))+" "+tn(It.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};It.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=It.internal.getWidth(e),n=It.internal.getHeight(e),i=Math.min(t,n);return{x1:{x:(t-i)/2,y:(n-i)/2+i},x2:{x:(t-i)/2+i,y:(n-i)/2},x3:{x:(t-i)/2,y:(n-i)/2},x4:{x:(t-i)/2+i,y:(n-i)/2+i}}}},It.internal.getWidth=function(e){var t=0;return qn(e)==="object"&&(t=N5(e.Rect[2])),t},It.internal.getHeight=function(e){var t=0;return qn(e)==="object"&&(t=N5(e.Rect[3])),t};var H6=ki.addField=function(e){if(q6(this,e),!(e instanceof Oa))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};ki.AcroFormChoiceField=Fu,ki.AcroFormListBox=Bu,ki.AcroFormComboBox=qu,ki.AcroFormEditBox=$h,ki.AcroFormButton=lr,ki.AcroFormPushButton=Yh,ki.AcroFormRadioButton=Hu,ki.AcroFormCheckBox=Wh,ki.AcroFormTextField=Cc,ki.AcroFormPasswordField=Xh,ki.AcroFormAppearance=It,ki.AcroForm={ChoiceField:Fu,ListBox:Bu,ComboBox:qu,EditBox:$h,Button:lr,PushButton:Yh,RadioButton:Hu,CheckBox:Wh,TextField:Cc,PasswordField:Xh,Appearance:It},Dt.AcroForm={ChoiceField:Fu,ListBox:Bu,ComboBox:qu,EditBox:$h,Button:lr,PushButton:Yh,RadioButton:Hu,CheckBox:Wh,TextField:Cc,PasswordField:Xh,Appearance:It};Dt.AcroForm;function R_(e){return e.reduce(function(t,n,i){return t[n]=i,t},{})}(function(e){var t="addImage_";e.__addimage__={};var n="UNKNOWN",i={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},o=e.__addimage__.getImageFileTypeByImageData=function(z,U){var q,I,ie,J,Y,le=n;if((U=U||n)==="RGBA"||z.data!==void 0&&z.data instanceof Uint8ClampedArray&&"height"in z&&"width"in z)return"RGBA";if(W(z))for(Y in i)for(ie=i[Y],q=0;q<ie.length;q+=1){for(J=!0,I=0;I<ie[q].length;I+=1)if(ie[q][I]!==void 0&&ie[q][I]!==z[I]){J=!1;break}if(J===!0){le=Y;break}}else for(Y in i)for(ie=i[Y],q=0;q<ie.length;q+=1){for(J=!0,I=0;I<ie[q].length;I+=1)if(ie[q][I]!==void 0&&ie[q][I]!==z.charCodeAt(I)){J=!1;break}if(J===!0){le=Y;break}}return le===n&&U!==n&&(le=U),le},a=function z(U){for(var q=this.internal.write,I=this.internal.putStream,ie=(0,this.internal.getFilters)();ie.indexOf("FlateEncode")!==-1;)ie.splice(ie.indexOf("FlateEncode"),1);U.objectId=this.internal.newObject();var J=[];if(J.push({key:"Type",value:"/XObject"}),J.push({key:"Subtype",value:"/Image"}),J.push({key:"Width",value:U.width}),J.push({key:"Height",value:U.height}),U.colorSpace===E.INDEXED?J.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(U.palette.length/3-1)+" "+("sMask"in U&&U.sMask!==void 0?U.objectId+2:U.objectId+1)+" 0 R]"}):(J.push({key:"ColorSpace",value:"/"+U.colorSpace}),U.colorSpace===E.DEVICE_CMYK&&J.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),J.push({key:"BitsPerComponent",value:U.bitsPerComponent}),"decodeParameters"in U&&U.decodeParameters!==void 0&&J.push({key:"DecodeParms",value:"<<"+U.decodeParameters+">>"}),"transparency"in U&&Array.isArray(U.transparency)&&U.transparency.length>0){for(var Y="",le=0,pe=U.transparency.length;le<pe;le++)Y+=U.transparency[le]+" "+U.transparency[le]+" ";J.push({key:"Mask",value:"["+Y+"]"})}U.sMask!==void 0&&J.push({key:"SMask",value:U.objectId+1+" 0 R"});var Ie=U.filter!==void 0?["/"+U.filter]:void 0;if(I({data:U.data,additionalKeyValues:J,alreadyAppliedFilters:Ie,objectId:U.objectId}),q("endobj"),"sMask"in U&&U.sMask!==void 0){var G,O=(G=U.sMaskBitsPerComponent)!==null&&G!==void 0?G:U.bitsPerComponent,ee={width:U.width,height:U.height,colorSpace:"DeviceGray",bitsPerComponent:O,data:U.sMask};"filter"in U&&(ee.decodeParameters="/Predictor ".concat(U.predictor," /Colors 1 /BitsPerComponent ").concat(O," /Columns ").concat(U.width),ee.filter=U.filter),z.call(this,ee)}if(U.colorSpace===E.INDEXED){var te=this.internal.newObject();I({data:$(new Uint8Array(U.palette)),objectId:te}),q("endobj")}},l=function(){var z=this.internal.collections[t+"images"];for(var U in z)a.call(this,z[U])},c=function(){var z,U=this.internal.collections[t+"images"],q=this.internal.write;for(var I in U)q("/I"+(z=U[I]).index,z.objectId,"0","R")},u=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",l),this.internal.events.subscribe("putXobjectDict",c))},d=function(){var z=this.internal.collections[t+"images"];return u.call(this),z},h=function(){return Object.keys(this.internal.collections[t+"images"]).length},v=function(z){return typeof e["process"+z.toUpperCase()]=="function"},b=function(z){return qn(z)==="object"&&z.nodeType===1},g=function(z,U){if(z.nodeName==="IMG"&&z.hasAttribute("src")){var q=""+z.getAttribute("src");if(q.indexOf("data:image/")===0)return Vh(unescape(q).split("base64,").pop());var I=e.loadFile(q,!0);if(I!==void 0)return I}if(z.nodeName==="CANVAS"){if(z.width===0||z.height===0)throw new Error("Given canvas must have data. Canvas width: "+z.width+", height: "+z.height);var ie;switch(U){case"PNG":ie="image/png";break;case"WEBP":ie="image/webp";break;default:ie="image/jpeg"}return Vh(z.toDataURL(ie,1).split("base64,").pop())}},A=function(z){var U=this.internal.collections[t+"images"];if(U){for(var q in U)if(z===U[q].alias)return U[q]}},_=function(z,U,q){return z||U||(z=-96,U=-96),z<0&&(z=-1*q.width*72/z/this.internal.scaleFactor),U<0&&(U=-1*q.height*72/U/this.internal.scaleFactor),z===0&&(z=U*q.width/q.height),U===0&&(U=z*q.height/q.width),[z,U]},C=function(z,U,q,I,ie,J){var Y=_.call(this,q,I,ie),le=this.internal.getCoordinateString,pe=this.internal.getVerticalCoordinateString,Ie=d.call(this);if(q=Y[0],I=Y[1],Ie[ie.index]=ie,J){J*=Math.PI/180;var G=Math.cos(J),O=Math.sin(J),ee=function(ce){return ce.toFixed(4)},te=[ee(G),ee(O),ee(-1*O),ee(G),0,0,"cm"]}this.internal.write("q"),J?(this.internal.write([1,"0","0",1,le(z),pe(U+I),"cm"].join(" ")),this.internal.write(te.join(" ")),this.internal.write([le(q),"0","0",le(I),"0","0","cm"].join(" "))):this.internal.write([le(q),"0","0",le(I),le(z),pe(U+I),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ie.index+" Do"),this.internal.write("Q")},E=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var R=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},k=e.__addimage__.sHashCode=function(z){var U,q,I=0;if(typeof z=="string")for(q=z.length,U=0;U<q;U++)I=(I<<5)-I+z.charCodeAt(U),I|=0;else if(W(z))for(q=z.byteLength/2,U=0;U<q;U++)I=(I<<5)-I+z[U],I|=0;return I},M=e.__addimage__.validateStringAsBase64=function(z){(z=z||"").toString().trim();var U=!0;return z.length===0&&(U=!1),z.length%4!=0&&(U=!1),/^[A-Za-z0-9+/]+$/.test(z.substr(0,z.length-2))===!1&&(U=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(z.substr(-2))===!1&&(U=!1),U},P=e.__addimage__.extractImageFromDataUrl=function(z){if(z==null||!(z=z.trim()).startsWith("data:"))return null;var U=z.indexOf(",");return U<0?null:z.substring(0,U).trim().endsWith("base64")?z.substring(U+1):null};e.__addimage__.isArrayBuffer=function(z){return z instanceof ArrayBuffer};var W=e.__addimage__.isArrayBufferView=function(z){return z instanceof Int8Array||z instanceof Uint8Array||z instanceof Uint8ClampedArray||z instanceof Int16Array||z instanceof Uint16Array||z instanceof Int32Array||z instanceof Uint32Array||z instanceof Float32Array||z instanceof Float64Array},V=e.__addimage__.binaryStringToUint8Array=function(z){for(var U=z.length,q=new Uint8Array(U),I=0;I<U;I++)q[I]=z.charCodeAt(I);return q},$=e.__addimage__.arrayBufferToBinaryString=function(z){for(var U="",q=W(z)?z:new Uint8Array(z),I=0;I<q.length;I+=8192)U+=String.fromCharCode.apply(null,q.subarray(I,I+8192));return U};e.addImage=function(){var z,U,q,I,ie,J,Y,le,pe;if(typeof arguments[1]=="number"?(U=n,q=arguments[1],I=arguments[2],ie=arguments[3],J=arguments[4],Y=arguments[5],le=arguments[6],pe=arguments[7]):(U=arguments[1],q=arguments[2],I=arguments[3],ie=arguments[4],J=arguments[5],Y=arguments[6],le=arguments[7],pe=arguments[8]),qn(z=arguments[0])==="object"&&!b(z)&&"imageData"in z){var Ie=z;z=Ie.imageData,U=Ie.format||U||n,q=Ie.x||q||0,I=Ie.y||I||0,ie=Ie.w||Ie.width||ie,J=Ie.h||Ie.height||J,Y=Ie.alias||Y,le=Ie.compression||le,pe=Ie.rotation||Ie.angle||pe}var G=this.internal.getFilters();if(le===void 0&&G.indexOf("FlateEncode")!==-1&&(le="SLOW"),isNaN(q)||isNaN(I))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var O=j.call(this,z,U,Y,le);return C.call(this,q,I,ie,J,O,pe),this};var j=function(z,U,q,I){var ie,J,Y;if(typeof z=="string"&&o(z)===n){z=unescape(z);var le=X(z,!1);(le!==""||(le=e.loadFile(z,!0))!==void 0)&&(z=le)}if(b(z)&&(z=g(z,U)),U=o(z,U),!v(U))throw new Error("addImage does not support files of type '"+U+"', please ensure that a plugin for '"+U+"' support is added.");if(((Y=q)==null||Y.length===0)&&(q=(function(pe){return typeof pe=="string"||W(pe)?k(pe):W(pe.data)?k(pe.data):null})(z)),(ie=A.call(this,q))||(z instanceof Uint8Array||U==="RGBA"||(J=z,z=V(z)),ie=this["process"+U.toUpperCase()](z,h.call(this),q,(function(pe){return pe&&typeof pe=="string"&&(pe=pe.toUpperCase()),pe in e.image_compression?pe:R.NONE})(I),J)),!ie)throw new Error("An unknown error occurred whilst processing the image.");return ie},X=e.__addimage__.convertBase64ToBinaryString=function(z,U){U=typeof U!="boolean"||U;var q,I="";if(typeof z=="string"){var ie;q=(ie=P(z))!==null&&ie!==void 0?ie:z;try{I=Vh(q)}catch(J){if(U)throw M(q)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+J.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return I};e.getImageProperties=function(z){var U,q,I="";if(b(z)&&(z=g(z)),typeof z=="string"&&o(z)===n&&((I=X(z,!1))===""&&(I=e.loadFile(z)||""),z=I),q=o(z),!v(q))throw new Error("addImage does not support files of type '"+q+"', please ensure that a plugin for '"+q+"' support is added.");if(z instanceof Uint8Array||(z=V(z)),!(U=this["process"+q.toUpperCase()](z)))throw new Error("An unknown error occurred whilst processing the image");return U.fileType=q,U}})(Dt.API),(function(e){var t=function(n){if(n!==void 0&&n!="")return!0};Dt.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(n){for(var i,o,a,l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(n.objId),d=n.pageContext.annotations,h=!1,v=0;v<d.length&&!h;v++)switch((i=d[v]).type){case"link":(t(i.options.url)||t(i.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var b=0;b<d.length;b++){i=d[b];var g=this.internal.pdfEscape,A=this.internal.getEncryptor(n.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var _=this.internal.newAdditionalObject(),C=this.internal.newAdditionalObject(),E=this.internal.getEncryptor(_.objId),R=i.title||"Note";a="<</Type /Annot /Subtype /Text "+(o="/Rect ["+l(i.bounds.x)+" "+c(i.bounds.y+i.bounds.h)+" "+l(i.bounds.x+i.bounds.w)+" "+c(i.bounds.y)+"] ")+"/Contents ("+g(E(i.contents))+")",a+=" /Popup "+C.objId+" 0 R",a+=" /P "+u.objId+" 0 R",a+=" /T ("+g(E(R))+") >>",_.content=a;var k=_.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(o="/Rect ["+l(i.bounds.x+30)+" "+c(i.bounds.y+i.bounds.h)+" "+l(i.bounds.x+i.bounds.w+30)+" "+c(i.bounds.y)+"] ")+" /Parent "+k,i.open&&(a+=" /Open true"),a+=" >>",C.content=a,this.internal.write(_.objId,"0 R",C.objId,"0 R");break;case"freetext":o="/Rect ["+l(i.bounds.x)+" "+c(i.bounds.y)+" "+l(i.bounds.x+i.bounds.w)+" "+c(i.bounds.y+i.bounds.h)+"] ";var M=i.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+o+"/Contents ("+g(A(i.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+M+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(i.options.name){var P=this.annotations._nameMap[i.options.name];i.options.pageNumber=P.page,i.options.top=P.y}else i.options.top||(i.options.top=0);if(o="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",a="",i.options.url)a="<</Type /Annot /Subtype /Link "+o+"/Border [0 0 0] /A <</S /URI /URI ("+g(A(i.options.url))+") >>";else if(i.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+o+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,a+=" /FitV "+i.options.left+"]";break;default:var W=c(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),a+=" /XYZ "+i.options.left+" "+W+" "+i.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),e.createAnnotation=function(n){var i=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":i.pageContext.annotations.push(n)}},e.link=function(n,i,o,a,l){var c=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:u(n),y:d(i),w:u(n+o),h:d(i+a)},options:l,type:"link"})},e.textWithLink=function(n,i,o,a){var l,c,u=this.getTextWidth(n),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){c=a.maxWidth;var h=this.splitTextToSize(n,c).length;l=Math.ceil(d*h)}else c=u,l=d;return this.text(n,i,o,a),o+=.2*d,a.align==="center"&&(i-=u/2),a.align==="right"&&(i-=u),this.link(i,o-d,c,l,a),u},e.getTextWidth=function(n){var i=this.internal.getFontSize();return this.getStringUnitWidth(n)*i/this.internal.scaleFactor}})(Dt.API),(function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},o=[1570,1571,1573,1575];e.__arabicParser__={};var a=e.__arabicParser__.isInArabicSubstitutionA=function(_){return t[_.charCodeAt(0)]!==void 0},l=e.__arabicParser__.isArabicLetter=function(_){return typeof _=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(_)},c=e.__arabicParser__.isArabicEndLetter=function(_){return l(_)&&a(_)&&t[_.charCodeAt(0)].length<=2},u=e.__arabicParser__.isArabicAlfLetter=function(_){return l(_)&&o.indexOf(_.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(_){return l(_)&&a(_)&&t[_.charCodeAt(0)].length>=1};var d=e.__arabicParser__.arabicLetterHasFinalForm=function(_){return l(_)&&a(_)&&t[_.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(_){return l(_)&&a(_)&&t[_.charCodeAt(0)].length>=3};var h=e.__arabicParser__.arabicLetterHasMedialForm=function(_){return l(_)&&a(_)&&t[_.charCodeAt(0)].length==4},v=e.__arabicParser__.resolveLigatures=function(_){var C=0,E=n,R="",k=0;for(C=0;C<_.length;C+=1)E[_.charCodeAt(C)]!==void 0?(k++,typeof(E=E[_.charCodeAt(C)])=="number"&&(R+=String.fromCharCode(E),E=n,k=0),C===_.length-1&&(E=n,R+=_.charAt(C-(k-1)),C-=k-1,k=0)):(E=n,R+=_.charAt(C-k),C-=k,k=0);return R};e.__arabicParser__.isArabicDiacritic=function(_){return _!==void 0&&i[_.charCodeAt(0)]!==void 0};var b=e.__arabicParser__.getCorrectForm=function(_,C,E){return l(_)?a(_)===!1?-1:!d(_)||!l(C)&&!l(E)||!l(E)&&c(C)||c(_)&&!l(C)||c(_)&&u(C)||c(_)&&c(C)?0:h(_)&&l(C)&&!c(C)&&l(E)&&d(E)?3:c(_)||!l(E)?1:2:-1},g=function(_){var C=0,E=0,R=0,k="",M="",P="",W=(_=_||"").split("\\s+"),V=[];for(C=0;C<W.length;C+=1){for(V.push(""),E=0;E<W[C].length;E+=1)k=W[C][E],M=W[C][E-1],P=W[C][E+1],l(k)?(R=b(k,M,P),V[C]+=R!==-1?String.fromCharCode(t[k.charCodeAt(0)][R]):k):V[C]+=k;V[C]=v(V[C])}return V.join(" ")},A=e.__arabicParser__.processArabic=e.processArabic=function(){var _,C=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,E=[];if(Array.isArray(C)){var R=0;for(E=[],R=0;R<C.length;R+=1)Array.isArray(C[R])?E.push([g(C[R][0]),C[R][1],C[R][2]]):E.push([g(C[R])]);_=E}else _=g(C);return typeof arguments[0]=="string"?_:(arguments[0].text=_,arguments[0])};e.events.push(["preProcessText",A])})(Dt.API),Dt.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},(function(e){var t=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(c){n=c}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(c){i=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var o=300;Object.defineProperty(this,"height",{get:function(){return o},set:function(c){o=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=o+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(c){a=c}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(c){l=c}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(n,i){var o;if((n=n||"2d")!=="2d")return null;for(o in i)this.pdf.context2d.hasOwnProperty(o)&&(this.pdf.context2d[o]=i[o]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])})(Dt.API),(function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),o.call(this))},o=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(_){u=_}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(_){d=_}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(_){h=_}});var v=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return v},set:function(_){v=_}});var b=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return b},set:function(_){b=_}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(_){g=_}});var A=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return A},set:function(_){A=_}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(u){return i.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},e.getTextDimensions=function(u,d){i.call(this);var h=(d=d||{}).fontSize||this.getFontSize(),v=d.font||this.getFont(),b=d.scaleFactor||this.internal.scaleFactor,g=0,A=0,_=0,C=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var E=d.maxWidth;E>0?typeof u=="string"?u=this.splitTextToSize(u,E):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(k,M){return k.concat(C.splitTextToSize(M,E))},[])):u=Array.isArray(u)?u:[u];for(var R=0;R<u.length;R++)g<(_=this.getStringUnitWidth(u[R],{font:v})*h)&&(g=_);return g!==0&&(A=u.length),{w:g/=b,h:Math.max((A*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/b,0)}},e.cellAddPage=function(){i.call(this),this.addPage();var u=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new a(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=e.cell=function(){var u;u=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),i.call(this);var d=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,v=this.internal.__cell__.margins||t,b=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===u.lineNumber?(u.x=(d.x||0)+(d.width||0),u.y=d.y||0):d.y+d.height+u.height+v.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=v.top,g&&b&&(this.printHeaderRow(u.lineNumber,!0),u.y+=b[0].height)):u.y=d.y+d.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,n===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-h,u.y+h,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+h,{align:"center",baseline:"top",maxWidth:u.width-h-h}):this.text(u.text,u.x+h,u.y+h,{align:"left",baseline:"top",maxWidth:u.width-h-h})),this.internal.__cell__.lastCell=u,this};e.table=function(u,d,h,v,b){if(i.call(this),!h)throw new Error("No data for PDF table.");var g,A,_,C,E=[],R=[],k=[],M={},P={},W=[],V=[],$=(b=b||{}).autoSize||!1,j=b.printHeaders!==!1,X=b.css&&b.css["font-size"]!==void 0?16*b.css["font-size"]:b.fontSize||12,z=b.margins||Object.assign({width:this.getPageWidth()},t),U=typeof b.padding=="number"?b.padding:3,q=b.headerBackgroundColor||"#c8c8c8",I=b.headerTextColor||"#000";if(o.call(this),this.internal.__cell__.printHeaders=j,this.internal.__cell__.margins=z,this.internal.__cell__.table_font_size=X,this.internal.__cell__.padding=U,this.internal.__cell__.headerBackgroundColor=q,this.internal.__cell__.headerTextColor=I,this.setFontSize(X),v==null)R=E=Object.keys(h[0]),k=E.map(function(){return"left"});else if(Array.isArray(v)&&qn(v[0])==="object")for(E=v.map(function(Ie){return Ie.name}),R=v.map(function(Ie){return Ie.prompt||Ie.name||""}),k=v.map(function(Ie){return Ie.align||"left"}),g=0;g<v.length;g+=1)P[v[g].name]=.7499990551181103*v[g].width;else Array.isArray(v)&&typeof v[0]=="string"&&(R=E=v,k=E.map(function(){return"left"}));if($||Array.isArray(v)&&typeof v[0]=="string")for(g=0;g<E.length;g+=1){for(M[C=E[g]]=h.map(function(Ie){return Ie[C]}),this.setFont(void 0,"bold"),W.push(this.getTextDimensions(R[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),A=M[C],this.setFont(void 0,"normal"),_=0;_<A.length;_+=1)W.push(this.getTextDimensions(A[_],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);P[C]=Math.max.apply(null,W)+U+U,W=[]}if(j){var ie={};for(g=0;g<E.length;g+=1)ie[E[g]]={},ie[E[g]].text=R[g],ie[E[g]].align=k[g];var J=c.call(this,ie,P);V=E.map(function(Ie){return new a(u,d,P[Ie],J,ie[Ie].text,void 0,ie[Ie].align)}),this.setTableHeaderRow(V),this.printHeaderRow(1,!1)}var Y=v.reduce(function(Ie,G){return Ie[G.name]=G.align,Ie},{});for(g=0;g<h.length;g+=1){"rowStart"in b&&b.rowStart instanceof Function&&b.rowStart({row:g,data:h[g]},this);var le=c.call(this,h[g],P);for(_=0;_<E.length;_+=1){var pe=h[g][E[_]];"cellStart"in b&&b.cellStart instanceof Function&&b.cellStart({row:g,col:_,data:pe},this),l.call(this,new a(u,d,P[E[_]],le,pe,g+2,Y[E[_]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=d,this};var c=function(u,d){var h=this.internal.__cell__.padding,v=this.internal.__cell__.table_font_size,b=this.internal.scaleFactor;return Object.keys(u).map(function(g){var A=u[g];return this.splitTextToSize(A.hasOwnProperty("text")?A.text:A,d[g]-h-h)},this).map(function(g){return this.getLineHeightFactor()*g.length*v/b+h+h},this).reduce(function(g,A){return Math.max(g,A)},0)};e.setTableHeaderRow=function(u){i.call(this),this.internal.__cell__.tableHeaderRow=u},e.printHeaderRow=function(u,d){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var v=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(v[0],v[1],v[2],v[3],void 0,-1)}this.setFont(void 0,"bold");for(var b=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){h=this.internal.__cell__.tableHeaderRow[g].clone(),d&&(h.y=this.internal.__cell__.margins.top||0,b.push(h)),h.lineNumber=u;var A=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,h),this.setTextColor(A)}b.length>0&&this.setTableHeaderRow(b),this.setFont(void 0,"normal"),n=!1}})(Dt.API);var L_={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},M_=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],pg=R_(M_),D_=[100,200,300,400,500,600,700,800,900],G6=R_(D_);function Mm(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),n=(function(a){return L_[a=a||"normal"]?a:"normal"})(e.style),i=(function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400})(e.weight),o=(function(a){return typeof pg[a=a||"normal"]=="number"?a:"normal"})(e.stretch);return{family:t,style:n,weight:i,stretch:o,src:e.src||[],ref:e.ref||{name:t,style:[o,n,i].join(" ")}}}function A5(e,t,n,i){var o;for(o=n;o>=0&&o<t.length;o+=i)if(e[t[o]])return e[t[o]];for(o=n;o>=0&&o<t.length;o-=i)if(e[t[o]])return e[t[o]]}var V6={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},C5={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function T5(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function k5(e){return e.trimLeft()}function $6(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function Y6(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var ku,Nh,I5,R5,L5,Dm=["times"];function M5(e,t,n,i,o){var a=4,l=P5;switch(o){case Dt.API.image_compression.FAST:a=1,l=D5;break;case Dt.API.image_compression.MEDIUM:a=6,l=O5;break;case Dt.API.image_compression.SLOW:a=9,l=U5}e=(function(u,d,h,v){for(var b,g=u.length/d,A=new Uint8Array(u.length+g),_=[W6,D5,P5,O5,U5],C=0;C<g;C+=1){var E=C*d,R=u.subarray(E,E+d);if(v)A.set(v(R,h,b),E+C);else{for(var k=_.length,M=[],P=0;P<k;P+=1)M[P]=_[P](R,h,b);var W=J6(M.concat());A.set(M[W],E+C)}b=R}return A})(e,t,Math.ceil(n*i/8),l);var c=sg(e,{level:a});return Dt.API.__addimage__.arrayBufferToBinaryString(c)}function W6(e){var t=Array.apply([],e);return t.unshift(0),t}function D5(e,t){var n=e.length,i=[];i[0]=1;for(var o=0;o<n;o+=1){var a=e[o-t]||0;i[o+1]=e[o]-a+256&255}return i}function P5(e,t,n){var i=e.length,o=[];o[0]=2;for(var a=0;a<i;a+=1){var l=n&&n[a]||0;o[a+1]=e[a]-l+256&255}return o}function O5(e,t,n){var i=e.length,o=[];o[0]=3;for(var a=0;a<i;a+=1){var l=e[a-t]||0,c=n&&n[a]||0;o[a+1]=e[a]+256-(l+c>>>1)&255}return o}function U5(e,t,n){var i=e.length,o=[];o[0]=4;for(var a=0;a<i;a+=1){var l=X6(e[a-t]||0,n&&n[a]||0,n&&n[a-t]||0);o[a+1]=e[a]-l+256&255}return o}function X6(e,t,n){if(e===t&&t===n)return e;var i=Math.abs(t-n),o=Math.abs(e-n),a=Math.abs(e+t-n-n);return i<=o&&i<=a?e:o<=a?t:n}function J6(e){var t=e.map(function(n){return n.reduce(function(i,o){return i+Math.abs(o)},0)});return t.indexOf(Math.min.apply(null,t))}function Pm(e,t,n){var i=t*n,o=Math.floor(i/8),a=16-(i-8*o+n),l=(1<<n)-1;return P_(e,o)>>a&l}function z5(e,t,n,i){var o=n*i,a=Math.floor(o/8),l=16-(o-8*a+i),c=(1<<i)-1,u=(t&c)<<l;(function(d,h,v){if(h+1<d.byteLength)d.setUint16(h,v,!1);else{var b=v>>8&255;d.setUint8(h,b)}})(e,a,P_(e,a)&~(c<<l)&65535|u)}function P_(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function K6(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,i=e[t++]|e[t++]<<8,o=e[t++],a=o>>7,l=1<<1+(7&o);e[t++],e[t++];var c=null,u=null;a&&(c=t,u=l,t+=3*l);var d=!0,h=[],v=0,b=null,g=0,A=null;for(this.width=n,this.height=i;d&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,A=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((z=e[t++])>=0))throw Error("Invalid block size");if(z===0)break;t+=z}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var _=e[t++];v=e[t++]|e[t++]<<8,b=e[t++],1&_||(b=null),g=_>>2&7,t++;break;case 254:for(;;){if(!((z=e[t++])>=0))throw Error("Invalid block size");if(z===0)break;t+=z}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var C=e[t++]|e[t++]<<8,E=e[t++]|e[t++]<<8,R=e[t++]|e[t++]<<8,k=e[t++]|e[t++]<<8,M=e[t++],P=M>>6&1,W=1<<1+(7&M),V=c,$=u,j=!1;M>>7&&(j=!0,V=t,$=W,t+=3*W);var X=t;for(t++;;){var z;if(!((z=e[t++])>=0))throw Error("Invalid block size");if(z===0)break;t+=z}h.push({x:C,y:E,width:R,height:k,has_local_palette:j,palette_offset:V,palette_size:$,data_offset:X,data_length:t-X,transparent_index:b,interlaced:!!P,delay:v,disposal:g});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return A},this.frameInfo=function(U){if(U<0||U>=h.length)throw new Error("Frame index out of range.");return h[U]},this.decodeAndBlitFrameBGRA=function(U,q){var I=this.frameInfo(U),ie=I.width*I.height,J=new Uint8Array(ie);j5(e,I.data_offset,J,ie);var Y=I.palette_offset,le=I.transparent_index;le===null&&(le=256);var pe=I.width,Ie=n-pe,G=pe,O=4*(I.y*n+I.x),ee=4*((I.y+I.height)*n+I.x),te=O,ce=4*Ie;I.interlaced===!0&&(ce+=4*n*7);for(var ye=8,we=0,Te=J.length;we<Te;++we){var Ce=J[we];if(G===0&&(G=pe,(te+=ce)>=ee&&(ce=4*Ie+4*n*(ye-1),te=O+(pe+Ie)*(ye<<1),ye>>=1)),Ce===le)te+=4;else{var De=e[Y+3*Ce],$e=e[Y+3*Ce+1],at=e[Y+3*Ce+2];q[te++]=at,q[te++]=$e,q[te++]=De,q[te++]=255}--G}},this.decodeAndBlitFrameRGBA=function(U,q){var I=this.frameInfo(U),ie=I.width*I.height,J=new Uint8Array(ie);j5(e,I.data_offset,J,ie);var Y=I.palette_offset,le=I.transparent_index;le===null&&(le=256);var pe=I.width,Ie=n-pe,G=pe,O=4*(I.y*n+I.x),ee=4*((I.y+I.height)*n+I.x),te=O,ce=4*Ie;I.interlaced===!0&&(ce+=4*n*7);for(var ye=8,we=0,Te=J.length;we<Te;++we){var Ce=J[we];if(G===0&&(G=pe,(te+=ce)>=ee&&(ce=4*Ie+4*n*(ye-1),te=O+(pe+Ie)*(ye<<1),ye>>=1)),Ce===le)te+=4;else{var De=e[Y+3*Ce],$e=e[Y+3*Ce+1],at=e[Y+3*Ce+2];q[te++]=De,q[te++]=$e,q[te++]=at,q[te++]=255}--G}}}function j5(e,t,n,i){for(var o=e[t++],a=1<<o,l=a+1,c=l+1,u=o+1,d=(1<<u)-1,h=0,v=0,b=0,g=e[t++],A=new Int32Array(4096),_=null;;){for(;h<16&&g!==0;)v|=e[t++]<<h,h+=8,g===1?g=e[t++]:--g;if(h<u)break;var C=v&d;if(v>>=u,h-=u,C!==a){if(C===l)break;for(var E=C<c?C:_,R=0,k=E;k>a;)k=A[k]>>8,++R;var M=k;if(b+R+(E!==C?1:0)>i)return void Qn.log("Warning, gif stream longer than expected.");n[b++]=M;var P=b+=R;for(E!==C&&(n[b++]=M),k=E;R--;)k=A[k],n[--P]=255&k,k>>=8;_!==null&&c<4096&&(A[c++]=_<<8|M,c>=d+1&&u<12&&(++u,d=d<<1|1)),_=C}else c=l+1,d=(1<<(u=o+1))-1,_=null}return b!==i&&Qn.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Om(e){var t,n,i,o,a,l=Math.floor,c=new Array(64),u=new Array(64),d=new Array(64),h=new Array(64),v=new Array(65535),b=new Array(65535),g=new Array(64),A=new Array(64),_=[],C=0,E=7,R=new Array(64),k=new Array(64),M=new Array(64),P=new Array(256),W=new Array(2048),V=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],$=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],j=[0,1,2,3,4,5,6,7,8,9,10,11],X=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],z=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],U=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],q=[0,1,2,3,4,5,6,7,8,9,10,11],I=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ie=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function J(O,ee){for(var te=0,ce=0,ye=new Array,we=1;we<=16;we++){for(var Te=1;Te<=O[we];Te++)ye[ee[ce]]=[],ye[ee[ce]][0]=te,ye[ee[ce]][1]=we,ce++,te++;te*=2}return ye}function Y(O){for(var ee=O[0],te=O[1]-1;te>=0;)ee&1<<te&&(C|=1<<E),te--,--E<0&&(C==255?(le(255),le(0)):le(C),E=7,C=0)}function le(O){_.push(O)}function pe(O){le(O>>8&255),le(255&O)}function Ie(O,ee,te,ce,ye){for(var we,Te=ye[0],Ce=ye[240],De=(function(ae,be){var Me,Se,He,Ne,ze,We,dt,ft,ht,Et,mt=0;for(ht=0;ht<8;++ht){Me=ae[mt],Se=ae[mt+1],He=ae[mt+2],Ne=ae[mt+3],ze=ae[mt+4],We=ae[mt+5],dt=ae[mt+6];var on=Me+(ft=ae[mt+7]),yt=Me-ft,vt=Se+dt,Rt=Se-dt,Ft=He+We,Le=He-We,nt=Ne+ze,Qe=Ne-ze,ut=on+nt,wt=on-nt,lt=vt+Ft,et=vt-Ft;ae[mt]=ut+lt,ae[mt+4]=ut-lt;var pt=.707106781*(et+wt);ae[mt+2]=wt+pt,ae[mt+6]=wt-pt;var Bt=.382683433*((ut=Qe+Le)-(et=Rt+yt)),Vt=.5411961*ut+Bt,zt=1.306562965*et+Bt,Jt=.707106781*(lt=Le+Rt),bt=yt+Jt,jt=yt-Jt;ae[mt+5]=jt+Vt,ae[mt+3]=jt-Vt,ae[mt+1]=bt+zt,ae[mt+7]=bt-zt,mt+=8}for(mt=0,ht=0;ht<8;++ht){Me=ae[mt],Se=ae[mt+8],He=ae[mt+16],Ne=ae[mt+24],ze=ae[mt+32],We=ae[mt+40],dt=ae[mt+48];var sn=Me+(ft=ae[mt+56]),Nn=Me-ft,Xn=Se+dt,mn=Se-dt,rn=He+We,wn=He-We,Qi=Ne+ze,Ii=Ne-ze,On=sn+Qi,ti=sn-Qi,er=Xn+rn,Cr=Xn-rn;ae[mt]=On+er,ae[mt+32]=On-er;var Br=.707106781*(Cr+ti);ae[mt+16]=ti+Br,ae[mt+48]=ti-Br;var fs=.382683433*((On=Ii+wn)-(Cr=mn+Nn)),co=.5411961*On+fs,uo=1.306562965*Cr+fs,ja=.707106781*(er=wn+mn),fo=Nn+ja,ho=Nn-ja;ae[mt+40]=ho+co,ae[mt+24]=ho-co,ae[mt+8]=fo+uo,ae[mt+56]=fo-uo,mt++}for(ht=0;ht<64;++ht)Et=ae[ht]*be[ht],g[ht]=Et>0?Et+.5|0:Et-.5|0;return g})(O,ee),$e=0;$e<64;++$e)A[V[$e]]=De[$e];var at=A[0]-te;te=A[0],at==0?Y(ce[0]):(Y(ce[b[we=32767+at]]),Y(v[we]));for(var st=63;st>0&&A[st]==0;)st--;if(st==0)return Y(Te),te;for(var B,K=1;K<=st;){for(var _e=K;A[K]==0&&K<=st;)++K;var he=K-_e;if(he>=16){B=he>>4;for(var ne=1;ne<=B;++ne)Y(Ce);he&=15}we=32767+A[K],Y(ye[(he<<4)+b[we]]),Y(v[we]),K++}return st!=63&&Y(Te),te}function G(O){O=Math.min(Math.max(O,1),100),a!=O&&((function(ee){for(var te=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ce=0;ce<64;ce++){var ye=l((te[ce]*ee+50)/100);ye=Math.min(Math.max(ye,1),255),c[V[ce]]=ye}for(var we=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Te=0;Te<64;Te++){var Ce=l((we[Te]*ee+50)/100);Ce=Math.min(Math.max(Ce,1),255),u[V[Te]]=Ce}for(var De=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],$e=0,at=0;at<8;at++)for(var st=0;st<8;st++)d[$e]=1/(c[V[$e]]*De[at]*De[st]*8),h[$e]=1/(u[V[$e]]*De[at]*De[st]*8),$e++})(O<50?Math.floor(5e3/O):Math.floor(200-2*O)),a=O)}this.encode=function(O,ee){ee&&G(ee),_=new Array,C=0,E=7,pe(65496),pe(65504),pe(16),le(74),le(70),le(73),le(70),le(0),le(1),le(1),le(0),pe(1),pe(1),le(0),le(0),(function(){pe(65499),pe(132),le(0);for(var Se=0;Se<64;Se++)le(c[Se]);le(1);for(var He=0;He<64;He++)le(u[He])})(),(function(Se,He){pe(65472),pe(17),le(8),pe(He),pe(Se),le(3),le(1),le(17),le(0),le(2),le(17),le(1),le(3),le(17),le(1)})(O.width,O.height),(function(){pe(65476),pe(418),le(0);for(var Se=0;Se<16;Se++)le($[Se+1]);for(var He=0;He<=11;He++)le(j[He]);le(16);for(var Ne=0;Ne<16;Ne++)le(X[Ne+1]);for(var ze=0;ze<=161;ze++)le(z[ze]);le(1);for(var We=0;We<16;We++)le(U[We+1]);for(var dt=0;dt<=11;dt++)le(q[dt]);le(17);for(var ft=0;ft<16;ft++)le(I[ft+1]);for(var ht=0;ht<=161;ht++)le(ie[ht])})(),pe(65498),pe(12),le(3),le(1),le(0),le(2),le(17),le(3),le(17),le(0),le(63),le(0);var te=0,ce=0,ye=0;C=0,E=7,this.encode.displayName="_encode_";for(var we,Te,Ce,De,$e,at,st,B,K,_e=O.data,he=O.width,ne=O.height,ae=4*he,be=0;be<ne;){for(we=0;we<ae;){for($e=ae*be+we,st=-1,B=0,K=0;K<64;K++)at=$e+(B=K>>3)*ae+(st=4*(7&K)),be+B>=ne&&(at-=ae*(be+1+B-ne)),we+st>=ae&&(at-=we+st-ae+4),Te=_e[at++],Ce=_e[at++],De=_e[at++],R[K]=(W[Te]+W[Ce+256|0]+W[De+512|0]>>16)-128,k[K]=(W[Te+768|0]+W[Ce+1024|0]+W[De+1280|0]>>16)-128,M[K]=(W[Te+1280|0]+W[Ce+1536|0]+W[De+1792|0]>>16)-128;te=Ie(R,d,te,t,i),ce=Ie(k,h,ce,n,o),ye=Ie(M,h,ye,n,o),we+=32}be+=8}if(E>=0){var Me=[];Me[1]=E+1,Me[0]=(1<<E+1)-1,Y(Me)}return pe(65497),new Uint8Array(_)},e=e||50,(function(){for(var O=String.fromCharCode,ee=0;ee<256;ee++)P[ee]=O(ee)})(),t=J($,j),n=J(U,q),i=J(X,z),o=J(I,ie),(function(){for(var O=1,ee=2,te=1;te<=15;te++){for(var ce=O;ce<ee;ce++)b[32767+ce]=te,v[32767+ce]=[],v[32767+ce][1]=te,v[32767+ce][0]=ce;for(var ye=-(ee-1);ye<=-O;ye++)b[32767+ye]=te,v[32767+ye]=[],v[32767+ye][1]=te,v[32767+ye][0]=ee-1+ye;O<<=1,ee<<=1}})(),(function(){for(var O=0;O<256;O++)W[O]=19595*O,W[O+256|0]=38470*O,W[O+512|0]=7471*O+32768,W[O+768|0]=-11059*O,W[O+1024|0]=-21709*O,W[O+1280|0]=32768*O+8421375,W[O+1536|0]=-27439*O,W[O+1792|0]=-5329*O})(),G(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ca(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function F5(e){function t(j){if(!j)throw Error("assert :P")}function n(j,X,z){for(var U=0;4>U;U++)if(j[X+U]!=z.charCodeAt(U))return!0;return!1}function i(j,X,z,U,q){for(var I=0;I<q;I++)j[X+I]=z[U+I]}function o(j,X,z,U){for(var q=0;q<U;q++)j[X+q]=z}function a(j){return new Int32Array(j)}function l(j,X){for(var z=[],U=0;U<j;U++)z.push(new X);return z}function c(j,X){var z=[];return(function U(q,I,ie){for(var J=ie[I],Y=0;Y<J&&(q.push(ie.length>I+1?[]:new X),!(ie.length<I+1));Y++)U(q[Y],I+1,ie)})(z,0,j),z}var u=function(){var j=this;function X(x,N){for(var D=1<<N-1>>>0;x&D;)D>>>=1;return D?(x&D-1)+D:x}function z(x,N,D,F,Q){t(!(F%D));do x[N+(F-=D)]=Q;while(0<F)}function U(x,N,D,F,Q){if(t(2328>=Q),512>=Q)var re=a(512);else if((re=a(Q))==null)return 0;return(function(oe,ue,fe,ge,Ae,Fe){var me,Re,Ue=ue,Xe=1<<fe,je=a(16),Ye=a(16);for(t(Ae!=0),t(ge!=null),t(oe!=null),t(0<fe),Re=0;Re<Ae;++Re){if(15<ge[Re])return 0;++je[ge[Re]]}if(je[0]==Ae)return 0;for(Ye[1]=0,me=1;15>me;++me){if(je[me]>1<<me)return 0;Ye[me+1]=Ye[me]+je[me]}for(Re=0;Re<Ae;++Re)me=ge[Re],0<ge[Re]&&(Fe[Ye[me]++]=Re);if(Ye[15]==1)return(ge=new q).g=0,ge.value=Fe[0],z(oe,Ue,1,Xe,ge),Xe;var Ze,ct=-1,rt=Xe-1,kt=0,_t=1,Wt=1,At=1<<fe;for(Re=0,me=1,Ae=2;me<=fe;++me,Ae<<=1){if(_t+=Wt<<=1,0>(Wt-=je[me]))return 0;for(;0<je[me];--je[me])(ge=new q).g=me,ge.value=Fe[Re++],z(oe,Ue+kt,Ae,At,ge),kt=X(kt,me)}for(me=fe+1,Ae=2;15>=me;++me,Ae<<=1){if(_t+=Wt<<=1,0>(Wt-=je[me]))return 0;for(;0<je[me];--je[me]){if(ge=new q,(kt&rt)!=ct){for(Ue+=At,Ze=1<<(ct=me)-fe;15>ct&&!(0>=(Ze-=je[ct]));)++ct,Ze<<=1;Xe+=At=1<<(Ze=ct-fe),oe[ue+(ct=kt&rt)].g=Ze+fe,oe[ue+ct].value=Ue-ue-ct}ge.g=me-fe,ge.value=Fe[Re++],z(oe,Ue+(kt>>fe),Ae,At,ge),kt=X(kt,me)}}return _t!=2*Ye[15]-1?0:Xe})(x,N,D,F,Q,re)}function q(){this.value=this.g=0}function I(){this.value=this.g=0}function ie(){this.G=l(5,q),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(Ga,I)}function J(x,N,D,F){t(x!=null),t(N!=null),t(2147483648>F),x.Ca=254,x.I=0,x.b=-8,x.Ka=0,x.oa=N,x.pa=D,x.Jd=N,x.Yc=D+F,x.Zc=4<=F?D+F-4+1:D,Te(x)}function Y(x,N){for(var D=0;0<N--;)D|=De(x,128)<<N;return D}function le(x,N){var D=Y(x,N);return Ce(x)?-D:D}function pe(x,N,D,F){var Q,re=0;for(t(x!=null),t(N!=null),t(4294967288>F),x.Sb=F,x.Ra=0,x.u=0,x.h=0,4<F&&(F=4),Q=0;Q<F;++Q)re+=N[D+Q]<<8*Q;x.Ra=re,x.bb=F,x.oa=N,x.pa=D}function Ie(x){for(;8<=x.u&&x.bb<x.Sb;)x.Ra>>>=8,x.Ra+=x.oa[x.pa+x.bb]<<Uo-8>>>0,++x.bb,x.u-=8;ce(x)&&(x.h=1,x.u=0)}function G(x,N){if(t(0<=N),!x.h&&N<=hr){var D=te(x)&br[N];return x.u+=N,Ie(x),D}return x.h=1,x.u=0}function O(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function ee(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function te(x){return x.Ra>>>(x.u&Uo-1)>>>0}function ce(x){return t(x.bb<=x.Sb),x.h||x.bb==x.Sb&&x.u>Uo}function ye(x,N){x.u=N,x.h=ce(x)}function we(x){x.u>=zo&&(t(x.u>=zo),Ie(x))}function Te(x){t(x!=null&&x.oa!=null),x.pa<x.Zc?(x.I=(x.oa[x.pa++]|x.I<<8)>>>0,x.b+=8):(t(x!=null&&x.oa!=null),x.pa<x.Yc?(x.b+=8,x.I=x.oa[x.pa++]|x.I<<8):x.Ka?x.b=0:(x.I<<=8,x.b+=8,x.Ka=1))}function Ce(x){return Y(x,1)}function De(x,N){var D=x.Ca;0>x.b&&Te(x);var F=x.b,Q=D*N>>>8,re=(x.I>>>F>Q)+0;for(re?(D-=Q,x.I-=Q+1<<F>>>0):D=Q+1,F=D,Q=0;256<=F;)Q+=8,F>>=8;return F=7^Q+pa[F],x.b-=F,x.Ca=(D<<F)-1,re}function $e(x,N,D){x[N+0]=D>>24&255,x[N+1]=D>>16&255,x[N+2]=D>>8&255,x[N+3]=255&D}function at(x,N){return x[N+0]|x[N+1]<<8}function st(x,N){return at(x,N)|x[N+2]<<16}function B(x,N){return at(x,N)|at(x,N+2)<<16}function K(x,N){var D=1<<N;return t(x!=null),t(0<N),x.X=a(D),x.X==null?0:(x.Mb=32-N,x.Xa=N,1)}function _e(x,N){t(x!=null),t(N!=null),t(x.Xa==N.Xa),i(N.X,0,x.X,0,1<<N.Xa)}function he(){this.X=[],this.Xa=this.Mb=0}function ne(x,N,D,F){t(D!=null),t(F!=null);var Q=D[0],re=F[0];return Q==0&&(Q=(x*re+N/2)/N),re==0&&(re=(N*Q+x/2)/x),0>=Q||0>=re?0:(D[0]=Q,F[0]=re,1)}function ae(x,N){return x+(1<<N)-1>>>N}function be(x,N){return((4278255360&x)+(4278255360&N)>>>0&4278255360)+((16711935&x)+(16711935&N)>>>0&16711935)>>>0}function Me(x,N){j[N]=function(D,F,Q,re,oe,ue,fe){var ge;for(ge=0;ge<oe;++ge){var Ae=j[x](ue[fe+ge-1],Q,re+ge);ue[fe+ge]=be(D[F+ge],Ae)}}}function Se(){this.ud=this.hd=this.jd=0}function He(x,N){return((4278124286&(x^N))>>>1)+(x&N)>>>0}function Ne(x){return 0<=x&&256>x?x:0>x?0:255<x?255:void 0}function ze(x,N){return Ne(x+(x-N+.5>>1))}function We(x,N,D){return Math.abs(N-D)-Math.abs(x-D)}function dt(x,N,D,F,Q,re,oe){for(F=re[oe-1],D=0;D<Q;++D)re[oe+D]=F=be(x[N+D],F)}function ft(x,N,D,F,Q){var re;for(re=0;re<D;++re){var oe=x[N+re],ue=oe>>8&255,fe=16711935&(fe=(fe=16711935&oe)+((ue<<16)+ue));F[Q+re]=(4278255360&oe)+fe>>>0}}function ht(x,N){N.jd=255&x,N.hd=x>>8&255,N.ud=x>>16&255}function Et(x,N,D,F,Q,re){var oe;for(oe=0;oe<F;++oe){var ue=N[D+oe],fe=ue>>>8,ge=ue,Ae=255&(Ae=(Ae=ue>>>16)+((x.jd<<24>>24)*(fe<<24>>24)>>>5));ge=255&(ge=(ge+=(x.hd<<24>>24)*(fe<<24>>24)>>>5)+((x.ud<<24>>24)*(Ae<<24>>24)>>>5)),Q[re+oe]=(4278255360&ue)+(Ae<<16)+ge}}function mt(x,N,D,F,Q){j[N]=function(re,oe,ue,fe,ge,Ae,Fe,me,Re){for(fe=Fe;fe<me;++fe)for(Fe=0;Fe<Re;++Fe)ge[Ae++]=Q(ue[F(re[oe++])])},j[x]=function(re,oe,ue,fe,ge,Ae,Fe){var me=8>>re.b,Re=re.Ea,Ue=re.K[0],Xe=re.w;if(8>me)for(re=(1<<re.b)-1,Xe=(1<<me)-1;oe<ue;++oe){var je,Ye=0;for(je=0;je<Re;++je)je&re||(Ye=F(fe[ge++])),Ae[Fe++]=Q(Ue[Ye&Xe]),Ye>>=me}else j["VP8LMapColor"+D](fe,ge,Ue,Xe,Ae,Fe,oe,ue,Re)}}function on(x,N,D,F,Q){for(D=N+D;N<D;){var re=x[N++];F[Q++]=re>>16&255,F[Q++]=re>>8&255,F[Q++]=255&re}}function yt(x,N,D,F,Q){for(D=N+D;N<D;){var re=x[N++];F[Q++]=re>>16&255,F[Q++]=re>>8&255,F[Q++]=255&re,F[Q++]=re>>24&255}}function vt(x,N,D,F,Q){for(D=N+D;N<D;){var re=(oe=x[N++])>>16&240|oe>>12&15,oe=240&oe|oe>>28&15;F[Q++]=re,F[Q++]=oe}}function Rt(x,N,D,F,Q){for(D=N+D;N<D;){var re=(oe=x[N++])>>16&248|oe>>13&7,oe=oe>>5&224|oe>>3&31;F[Q++]=re,F[Q++]=oe}}function Ft(x,N,D,F,Q){for(D=N+D;N<D;){var re=x[N++];F[Q++]=255&re,F[Q++]=re>>8&255,F[Q++]=re>>16&255}}function Le(x,N,D,F,Q,re){if(re==0)for(D=N+D;N<D;)$e(F,((re=x[N++])[0]>>24|re[1]>>8&65280|re[2]<<8&16711680|re[3]<<24)>>>0),Q+=32;else i(F,Q,x,N,D)}function nt(x,N){j[N][0]=j[x+"0"],j[N][1]=j[x+"1"],j[N][2]=j[x+"2"],j[N][3]=j[x+"3"],j[N][4]=j[x+"4"],j[N][5]=j[x+"5"],j[N][6]=j[x+"6"],j[N][7]=j[x+"7"],j[N][8]=j[x+"8"],j[N][9]=j[x+"9"],j[N][10]=j[x+"10"],j[N][11]=j[x+"11"],j[N][12]=j[x+"12"],j[N][13]=j[x+"13"],j[N][14]=j[x+"0"],j[N][15]=j[x+"0"]}function Qe(x){return x==hc||x==Zc||x==ll||x==Qc}function ut(){this.eb=[],this.size=this.A=this.fb=0}function wt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function lt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ut,this.f.kb=new wt,this.sd=null}function et(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function pt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Bt(x){return alert("todo:WebPSamplerProcessPlane"),x.T}function Vt(x,N){var D=x.T,F=N.ba.f.RGBA,Q=F.eb,re=F.fb+x.ka*F.A,oe=Wi[N.ba.S],ue=x.y,fe=x.O,ge=x.f,Ae=x.N,Fe=x.ea,me=x.W,Re=N.cc,Ue=N.dc,Xe=N.Mc,je=N.Nc,Ye=x.ka,Ze=x.ka+x.T,ct=x.U,rt=ct+1>>1;for(Ye==0?oe(ue,fe,null,null,ge,Ae,Fe,me,ge,Ae,Fe,me,Q,re,null,null,ct):(oe(N.ec,N.fc,ue,fe,Re,Ue,Xe,je,ge,Ae,Fe,me,Q,re-F.A,Q,re,ct),++D);Ye+2<Ze;Ye+=2)Re=ge,Ue=Ae,Xe=Fe,je=me,Ae+=x.Rc,me+=x.Rc,re+=2*F.A,oe(ue,(fe+=2*x.fa)-x.fa,ue,fe,Re,Ue,Xe,je,ge,Ae,Fe,me,Q,re-F.A,Q,re,ct);return fe+=x.fa,x.j+Ze<x.o?(i(N.ec,N.fc,ue,fe,ct),i(N.cc,N.dc,ge,Ae,rt),i(N.Mc,N.Nc,Fe,me,rt),D--):1&Ze||oe(ue,fe,null,null,ge,Ae,Fe,me,ge,Ae,Fe,me,Q,re+F.A,null,null,ct),D}function zt(x,N,D){var F=x.F,Q=[x.J];if(F!=null){var re=x.U,oe=N.ba.S,ue=oe==fc||oe==ll;N=N.ba.f.RGBA;var fe=[0],ge=x.ka;fe[0]=x.T,x.Kb&&(ge==0?--fe[0]:(--ge,Q[0]-=x.width),x.j+x.ka+x.T==x.o&&(fe[0]=x.o-x.j-ge));var Ae=N.eb;ge=N.fb+ge*N.A,x=lc(F,Q[0],x.width,re,fe,Ae,ge+(ue?0:3),N.A),t(D==fe),x&&Qe(oe)&&Ss(Ae,ge,ue,re,fe,N.A)}return 0}function Jt(x){var N=x.ma,D=N.ba.S,F=11>D,Q=D==ir||D==$r||D==fc||D==sl||D==12||Qe(D);if(N.memory=null,N.Ib=null,N.Jb=null,N.Nd=null,!ha(N.Oa,x,Q?11:12))return 0;if(Q&&Qe(D)&&rc(),x.da)alert("todo:use_scaling");else{if(F){if(N.Ib=Bt,x.Kb){if(D=x.U+1>>1,N.memory=a(x.U+2*D),N.memory==null)return 0;N.ec=N.memory,N.fc=0,N.cc=N.ec,N.dc=N.fc+x.U,N.Mc=N.cc,N.Nc=N.dc+D,N.Ib=Vt,rc()}}else alert("todo:EmitYUV");Q&&(N.Jb=zt,F&&yo())}if(F&&!Ka){for(x=0;256>x;++x)Xi[x]=89858*(x-128)+dl>>Zr,Hp[x]=-22014*(x-128)+dl,Cf[x]=-45773*(x-128),ru[x]=113618*(x-128)+dl>>Zr;for(x=Cs;x<Ja;++x)N=76283*(x-16)+dl>>Zr,Gp[x-Cs]=kr(N,255),Vp[x-Cs]=kr(N+8>>4,15);Ka=1}return 1}function bt(x){var N=x.ma,D=x.U,F=x.T;return t(!(1&x.ka)),0>=D||0>=F?0:(D=N.Ib(x,N),N.Jb!=null&&N.Jb(x,N,D),N.Dc+=D,1)}function jt(x){x.ma.memory=null}function sn(x,N,D,F){return G(x,8)!=47?0:(N[0]=G(x,14)+1,D[0]=G(x,14)+1,F[0]=G(x,1),G(x,3)!=0?0:!x.h)}function Nn(x,N){if(4>x)return x+1;var D=x-2>>1;return(2+(1&x)<<D)+G(N,D)+1}function Xn(x,N){return 120<N?N-120:1<=(D=((D=Wr[N-1])>>4)*x+(8-(15&D)))?D:1;var D}function mn(x,N,D){var F=te(D),Q=x[N+=255&F].g-8;return 0<Q&&(ye(D,D.u+8),F=te(D),N+=x[N].value,N+=F&(1<<Q)-1),ye(D,D.u+x[N].g),x[N].value}function rn(x,N,D){return D.g+=x.g,D.value+=x.value<<N>>>0,t(8>=D.g),x.g}function wn(x,N,D){var F=x.xc;return t((N=F==0?0:x.vc[x.md*(D>>F)+(N>>F)])<x.Wb),x.Ya[N]}function Qi(x,N,D,F){var Q=x.ab,re=x.c*N,oe=x.C;N=oe+N;var ue=D,fe=F;for(F=x.Ta,D=x.Ua;0<Q--;){var ge=x.gc[Q],Ae=oe,Fe=N,me=ue,Re=fe,Ue=(fe=F,ue=D,ge.Ea);switch(t(Ae<Fe),t(Fe<=ge.nc),ge.hc){case 2:gi(me,Re,(Fe-Ae)*Ue,fe,ue);break;case 0:var Xe=Ae,je=Fe,Ye=fe,Ze=ue,ct=(At=ge).Ea;Xe==0&&(il(me,Re,null,null,1,Ye,Ze),dt(me,Re+1,0,0,ct-1,Ye,Ze+1),Re+=ct,Ze+=ct,++Xe);for(var rt=1<<At.b,kt=rt-1,_t=ae(ct,At.b),Wt=At.K,At=At.w+(Xe>>At.b)*_t;Xe<je;){var cn=Wt,Kn=At,Qt=1;for(rl(me,Re,Ye,Ze-ct,1,Ye,Ze);Qt<ct;){var St=(Qt&~kt)+rt;St>ct&&(St=ct),(0,ma[cn[Kn++]>>8&15])(me,Re+ +Qt,Ye,Ze+Qt-ct,St-Qt,Ye,Ze+Qt),Qt=St}Re+=ct,Ze+=ct,++Xe&kt||(At+=_t)}Fe!=ge.nc&&i(fe,ue-Ue,fe,ue+(Fe-Ae-1)*Ue,Ue);break;case 1:for(Ue=me,je=Re,ct=(me=ge.Ea)-(Ze=me&~(Ye=(Re=1<<ge.b)-1)),Xe=ae(me,ge.b),rt=ge.K,ge=ge.w+(Ae>>ge.b)*Xe;Ae<Fe;){for(kt=rt,_t=ge,Wt=new Se,At=je+Ze,cn=je+me;je<At;)ht(kt[_t++],Wt),ol(Wt,Ue,je,Re,fe,ue),je+=Re,ue+=Re;je<cn&&(ht(kt[_t++],Wt),ol(Wt,Ue,je,ct,fe,ue),je+=ct,ue+=ct),++Ae&Ye||(ge+=Xe)}break;case 3:if(me==fe&&Re==ue&&0<ge.b){for(je=fe,me=Ue=ue+(Fe-Ae)*Ue-(Ze=(Fe-Ae)*ae(ge.Ea,ge.b)),Re=fe,Ye=ue,Xe=[],Ze=(ct=Ze)-1;0<=Ze;--Ze)Xe[Ze]=Re[Ye+Ze];for(Ze=ct-1;0<=Ze;--Ze)je[me+Ze]=Xe[Ze];Yc(ge,Ae,Fe,fe,Ue,fe,ue)}else Yc(ge,Ae,Fe,me,Re,fe,ue)}ue=F,fe=D}fe!=D&&i(F,D,ue,fe,re)}function Ii(x,N){var D=x.V,F=x.Ba+x.c*x.C,Q=N-x.C;if(t(N<=x.l.o),t(16>=Q),0<Q){var re=x.l,oe=x.Ta,ue=x.Ua,fe=re.width;if(Qi(x,Q,D,F),Q=ue=[ue],t((D=x.C)<(F=N)),t(re.v<re.va),F>re.o&&(F=re.o),D<re.j){var ge=re.j-D;D=re.j,Q[0]+=ge*fe}if(D>=F?D=0:(Q[0]+=4*re.v,re.ka=D-re.j,re.U=re.va-re.v,re.T=F-D,D=1),D){if(ue=ue[0],11>(D=x.ca).S){var Ae=D.f.RGBA,Fe=(F=D.S,Q=re.U,re=re.T,ge=Ae.eb,Ae.A),me=re;for(Ae=Ae.fb+x.Ma*Ae.A;0<me--;){var Re=oe,Ue=ue,Xe=Q,je=ge,Ye=Ae;switch(F){case Jc:al(Re,Ue,Xe,je,Ye);break;case ir:ga(Re,Ue,Xe,je,Ye);break;case hc:ga(Re,Ue,Xe,je,Ye),Ss(je,Ye,0,Xe,1,0);break;case Kc:ws(Re,Ue,Xe,je,Ye);break;case $r:Le(Re,Ue,Xe,je,Ye,1);break;case Zc:Le(Re,Ue,Xe,je,Ye,1),Ss(je,Ye,0,Xe,1,0);break;case fc:Le(Re,Ue,Xe,je,Ye,0);break;case ll:Le(Re,Ue,Xe,je,Ye,0),Ss(je,Ye,1,Xe,1,0);break;case sl:va(Re,Ue,Xe,je,Ye);break;case Qc:va(Re,Ue,Xe,je,Ye),Vr(je,Ye,Xe,1,0);break;case Va:Bo(Re,Ue,Xe,je,Ye);break;default:t(0)}ue+=fe,Ae+=Fe}x.Ma+=re}else alert("todo:EmitRescaledRowsYUVA");t(x.Ma<=D.height)}}x.C=N,t(x.C<=x.i)}function On(x){var N;if(0<x.ua)return 0;for(N=0;N<x.Wb;++N){var D=x.Ya[N].G,F=x.Ya[N].H;if(0<D[1][F[1]+0].g||0<D[2][F[2]+0].g||0<D[3][F[3]+0].g)return 0}return 1}function ti(x,N,D,F,Q,re){if(x.Z!=0){var oe=x.qd,ue=x.rd;for(t(xa[x.Z]!=null);N<D;++N)xa[x.Z](oe,ue,F,Q,F,Q,re),oe=F,ue=Q,Q+=re;x.qd=oe,x.rd=ue}}function er(x,N){var D=x.l.ma,F=D.Z==0||D.Z==1?x.l.j:x.C;if(F=x.C<F?F:x.C,t(N<=x.l.o),N>F){var Q=x.l.width,re=D.ca,oe=D.tb+Q*F,ue=x.V,fe=x.Ba+x.c*F,ge=x.gc;t(x.ab==1),t(ge[0].hc==3),Fo(ge[0],F,N,ue,fe,re,oe),ti(D,F,N,re,oe,Q)}x.C=x.Ma=N}function Cr(x,N,D,F,Q,re,oe){var ue=x.$/F,fe=x.$%F,ge=x.m,Ae=x.s,Fe=D+x.$,me=Fe;Q=D+F*Q;var Re=D+F*re,Ue=280+Ae.ua,Xe=x.Pb?ue:16777216,je=0<Ae.ua?Ae.Wa:null,Ye=Ae.wc,Ze=Fe<Re?wn(Ae,fe,ue):null;t(x.C<re),t(Re<=Q);var ct=!1;e:for(;;){for(;ct||Fe<Re;){var rt=0;if(ue>=Xe){var kt=Fe-D;t((Xe=x).Pb),Xe.wd=Xe.m,Xe.xd=kt,0<Xe.s.ua&&_e(Xe.s.Wa,Xe.s.vb),Xe=ue+$a}if(fe&Ye||(Ze=wn(Ae,fe,ue)),t(Ze!=null),Ze.Qb&&(N[Fe]=Ze.qb,ct=!0),!ct)if(we(ge),Ze.jc){rt=ge,kt=N;var _t=Fe,Wt=Ze.pd[te(rt)&Ga-1];t(Ze.jc),256>Wt.g?(ye(rt,rt.u+Wt.g),kt[_t]=Wt.value,rt=0):(ye(rt,rt.u+Wt.g-256),t(256<=Wt.value),rt=Wt.value),rt==0&&(ct=!0)}else rt=mn(Ze.G[0],Ze.H[0],ge);if(ge.h)break;if(ct||256>rt){if(!ct)if(Ze.nd)N[Fe]=(Ze.qb|rt<<8)>>>0;else{if(we(ge),ct=mn(Ze.G[1],Ze.H[1],ge),we(ge),kt=mn(Ze.G[2],Ze.H[2],ge),_t=mn(Ze.G[3],Ze.H[3],ge),ge.h)break;N[Fe]=(_t<<24|ct<<16|rt<<8|kt)>>>0}if(ct=!1,++Fe,++fe>=F&&(fe=0,++ue,oe!=null&&ue<=re&&!(ue%16)&&oe(x,ue),je!=null))for(;me<Fe;)rt=N[me++],je.X[(506832829*rt&4294967295)>>>je.Mb]=rt}else if(280>rt){if(rt=Nn(rt-256,ge),kt=mn(Ze.G[4],Ze.H[4],ge),we(ge),kt=Xn(F,kt=Nn(kt,ge)),ge.h)break;if(Fe-D<kt||Q-Fe<rt)break e;for(_t=0;_t<rt;++_t)N[Fe+_t]=N[Fe+_t-kt];for(Fe+=rt,fe+=rt;fe>=F;)fe-=F,++ue,oe!=null&&ue<=re&&!(ue%16)&&oe(x,ue);if(t(Fe<=Q),fe&Ye&&(Ze=wn(Ae,fe,ue)),je!=null)for(;me<Fe;)rt=N[me++],je.X[(506832829*rt&4294967295)>>>je.Mb]=rt}else{if(!(rt<Ue))break e;for(ct=rt-280,t(je!=null);me<Fe;)rt=N[me++],je.X[(506832829*rt&4294967295)>>>je.Mb]=rt;rt=Fe,t(!(ct>>>(kt=je).Xa)),N[rt]=kt.X[ct],ct=!0}ct||t(ge.h==ce(ge))}if(x.Pb&&ge.h&&Fe<Q)t(x.m.h),x.a=5,x.m=x.wd,x.$=x.xd,0<x.s.ua&&_e(x.s.vb,x.s.Wa);else{if(ge.h)break e;oe!=null&&oe(x,ue>re?re:ue),x.a=0,x.$=Fe-D}return 1}return x.a=3,0}function Br(x){t(x!=null),x.vc=null,x.yc=null,x.Ya=null;var N=x.Wa;N!=null&&(N.X=null),x.vb=null,t(x!=null)}function fs(){var x=new $t;return x==null?null:(x.a=0,x.xb=cd,nt("Predictor","VP8LPredictors"),nt("Predictor","VP8LPredictors_C"),nt("PredictorAdd","VP8LPredictorsAdd"),nt("PredictorAdd","VP8LPredictorsAdd_C"),gi=ft,ol=Et,al=on,ga=yt,va=vt,Bo=Rt,ws=Ft,j.VP8LMapColor32b=jo,j.VP8LMapColor8b=Vi,x)}function co(x,N,D,F,Q){var re=1,oe=[x],ue=[N],fe=F.m,ge=F.s,Ae=null,Fe=0;e:for(;;){if(D)for(;re&&G(fe,1);){var me=oe,Re=ue,Ue=F,Xe=1,je=Ue.m,Ye=Ue.gc[Ue.ab],Ze=G(je,2);if(Ue.Oc&1<<Ze)re=0;else{switch(Ue.Oc|=1<<Ze,Ye.hc=Ze,Ye.Ea=me[0],Ye.nc=Re[0],Ye.K=[null],++Ue.ab,t(4>=Ue.ab),Ze){case 0:case 1:Ye.b=G(je,3)+2,Xe=co(ae(Ye.Ea,Ye.b),ae(Ye.nc,Ye.b),0,Ue,Ye.K),Ye.K=Ye.K[0];break;case 3:var ct,rt=G(je,8)+1,kt=16<rt?0:4<rt?1:2<rt?2:3;if(me[0]=ae(Ye.Ea,kt),Ye.b=kt,ct=Xe=co(rt,1,0,Ue,Ye.K)){var _t,Wt=rt,At=Ye,cn=1<<(8>>At.b),Kn=a(cn);if(Kn==null)ct=0;else{var Qt=At.K[0],St=At.w;for(Kn[0]=At.K[0][0],_t=1;_t<1*Wt;++_t)Kn[_t]=be(Qt[St+_t],Kn[_t-1]);for(;_t<4*cn;++_t)Kn[_t]=0;At.K[0]=null,At.K[0]=Kn,ct=1}}Xe=ct;break;case 2:break;default:t(0)}re=Xe}}if(oe=oe[0],ue=ue[0],re&&G(fe,1)&&!(re=1<=(Fe=G(fe,4))&&11>=Fe)){F.a=3;break e}var gt;if(gt=re)t:{var ii,Ht,nn,Mn=F,Mi=oe,Ji=ue,Vn=Fe,Si=D,rr=Mn.m,Ei=Mn.s,ln=[null],_n=1,ri=0,Tn=Xr[Vn];n:for(;;){if(Si&&G(rr,1)){var Di=G(rr,3)+2,oi=ae(Mi,Di),Sn=ae(Ji,Di),bi=oi*Sn;if(!co(oi,Sn,0,Mn,ln))break n;for(ln=ln[0],Ei.xc=Di,ii=0;ii<bi;++ii){var Dn=ln[ii]>>8&65535;ln[ii]=Dn,Dn>=_n&&(_n=Dn+1)}}if(rr.h)break n;for(Ht=0;5>Ht;++Ht){var Ni=Ns[Ht];!Ht&&0<Vn&&(Ni+=1<<Vn),ri<Ni&&(ri=Ni)}var Ai=l(_n*Tn,q),Un=_n,yn=l(Un,ie);if(yn==null)var or=null;else t(65536>=Un),or=yn;var ci=a(ri);if(or==null||ci==null||Ai==null){Mn.a=1;break n}var Pt=Ai;for(ii=nn=0;ii<_n;++ii){var Ot=or[ii],En=Ot.G,xr=Ot.H,Qr=0,mr=1,Ci=0;for(Ht=0;5>Ht;++Ht){Ni=Ns[Ht],En[Ht]=Pt,xr[Ht]=nn,!Ht&&0<Vn&&(Ni+=1<<Vn);r:{var Za,Qa=Ni,au=Mn,$n=ci,dd=Pt,fd=nn,su=0,wa=au.m,$p=G(wa,1);if(o($n,0,0,Qa),$p){var hd=G(wa,1)+1,pd=G(wa,1),lu=G(wa,pd==0?1:8);$n[lu]=1,hd==2&&($n[lu=G(wa,8)]=1);var Fi=1}else{var ui=a(19),vc=G(wa,4)+4;if(19<vc){au.a=3;var es=0;break r}for(Za=0;Za<vc;++Za)ui[pc[Za]]=G(wa,3);var hl=void 0,Ts=void 0,Go=au,cu=ui,pl=Qa,uu=$n,du=0,_a=Go.m,md=8,gd=l(128,q);i:for(;U(gd,0,7,cu,19);){if(G(_a,1)){var Tf=2+2*G(_a,3);if((hl=2+G(_a,Tf))>pl)break i}else hl=pl;for(Ts=0;Ts<pl&&hl--;){we(_a);var vd=gd[0+(127&te(_a))];ye(_a,_a.u+vd.g);var ts=vd.value;if(16>ts)uu[Ts++]=ts,ts!=0&&(md=ts);else{var kf=ts==16,If=ts-16,Rf=cl[If],yd=G(_a,Yr[If])+Rf;if(Ts+yd>pl)break i;for(var Lf=kf?md:0;0<yd--;)uu[Ts++]=Lf}}du=1;break i}du||(Go.a=3),Fi=du}(Fi=Fi&&!wa.h)&&(su=U(dd,fd,8,$n,Qa)),Fi&&su!=0?es=su:(au.a=3,es=0)}if(es==0)break n;if(mr&&eu[Ht]==1&&(mr=Pt[nn].g==0),Qr+=Pt[nn].g,nn+=es,3>=Ht){var ks,fu=ci[0];for(ks=1;ks<Ni;++ks)ci[ks]>fu&&(fu=ci[ks]);Ci+=fu}}if(Ot.nd=mr,Ot.Qb=0,mr&&(Ot.qb=(En[3][xr[3]+0].value<<24|En[1][xr[1]+0].value<<16|En[2][xr[2]+0].value)>>>0,Qr==0&&256>En[0][xr[0]+0].value&&(Ot.Qb=1,Ot.qb+=En[0][xr[0]+0].value<<8)),Ot.jc=!Ot.Qb&&6>Ci,Ot.jc){var yc,Vo=Ot;for(yc=0;yc<Ga;++yc){var Sa=yc,Ea=Vo.pd[Sa],hu=Vo.G[0][Vo.H[0]+Sa];256<=hu.value?(Ea.g=hu.g+256,Ea.value=hu.value):(Ea.g=0,Ea.value=0,Sa>>=rn(hu,8,Ea),Sa>>=rn(Vo.G[1][Vo.H[1]+Sa],16,Ea),Sa>>=rn(Vo.G[2][Vo.H[2]+Sa],0,Ea),rn(Vo.G[3][Vo.H[3]+Sa],24,Ea))}}}Ei.vc=ln,Ei.Wb=_n,Ei.Ya=or,Ei.yc=Ai,gt=1;break t}gt=0}if(!(re=gt)){F.a=3;break e}if(0<Fe){if(ge.ua=1<<Fe,!K(ge.Wa,Fe)){F.a=1,re=0;break e}}else ge.ua=0;var pu=F,Is=oe,Mf=ue,ml=pu.s,gl=ml.xc;if(pu.c=Is,pu.i=Mf,ml.md=ae(Is,gl),ml.wc=gl==0?-1:(1<<gl)-1,D){F.xb=Ya;break e}if((Ae=a(oe*ue))==null){F.a=1,re=0;break e}re=(re=Cr(F,Ae,0,oe,ue,ue,null))&&!fe.h;break e}return re?(Q!=null?Q[0]=Ae:(t(Ae==null),t(D)),F.$=0,D||Br(ge)):Br(ge),re}function uo(x,N){var D=x.c*x.i,F=D+N+16*N;return t(x.c<=N),x.V=a(F),x.V==null?(x.Ta=null,x.Ua=0,x.a=1,0):(x.Ta=x.V,x.Ua=x.Ba+D+N,1)}function ja(x,N){var D=x.C,F=N-D,Q=x.V,re=x.Ba+x.c*D;for(t(N<=x.l.o);0<F;){var oe=16<F?16:F,ue=x.l.ma,fe=x.l.width,ge=fe*oe,Ae=ue.ca,Fe=ue.tb+fe*D,me=x.Ta,Re=x.Ua;Qi(x,oe,Q,re),Dr(me,Re,Ae,Fe,ge),ti(ue,D,D+oe,Ae,Fe,fe),F-=oe,Q+=oe*x.c,D+=oe}t(D==N),x.C=x.Ma=N}function fo(){this.ub=this.yd=this.td=this.Rb=0}function ho(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function hs(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function Ro(){this.Yb=(function(){var x=[];return(function N(D,F,Q){for(var re=Q[F],oe=0;oe<re&&(D.push(Q.length>F+1?[]:0),!(Q.length<F+1));oe++)N(D[oe],F+1,Q)})(x,0,[3,11]),x})()}function pi(){this.jb=a(3),this.Wc=c([4,8],Ro),this.Xc=c([4,17],Ro)}function Gl(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Tr(){this.ld=this.La=this.dd=this.tc=0}function po(){this.Na=this.la=0}function ea(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Vl(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function $l(){this.uc=this.M=this.Nb=0,this.wa=Array(new Tr),this.Y=0,this.ya=Array(new Vl),this.aa=0,this.l=new ta}function Yl(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Uc(){this.cb=this.a=0,this.sc="",this.m=new O,this.Od=new fo,this.Kc=new ho,this.ed=new Gl,this.Qa=new hs,this.Ic=this.$c=this.Aa=0,this.D=new $l,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,O),this.ia=0,this.pb=l(4,ea),this.Pa=new pi,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Yl),this.Hd=0,this.rb=Array(new po),this.sb=0,this.wa=Array(new Tr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Vl),this.L=this.aa=0,this.gd=c([4,2],Tr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function kr(x,N){return 0>x?0:x>N?N:x}function ta(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function mo(){var x=new Uc;return x!=null&&(x.a=0,x.sc="OK",x.cb=0,x.Xb=0,Pr||(Pr=Fa)),x}function An(x,N,D){return x.a==0&&(x.a=N,x.sc=D,x.cb=0),0}function Wl(x,N,D){return 3<=D&&x[N+0]==157&&x[N+1]==1&&x[N+2]==42}function Lo(x,N){if(x==null)return 0;if(x.a=0,x.sc="OK",N==null)return An(x,2,"null VP8Io passed to VP8GetHeaders()");var D=N.data,F=N.w,Q=N.ha;if(4>Q)return An(x,7,"Truncated header.");var re=D[F+0]|D[F+1]<<8|D[F+2]<<16,oe=x.Od;if(oe.Rb=!(1&re),oe.td=re>>1&7,oe.yd=re>>4&1,oe.ub=re>>5,3<oe.td)return An(x,3,"Incorrect keyframe parameters.");if(!oe.yd)return An(x,4,"Frame not displayable.");F+=3,Q-=3;var ue=x.Kc;if(oe.Rb){if(7>Q)return An(x,7,"cannot parse picture header");if(!Wl(D,F,Q))return An(x,3,"Bad code word");ue.c=16383&(D[F+4]<<8|D[F+3]),ue.Td=D[F+4]>>6,ue.i=16383&(D[F+6]<<8|D[F+5]),ue.Ud=D[F+6]>>6,F+=7,Q-=7,x.za=ue.c+15>>4,x.Ub=ue.i+15>>4,N.width=ue.c,N.height=ue.i,N.Da=0,N.j=0,N.v=0,N.va=N.width,N.o=N.height,N.da=0,N.ib=N.width,N.hb=N.height,N.U=N.width,N.T=N.height,o((re=x.Pa).jb,0,255,re.jb.length),t((re=x.Qa)!=null),re.Cb=0,re.Bb=0,re.Fb=1,o(re.Zb,0,0,re.Zb.length),o(re.Lb,0,0,re.Lb)}if(oe.ub>Q)return An(x,7,"bad partition length");J(re=x.m,D,F,oe.ub),F+=oe.ub,Q-=oe.ub,oe.Rb&&(ue.Ld=Ce(re),ue.Kd=Ce(re)),ue=x.Qa;var fe,ge=x.Pa;if(t(re!=null),t(ue!=null),ue.Cb=Ce(re),ue.Cb){if(ue.Bb=Ce(re),Ce(re)){for(ue.Fb=Ce(re),fe=0;4>fe;++fe)ue.Zb[fe]=Ce(re)?le(re,7):0;for(fe=0;4>fe;++fe)ue.Lb[fe]=Ce(re)?le(re,6):0}if(ue.Bb)for(fe=0;3>fe;++fe)ge.jb[fe]=Ce(re)?Y(re,8):255}else ue.Bb=0;if(re.Ka)return An(x,3,"cannot parse segment header");if((ue=x.ed).zd=Ce(re),ue.Tb=Y(re,6),ue.wb=Y(re,3),ue.Pc=Ce(re),ue.Pc&&Ce(re)){for(ge=0;4>ge;++ge)Ce(re)&&(ue.vd[ge]=le(re,6));for(ge=0;4>ge;++ge)Ce(re)&&(ue.od[ge]=le(re,6))}if(x.L=ue.Tb==0?0:ue.zd?1:2,re.Ka)return An(x,3,"cannot parse filter header");var Ae=Q;if(Q=fe=F,F=fe+Ae,ue=Ae,x.Xb=(1<<Y(x.m,2))-1,Ae<3*(ge=x.Xb))D=7;else{for(fe+=3*ge,ue-=3*ge,Ae=0;Ae<ge;++Ae){var Fe=D[Q+0]|D[Q+1]<<8|D[Q+2]<<16;Fe>ue&&(Fe=ue),J(x.Jc[+Ae],D,fe,Fe),fe+=Fe,ue-=Fe,Q+=3}J(x.Jc[+ge],D,fe,ue),D=fe<F?0:5}if(D!=0)return An(x,D,"cannot parse partitions");for(D=Y(fe=x.m,7),Q=Ce(fe)?le(fe,4):0,F=Ce(fe)?le(fe,4):0,ue=Ce(fe)?le(fe,4):0,ge=Ce(fe)?le(fe,4):0,fe=Ce(fe)?le(fe,4):0,Ae=x.Qa,Fe=0;4>Fe;++Fe){if(Ae.Cb){var me=Ae.Zb[Fe];Ae.Fb||(me+=D)}else{if(0<Fe){x.pb[Fe]=x.pb[0];continue}me=D}var Re=x.pb[Fe];Re.Sc[0]=Jr[kr(me+Q,127)],Re.Sc[1]=Kr[kr(me+0,127)],Re.Eb[0]=2*Jr[kr(me+F,127)],Re.Eb[1]=101581*Kr[kr(me+ue,127)]>>16,8>Re.Eb[1]&&(Re.Eb[1]=8),Re.Qc[0]=Jr[kr(me+ge,117)],Re.Qc[1]=Kr[kr(me+fe,127)],Re.lc=me+fe}if(!oe.Rb)return An(x,4,"Not a key frame.");for(Ce(re),oe=x.Pa,D=0;4>D;++D){for(Q=0;8>Q;++Q)for(F=0;3>F;++F)for(ue=0;11>ue;++ue)ge=De(re,Jn[D][Q][F][ue])?Y(re,8):Af[D][Q][F][ue],oe.Wc[D][Q].Yb[F][ue]=ge;for(Q=0;17>Q;++Q)oe.Xc[D][Q]=oe.Wc[D][un[Q]]}return x.kc=Ce(re),x.kc&&(x.Bd=Y(re,8)),x.cb=1}function Fa(x,N,D,F,Q,re,oe){var ue=N[Q].Yb[D];for(D=0;16>Q;++Q){if(!De(x,ue[D+0]))return Q;for(;!De(x,ue[D+1]);)if(ue=N[++Q].Yb[0],D=0,Q==16)return 16;var fe=N[Q+1].Yb;if(De(x,ue[D+2])){var ge=x,Ae=0;if(De(ge,(me=ue)[(Fe=D)+3]))if(De(ge,me[Fe+6])){for(ue=0,Fe=2*(Ae=De(ge,me[Fe+8]))+(me=De(ge,me[Fe+9+Ae])),Ae=0,me=Nf[Fe];me[ue];++ue)Ae+=Ae+De(ge,me[ue]);Ae+=3+(8<<Fe)}else De(ge,me[Fe+7])?(Ae=7+2*De(ge,165),Ae+=De(ge,145)):Ae=5+De(ge,159);else Ae=De(ge,me[Fe+4])?3+De(ge,me[Fe+5]):2;ue=fe[2]}else Ae=1,ue=fe[1];fe=oe+ld[Q],0>(ge=x).b&&Te(ge);var Fe,me=ge.b,Re=(Fe=ge.Ca>>1)-(ge.I>>me)>>31;--ge.b,ge.Ca+=Re,ge.Ca|=1,ge.I-=(Fe+1&Re)<<me,re[fe]=((Ae^Re)-Re)*F[(0<Q)+0]}return 16}function Xl(x){var N=x.rb[x.sb-1];N.la=0,N.Na=0,o(x.zc,0,0,x.zc.length),x.ja=0}function ur(x,N,D,F,Q){Q=x[N+D+32*F]+(Q>>3),x[N+D+32*F]=-256&Q?0>Q?0:255:Q}function Ri(x,N,D,F,Q,re){ur(x,N,0,D,F+Q),ur(x,N,1,D,F+re),ur(x,N,2,D,F-re),ur(x,N,3,D,F-Q)}function wi(x){return(20091*x>>16)+x}function Js(x,N,D,F){var Q,re=0,oe=a(16);for(Q=0;4>Q;++Q){var ue=x[N+0]+x[N+8],fe=x[N+0]-x[N+8],ge=(35468*x[N+4]>>16)-wi(x[N+12]),Ae=wi(x[N+4])+(35468*x[N+12]>>16);oe[re+0]=ue+Ae,oe[re+1]=fe+ge,oe[re+2]=fe-ge,oe[re+3]=ue-Ae,re+=4,N++}for(Q=re=0;4>Q;++Q)ue=(x=oe[re+0]+4)+oe[re+8],fe=x-oe[re+8],ge=(35468*oe[re+4]>>16)-wi(oe[re+12]),ur(D,F,0,0,ue+(Ae=wi(oe[re+4])+(35468*oe[re+12]>>16))),ur(D,F,1,0,fe+ge),ur(D,F,2,0,fe-ge),ur(D,F,3,0,ue-Ae),re++,F+=32}function zc(x,N,D,F){var Q=x[N+0]+4,re=35468*x[N+4]>>16,oe=wi(x[N+4]),ue=35468*x[N+1]>>16;Ri(D,F,0,Q+oe,x=wi(x[N+1]),ue),Ri(D,F,1,Q+re,x,ue),Ri(D,F,2,Q-re,x,ue),Ri(D,F,3,Q-oe,x,ue)}function Jl(x,N,D,F,Q){Js(x,N,D,F),Q&&Js(x,N+16,D,F+4)}function dr(x,N,D,F){ya(x,N+0,D,F,1),ya(x,N+32,D,F+128,1)}function Kl(x,N,D,F){var Q;for(x=x[N+0]+4,Q=0;4>Q;++Q)for(N=0;4>N;++N)ur(D,F,N,Q,x)}function Zl(x,N,D,F){x[N+0]&&Cn(x,N+0,D,F),x[N+16]&&Cn(x,N+16,D,F+4),x[N+32]&&Cn(x,N+32,D,F+128),x[N+48]&&Cn(x,N+48,D,F+128+4)}function go(x,N,D,F){var Q,re=a(16);for(Q=0;4>Q;++Q){var oe=x[N+0+Q]+x[N+12+Q],ue=x[N+4+Q]+x[N+8+Q],fe=x[N+4+Q]-x[N+8+Q],ge=x[N+0+Q]-x[N+12+Q];re[0+Q]=oe+ue,re[8+Q]=oe-ue,re[4+Q]=ge+fe,re[12+Q]=ge-fe}for(Q=0;4>Q;++Q)oe=(x=re[0+4*Q]+3)+re[3+4*Q],ue=re[1+4*Q]+re[2+4*Q],fe=re[1+4*Q]-re[2+4*Q],ge=x-re[3+4*Q],D[F+0]=oe+ue>>3,D[F+16]=ge+fe>>3,D[F+32]=oe-ue>>3,D[F+48]=ge-fe>>3,F+=64}function ps(x,N,D){var F,Q=N-32,re=nr,oe=255-x[Q-1];for(F=0;F<D;++F){var ue,fe=re,ge=oe+x[N-1];for(ue=0;ue<D;++ue)x[N+ue]=fe[ge+x[Q+ue]];N+=32}}function jc(x,N){ps(x,N,4)}function Fc(x,N){ps(x,N,8)}function Ql(x,N){ps(x,N,16)}function ec(x,N){var D;for(D=0;16>D;++D)i(x,N+32*D,x,N-32,16)}function Bc(x,N){var D;for(D=16;0<D;--D)o(x,N,x[N-1],16),N+=32}function yr(x,N,D){var F;for(F=0;16>F;++F)o(N,D+32*F,x,16)}function vo(x,N){var D,F=16;for(D=0;16>D;++D)F+=x[N-1+32*D]+x[N+D-32];yr(F>>5,x,N)}function na(x,N){var D,F=8;for(D=0;16>D;++D)F+=x[N-1+32*D];yr(F>>4,x,N)}function ms(x,N){var D,F=8;for(D=0;16>D;++D)F+=x[N+D-32];yr(F>>4,x,N)}function Ba(x,N){yr(128,x,N)}function qt(x,N,D){return x+2*N+D+2>>2}function qc(x,N){var D,F=N-32;for(F=new Uint8Array([qt(x[F-1],x[F+0],x[F+1]),qt(x[F+0],x[F+1],x[F+2]),qt(x[F+1],x[F+2],x[F+3]),qt(x[F+2],x[F+3],x[F+4])]),D=0;4>D;++D)i(x,N+32*D,F,0,F.length)}function tc(x,N){var D=x[N-1],F=x[N-1+32],Q=x[N-1+64],re=x[N-1+96];$e(x,N+0,16843009*qt(x[N-1-32],D,F)),$e(x,N+32,16843009*qt(D,F,Q)),$e(x,N+64,16843009*qt(F,Q,re)),$e(x,N+96,16843009*qt(Q,re,re))}function Hc(x,N){var D,F=4;for(D=0;4>D;++D)F+=x[N+D-32]+x[N-1+32*D];for(F>>=3,D=0;4>D;++D)o(x,N+32*D,F,4)}function Ir(x,N){var D=x[N-1+0],F=x[N-1+32],Q=x[N-1+64],re=x[N-1-32],oe=x[N+0-32],ue=x[N+1-32],fe=x[N+2-32],ge=x[N+3-32];x[N+0+96]=qt(F,Q,x[N-1+96]),x[N+1+96]=x[N+0+64]=qt(D,F,Q),x[N+2+96]=x[N+1+64]=x[N+0+32]=qt(re,D,F),x[N+3+96]=x[N+2+64]=x[N+1+32]=x[N+0+0]=qt(oe,re,D),x[N+3+64]=x[N+2+32]=x[N+1+0]=qt(ue,oe,re),x[N+3+32]=x[N+2+0]=qt(fe,ue,oe),x[N+3+0]=qt(ge,fe,ue)}function Hi(x,N){var D=x[N+1-32],F=x[N+2-32],Q=x[N+3-32],re=x[N+4-32],oe=x[N+5-32],ue=x[N+6-32],fe=x[N+7-32];x[N+0+0]=qt(x[N+0-32],D,F),x[N+1+0]=x[N+0+32]=qt(D,F,Q),x[N+2+0]=x[N+1+32]=x[N+0+64]=qt(F,Q,re),x[N+3+0]=x[N+2+32]=x[N+1+64]=x[N+0+96]=qt(Q,re,oe),x[N+3+32]=x[N+2+64]=x[N+1+96]=qt(re,oe,ue),x[N+3+64]=x[N+2+96]=qt(oe,ue,fe),x[N+3+96]=qt(ue,fe,fe)}function nc(x,N){var D=x[N-1+0],F=x[N-1+32],Q=x[N-1+64],re=x[N-1-32],oe=x[N+0-32],ue=x[N+1-32],fe=x[N+2-32],ge=x[N+3-32];x[N+0+0]=x[N+1+64]=re+oe+1>>1,x[N+1+0]=x[N+2+64]=oe+ue+1>>1,x[N+2+0]=x[N+3+64]=ue+fe+1>>1,x[N+3+0]=fe+ge+1>>1,x[N+0+96]=qt(Q,F,D),x[N+0+64]=qt(F,D,re),x[N+0+32]=x[N+1+96]=qt(D,re,oe),x[N+1+32]=x[N+2+96]=qt(re,oe,ue),x[N+2+32]=x[N+3+96]=qt(oe,ue,fe),x[N+3+32]=qt(ue,fe,ge)}function gs(x,N){var D=x[N+0-32],F=x[N+1-32],Q=x[N+2-32],re=x[N+3-32],oe=x[N+4-32],ue=x[N+5-32],fe=x[N+6-32],ge=x[N+7-32];x[N+0+0]=D+F+1>>1,x[N+1+0]=x[N+0+64]=F+Q+1>>1,x[N+2+0]=x[N+1+64]=Q+re+1>>1,x[N+3+0]=x[N+2+64]=re+oe+1>>1,x[N+0+32]=qt(D,F,Q),x[N+1+32]=x[N+0+96]=qt(F,Q,re),x[N+2+32]=x[N+1+96]=qt(Q,re,oe),x[N+3+32]=x[N+2+96]=qt(re,oe,ue),x[N+3+64]=qt(oe,ue,fe),x[N+3+96]=qt(ue,fe,ge)}function Rr(x,N){var D=x[N-1+0],F=x[N-1+32],Q=x[N-1+64],re=x[N-1+96];x[N+0+0]=D+F+1>>1,x[N+2+0]=x[N+0+32]=F+Q+1>>1,x[N+2+32]=x[N+0+64]=Q+re+1>>1,x[N+1+0]=qt(D,F,Q),x[N+3+0]=x[N+1+32]=qt(F,Q,re),x[N+3+32]=x[N+1+64]=qt(Q,re,re),x[N+3+64]=x[N+2+64]=x[N+0+96]=x[N+1+96]=x[N+2+96]=x[N+3+96]=re}function vs(x,N){var D=x[N-1+0],F=x[N-1+32],Q=x[N-1+64],re=x[N-1+96],oe=x[N-1-32],ue=x[N+0-32],fe=x[N+1-32],ge=x[N+2-32];x[N+0+0]=x[N+2+32]=D+oe+1>>1,x[N+0+32]=x[N+2+64]=F+D+1>>1,x[N+0+64]=x[N+2+96]=Q+F+1>>1,x[N+0+96]=re+Q+1>>1,x[N+3+0]=qt(ue,fe,ge),x[N+2+0]=qt(oe,ue,fe),x[N+1+0]=x[N+3+32]=qt(D,oe,ue),x[N+1+32]=x[N+3+64]=qt(F,D,oe),x[N+1+64]=x[N+3+96]=qt(Q,F,D),x[N+1+96]=qt(re,Q,F)}function Mo(x,N){var D;for(D=0;8>D;++D)i(x,N+32*D,x,N-32,8)}function Gc(x,N){var D;for(D=0;8>D;++D)o(x,N,x[N-1],8),N+=32}function qr(x,N,D){var F;for(F=0;8>F;++F)o(N,D+32*F,x,8)}function Ks(x,N){var D,F=8;for(D=0;8>D;++D)F+=x[N+D-32]+x[N-1+32*D];qr(F>>4,x,N)}function Zs(x,N){var D,F=4;for(D=0;8>D;++D)F+=x[N+D-32];qr(F>>3,x,N)}function zi(x,N){var D,F=4;for(D=0;8>D;++D)F+=x[N-1+32*D];qr(F>>3,x,N)}function Do(x,N){qr(128,x,N)}function Hr(x,N,D){var F=x[N-D],Q=x[N+0],re=3*(Q-F)+ba[1020+x[N-2*D]-x[N+D]],oe=dc[112+(re+4>>3)];x[N-D]=nr[255+F+dc[112+(re+3>>3)]],x[N+0]=nr[255+Q-oe]}function ia(x,N,D,F){var Q=x[N+0],re=x[N+D];return $i[255+x[N-2*D]-x[N-D]]>F||$i[255+re-Q]>F}function Qs(x,N,D,F){return 4*$i[255+x[N-D]-x[N+0]]+$i[255+x[N-2*D]-x[N+D]]<=F}function ys(x,N,D,F,Q){var re=x[N-3*D],oe=x[N-2*D],ue=x[N-D],fe=x[N+0],ge=x[N+D],Ae=x[N+2*D],Fe=x[N+3*D];return 4*$i[255+ue-fe]+$i[255+oe-ge]>F?0:$i[255+x[N-4*D]-re]<=Q&&$i[255+re-oe]<=Q&&$i[255+oe-ue]<=Q&&$i[255+Fe-Ae]<=Q&&$i[255+Ae-ge]<=Q&&$i[255+ge-fe]<=Q}function ra(x,N,D,F){var Q=2*F+1;for(F=0;16>F;++F)Qs(x,N+F,D,Q)&&Hr(x,N+F,D)}function oa(x,N,D,F){var Q=2*F+1;for(F=0;16>F;++F)Qs(x,N+F*D,1,Q)&&Hr(x,N+F*D,1)}function bs(x,N,D,F){var Q;for(Q=3;0<Q;--Q)ra(x,N+=4*D,D,F)}function ic(x,N,D,F){var Q;for(Q=3;0<Q;--Q)oa(x,N+=4,D,F)}function aa(x,N,D,F,Q,re,oe,ue){for(re=2*re+1;0<Q--;){if(ys(x,N,D,re,oe))if(ia(x,N,D,ue))Hr(x,N,D);else{var fe=x,ge=N,Ae=D,Fe=fe[ge-2*Ae],me=fe[ge-Ae],Re=fe[ge+0],Ue=fe[ge+Ae],Xe=fe[ge+2*Ae],je=27*(Ze=ba[1020+3*(Re-me)+ba[1020+Fe-Ue]])+63>>7,Ye=18*Ze+63>>7,Ze=9*Ze+63>>7;fe[ge-3*Ae]=nr[255+fe[ge-3*Ae]+Ze],fe[ge-2*Ae]=nr[255+Fe+Ye],fe[ge-Ae]=nr[255+me+je],fe[ge+0]=nr[255+Re-je],fe[ge+Ae]=nr[255+Ue-Ye],fe[ge+2*Ae]=nr[255+Xe-Ze]}N+=F}}function sa(x,N,D,F,Q,re,oe,ue){for(re=2*re+1;0<Q--;){if(ys(x,N,D,re,oe))if(ia(x,N,D,ue))Hr(x,N,D);else{var fe=x,ge=N,Ae=D,Fe=fe[ge-Ae],me=fe[ge+0],Re=fe[ge+Ae],Ue=dc[112+(4+(Xe=3*(me-Fe))>>3)],Xe=dc[112+(Xe+3>>3)],je=Ue+1>>1;fe[ge-2*Ae]=nr[255+fe[ge-2*Ae]+je],fe[ge-Ae]=nr[255+Fe+Xe],fe[ge+0]=nr[255+me-Ue],fe[ge+Ae]=nr[255+Re-je]}N+=F}}function Vc(x,N,D,F,Q,re){aa(x,N,D,1,16,F,Q,re)}function la(x,N,D,F,Q,re){aa(x,N,1,D,16,F,Q,re)}function $c(x,N,D,F,Q,re){var oe;for(oe=3;0<oe;--oe)sa(x,N+=4*D,D,1,16,F,Q,re)}function L(x,N,D,F,Q,re){var oe;for(oe=3;0<oe;--oe)sa(x,N+=4,1,D,16,F,Q,re)}function Z(x,N,D,F,Q,re,oe,ue){aa(x,N,Q,1,8,re,oe,ue),aa(D,F,Q,1,8,re,oe,ue)}function ve(x,N,D,F,Q,re,oe,ue){aa(x,N,1,Q,8,re,oe,ue),aa(D,F,1,Q,8,re,oe,ue)}function Ee(x,N,D,F,Q,re,oe,ue){sa(x,N+4*Q,Q,1,8,re,oe,ue),sa(D,F+4*Q,Q,1,8,re,oe,ue)}function Pe(x,N,D,F,Q,re,oe,ue){sa(x,N+4,1,Q,8,re,oe,ue),sa(D,F+4,1,Q,8,re,oe,ue)}function Ke(){this.ba=new lt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new pt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ot(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ct(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Lt(){this.ua=0,this.Wa=new he,this.vb=new he,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ie,this.yc=new q}function $t(){this.xb=this.a=0,this.l=new ta,this.ca=new lt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new ee,this.Pb=0,this.wd=new ee,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Lt,this.ab=0,this.gc=l(4,Ct),this.Oc=0}function Zt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ta,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function gn(x,N,D,F,Q,re,oe){for(x=x==null?0:x[N+0],N=0;N<oe;++N)Q[re+N]=x+D[F+N]&255,x=Q[re+N]}function ni(x,N,D,F,Q,re,oe){var ue;if(x==null)gn(null,null,D,F,Q,re,oe);else for(ue=0;ue<oe;++ue)Q[re+ue]=x[N+ue]+D[F+ue]&255}function mi(x,N,D,F,Q,re,oe){if(x==null)gn(null,null,D,F,Q,re,oe);else{var ue,fe=x[N+0],ge=fe,Ae=fe;for(ue=0;ue<oe;++ue)ge=Ae+(fe=x[N+ue])-ge,Ae=D[F+ue]+(-256&ge?0>ge?0:255:ge)&255,ge=fe,Q[re+ue]=Ae}}function Hn(x,N,D,F){var Q=N.width,re=N.o;if(t(x!=null&&N!=null),0>D||0>=F||D+F>re)return null;if(!x.Cc){if(x.ga==null){var oe;if(x.ga=new Zt,(oe=x.ga==null)||(oe=N.width*N.o,t(x.Gb.length==0),x.Gb=a(oe),x.Uc=0,x.Gb==null?oe=0:(x.mb=x.Gb,x.nb=x.Uc,x.rc=null,oe=1),oe=!oe),!oe){oe=x.ga;var ue=x.Fa,fe=x.P,ge=x.qc,Ae=x.mb,Fe=x.nb,me=fe+1,Re=ge-1,Ue=oe.l;if(t(ue!=null&&Ae!=null&&N!=null),xa[0]=null,xa[1]=gn,xa[2]=ni,xa[3]=mi,oe.ca=Ae,oe.tb=Fe,oe.c=N.width,oe.i=N.height,t(0<oe.c&&0<oe.i),1>=ge)N=0;else if(oe.$a=3&ue[fe+0],oe.Z=ue[fe+0]>>2&3,oe.Lc=ue[fe+0]>>4&3,fe=ue[fe+0]>>6&3,0>oe.$a||1<oe.$a||4<=oe.Z||1<oe.Lc||fe)N=0;else if(Ue.put=bt,Ue.ac=Jt,Ue.bc=jt,Ue.ma=oe,Ue.width=N.width,Ue.height=N.height,Ue.Da=N.Da,Ue.v=N.v,Ue.va=N.va,Ue.j=N.j,Ue.o=N.o,oe.$a)e:{t(oe.$a==1),N=fs();t:for(;;){if(N==null){N=0;break e}if(t(oe!=null),oe.mc=N,N.c=oe.c,N.i=oe.i,N.l=oe.l,N.l.ma=oe,N.l.width=oe.c,N.l.height=oe.i,N.a=0,pe(N.m,ue,me,Re),!co(oe.c,oe.i,1,N,null)||(N.ab==1&&N.gc[0].hc==3&&On(N.s)?(oe.ic=1,ue=N.c*N.i,N.Ta=null,N.Ua=0,N.V=a(ue),N.Ba=0,N.V==null?(N.a=1,N=0):N=1):(oe.ic=0,N=uo(N,oe.c)),!N))break t;N=1;break e}oe.mc=null,N=0}else N=Re>=oe.c*oe.i;oe=!N}if(oe)return null;x.ga.Lc!=1?x.Ga=0:F=re-D}t(x.ga!=null),t(D+F<=re);e:{if(N=(ue=x.ga).c,re=ue.l.o,ue.$a==0){if(me=x.rc,Re=x.Vc,Ue=x.Fa,fe=x.P+1+D*N,ge=x.mb,Ae=x.nb+D*N,t(fe<=x.P+x.qc),ue.Z!=0)for(t(xa[ue.Z]!=null),oe=0;oe<F;++oe)xa[ue.Z](me,Re,Ue,fe,ge,Ae,N),me=ge,Re=Ae,Ae+=N,fe+=N;else for(oe=0;oe<F;++oe)i(ge,Ae,Ue,fe,N),me=ge,Re=Ae,Ae+=N,fe+=N;x.rc=me,x.Vc=Re}else{if(t(ue.mc!=null),N=D+F,t((oe=ue.mc)!=null),t(N<=oe.i),oe.C>=N)N=1;else if(ue.ic||yo(),ue.ic){ue=oe.V,me=oe.Ba,Re=oe.c;var Xe=oe.i,je=(Ue=1,fe=oe.$/Re,ge=oe.$%Re,Ae=oe.m,Fe=oe.s,oe.$),Ye=Re*Xe,Ze=Re*N,ct=Fe.wc,rt=je<Ze?wn(Fe,ge,fe):null;t(je<=Ye),t(N<=Xe),t(On(Fe));t:for(;;){for(;!Ae.h&&je<Ze;){if(ge&ct||(rt=wn(Fe,ge,fe)),t(rt!=null),we(Ae),256>(Xe=mn(rt.G[0],rt.H[0],Ae)))ue[me+je]=Xe,++je,++ge>=Re&&(ge=0,++fe<=N&&!(fe%16)&&er(oe,fe));else{if(!(280>Xe)){Ue=0;break t}Xe=Nn(Xe-256,Ae);var kt,_t=mn(rt.G[4],rt.H[4],Ae);if(we(Ae),!(je>=(_t=Xn(Re,_t=Nn(_t,Ae)))&&Ye-je>=Xe)){Ue=0;break t}for(kt=0;kt<Xe;++kt)ue[me+je+kt]=ue[me+je+kt-_t];for(je+=Xe,ge+=Xe;ge>=Re;)ge-=Re,++fe<=N&&!(fe%16)&&er(oe,fe);je<Ze&&ge&ct&&(rt=wn(Fe,ge,fe))}t(Ae.h==ce(Ae))}er(oe,fe>N?N:fe);break t}!Ue||Ae.h&&je<Ye?(Ue=0,oe.a=Ae.h?5:3):oe.$=je,N=Ue}else N=Cr(oe,oe.V,oe.Ba,oe.c,oe.i,N,ja);if(!N){F=0;break e}}D+F>=re&&(x.Cc=1),F=1}if(!F)return null;if(x.Cc&&((F=x.ga)!=null&&(F.mc=null),x.ga=null,0<x.Ga))return alert("todo:WebPDequantizeLevels"),null}return x.nb+D*Q}function Li(x,N,D,F,Q,re){for(;0<Q--;){var oe,ue=x,fe=N+(D?1:0),ge=x,Ae=N+(D?0:3);for(oe=0;oe<F;++oe){var Fe=ge[Ae+4*oe];Fe!=255&&(Fe*=32897,ue[fe+4*oe+0]=ue[fe+4*oe+0]*Fe>>23,ue[fe+4*oe+1]=ue[fe+4*oe+1]*Fe>>23,ue[fe+4*oe+2]=ue[fe+4*oe+2]*Fe>>23)}N+=re}}function _i(x,N,D,F,Q){for(;0<F--;){var re;for(re=0;re<D;++re){var oe=x[N+2*re+0],ue=15&(ge=x[N+2*re+1]),fe=4369*ue,ge=(240&ge|ge>>4)*fe>>16;x[N+2*re+0]=(240&oe|oe>>4)*fe>>16&240|(15&oe|oe<<4)*fe>>16>>4&15,x[N+2*re+1]=240&ge|ue}N+=Q}}function Gi(x,N,D,F,Q,re,oe,ue){var fe,ge,Ae=255;for(ge=0;ge<Q;++ge){for(fe=0;fe<F;++fe){var Fe=x[N+fe];re[oe+4*fe]=Fe,Ae&=Fe}N+=D,oe+=ue}return Ae!=255}function ca(x,N,D,F,Q){var re;for(re=0;re<Q;++re)D[F+re]=x[N+re]>>8}function yo(){Ss=Li,Vr=_i,lc=Gi,Dr=ca}function ua(x,N,D){j[x]=function(F,Q,re,oe,ue,fe,ge,Ae,Fe,me,Re,Ue,Xe,je,Ye,Ze,ct){var rt,kt=ct-1>>1,_t=ue[fe+0]|ge[Ae+0]<<16,Wt=Fe[me+0]|Re[Ue+0]<<16;t(F!=null);var At=3*_t+Wt+131074>>2;for(N(F[Q+0],255&At,At>>16,Xe,je),re!=null&&(At=3*Wt+_t+131074>>2,N(re[oe+0],255&At,At>>16,Ye,Ze)),rt=1;rt<=kt;++rt){var cn=ue[fe+rt]|ge[Ae+rt]<<16,Kn=Fe[me+rt]|Re[Ue+rt]<<16,Qt=_t+cn+Wt+Kn+524296,St=Qt+2*(cn+Wt)>>3;At=St+_t>>1,_t=(Qt=Qt+2*(_t+Kn)>>3)+cn>>1,N(F[Q+2*rt-1],255&At,At>>16,Xe,je+(2*rt-1)*D),N(F[Q+2*rt-0],255&_t,_t>>16,Xe,je+(2*rt-0)*D),re!=null&&(At=Qt+Wt>>1,_t=St+Kn>>1,N(re[oe+2*rt-1],255&At,At>>16,Ye,Ze+(2*rt-1)*D),N(re[oe+2*rt+0],255&_t,_t>>16,Ye,Ze+(2*rt+0)*D)),_t=cn,Wt=Kn}1&ct||(At=3*_t+Wt+131074>>2,N(F[Q+ct-1],255&At,At>>16,Xe,je+(ct-1)*D),re!=null&&(At=3*Wt+_t+131074>>2,N(re[oe+ct-1],255&At,At>>16,Ye,Ze+(ct-1)*D)))}}function rc(){Wi[Jc]=As,Wi[ir]=ul,Wi[Kc]=ud,Wi[$r]=nu,Wi[fc]=Wa,Wi[sl]=Ho,Wi[Va]=Xa,Wi[hc]=ul,Wi[Zc]=nu,Wi[ll]=Wa,Wi[Qc]=Ho}function el(x){return x&-16384?0>x?0:255:x>>iu}function Po(x,N){return el((19077*x>>8)+(26149*N>>8)-14234)}function bo(x,N,D){return el((19077*x>>8)-(6419*N>>8)-(13320*D>>8)+8708)}function xs(x,N){return el((19077*x>>8)+(33050*N>>8)-17685)}function da(x,N,D,F,Q){F[Q+0]=Po(x,D),F[Q+1]=bo(x,N,D),F[Q+2]=xs(x,N)}function ji(x,N,D,F,Q){F[Q+0]=xs(x,N),F[Q+1]=bo(x,N,D),F[Q+2]=Po(x,D)}function qa(x,N,D,F,Q){var re=bo(x,N,D);N=re<<3&224|xs(x,N)>>3,F[Q+0]=248&Po(x,D)|re>>5,F[Q+1]=N}function Ha(x,N,D,F,Q){var re=240&xs(x,N)|15;F[Q+0]=240&Po(x,D)|bo(x,N,D)>>4,F[Q+1]=re}function tl(x,N,D,F,Q){F[Q+0]=255,da(x,N,D,F,Q+1)}function Oo(x,N,D,F,Q){ji(x,N,D,F,Q),F[Q+3]=255}function fr(x,N,D,F,Q){da(x,N,D,F,Q),F[Q+3]=255}function fa(x,N,D){j[x]=function(F,Q,re,oe,ue,fe,ge,Ae,Fe){for(var me=Ae+(-2&Fe)*D;Ae!=me;)N(F[Q+0],re[oe+0],ue[fe+0],ge,Ae),N(F[Q+1],re[oe+0],ue[fe+0],ge,Ae+D),Q+=2,++oe,++fe,Ae+=2*D;1&Fe&&N(F[Q+0],re[oe+0],ue[fe+0],ge,Ae)}}function nl(x,N,D){return D==0?x==0?N==0?6:5:N==0?4:0:D}function oc(x,N,D,F,Q){switch(x>>>30){case 3:ya(N,D,F,Q,0);break;case 2:tr(N,D,F,Q);break;case 1:Cn(N,D,F,Q)}}function Lr(x,N){var D,F,Q=N.M,re=N.Nb,oe=x.oc,ue=x.pc+40,fe=x.oc,ge=x.pc+584,Ae=x.oc,Fe=x.pc+600;for(D=0;16>D;++D)oe[ue+32*D-1]=129;for(D=0;8>D;++D)fe[ge+32*D-1]=129,Ae[Fe+32*D-1]=129;for(0<Q?oe[ue-1-32]=fe[ge-1-32]=Ae[Fe-1-32]=129:(o(oe,ue-32-1,127,21),o(fe,ge-32-1,127,9),o(Ae,Fe-32-1,127,9)),F=0;F<x.za;++F){var me=N.ya[N.aa+F];if(0<F){for(D=-1;16>D;++D)i(oe,ue+32*D-4,oe,ue+32*D+12,4);for(D=-1;8>D;++D)i(fe,ge+32*D-4,fe,ge+32*D+4,4),i(Ae,Fe+32*D-4,Ae,Fe+32*D+4,4)}var Re=x.Gd,Ue=x.Hd+F,Xe=me.ad,je=me.Hc;if(0<Q&&(i(oe,ue-32,Re[Ue].y,0,16),i(fe,ge-32,Re[Ue].f,0,8),i(Ae,Fe-32,Re[Ue].ea,0,8)),me.Za){var Ye=oe,Ze=ue-32+16;for(0<Q&&(F>=x.za-1?o(Ye,Ze,Re[Ue].y[15],4):i(Ye,Ze,Re[Ue+1].y,0,4)),D=0;4>D;D++)Ye[Ze+128+D]=Ye[Ze+256+D]=Ye[Ze+384+D]=Ye[Ze+0+D];for(D=0;16>D;++D,je<<=2)Ye=oe,Ze=ue+yi[D],li[me.Ob[D]](Ye,Ze),oc(je,Xe,16*+D,Ye,Ze)}else if(Ye=nl(F,Q,me.Ob[0]),pr[Ye](oe,ue),je!=0)for(D=0;16>D;++D,je<<=2)oc(je,Xe,16*+D,oe,ue+yi[D]);for(D=me.Gc,Ye=nl(F,Q,me.Dd),So[Ye](fe,ge),So[Ye](Ae,Fe),je=Xe,Ye=fe,Ze=ge,255&(me=0|D)&&(170&me?Gr(je,256,Ye,Ze):vn(je,256,Ye,Ze)),me=Ae,je=Fe,255&(D>>=8)&&(170&D?Gr(Xe,320,me,je):vn(Xe,320,me,je)),Q<x.Ub-1&&(i(Re[Ue].y,0,oe,ue+480,16),i(Re[Ue].f,0,fe,ge+224,8),i(Re[Ue].ea,0,Ae,Fe+224,8)),D=8*re*x.B,Re=x.sa,Ue=x.ta+16*F+16*re*x.R,Xe=x.qa,me=x.ra+8*F+D,je=x.Ha,Ye=x.Ia+8*F+D,D=0;16>D;++D)i(Re,Ue+D*x.R,oe,ue+32*D,16);for(D=0;8>D;++D)i(Xe,me+D*x.B,fe,ge+32*D,8),i(je,Ye+D*x.B,Ae,Fe+32*D,8)}}function xo(x,N,D,F,Q,re,oe,ue,fe){var ge=[0],Ae=[0],Fe=0,me=fe!=null?fe.kd:0,Re=fe??new ot;if(x==null||12>D)return 7;Re.data=x,Re.w=N,Re.ha=D,N=[N],D=[D],Re.gb=[Re.gb];e:{var Ue=N,Xe=D,je=Re.gb;if(t(x!=null),t(Xe!=null),t(je!=null),je[0]=0,12<=Xe[0]&&!n(x,Ue[0],"RIFF")){if(n(x,Ue[0]+8,"WEBP")){je=3;break e}var Ye=B(x,Ue[0]+4);if(12>Ye||4294967286<Ye){je=3;break e}if(me&&Ye>Xe[0]-8){je=7;break e}je[0]=Ye,Ue[0]+=12,Xe[0]-=12}je=0}if(je!=0)return je;for(Ye=0<Re.gb[0],D=D[0];;){e:{var Ze=x;Xe=N,je=D;var ct=ge,rt=Ae,kt=Ue=[0];if((At=Fe=[Fe])[0]=0,8>je[0])je=7;else{if(!n(Ze,Xe[0],"VP8X")){if(B(Ze,Xe[0]+4)!=10){je=3;break e}if(18>je[0]){je=7;break e}var _t=B(Ze,Xe[0]+8),Wt=1+st(Ze,Xe[0]+12);if(2147483648<=Wt*(Ze=1+st(Ze,Xe[0]+15))){je=3;break e}kt!=null&&(kt[0]=_t),ct!=null&&(ct[0]=Wt),rt!=null&&(rt[0]=Ze),Xe[0]+=18,je[0]-=18,At[0]=1}je=0}}if(Fe=Fe[0],Ue=Ue[0],je!=0)return je;if(Xe=!!(2&Ue),!Ye&&Fe)return 3;if(re!=null&&(re[0]=!!(16&Ue)),oe!=null&&(oe[0]=Xe),ue!=null&&(ue[0]=0),oe=ge[0],Ue=Ae[0],Fe&&Xe&&fe==null){je=0;break}if(4>D){je=7;break}if(Ye&&Fe||!Ye&&!Fe&&!n(x,N[0],"ALPH")){D=[D],Re.na=[Re.na],Re.P=[Re.P],Re.Sa=[Re.Sa];e:{_t=x,je=N,Ye=D;var At=Re.gb;ct=Re.na,rt=Re.P,kt=Re.Sa,Wt=22,t(_t!=null),t(Ye!=null),Ze=je[0];var cn=Ye[0];for(t(ct!=null),t(kt!=null),ct[0]=null,rt[0]=null,kt[0]=0;;){if(je[0]=Ze,Ye[0]=cn,8>cn){je=7;break e}var Kn=B(_t,Ze+4);if(4294967286<Kn){je=3;break e}var Qt=8+Kn+1&-2;if(Wt+=Qt,0<At&&Wt>At){je=3;break e}if(!n(_t,Ze,"VP8 ")||!n(_t,Ze,"VP8L")){je=0;break e}if(cn[0]<Qt){je=7;break e}n(_t,Ze,"ALPH")||(ct[0]=_t,rt[0]=Ze+8,kt[0]=Kn),Ze+=Qt,cn-=Qt}}if(D=D[0],Re.na=Re.na[0],Re.P=Re.P[0],Re.Sa=Re.Sa[0],je!=0)break}D=[D],Re.Ja=[Re.Ja],Re.xa=[Re.xa];e:if(At=x,je=N,Ye=D,ct=Re.gb[0],rt=Re.Ja,kt=Re.xa,_t=je[0],Ze=!n(At,_t,"VP8 "),Wt=!n(At,_t,"VP8L"),t(At!=null),t(Ye!=null),t(rt!=null),t(kt!=null),8>Ye[0])je=7;else{if(Ze||Wt){if(At=B(At,_t+4),12<=ct&&At>ct-12){je=3;break e}if(me&&At>Ye[0]-8){je=7;break e}rt[0]=At,je[0]+=8,Ye[0]-=8,kt[0]=Wt}else kt[0]=5<=Ye[0]&&At[_t+0]==47&&!(At[_t+4]>>5),rt[0]=Ye[0];je=0}if(D=D[0],Re.Ja=Re.Ja[0],Re.xa=Re.xa[0],N=N[0],je!=0)break;if(4294967286<Re.Ja)return 3;if(ue==null||Xe||(ue[0]=Re.xa?2:1),oe=[oe],Ue=[Ue],Re.xa){if(5>D){je=7;break}ue=oe,me=Ue,Xe=re,x==null||5>D?x=0:5<=D&&x[N+0]==47&&!(x[N+4]>>5)?(Ye=[0],At=[0],ct=[0],pe(rt=new ee,x,N,D),sn(rt,Ye,At,ct)?(ue!=null&&(ue[0]=Ye[0]),me!=null&&(me[0]=At[0]),Xe!=null&&(Xe[0]=ct[0]),x=1):x=0):x=0}else{if(10>D){je=7;break}ue=Ue,x==null||10>D||!Wl(x,N+3,D-3)?x=0:(me=x[N+0]|x[N+1]<<8|x[N+2]<<16,Xe=16383&(x[N+7]<<8|x[N+6]),x=16383&(x[N+9]<<8|x[N+8]),1&me||3<(me>>1&7)||!(me>>4&1)||me>>5>=Re.Ja||!Xe||!x?x=0:(oe&&(oe[0]=Xe),ue&&(ue[0]=x),x=1))}if(!x||(oe=oe[0],Ue=Ue[0],Fe&&(ge[0]!=oe||Ae[0]!=Ue)))return 3;fe!=null&&(fe[0]=Re,fe.offset=N-fe.w,t(4294967286>N-fe.w),t(fe.offset==fe.ha-D));break}return je==0||je==7&&Fe&&fe==null?(re!=null&&(re[0]|=Re.na!=null&&0<Re.na.length),F!=null&&(F[0]=oe),Q!=null&&(Q[0]=Ue),0):je}function ha(x,N,D){var F=N.width,Q=N.height,re=0,oe=0,ue=F,fe=Q;if(N.Da=x!=null&&0<x.Da,N.Da&&(ue=x.cd,fe=x.bd,re=x.v,oe=x.j,11>D||(re&=-2,oe&=-2),0>re||0>oe||0>=ue||0>=fe||re+ue>F||oe+fe>Q))return 0;if(N.v=re,N.j=oe,N.va=re+ue,N.o=oe+fe,N.U=ue,N.T=fe,N.da=x!=null&&0<x.da,N.da){if(!ne(ue,fe,D=[x.ib],re=[x.hb]))return 0;N.ib=D[0],N.hb=re[0]}return N.ob=x!=null&&x.ob,N.Kb=x==null||!x.Sd,N.da&&(N.ob=N.ib<3*F/4&&N.hb<3*Q/4,N.Kb=0),1}function ac(x){if(x==null)return 2;if(11>x.S){var N=x.f.RGBA;N.fb+=(x.height-1)*N.A,N.A=-N.A}else N=x.f.kb,x=x.height,N.O+=(x-1)*N.fa,N.fa=-N.fa,N.N+=(x-1>>1)*N.Ab,N.Ab=-N.Ab,N.W+=(x-1>>1)*N.Db,N.Db=-N.Db,N.F!=null&&(N.J+=(x-1)*N.lb,N.lb=-N.lb);return 0}function wo(x,N,D,F){if(F==null||0>=x||0>=N)return 2;if(D!=null){if(D.Da){var Q=D.cd,re=D.bd,oe=-2&D.v,ue=-2&D.j;if(0>oe||0>ue||0>=Q||0>=re||oe+Q>x||ue+re>N)return 2;x=Q,N=re}if(D.da){if(!ne(x,N,Q=[D.ib],re=[D.hb]))return 2;x=Q[0],N=re[0]}}F.width=x,F.height=N;e:{var fe=F.width,ge=F.height;if(x=F.S,0>=fe||0>=ge||!(x>=Jc&&13>x))x=2;else{if(0>=F.Rd&&F.sd==null){oe=re=Q=N=0;var Ae=(ue=fe*ou[x])*ge;if(11>x||(re=(ge+1)/2*(N=(fe+1)/2),x==12&&(oe=(Q=fe)*ge)),(ge=a(Ae+2*re+oe))==null){x=1;break e}F.sd=ge,11>x?((fe=F.f.RGBA).eb=ge,fe.fb=0,fe.A=ue,fe.size=Ae):((fe=F.f.kb).y=ge,fe.O=0,fe.fa=ue,fe.Fd=Ae,fe.f=ge,fe.N=0+Ae,fe.Ab=N,fe.Cd=re,fe.ea=ge,fe.W=0+Ae+re,fe.Db=N,fe.Ed=re,x==12&&(fe.F=ge,fe.J=0+Ae+2*re),fe.Tc=oe,fe.lb=Q)}if(N=1,Q=F.S,re=F.width,oe=F.height,Q>=Jc&&13>Q)if(11>Q)x=F.f.RGBA,N&=(ue=Math.abs(x.A))*(oe-1)+re<=x.size,N&=ue>=re*ou[Q],N&=x.eb!=null;else{x=F.f.kb,ue=(re+1)/2,Ae=(oe+1)/2,fe=Math.abs(x.fa),ge=Math.abs(x.Ab);var Fe=Math.abs(x.Db),me=Math.abs(x.lb),Re=me*(oe-1)+re;N&=fe*(oe-1)+re<=x.Fd,N&=ge*(Ae-1)+ue<=x.Cd,N=(N&=Fe*(Ae-1)+ue<=x.Ed)&fe>=re&ge>=ue&Fe>=ue,N&=x.y!=null,N&=x.f!=null,N&=x.ea!=null,Q==12&&(N&=me>=re,N&=Re<=x.Tc,N&=x.F!=null)}else N=0;x=N?0:2}}return x!=0||D!=null&&D.fd&&(x=ac(F)),x}var Ga=64,br=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],hr=24,Uo=32,zo=8,pa=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Me("Predictor0","PredictorAdd0"),j.Predictor0=function(){return 4278190080},j.Predictor1=function(x){return x},j.Predictor2=function(x,N,D){return N[D+0]},j.Predictor3=function(x,N,D){return N[D+1]},j.Predictor4=function(x,N,D){return N[D-1]},j.Predictor5=function(x,N,D){return He(He(x,N[D+1]),N[D+0])},j.Predictor6=function(x,N,D){return He(x,N[D-1])},j.Predictor7=function(x,N,D){return He(x,N[D+0])},j.Predictor8=function(x,N,D){return He(N[D-1],N[D+0])},j.Predictor9=function(x,N,D){return He(N[D+0],N[D+1])},j.Predictor10=function(x,N,D){return He(He(x,N[D-1]),He(N[D+0],N[D+1]))},j.Predictor11=function(x,N,D){var F=N[D+0];return 0>=We(F>>24&255,x>>24&255,(N=N[D-1])>>24&255)+We(F>>16&255,x>>16&255,N>>16&255)+We(F>>8&255,x>>8&255,N>>8&255)+We(255&F,255&x,255&N)?F:x},j.Predictor12=function(x,N,D){var F=N[D+0];return(Ne((x>>24&255)+(F>>24&255)-((N=N[D-1])>>24&255))<<24|Ne((x>>16&255)+(F>>16&255)-(N>>16&255))<<16|Ne((x>>8&255)+(F>>8&255)-(N>>8&255))<<8|Ne((255&x)+(255&F)-(255&N)))>>>0},j.Predictor13=function(x,N,D){var F=N[D-1];return(ze((x=He(x,N[D+0]))>>24&255,F>>24&255)<<24|ze(x>>16&255,F>>16&255)<<16|ze(x>>8&255,F>>8&255)<<8|ze(255&x,255&F))>>>0};var il=j.PredictorAdd0;j.PredictorAdd1=dt,Me("Predictor2","PredictorAdd2"),Me("Predictor3","PredictorAdd3"),Me("Predictor4","PredictorAdd4"),Me("Predictor5","PredictorAdd5"),Me("Predictor6","PredictorAdd6"),Me("Predictor7","PredictorAdd7"),Me("Predictor8","PredictorAdd8"),Me("Predictor9","PredictorAdd9"),Me("Predictor10","PredictorAdd10"),Me("Predictor11","PredictorAdd11"),Me("Predictor12","PredictorAdd12"),Me("Predictor13","PredictorAdd13");var rl=j.PredictorAdd2;mt("ColorIndexInverseTransform","MapARGB","32b",function(x){return x>>8&255},function(x){return x}),mt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(x){return x},function(x){return x>>8&255});var gi,Yc=j.ColorIndexInverseTransform,jo=j.MapARGB,Fo=j.VP8LColorIndexInverseTransformAlpha,Vi=j.MapAlpha,ma=j.VP8LPredictorsAdd=[];ma.length=16,(j.VP8LPredictors=[]).length=16,(j.VP8LPredictorsAdd_C=[]).length=16,(j.VP8LPredictors_C=[]).length=16;var ol,al,ga,va,Bo,ws,Mr,ya,tr,Gr,Cn,vn,Gn,vi,qo,_o,_s,sc,od,_f,Sf,Ef,ad,sd,Ss,Vr,lc,Dr,Es=a(511),Wc=a(2041),cc=a(225),uc=a(767),Xc=0,ba=Wc,dc=cc,nr=uc,$i=Es,Jc=0,ir=1,Kc=2,$r=3,fc=4,sl=5,Va=6,hc=7,Zc=8,ll=9,Qc=10,Yr=[2,3,7],cl=[3,3,11],Ns=[280,256,256,256,40],eu=[0,1,1,1,0],pc=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Wr=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Xr=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],$a=8,Jr=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Kr=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Pr=null,Nf=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],ld=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],tu=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Af=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Yi=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Jn=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],un=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],pr=[],li=[],So=[],Ya=1,cd=2,xa=[],Wi=[];ua("UpsampleRgbLinePair",da,3),ua("UpsampleBgrLinePair",ji,3),ua("UpsampleRgbaLinePair",fr,4),ua("UpsampleBgraLinePair",Oo,4),ua("UpsampleArgbLinePair",tl,4),ua("UpsampleRgba4444LinePair",Ha,2),ua("UpsampleRgb565LinePair",qa,2);var As=j.UpsampleRgbLinePair,ud=j.UpsampleBgrLinePair,ul=j.UpsampleRgbaLinePair,nu=j.UpsampleBgraLinePair,Wa=j.UpsampleArgbLinePair,Ho=j.UpsampleRgba4444LinePair,Xa=j.UpsampleRgb565LinePair,Zr=16,dl=1<<Zr-1,Cs=-227,Ja=482,iu=6,Ka=0,Xi=a(256),ru=a(256),Cf=a(256),Hp=a(256),Gp=a(Ja-Cs),Vp=a(Ja-Cs);fa("YuvToRgbRow",da,3),fa("YuvToBgrRow",ji,3),fa("YuvToRgbaRow",fr,4),fa("YuvToBgraRow",Oo,4),fa("YuvToArgbRow",tl,4),fa("YuvToRgba4444Row",Ha,2),fa("YuvToRgb565Row",qa,2);var yi=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],fl=[0,2,8],mc=[8,7,6,4,4,2,2,2,1,1,1,1],gc=1;this.WebPDecodeRGBA=function(x,N,D,F,Q){var re=ir,oe=new Ke,ue=new lt;oe.ba=ue,ue.S=re,ue.width=[ue.width],ue.height=[ue.height];var fe=ue.width,ge=ue.height,Ae=new et;if(Ae==null||x==null)var Fe=2;else t(Ae!=null),Fe=xo(x,N,D,Ae.width,Ae.height,Ae.Pd,Ae.Qd,Ae.format,null);if(Fe!=0?fe=0:(fe!=null&&(fe[0]=Ae.width[0]),ge!=null&&(ge[0]=Ae.height[0]),fe=1),fe){ue.width=ue.width[0],ue.height=ue.height[0],F!=null&&(F[0]=ue.width),Q!=null&&(Q[0]=ue.height);e:{if(F=new ta,(Q=new ot).data=x,Q.w=N,Q.ha=D,Q.kd=1,N=[0],t(Q!=null),((x=xo(Q.data,Q.w,Q.ha,null,null,null,N,null,Q))==0||x==7)&&N[0]&&(x=4),(N=x)==0){if(t(oe!=null),F.data=Q.data,F.w=Q.w+Q.offset,F.ha=Q.ha-Q.offset,F.put=bt,F.ac=Jt,F.bc=jt,F.ma=oe,Q.xa){if((x=fs())==null){oe=1;break e}if((function(me,Re){var Ue=[0],Xe=[0],je=[0];t:for(;;){if(me==null)return 0;if(Re==null)return me.a=2,0;if(me.l=Re,me.a=0,pe(me.m,Re.data,Re.w,Re.ha),!sn(me.m,Ue,Xe,je)){me.a=3;break t}if(me.xb=cd,Re.width=Ue[0],Re.height=Xe[0],!co(Ue[0],Xe[0],1,me,null))break t;return 1}return t(me.a!=0),0})(x,F)){if(F=(N=wo(F.width,F.height,oe.Oa,oe.ba))==0){t:{F=x;n:for(;;){if(F==null){F=0;break t}if(t(F.s.yc!=null),t(F.s.Ya!=null),t(0<F.s.Wb),t((D=F.l)!=null),t((Q=D.ma)!=null),F.xb!=0){if(F.ca=Q.ba,F.tb=Q.tb,t(F.ca!=null),!ha(Q.Oa,D,$r)){F.a=2;break n}if(!uo(F,D.width)||D.da)break n;if((D.da||Qe(F.ca.S))&&yo(),11>F.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),F.ca.f.kb.F!=null&&yo()),F.Pb&&0<F.s.ua&&F.s.vb.X==null&&!K(F.s.vb,F.s.Wa.Xa)){F.a=1;break n}F.xb=0}if(!Cr(F,F.V,F.Ba,F.c,F.i,D.o,Ii))break n;Q.Dc=F.Ma,F=1;break t}t(F.a!=0),F=0}F=!F}F&&(N=x.a)}else N=x.a}else{if((x=new mo)==null){oe=1;break e}if(x.Fa=Q.na,x.P=Q.P,x.qc=Q.Sa,Lo(x,F)){if((N=wo(F.width,F.height,oe.Oa,oe.ba))==0){if(x.Aa=0,D=oe.Oa,t((Q=x)!=null),D!=null){if(0<(fe=0>(fe=D.Md)?0:100<fe?255:255*fe/100)){for(ge=Ae=0;4>ge;++ge)12>(Fe=Q.pb[ge]).lc&&(Fe.ia=fe*mc[0>Fe.lc?0:Fe.lc]>>3),Ae|=Fe.ia;Ae&&(alert("todo:VP8InitRandom"),Q.ia=1)}Q.Ga=D.Id,100<Q.Ga?Q.Ga=100:0>Q.Ga&&(Q.Ga=0)}(function(me,Re){if(me==null)return 0;if(Re==null)return An(me,2,"NULL VP8Io parameter in VP8Decode().");if(!me.cb&&!Lo(me,Re))return 0;if(t(me.cb),Re.ac==null||Re.ac(Re)){Re.ob&&(me.L=0);var Ue=fl[me.L];if(me.L==2?(me.yb=0,me.zb=0):(me.yb=Re.v-Ue>>4,me.zb=Re.j-Ue>>4,0>me.yb&&(me.yb=0),0>me.zb&&(me.zb=0)),me.Va=Re.o+15+Ue>>4,me.Hb=Re.va+15+Ue>>4,me.Hb>me.za&&(me.Hb=me.za),me.Va>me.Ub&&(me.Va=me.Ub),0<me.L){var Xe=me.ed;for(Ue=0;4>Ue;++Ue){var je;if(me.Qa.Cb){var Ye=me.Qa.Lb[Ue];me.Qa.Fb||(Ye+=Xe.Tb)}else Ye=Xe.Tb;for(je=0;1>=je;++je){var Ze=me.gd[Ue][je],ct=Ye;if(Xe.Pc&&(ct+=Xe.vd[0],je&&(ct+=Xe.od[0])),0<(ct=0>ct?0:63<ct?63:ct)){var rt=ct;0<Xe.wb&&(rt=4<Xe.wb?rt>>2:rt>>1)>9-Xe.wb&&(rt=9-Xe.wb),1>rt&&(rt=1),Ze.dd=rt,Ze.tc=2*ct+rt,Ze.ld=40<=ct?2:15<=ct?1:0}else Ze.tc=0;Ze.La=je}}}Ue=0}else An(me,6,"Frame setup failed"),Ue=me.a;if(Ue=Ue==0){if(Ue){me.$c=0,0<me.Aa||(me.Ic=gc);t:{Ue=me.Ic,Xe=4*(rt=me.za);var kt=32*rt,_t=rt+1,Wt=0<me.L?rt*(0<me.Aa?2:1):0,At=(me.Aa==2?2:1)*rt;if((Ze=Xe+832+(je=3*(16*Ue+fl[me.L])/2*kt)+(Ye=me.Fa!=null&&0<me.Fa.length?me.Kc.c*me.Kc.i:0))!=Ze)Ue=0;else{if(Ze>me.Vb){if(me.Vb=0,me.Ec=a(Ze),me.Fc=0,me.Ec==null){Ue=An(me,1,"no memory during frame initialization.");break t}me.Vb=Ze}Ze=me.Ec,ct=me.Fc,me.Ac=Ze,me.Bc=ct,ct+=Xe,me.Gd=l(kt,Yl),me.Hd=0,me.rb=l(_t+1,po),me.sb=1,me.wa=Wt?l(Wt,Tr):null,me.Y=0,me.D.Nb=0,me.D.wa=me.wa,me.D.Y=me.Y,0<me.Aa&&(me.D.Y+=rt),t(!0),me.oc=Ze,me.pc=ct,ct+=832,me.ya=l(At,Vl),me.aa=0,me.D.ya=me.ya,me.D.aa=me.aa,me.Aa==2&&(me.D.aa+=rt),me.R=16*rt,me.B=8*rt,rt=(kt=fl[me.L])*me.R,kt=kt/2*me.B,me.sa=Ze,me.ta=ct+rt,me.qa=me.sa,me.ra=me.ta+16*Ue*me.R+kt,me.Ha=me.qa,me.Ia=me.ra+8*Ue*me.B+kt,me.$c=0,ct+=je,me.mb=Ye?Ze:null,me.nb=Ye?ct:null,t(ct+Ye<=me.Fc+me.Vb),Xl(me),o(me.Ac,me.Bc,0,Xe),Ue=1}}if(Ue){if(Re.ka=0,Re.y=me.sa,Re.O=me.ta,Re.f=me.qa,Re.N=me.ra,Re.ea=me.Ha,Re.Vd=me.Ia,Re.fa=me.R,Re.Rc=me.B,Re.F=null,Re.J=0,!Xc){for(Ue=-255;255>=Ue;++Ue)Es[255+Ue]=0>Ue?-Ue:Ue;for(Ue=-1020;1020>=Ue;++Ue)Wc[1020+Ue]=-128>Ue?-128:127<Ue?127:Ue;for(Ue=-112;112>=Ue;++Ue)cc[112+Ue]=-16>Ue?-16:15<Ue?15:Ue;for(Ue=-255;510>=Ue;++Ue)uc[255+Ue]=0>Ue?0:255<Ue?255:Ue;Xc=1}Mr=go,ya=Jl,Gr=dr,Cn=Kl,vn=Zl,tr=zc,Gn=Vc,vi=la,qo=Z,_o=ve,_s=$c,sc=L,od=Ee,_f=Pe,Sf=ra,Ef=oa,ad=bs,sd=ic,li[0]=Hc,li[1]=jc,li[2]=qc,li[3]=tc,li[4]=Ir,li[5]=nc,li[6]=Hi,li[7]=gs,li[8]=vs,li[9]=Rr,pr[0]=vo,pr[1]=Ql,pr[2]=ec,pr[3]=Bc,pr[4]=na,pr[5]=ms,pr[6]=Ba,So[0]=Ks,So[1]=Fc,So[2]=Mo,So[3]=Gc,So[4]=zi,So[5]=Zs,So[6]=Do,Ue=1}else Ue=0}Ue&&(Ue=(function(cn,Kn){for(cn.M=0;cn.M<cn.Va;++cn.M){var Qt,St=cn.Jc[cn.M&cn.Xb],gt=cn.m,ii=cn;for(Qt=0;Qt<ii.za;++Qt){var Ht=gt,nn=ii,Mn=nn.Ac,Mi=nn.Bc+4*Qt,Ji=nn.zc,Vn=nn.ya[nn.aa+Qt];if(nn.Qa.Bb?Vn.$b=De(Ht,nn.Pa.jb[0])?2+De(Ht,nn.Pa.jb[2]):De(Ht,nn.Pa.jb[1]):Vn.$b=0,nn.kc&&(Vn.Ad=De(Ht,nn.Bd)),Vn.Za=!De(Ht,145)+0,Vn.Za){var Si=Vn.Ob,rr=0;for(nn=0;4>nn;++nn){var Ei,ln=Ji[0+nn];for(Ei=0;4>Ei;++Ei){ln=Yi[Mn[Mi+Ei]][ln];for(var _n=tu[De(Ht,ln[0])];0<_n;)_n=tu[2*_n+De(Ht,ln[_n])];ln=-_n,Mn[Mi+Ei]=ln}i(Si,rr,Mn,Mi,4),rr+=4,Ji[0+nn]=ln}}else ln=De(Ht,156)?De(Ht,128)?1:3:De(Ht,163)?2:0,Vn.Ob[0]=ln,o(Mn,Mi,ln,4),o(Ji,0,ln,4);Vn.Dd=De(Ht,142)?De(Ht,114)?De(Ht,183)?1:3:2:0}if(ii.m.Ka)return An(cn,7,"Premature end-of-partition0 encountered.");for(;cn.ja<cn.za;++cn.ja){if(ii=St,Ht=(gt=cn).rb[gt.sb-1],Mn=gt.rb[gt.sb+gt.ja],Qt=gt.ya[gt.aa+gt.ja],Mi=gt.kc?Qt.Ad:0)Ht.la=Mn.la=0,Qt.Za||(Ht.Na=Mn.Na=0),Qt.Hc=0,Qt.Gc=0,Qt.ia=0;else{var ri,Tn;if(Ht=Mn,Mn=ii,Mi=gt.Pa.Xc,Ji=gt.ya[gt.aa+gt.ja],Vn=gt.pb[Ji.$b],nn=Ji.ad,Si=0,rr=gt.rb[gt.sb-1],ln=Ei=0,o(nn,Si,0,384),Ji.Za)var Di=0,oi=Mi[3];else{_n=a(16);var Sn=Ht.Na+rr.Na;if(Sn=Pr(Mn,Mi[1],Sn,Vn.Eb,0,_n,0),Ht.Na=rr.Na=(0<Sn)+0,1<Sn)Mr(_n,0,nn,Si);else{var bi=_n[0]+3>>3;for(_n=0;256>_n;_n+=16)nn[Si+_n]=bi}Di=1,oi=Mi[0]}var Dn=15&Ht.la,Ni=15&rr.la;for(_n=0;4>_n;++_n){var Ai=1&Ni;for(bi=Tn=0;4>bi;++bi)Dn=Dn>>1|(Ai=(Sn=Pr(Mn,oi,Sn=Ai+(1&Dn),Vn.Sc,Di,nn,Si))>Di)<<7,Tn=Tn<<2|(3<Sn?3:1<Sn?2:nn[Si+0]!=0),Si+=16;Dn>>=4,Ni=Ni>>1|Ai<<7,Ei=(Ei<<8|Tn)>>>0}for(oi=Dn,Di=Ni>>4,ri=0;4>ri;ri+=2){for(Tn=0,Dn=Ht.la>>4+ri,Ni=rr.la>>4+ri,_n=0;2>_n;++_n){for(Ai=1&Ni,bi=0;2>bi;++bi)Sn=Ai+(1&Dn),Dn=Dn>>1|(Ai=0<(Sn=Pr(Mn,Mi[2],Sn,Vn.Qc,0,nn,Si)))<<3,Tn=Tn<<2|(3<Sn?3:1<Sn?2:nn[Si+0]!=0),Si+=16;Dn>>=2,Ni=Ni>>1|Ai<<5}ln|=Tn<<4*ri,oi|=Dn<<4<<ri,Di|=(240&Ni)<<ri}Ht.la=oi,rr.la=Di,Ji.Hc=Ei,Ji.Gc=ln,Ji.ia=43690&ln?0:Vn.ia,Mi=!(Ei|ln)}if(0<gt.L&&(gt.wa[gt.Y+gt.ja]=gt.gd[Qt.$b][Qt.Za],gt.wa[gt.Y+gt.ja].La|=!Mi),ii.Ka)return An(cn,7,"Premature end-of-file encountered.")}if(Xl(cn),gt=Kn,ii=1,Qt=(St=cn).D,Ht=0<St.L&&St.M>=St.zb&&St.M<=St.Va,St.Aa==0)t:{if(Qt.M=St.M,Qt.uc=Ht,Lr(St,Qt),ii=1,Qt=(Tn=St.D).Nb,Ht=(ln=fl[St.L])*St.R,Mn=ln/2*St.B,_n=16*Qt*St.R,bi=8*Qt*St.B,Mi=St.sa,Ji=St.ta-Ht+_n,Vn=St.qa,nn=St.ra-Mn+bi,Si=St.Ha,rr=St.Ia-Mn+bi,Ni=(Dn=Tn.M)==0,Ei=Dn>=St.Va-1,St.Aa==2&&Lr(St,Tn),Tn.uc)for(Ai=(Sn=St).D.M,t(Sn.D.uc),Tn=Sn.yb;Tn<Sn.Hb;++Tn){Di=Tn,oi=Ai;var Un=(yn=(Ci=Sn).D).Nb;ri=Ci.R;var yn=yn.wa[yn.Y+Di],or=Ci.sa,ci=Ci.ta+16*Un*ri+16*Di,Pt=yn.dd,Ot=yn.tc;if(Ot!=0)if(t(3<=Ot),Ci.L==1)0<Di&&Ef(or,ci,ri,Ot+4),yn.La&&sd(or,ci,ri,Ot),0<oi&&Sf(or,ci,ri,Ot+4),yn.La&&ad(or,ci,ri,Ot);else{var En=Ci.B,xr=Ci.qa,Qr=Ci.ra+8*Un*En+8*Di,mr=Ci.Ha,Ci=Ci.Ia+8*Un*En+8*Di;Un=yn.ld,0<Di&&(vi(or,ci,ri,Ot+4,Pt,Un),_o(xr,Qr,mr,Ci,En,Ot+4,Pt,Un)),yn.La&&(sc(or,ci,ri,Ot,Pt,Un),_f(xr,Qr,mr,Ci,En,Ot,Pt,Un)),0<oi&&(Gn(or,ci,ri,Ot+4,Pt,Un),qo(xr,Qr,mr,Ci,En,Ot+4,Pt,Un)),yn.La&&(_s(or,ci,ri,Ot,Pt,Un),od(xr,Qr,mr,Ci,En,Ot,Pt,Un))}}if(St.ia&&alert("todo:DitherRow"),gt.put!=null){if(Tn=16*Dn,Dn=16*(Dn+1),Ni?(gt.y=St.sa,gt.O=St.ta+_n,gt.f=St.qa,gt.N=St.ra+bi,gt.ea=St.Ha,gt.W=St.Ia+bi):(Tn-=ln,gt.y=Mi,gt.O=Ji,gt.f=Vn,gt.N=nn,gt.ea=Si,gt.W=rr),Ei||(Dn-=ln),Dn>gt.o&&(Dn=gt.o),gt.F=null,gt.J=null,St.Fa!=null&&0<St.Fa.length&&Tn<Dn&&(gt.J=Hn(St,gt,Tn,Dn-Tn),gt.F=St.mb,gt.F==null&&gt.F.length==0)){ii=An(St,3,"Could not decode alpha data.");break t}Tn<gt.j&&(ln=gt.j-Tn,Tn=gt.j,t(!(1&ln)),gt.O+=St.R*ln,gt.N+=St.B*(ln>>1),gt.W+=St.B*(ln>>1),gt.F!=null&&(gt.J+=gt.width*ln)),Tn<Dn&&(gt.O+=gt.v,gt.N+=gt.v>>1,gt.W+=gt.v>>1,gt.F!=null&&(gt.J+=gt.v),gt.ka=Tn-gt.j,gt.U=gt.va-gt.v,gt.T=Dn-Tn,ii=gt.put(gt))}Qt+1!=St.Ic||Ei||(i(St.sa,St.ta-Ht,Mi,Ji+16*St.R,Ht),i(St.qa,St.ra-Mn,Vn,nn+8*St.B,Mn),i(St.Ha,St.Ia-Mn,Si,rr+8*St.B,Mn))}if(!ii)return An(cn,6,"Output aborted.")}return 1})(me,Re)),Re.bc!=null&&Re.bc(Re),Ue&=1}return Ue?(me.cb=0,Ue):0})(x,F)||(N=x.a)}}else N=x.a}N==0&&oe.Oa!=null&&oe.Oa.fd&&(N=ac(oe.ba))}oe=N}re=oe!=0?null:11>re?ue.f.RGBA.eb:ue.f.kb.y}else re=null;return re};var ou=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(j,X){for(var z="",U=0;U<4;U++)z+=String.fromCharCode(j[X++]);return z}function h(j,X){return j[X+0]|j[X+1]<<8}function v(j,X){return(j[X+0]|j[X+1]<<8|j[X+2]<<16)>>>0}function b(j,X){return(j[X+0]|j[X+1]<<8|j[X+2]<<16|j[X+3]<<24)>>>0}new u;var g=[0],A=[0],_=[],C=new u,E=e,R=(function(j,X){var z={},U=0,q=!1,I=0,ie=0;if(z.frames=[],!(function(O,ee){for(var te=0;te<4;te++)if(O[ee+te]!="RIFF".charCodeAt(te))return!0;return!1})(j,X)){for(b(j,X+=4),X+=8;X<j.length;){var J=d(j,X),Y=b(j,X+=4);X+=4;var le=Y+(1&Y);switch(J){case"VP8 ":case"VP8L":z.frames[U]===void 0&&(z.frames[U]={}),(G=z.frames[U]).src_off=q?ie:X-8,G.src_size=I+Y+8,U++,q&&(q=!1,I=0,ie=0);break;case"VP8X":(G=z.header={}).feature_flags=j[X];var pe=X+4;G.canvas_width=1+v(j,pe),pe+=3,G.canvas_height=1+v(j,pe),pe+=3;break;case"ALPH":q=!0,I=le+8,ie=X-8;break;case"ANIM":(G=z.header).bgcolor=b(j,X),pe=X+4,G.loop_count=h(j,pe),pe+=2;break;case"ANMF":var Ie,G;(G=z.frames[U]={}).offset_x=2*v(j,X),X+=3,G.offset_y=2*v(j,X),X+=3,G.width=1+v(j,X),X+=3,G.height=1+v(j,X),X+=3,G.duration=v(j,X),X+=3,Ie=j[X++],G.dispose=1&Ie,G.blend=Ie>>1&1}J!="ANMF"&&(X+=le)}return z}})(E,0);R.response=E,R.rgbaoutput=!0,R.dataurl=!1;var k=R.header?R.header:null,M=R.frames?R.frames:null;if(k){k.loop_counter=k.loop_count,g=[k.canvas_height],A=[k.canvas_width];for(var P=0;P<M.length&&M[P].blend!=0;P++);}var W=M[0],V=C.WebPDecodeRGBA(E,W.src_off,W.src_size,A,g);W.rgba=V,W.imgwidth=A[0],W.imgheight=g[0];for(var $=0;$<A[0]*g[0]*4;$++)_[$]=V[$];return this.width=A,this.height=g,this.data=_,this}/** ====================================================================
 * @license
 * jsPDF XMP metadata plugin
 * Copyright (c) 2016 Jussi Utunen, u-jussi@suomi24.fi
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */function Z6(){var e,t=this.internal.__metadata__.metadata,n=unescape(encodeURIComponent(t));e=this.internal.__metadata__.rawXml?n:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+e.length+" >>"),this.internal.write("stream"),this.internal.write(e),this.internal.write("endstream"),this.internal.write("endobj")}function Q6(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(e){var t,n,i,o,a,l,c,u,d,h=function(O){return O=O||{},this.isStrokeTransparent=O.isStrokeTransparent||!1,this.strokeOpacity=O.strokeOpacity||1,this.strokeStyle=O.strokeStyle||"#000000",this.fillStyle=O.fillStyle||"#000000",this.isFillTransparent=O.isFillTransparent||!1,this.fillOpacity=O.fillOpacity||1,this.font=O.font||"10px sans-serif",this.textBaseline=O.textBaseline||"alphabetic",this.textAlign=O.textAlign||"left",this.lineWidth=O.lineWidth||1,this.lineJoin=O.lineJoin||"miter",this.lineCap=O.lineCap||"butt",this.path=O.path||[],this.transform=O.transform!==void 0?O.transform.clone():new u,this.globalCompositeOperation=O.globalCompositeOperation||"normal",this.globalAlpha=O.globalAlpha||1,this.clip_path=O.clip_path||[],this.currentPoint=O.currentPoint||new l,this.miterLimit=O.miterLimit||10,this.lastPoint=O.lastPoint||new l,this.lineDashOffset=O.lineDashOffset||0,this.lineDash=O.lineDash||[],this.margin=O.margin||[0,0,0,0],this.prevPageLastElemOffset=O.prevPageLastElemOffset||0,this.ignoreClearRect=typeof O.ignoreClearRect!="boolean"||O.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new v(this),t=this.internal.f2,n=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,o=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,l=this.internal.Point,c=this.internal.Rectangle,u=this.internal.Matrix,d=new h}]);var v=function(O){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var ee=O;Object.defineProperty(this,"pdf",{get:function(){return ee}});var te=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return te},set:function(K){te=!!K}});var ce=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ce},set:function(K){ce=!!K}});var ye=0;Object.defineProperty(this,"posX",{get:function(){return ye},set:function(K){isNaN(K)||(ye=K)}});var we=0;Object.defineProperty(this,"posY",{get:function(){return we},set:function(K){isNaN(K)||(we=K)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(K){var _e;typeof K=="number"?_e=[K,K,K,K]:((_e=new Array(4))[0]=K[0],_e[1]=K.length>=2?K[1]:_e[0],_e[2]=K.length>=3?K[2]:_e[0],_e[3]=K.length>=4?K[3]:_e[1]),d.margin=_e}});var Te=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Te},set:function(K){Te=K}});var Ce=0;Object.defineProperty(this,"lastBreak",{get:function(){return Ce},set:function(K){Ce=K}});var De=[];Object.defineProperty(this,"pageBreaks",{get:function(){return De},set:function(K){De=K}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(K){K instanceof h&&(d=K)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(K){d.path=K}});var $e=[];Object.defineProperty(this,"ctxStack",{get:function(){return $e},set:function(K){$e=K}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(K){var _e;_e=b(K),this.ctx.fillStyle=_e.style,this.ctx.isFillTransparent=_e.a===0,this.ctx.fillOpacity=_e.a,this.pdf.setFillColor(_e.r,_e.g,_e.b,{a:_e.a}),this.pdf.setTextColor(_e.r,_e.g,_e.b,{a:_e.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(K){var _e=b(K);this.ctx.strokeStyle=_e.style,this.ctx.isStrokeTransparent=_e.a===0,this.ctx.strokeOpacity=_e.a,_e.a===0?this.pdf.setDrawColor(255,255,255):(_e.a,this.pdf.setDrawColor(_e.r,_e.g,_e.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(K){["butt","round","square"].indexOf(K)!==-1&&(this.ctx.lineCap=K,this.pdf.setLineCap(K))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(K){isNaN(K)||(this.ctx.lineWidth=K,this.pdf.setLineWidth(K))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(K){["bevel","round","miter"].indexOf(K)!==-1&&(this.ctx.lineJoin=K,this.pdf.setLineJoin(K))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(K){isNaN(K)||(this.ctx.miterLimit=K,this.pdf.setMiterLimit(K))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(K){this.ctx.textBaseline=K}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(K){["right","end","center","left","start"].indexOf(K)!==-1&&(this.ctx.textAlign=K)}});var at=null,st=null,B=null;Object.defineProperty(this,"fontFaces",{get:function(){return B},set:function(K){at=null,st=null,B=K}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(K){var _e;if(this.ctx.font=K,(_e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(K))!==null){var he=_e[1];_e[2];var ne=_e[3],ae=_e[4];_e[5];var be=_e[6],Me=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ae)[2];ae=Math.floor(Me==="px"?parseFloat(ae)*this.pdf.internal.scaleFactor:Me==="em"?parseFloat(ae)*this.pdf.getFontSize():parseFloat(ae)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ae);var Se=(function(mt){var on,yt,vt=[],Rt=mt.trim();if(Rt==="")return Dm;if(Rt in C5)return[C5[Rt]];for(;Rt!=="";){switch(yt=null,on=(Rt=k5(Rt)).charAt(0)){case'"':case"'":yt=$6(Rt.substring(1),on);break;default:yt=Y6(Rt)}if(yt===null||(vt.push(yt[0]),(Rt=k5(yt[1]))!==""&&Rt.charAt(0)!==","))return Dm;Rt=Rt.replace(/^,/,"")}return vt})(be);if(this.fontFaces){var He=(function(mt,on){var yt=mt.getFontList(),vt=JSON.stringify(yt);if(at===null||st!==vt){var Rt=(function(Ft){var Le=[];return Object.keys(Ft).forEach(function(nt){Ft[nt].forEach(function(Qe){var ut=null;switch(Qe){case"bold":ut={family:nt,weight:"bold"};break;case"italic":ut={family:nt,style:"italic"};break;case"bolditalic":ut={family:nt,weight:"bold",style:"italic"};break;case"":case"normal":ut={family:nt}}ut!==null&&(ut.ref={name:nt,style:Qe},Le.push(ut))})}),Le})(yt);at=(function(Ft){for(var Le={},nt=0;nt<Ft.length;++nt){var Qe=Mm(Ft[nt]),ut=Qe.family,wt=Qe.stretch,lt=Qe.style,et=Qe.weight;Le[ut]=Le[ut]||{},Le[ut][wt]=Le[ut][wt]||{},Le[ut][wt][lt]=Le[ut][wt][lt]||{},Le[ut][wt][lt][et]=Qe}return Le})(Rt.concat(on)),st=vt}return at})(this.pdf,this.fontFaces),Ne=Se.map(function(mt){return{family:mt,stretch:"normal",weight:ne,style:he}}),ze=(function(mt,on,yt){for(var vt=(yt=yt||{}).defaultFontFamily||"times",Rt=Object.assign({},V6,yt.genericFontFamilies||{}),Ft=null,Le=null,nt=0;nt<on.length;++nt)if(Rt[(Ft=Mm(on[nt])).family]&&(Ft.family=Rt[Ft.family]),mt.hasOwnProperty(Ft.family)){Le=mt[Ft.family];break}if(!(Le=Le||mt[vt]))throw new Error("Could not find a font-family for the rule '"+T5(Ft)+"' and default family '"+vt+"'.");if(Le=(function(Qe,ut){if(ut[Qe])return ut[Qe];var wt=pg[Qe],lt=wt<=pg.normal?-1:1,et=A5(ut,M_,wt,lt);if(!et)throw new Error("Could not find a matching font-stretch value for "+Qe);return et})(Ft.stretch,Le),Le=(function(Qe,ut){if(ut[Qe])return ut[Qe];for(var wt=L_[Qe],lt=0;lt<wt.length;++lt)if(ut[wt[lt]])return ut[wt[lt]];throw new Error("Could not find a matching font-style for "+Qe)})(Ft.style,Le),!(Le=(function(Qe,ut){if(ut[Qe])return ut[Qe];if(Qe===400&&ut[500])return ut[500];if(Qe===500&&ut[400])return ut[400];var wt=G6[Qe],lt=A5(ut,D_,wt,Qe<400?-1:1);if(!lt)throw new Error("Could not find a matching font-weight for value "+Qe);return lt})(Ft.weight,Le)))throw new Error("Failed to resolve a font for the rule '"+T5(Ft)+"'.");return Le})(He,Ne);this.pdf.setFont(ze.ref.name,ze.ref.style)}else{var We="";(ne==="bold"||parseInt(ne,10)>=700||he==="bold")&&(We="bold"),he==="italic"&&(We+="italic"),We.length===0&&(We="normal");for(var dt="",ft={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ht=0;ht<Se.length;ht++){if(this.pdf.internal.getFont(Se[ht],We,{noFallback:!0,disableWarning:!0})!==void 0){dt=Se[ht];break}if(We==="bolditalic"&&this.pdf.internal.getFont(Se[ht],"bold",{noFallback:!0,disableWarning:!0})!==void 0)dt=Se[ht],We="bold";else if(this.pdf.internal.getFont(Se[ht],"normal",{noFallback:!0,disableWarning:!0})!==void 0){dt=Se[ht],We="normal";break}}if(dt===""){for(var Et=0;Et<Se.length;Et++)if(ft[Se[Et]]){dt=ft[Se[Et]];break}}dt=dt===""?"Times":dt,this.pdf.setFont(dt,We)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(K){this.ctx.globalCompositeOperation=K}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(K){this.ctx.globalAlpha=K}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(K){this.ctx.lineDashOffset=K,G.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(K){this.ctx.lineDash=K,G.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(K){this.ctx.ignoreClearRect=!!K}})};v.prototype.setLineDash=function(O){this.lineDash=O},v.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},v.prototype.fill=function(){M.call(this,"fill",!1)},v.prototype.stroke=function(){M.call(this,"stroke",!1)},v.prototype.beginPath=function(){this.path=[{type:"begin"}]},v.prototype.moveTo=function(O,ee){if(isNaN(O)||isNaN(ee))throw Qn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var te=this.ctx.transform.applyToPoint(new l(O,ee));this.path.push({type:"mt",x:te.x,y:te.y}),this.ctx.lastPoint=new l(O,ee)},v.prototype.closePath=function(){var O=new l(0,0),ee=0;for(ee=this.path.length-1;ee!==-1;ee--)if(this.path[ee].type==="begin"&&qn(this.path[ee+1])==="object"&&typeof this.path[ee+1].x=="number"){O=new l(this.path[ee+1].x,this.path[ee+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(O.x,O.y)},v.prototype.lineTo=function(O,ee){if(isNaN(O)||isNaN(ee))throw Qn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var te=this.ctx.transform.applyToPoint(new l(O,ee));this.path.push({type:"lt",x:te.x,y:te.y}),this.ctx.lastPoint=new l(te.x,te.y)},v.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),M.call(this,null,!0)},v.prototype.quadraticCurveTo=function(O,ee,te,ce){if(isNaN(te)||isNaN(ce)||isNaN(O)||isNaN(ee))throw Qn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ye=this.ctx.transform.applyToPoint(new l(te,ce)),we=this.ctx.transform.applyToPoint(new l(O,ee));this.path.push({type:"qct",x1:we.x,y1:we.y,x:ye.x,y:ye.y}),this.ctx.lastPoint=new l(ye.x,ye.y)},v.prototype.bezierCurveTo=function(O,ee,te,ce,ye,we){if(isNaN(ye)||isNaN(we)||isNaN(O)||isNaN(ee)||isNaN(te)||isNaN(ce))throw Qn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Te=this.ctx.transform.applyToPoint(new l(ye,we)),Ce=this.ctx.transform.applyToPoint(new l(O,ee)),De=this.ctx.transform.applyToPoint(new l(te,ce));this.path.push({type:"bct",x1:Ce.x,y1:Ce.y,x2:De.x,y2:De.y,x:Te.x,y:Te.y}),this.ctx.lastPoint=new l(Te.x,Te.y)},v.prototype.arc=function(O,ee,te,ce,ye,we){if(isNaN(O)||isNaN(ee)||isNaN(te)||isNaN(ce)||isNaN(ye))throw Qn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(we=!!we,!this.ctx.transform.isIdentity){var Te=this.ctx.transform.applyToPoint(new l(O,ee));O=Te.x,ee=Te.y;var Ce=this.ctx.transform.applyToPoint(new l(0,te)),De=this.ctx.transform.applyToPoint(new l(0,0));te=Math.sqrt(Math.pow(Ce.x-De.x,2)+Math.pow(Ce.y-De.y,2))}Math.abs(ye-ce)>=2*Math.PI&&(ce=0,ye=2*Math.PI),this.path.push({type:"arc",x:O,y:ee,radius:te,startAngle:ce,endAngle:ye,counterclockwise:we})},v.prototype.arcTo=function(O,ee,te,ce,ye){throw new Error("arcTo not implemented.")},v.prototype.rect=function(O,ee,te,ce){if(isNaN(O)||isNaN(ee)||isNaN(te)||isNaN(ce))throw Qn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(O,ee),this.lineTo(O+te,ee),this.lineTo(O+te,ee+ce),this.lineTo(O,ee+ce),this.lineTo(O,ee),this.lineTo(O+te,ee),this.lineTo(O,ee)},v.prototype.fillRect=function(O,ee,te,ce){if(isNaN(O)||isNaN(ee)||isNaN(te)||isNaN(ce))throw Qn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var ye={};this.lineCap!=="butt"&&(ye.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ye.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(O,ee,te,ce),this.fill(),ye.hasOwnProperty("lineCap")&&(this.lineCap=ye.lineCap),ye.hasOwnProperty("lineJoin")&&(this.lineJoin=ye.lineJoin)}},v.prototype.strokeRect=function(O,ee,te,ce){if(isNaN(O)||isNaN(ee)||isNaN(te)||isNaN(ce))throw Qn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");A.call(this)||(this.beginPath(),this.rect(O,ee,te,ce),this.stroke())},v.prototype.clearRect=function(O,ee,te,ce){if(isNaN(O)||isNaN(ee)||isNaN(te)||isNaN(ce))throw Qn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(O,ee,te,ce))},v.prototype.save=function(O){O=typeof O!="boolean"||O;for(var ee=this.pdf.internal.getCurrentPageInfo().pageNumber,te=0;te<this.pdf.internal.getNumberOfPages();te++)this.pdf.setPage(te+1),this.pdf.internal.out("q");if(this.pdf.setPage(ee),O){this.ctx.fontSize=this.pdf.internal.getFontSize();var ce=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ce}},v.prototype.restore=function(O){O=typeof O!="boolean"||O;for(var ee=this.pdf.internal.getCurrentPageInfo().pageNumber,te=0;te<this.pdf.internal.getNumberOfPages();te++)this.pdf.setPage(te+1),this.pdf.internal.out("Q");this.pdf.setPage(ee),O&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},v.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var b=function(O){var ee,te,ce,ye;if(O.isCanvasGradient===!0&&(O=O.getColor()),!O)return{r:0,g:0,b:0,a:0,style:O};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(O))ee=0,te=0,ce=0,ye=0;else{var we=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(O);if(we!==null)ee=parseInt(we[1]),te=parseInt(we[2]),ce=parseInt(we[3]),ye=1;else if((we=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(O))!==null)ee=parseInt(we[1]),te=parseInt(we[2]),ce=parseInt(we[3]),ye=parseFloat(we[4]);else{if(ye=1,typeof O=="string"&&O.charAt(0)!=="#"){var Te=new N_(O);O=Te.ok?Te.toHex():"#000000"}O.length===4?(ee=O.substring(1,2),ee+=ee,te=O.substring(2,3),te+=te,ce=O.substring(3,4),ce+=ce):(ee=O.substring(1,3),te=O.substring(3,5),ce=O.substring(5,7)),ee=parseInt(ee,16),te=parseInt(te,16),ce=parseInt(ce,16)}}return{r:ee,g:te,b:ce,a:ye,style:O}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},A=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};v.prototype.fillText=function(O,ee,te,ce){if(isNaN(ee)||isNaN(te)||typeof O!="string")throw Qn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ce=isNaN(ce)?void 0:ce,!g.call(this)){var ye=le(this.ctx.transform.rotation),we=this.ctx.transform.scaleX;U.call(this,{text:O,x:ee,y:te,scale:we,angle:ye,align:this.textAlign,maxWidth:ce})}},v.prototype.strokeText=function(O,ee,te,ce){if(isNaN(ee)||isNaN(te)||typeof O!="string")throw Qn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!A.call(this)){ce=isNaN(ce)?void 0:ce;var ye=le(this.ctx.transform.rotation),we=this.ctx.transform.scaleX;U.call(this,{text:O,x:ee,y:te,scale:we,renderingMode:"stroke",angle:ye,align:this.textAlign,maxWidth:ce})}},v.prototype.measureText=function(O){if(typeof O!="string")throw Qn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var ee=this.pdf,te=this.pdf.internal.scaleFactor,ce=ee.internal.getFontSize(),ye=ee.getStringUnitWidth(O)*ce/ee.internal.scaleFactor;return new function(we){var Te=(we=we||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Te}}),this}({width:ye*=Math.round(96*te/72*1e4)/1e4})},v.prototype.scale=function(O,ee){if(isNaN(O)||isNaN(ee))throw Qn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var te=new u(O,0,0,ee,0,0);this.ctx.transform=this.ctx.transform.multiply(te)},v.prototype.rotate=function(O){if(isNaN(O))throw Qn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var ee=new u(Math.cos(O),Math.sin(O),-Math.sin(O),Math.cos(O),0,0);this.ctx.transform=this.ctx.transform.multiply(ee)},v.prototype.translate=function(O,ee){if(isNaN(O)||isNaN(ee))throw Qn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var te=new u(1,0,0,1,O,ee);this.ctx.transform=this.ctx.transform.multiply(te)},v.prototype.transform=function(O,ee,te,ce,ye,we){if(isNaN(O)||isNaN(ee)||isNaN(te)||isNaN(ce)||isNaN(ye)||isNaN(we))throw Qn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Te=new u(O,ee,te,ce,ye,we);this.ctx.transform=this.ctx.transform.multiply(Te)},v.prototype.setTransform=function(O,ee,te,ce,ye,we){O=isNaN(O)?1:O,ee=isNaN(ee)?0:ee,te=isNaN(te)?0:te,ce=isNaN(ce)?1:ce,ye=isNaN(ye)?0:ye,we=isNaN(we)?0:we,this.ctx.transform=new u(O,ee,te,ce,ye,we)};var _=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};v.prototype.drawImage=function(O,ee,te,ce,ye,we,Te,Ce,De){var $e=this.pdf.getImageProperties(O),at=1,st=1,B=1,K=1;ce!==void 0&&Ce!==void 0&&(B=Ce/ce,K=De/ye,at=$e.width/ce*Ce/ce,st=$e.height/ye*De/ye),we===void 0&&(we=ee,Te=te,ee=0,te=0),ce!==void 0&&Ce===void 0&&(Ce=ce,De=ye),ce===void 0&&Ce===void 0&&(Ce=$e.width,De=$e.height);var _e=this.ctx.transform.decompose(),he=le(_e.rotate.shx),ne=new u,ae=(ne=(ne=(ne=ne.multiply(_e.translate)).multiply(_e.skew)).multiply(_e.scale)).applyToRectangle(new c(we-ee*B,Te-te*K,ce*at,ye*st));if(this.autoPaging){for(var be,Me=C.call(this,ae),Se=[],He=0;He<Me.length;He+=1)Se.indexOf(Me[He])===-1&&Se.push(Me[He]);k(Se);for(var Ne=Se[0],ze=Se[Se.length-1],We=Ne;We<ze+1;We++){this.pdf.setPage(We);var dt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ft=We===1?this.posY+this.margin[0]:this.margin[0],ht=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Et=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],mt=We===1?0:ht+(We-2)*Et;if(this.ctx.clip_path.length!==0){var on=this.path;be=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=R(be,this.posX+this.margin[3],-mt+ft+this.ctx.prevPageLastElemOffset),P.call(this,"fill",!0),this.path=on}var yt=JSON.parse(JSON.stringify(ae));yt=R([yt],this.posX+this.margin[3],-mt+ft+this.ctx.prevPageLastElemOffset)[0];var vt=(We>Ne||We<ze)&&_.call(this);vt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],dt,Et,null).clip().discardPath()),this.pdf.addImage(O,"JPEG",yt.x,yt.y,yt.w,yt.h,null,null,he),vt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(O,"JPEG",ae.x,ae.y,ae.w,ae.h,null,null,he)};var C=function(O,ee,te){var ce=[];ee=ee||this.pdf.internal.pageSize.width,te=te||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ye=this.posY+this.ctx.prevPageLastElemOffset;switch(O.type){default:case"mt":case"lt":ce.push(Math.floor((O.y+ye)/te)+1);break;case"arc":ce.push(Math.floor((O.y+ye-O.radius)/te)+1),ce.push(Math.floor((O.y+ye+O.radius)/te)+1);break;case"qct":var we=pe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x,O.y);ce.push(Math.floor((we.y+ye)/te)+1),ce.push(Math.floor((we.y+we.h+ye)/te)+1);break;case"bct":var Te=Ie(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x2,O.y2,O.x,O.y);ce.push(Math.floor((Te.y+ye)/te)+1),ce.push(Math.floor((Te.y+Te.h+ye)/te)+1);break;case"rect":ce.push(Math.floor((O.y+ye)/te)+1),ce.push(Math.floor((O.y+O.h+ye)/te)+1)}for(var Ce=0;Ce<ce.length;Ce+=1)for(;this.pdf.internal.getNumberOfPages()<ce[Ce];)E.call(this);return ce},E=function(){var O=this.fillStyle,ee=this.strokeStyle,te=this.font,ce=this.lineCap,ye=this.lineWidth,we=this.lineJoin;this.pdf.addPage(),this.fillStyle=O,this.strokeStyle=ee,this.font=te,this.lineCap=ce,this.lineWidth=ye,this.lineJoin=we},R=function(O,ee,te){for(var ce=0;ce<O.length;ce++)switch(O[ce].type){case"bct":O[ce].x2+=ee,O[ce].y2+=te;case"qct":O[ce].x1+=ee,O[ce].y1+=te;default:O[ce].x+=ee,O[ce].y+=te}return O},k=function(O){return O.sort(function(ee,te){return ee-te})},M=function(O,ee){var te=this.fillStyle,ce=this.strokeStyle,ye=this.lineCap,we=this.lineWidth,Te=Math.abs(we*this.ctx.transform.scaleX),Ce=this.lineJoin;if(this.autoPaging){for(var De,$e,at=JSON.parse(JSON.stringify(this.path)),st=JSON.parse(JSON.stringify(this.path)),B=[],K=0;K<st.length;K++)if(st[K].x!==void 0)for(var _e=C.call(this,st[K]),he=0;he<_e.length;he+=1)B.indexOf(_e[he])===-1&&B.push(_e[he]);for(var ne=0;ne<B.length;ne++)for(;this.pdf.internal.getNumberOfPages()<B[ne];)E.call(this);k(B);for(var ae=B[0],be=B[B.length-1],Me=ae;Me<be+1;Me++){this.pdf.setPage(Me),this.fillStyle=te,this.strokeStyle=ce,this.lineCap=ye,this.lineWidth=Te,this.lineJoin=Ce;var Se=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],He=Me===1?this.posY+this.margin[0]:this.margin[0],Ne=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ze=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],We=Me===1?0:Ne+(Me-2)*ze;if(this.ctx.clip_path.length!==0){var dt=this.path;De=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=R(De,this.posX+this.margin[3],-We+He+this.ctx.prevPageLastElemOffset),P.call(this,O,!0),this.path=dt}if($e=JSON.parse(JSON.stringify(at)),this.path=R($e,this.posX+this.margin[3],-We+He+this.ctx.prevPageLastElemOffset),ee===!1||Me===0){var ft=(Me>ae||Me<be)&&_.call(this);ft&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Se,ze,null).clip().discardPath()),P.call(this,O,ee),ft&&this.pdf.restoreGraphicsState()}this.lineWidth=we}this.path=at}else this.lineWidth=Te,P.call(this,O,ee),this.lineWidth=we},P=function(O,ee){if((O!=="stroke"||ee||!A.call(this))&&(O==="stroke"||ee||!g.call(this))){for(var te,ce,ye=[],we=this.path,Te=0;Te<we.length;Te++){var Ce=we[Te];switch(Ce.type){case"begin":ye.push({begin:!0});break;case"close":ye.push({close:!0});break;case"mt":ye.push({start:Ce,deltas:[],abs:[]});break;case"lt":var De=ye.length;if(we[Te-1]&&!isNaN(we[Te-1].x)&&(te=[Ce.x-we[Te-1].x,Ce.y-we[Te-1].y],De>0)){for(;De>=0;De--)if(ye[De-1].close!==!0&&ye[De-1].begin!==!0){ye[De-1].deltas.push(te),ye[De-1].abs.push(Ce);break}}break;case"bct":te=[Ce.x1-we[Te-1].x,Ce.y1-we[Te-1].y,Ce.x2-we[Te-1].x,Ce.y2-we[Te-1].y,Ce.x-we[Te-1].x,Ce.y-we[Te-1].y],ye[ye.length-1].deltas.push(te);break;case"qct":var $e=we[Te-1].x+2/3*(Ce.x1-we[Te-1].x),at=we[Te-1].y+2/3*(Ce.y1-we[Te-1].y),st=Ce.x+2/3*(Ce.x1-Ce.x),B=Ce.y+2/3*(Ce.y1-Ce.y),K=Ce.x,_e=Ce.y;te=[$e-we[Te-1].x,at-we[Te-1].y,st-we[Te-1].x,B-we[Te-1].y,K-we[Te-1].x,_e-we[Te-1].y],ye[ye.length-1].deltas.push(te);break;case"arc":ye.push({deltas:[],abs:[],arc:!0}),Array.isArray(ye[ye.length-1].abs)&&ye[ye.length-1].abs.push(Ce)}}ce=ee?null:O==="stroke"?"stroke":"fill";for(var he=!1,ne=0;ne<ye.length;ne++)if(ye[ne].arc)for(var ae=ye[ne].abs,be=0;be<ae.length;be++){var Me=ae[be];Me.type==="arc"?$.call(this,Me.x,Me.y,Me.radius,Me.startAngle,Me.endAngle,Me.counterclockwise,void 0,ee,!he):q.call(this,Me.x,Me.y),he=!0}else if(ye[ne].close===!0)this.pdf.internal.out("h"),he=!1;else if(ye[ne].begin!==!0){var Se=ye[ne].start.x,He=ye[ne].start.y;I.call(this,ye[ne].deltas,Se,He),he=!0}ce&&j.call(this,ce),ee&&X.call(this)}},W=function(O){var ee=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,te=ee*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return O-te;case"top":return O+ee-te;case"hanging":return O+ee-2*te;case"middle":return O+ee/2-te;default:return O}},V=function(O){return O+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};v.prototype.createLinearGradient=function(){var O=function(){};return O.colorStops=[],O.addColorStop=function(ee,te){this.colorStops.push([ee,te])},O.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},O.isCanvasGradient=!0,O},v.prototype.createPattern=function(){return this.createLinearGradient()},v.prototype.createRadialGradient=function(){return this.createLinearGradient()};var $=function(O,ee,te,ce,ye,we,Te,Ce,De){for(var $e=J.call(this,te,ce,ye,we),at=0;at<$e.length;at++){var st=$e[at];at===0&&(De?z.call(this,st.x1+O,st.y1+ee):q.call(this,st.x1+O,st.y1+ee)),ie.call(this,O,ee,st.x2,st.y2,st.x3,st.y3,st.x4,st.y4)}Ce?X.call(this):j.call(this,Te)},j=function(O){switch(O){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},X=function(){this.pdf.clip(),this.pdf.discardPath()},z=function(O,ee){this.pdf.internal.out(n(O)+" "+i(ee)+" m")},U=function(O){var ee;switch(O.align){case"right":case"end":ee="right";break;case"center":ee="center";break;default:ee="left"}var te,ce,ye,we=this.pdf.getTextDimensions(O.text),Te=W.call(this,O.y),Ce=V.call(this,Te)-we.h,De=this.ctx.transform.applyToPoint(new l(O.x,Te));if(this.autoPaging){var $e=this.ctx.transform.decompose(),at=new u;at=(at=(at=at.multiply($e.translate)).multiply($e.skew)).multiply($e.scale);for(var st=this.ctx.transform.applyToRectangle(new c(O.x,Te,we.w,we.h)),B=at.applyToRectangle(new c(O.x,Ce,we.w,we.h)),K=C.call(this,B),_e=[],he=0;he<K.length;he+=1)_e.indexOf(K[he])===-1&&_e.push(K[he]);k(_e);for(var ne=_e[0],ae=_e[_e.length-1],be=ne;be<ae+1;be++){this.pdf.setPage(be);var Me=be===1?this.posY+this.margin[0]:this.margin[0],Se=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],He=this.pdf.internal.pageSize.height-this.margin[2],Ne=He-this.margin[0],ze=this.pdf.internal.pageSize.width-this.margin[1],We=ze-this.margin[3],dt=be===1?0:Se+(be-2)*Ne;if(this.ctx.clip_path.length!==0){var ft=this.path;te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=R(te,this.posX+this.margin[3],-1*dt+Me),P.call(this,"fill",!0),this.path=ft}var ht=R([JSON.parse(JSON.stringify(B))],this.posX+this.margin[3],-dt+Me+this.ctx.prevPageLastElemOffset)[0];O.scale>=.01&&(ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ce*O.scale),ye=this.lineWidth,this.lineWidth=ye*O.scale);var Et=this.autoPaging!=="text";if(Et||ht.y+ht.h<=He){if(Et||ht.y>=Me&&ht.x<=ze){var mt=Et?O.text:this.pdf.splitTextToSize(O.text,O.maxWidth||ze-ht.x)[0],on=R([JSON.parse(JSON.stringify(st))],this.posX+this.margin[3],-dt+Me+this.ctx.prevPageLastElemOffset)[0],yt=Et&&(be>ne||be<ae)&&_.call(this);yt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],We,Ne,null).clip().discardPath()),this.pdf.text(mt,on.x,on.y,{angle:O.angle,align:ee,renderingMode:O.renderingMode}),yt&&this.pdf.restoreGraphicsState()}}else ht.y<He&&(this.ctx.prevPageLastElemOffset+=He-ht.y);O.scale>=.01&&(this.pdf.setFontSize(ce),this.lineWidth=ye)}}else O.scale>=.01&&(ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ce*O.scale),ye=this.lineWidth,this.lineWidth=ye*O.scale),this.pdf.text(O.text,De.x+this.posX,De.y+this.posY,{angle:O.angle,align:ee,renderingMode:O.renderingMode,maxWidth:O.maxWidth}),O.scale>=.01&&(this.pdf.setFontSize(ce),this.lineWidth=ye)},q=function(O,ee,te,ce){te=te||0,ce=ce||0,this.pdf.internal.out(n(O+te)+" "+i(ee+ce)+" l")},I=function(O,ee,te){return this.pdf.lines(O,ee,te,null,null)},ie=function(O,ee,te,ce,ye,we,Te,Ce){this.pdf.internal.out([t(o(te+O)),t(a(ce+ee)),t(o(ye+O)),t(a(we+ee)),t(o(Te+O)),t(a(Ce+ee)),"c"].join(" "))},J=function(O,ee,te,ce){for(var ye=2*Math.PI,we=Math.PI/2;ee>te;)ee-=ye;var Te=Math.abs(te-ee);Te<ye&&ce&&(Te=ye-Te);for(var Ce=[],De=ce?-1:1,$e=ee;Te>1e-5;){var at=$e+De*Math.min(Te,we);Ce.push(Y.call(this,O,$e,at)),Te-=Math.abs(at-$e),$e=at}return Ce},Y=function(O,ee,te){var ce=(te-ee)/2,ye=O*Math.cos(ce),we=O*Math.sin(ce),Te=ye,Ce=-we,De=Te*Te+Ce*Ce,$e=De+Te*ye+Ce*we,at=4/3*(Math.sqrt(2*De*$e)-$e)/(Te*we-Ce*ye),st=Te-at*Ce,B=Ce+at*Te,K=st,_e=-B,he=ce+ee,ne=Math.cos(he),ae=Math.sin(he);return{x1:O*Math.cos(ee),y1:O*Math.sin(ee),x2:st*ne-B*ae,y2:st*ae+B*ne,x3:K*ne-_e*ae,y3:K*ae+_e*ne,x4:O*Math.cos(te),y4:O*Math.sin(te)}},le=function(O){return 180*O/Math.PI},pe=function(O,ee,te,ce,ye,we){var Te=O+.5*(te-O),Ce=ee+.5*(ce-ee),De=ye+.5*(te-ye),$e=we+.5*(ce-we),at=Math.min(O,ye,Te,De),st=Math.max(O,ye,Te,De),B=Math.min(ee,we,Ce,$e),K=Math.max(ee,we,Ce,$e);return new c(at,B,st-at,K-B)},Ie=function(O,ee,te,ce,ye,we,Te,Ce){var De,$e,at,st,B,K,_e,he,ne,ae,be,Me,Se,He,Ne=te-O,ze=ce-ee,We=ye-te,dt=we-ce,ft=Te-ye,ht=Ce-we;for($e=0;$e<41;$e++)ne=(_e=(at=O+(De=$e/40)*Ne)+De*((B=te+De*We)-at))+De*(B+De*(ye+De*ft-B)-_e),ae=(he=(st=ee+De*ze)+De*((K=ce+De*dt)-st))+De*(K+De*(we+De*ht-K)-he),$e==0?(be=ne,Me=ae,Se=ne,He=ae):(be=Math.min(be,ne),Me=Math.min(Me,ae),Se=Math.max(Se,ne),He=Math.max(He,ae));return new c(Math.round(be),Math.round(Me),Math.round(Se-be),Math.round(He-Me))},G=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var O,ee,te=(O=this.ctx.lineDash,ee=this.ctx.lineDashOffset,JSON.stringify({lineDash:O,lineDashOffset:ee}));this.prevLineDash!==te&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=te)}}})(Dt.API),(function(e){var t=function(l){var c,u,d,h,v,b,g,A,_,C;for(u=[],d=0,h=(l+=c="\0\0\0\0".slice(l.length%4||4)).length;h>d;d+=4)(v=(l.charCodeAt(d)<<24)+(l.charCodeAt(d+1)<<16)+(l.charCodeAt(d+2)<<8)+l.charCodeAt(d+3))!==0?(b=(v=((v=((v=((v=(v-(C=v%85))/85)-(_=v%85))/85)-(A=v%85))/85)-(g=v%85))/85)%85,u.push(b+33,g+33,A+33,_+33,C+33)):u.push(122);return(function(E,R){for(var k=R;k>0;k--)E.pop()})(u,c.length),String.fromCharCode.apply(String,u)+"~>"},n=function(l){var c,u,d,h,v,b=String,g="length",A=255,_="charCodeAt",C="slice",E="replace";for(l[C](-2),l=l[C](0,-2)[E](/\s/g,"")[E]("z","!!!!!"),d=[],h=0,v=(l+=c="uuuuu"[C](l[g]%5||5))[g];v>h;h+=5)u=52200625*(l[_](h)-33)+614125*(l[_](h+1)-33)+7225*(l[_](h+2)-33)+85*(l[_](h+3)-33)+(l[_](h+4)-33),d.push(A&u>>24,A&u>>16,A&u>>8,A&u);return(function(R,k){for(var M=k;M>0;M--)R.pop()})(d,c[g]),b.fromCharCode.apply(b,d)},i=function(l){return l.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">"},o=function(l){var c=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((l=l.replace(/\s/g,"")).indexOf(">")!==-1&&(l=l.substr(0,l.indexOf(">"))),l.length%2&&(l+="0"),c.test(l)===!1)return"";for(var u="",d=0;d<l.length;d+=2)u+=String.fromCharCode("0x"+(l[d]+l[d+1]));return u},a=function(l){for(var c=new Uint8Array(l.length),u=l.length;u--;)c[u]=l.charCodeAt(u);return(c=sg(c)).reduce(function(d,h){return d+String.fromCharCode(h)},"")};e.processDataByFilters=function(l,c){var u=0,d=l||"",h=[];for(typeof(c=c||[])=="string"&&(c=[c]),u=0;u<c.length;u+=1)switch(c[u]){case"ASCII85Decode":case"/ASCII85Decode":d=n(d),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=t(d),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=o(d),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=i(d),h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=a(d),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+c[u]+'" is not implemented')}return{data:d,reverseChain:h.reverse().join(" ")}}})(Dt.API),(function(e){e.loadFile=function(t,n,i){return(function(o,a,l){a=a!==!1,l=typeof l=="function"?l:function(){};var c=void 0;try{c=(function(u,d,h){var v=new XMLHttpRequest,b=0,g=function(A){var _=A.length,C=[],E=String.fromCharCode;for(b=0;b<_;b+=1)C.push(E(255&A.charCodeAt(b)));return C.join("")};if(v.open("GET",u,!d),v.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(v.onload=function(){v.status===200?h(g(this.responseText)):h(void 0)}),v.send(null),d&&v.status===200)return g(v.responseText)})(o,a,l)}catch{}return c})(t,n,i)},e.allowFsRead=void 0,e.loadImageFile=e.loadFile})(Dt.API),(function(e){function t(){return(Xt.html2canvas?Promise.resolve(Xt.html2canvas):mm(()=>import("./html2canvas.esm-QH1iLAAe.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load html2canvas: "+c))}).then(function(c){return c.default?c.default:c})}function n(){return(Xt.DOMPurify?Promise.resolve(Xt.DOMPurify):mm(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load dompurify: "+c))}).then(function(c){return c.default?c.default:c})}var i=function(c){var u=qn(c);return u==="undefined"?"undefined":u==="string"||c instanceof String?"string":u==="number"||c instanceof Number?"number":u==="function"||c instanceof Function?"function":c&&c.constructor===Array?"array":c&&c.nodeType===1?"element":u==="object"?"object":"unknown"},o=function(c,u){var d=document.createElement(c);for(var h in u.className&&(d.className=u.className),u.innerHTML&&u.dompurify&&(d.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)d.style[h]=u.style[h];return d},a=function c(u,d){for(var h=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),v=u.firstChild;v;v=v.nextSibling)d!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||h.appendChild(c(v,d));return u.nodeType===1&&(u.nodeName==="CANVAS"?(h.width=u.width,h.height=u.height,h.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(h.value=u.value),h.addEventListener("load",function(){h.scrollTop=u.scrollTop,h.scrollLeft=u.scrollLeft},!0)),h},l=function c(u){var d=Object.assign(c.convert(Promise.resolve()),JSON.parse(JSON.stringify(c.template))),h=c.convert(Promise.resolve(),d);return(h=h.setProgress(1,c,1,[c])).set(u)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(c,u){return c.__proto__=u||l.prototype,c},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(c,u){return this.then(function(){switch(u=u||(function(d){switch(i(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(c),u){case"string":return this.then(n).then(function(d){return this.set({src:o("div",{innerHTML:c,dompurify:d})})});case"element":return this.set({src:c});case"canvas":return this.set({canvas:c});case"img":return this.set({img:c});default:return this.error("Unknown source type.")}})},l.prototype.to=function(c){switch(c){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var c={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(c.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=o("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=o("div",{className:"html2pdf__container",style:c}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(o("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},l.prototype.toCanvas=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(t).then(function(u){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,u(this.prop.container,d)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},l.prototype.toContext2d=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(t).then(function(u){var d=this.opt.jsPDF,h=this.opt.fontFaces,v=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,b=Object.assign({async:!0,allowTaint:!0,scale:v,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete b.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=h,h)for(var g=0;g<h.length;++g){var A=h[g],_=A.src.find(function(C){return C.format==="truetype"});_&&d.addFont(_.url,A.ref.name,A.ref.style)}return b.windowHeight=b.windowHeight||0,b.windowHeight=b.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):b.windowHeight,d.context2d.save(!0),u(this.prop.container,b)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var c=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=c})},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},l.prototype.output=function(c,u,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(c,u):this.outputPdf(c,u)},l.prototype.outputPdf=function(c,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(c,u)})},l.prototype.outputImg=function(c){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(c){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+c+'" is not supported.'}})},l.prototype.save=function(c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(c?{filename:c}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},l.prototype.set=function(c){if(i(c)!=="object")return this;var u=Object.keys(c||{}).map(function(d){if(d in l.template.prop)return function(){this.prop[d]=c[d]};switch(d){case"margin":return this.setMargin.bind(this,c.margin);case"jsPDF":return function(){return this.opt.jsPDF=c.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,c.pageSize);default:return function(){this.opt[d]=c[d]}}},this);return this.then(function(){return this.thenList(u)})},l.prototype.get=function(c,u){return this.then(function(){var d=c in l.template.prop?this.prop[c]:this.opt[c];return u?u(d):d})},l.prototype.setMargin=function(c){return this.then(function(){switch(i(c)){case"number":c=[c,c,c,c];case"array":if(c.length===2&&(c=[c[0],c[1],c[0],c[1]]),c.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=c}).then(this.setPageSize)},l.prototype.setPageSize=function(c){function u(d,h){return Math.floor(d*h/72*96)}return this.then(function(){(c=c||Dt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(c.inner={width:c.width-this.opt.margin[1]-this.opt.margin[3],height:c.height-this.opt.margin[0]-this.opt.margin[2]},c.inner.px={width:u(c.inner.width,c.k),height:u(c.inner.height,c.k)},c.inner.ratio=c.inner.height/c.inner.width),this.prop.pageSize=c})},l.prototype.setProgress=function(c,u,d,h){return c!=null&&(this.progress.val=c),u!=null&&(this.progress.state=u),d!=null&&(this.progress.n=d),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(c,u,d,h){return this.setProgress(c?this.progress.val+c:null,u||null,d?this.progress.n+d:null,h?this.progress.stack.concat(h):null)},l.prototype.then=function(c,u){var d=this;return this.thenCore(c,u,function(h,v){return d.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,function(b){return d.updateProgress(null,h),b}).then(h,v).then(function(b){return d.updateProgress(1),b})})},l.prototype.thenCore=function(c,u,d){d=d||Promise.prototype.then;var h=this;c&&(c=c.bind(h)),u&&(u=u.bind(h));var v=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?h:l.convert(Object.assign({},h),Promise.prototype),b=d.call(v,c,u);return l.convert(b,h.__proto__)},l.prototype.thenExternal=function(c,u){return Promise.prototype.then.call(this,c,u)},l.prototype.thenList=function(c){var u=this;return c.forEach(function(d){u=u.thenCore(d)}),u},l.prototype.catch=function(c){c&&(c=c.bind(this));var u=Promise.prototype.catch.call(this,c);return l.convert(u,this)},l.prototype.catchExternal=function(c){return Promise.prototype.catch.call(this,c)},l.prototype.error=function(c){return this.then(function(){throw new Error(c)})},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,Dt.getPageSize=function(c,u,d){if(qn(c)==="object"){var h=c;c=h.orientation,u=h.unit||u,d=h.format||d}u=u||"mm",d=d||"a4",c=(""+(c||"P")).toLowerCase();var v,b=(""+d).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":v=1;break;case"mm":v=72/25.4;break;case"cm":v=72/2.54;break;case"in":v=72;break;case"px":v=.75;break;case"pc":case"em":v=12;break;case"ex":v=6;break;default:throw"Invalid unit: "+u}var A,_=0,C=0;if(g.hasOwnProperty(b))_=g[b][1]/v,C=g[b][0]/v;else try{_=d[1],C=d[0]}catch{throw new Error("Invalid format: "+d)}if(c==="p"||c==="portrait")c="p",C>_&&(A=C,C=_,_=A);else{if(c!=="l"&&c!=="landscape")throw"Invalid orientation: "+c;c="l",_>C&&(A=C,C=_,_=A)}return{width:C,height:_,unit:u,k:v,orientation:c}},e.html=function(c,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(Mm):null;var d=new l(u);return u.worker?d:d.from(c).doCallback()}})(Dt.API),Dt.API.addJS=function(e){var t,n,i=e;return this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(t+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),n=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+i+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){t!==void 0&&n!==void 0&&this.internal.out("/Names <</JavaScript "+t+" 0 R>>")}),this},(function(e){var t;e.events.push(["postPutResources",function(){var n=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var o=n.outline.render().split(/\r\n/),a=0;a<o.length;a++){var l=o[a],c=i.exec(l);if(c!=null){var u=c[1];n.internal.newObjectDeferredBegin(u,!1)}n.internal.write(l)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,h=[];for(a=0;a<d;a++){var v=n.internal.newObject();h.push(v);var b=n.internal.getPageInfo(a+1);n.internal.write("<< /D["+b.objId+" 0 R /XYZ null null null]>> endobj")}var g=n.internal.newObject();for(n.internal.write("<< /Names [ "),a=0;a<h.length;a++)n.internal.write("(page_"+(a+1)+")"+h[a]+" 0 R");n.internal.write(" ] >>","endobj"),t=n.internal.newObject(),n.internal.write("<< /Dests "+g+" 0 R"),n.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(i,o,a){var l={title:o,options:a,children:[]};return i==null&&(i=this.root),i.children.push(l),l},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(i){i.id=n.internal.newObjectDeferred();for(var o=0;o<i.children.length;o++)this.genIds_r(i.children[o])},n.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},n.outline.renderItems=function(i){for(var o=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<i.children.length;a++){var l=i.children[a];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(i)),a>0&&this.line("/Prev "+this.makeRef(i.children[a-1])),a<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[a+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var c=this.count=this.count_r({count:0},l);if(c>0&&this.line("/Count "+c),l.options&&l.options.pageNumber){var u=n.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+o(0)+" 0]")}this.objEnd()}for(var d=0;d<i.children.length;d++)this.renderItems(i.children[d])},n.outline.line=function(i){this.ctx.val+=i+`\r
`},n.outline.makeRef=function(i){return i.id+" 0 R"},n.outline.makeString=function(i){return"("+n.internal.pdfEscape(i)+")"},n.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(i,o){for(var a=0;a<o.children.length;a++)i.count++,this.count_r(i,o.children[a]);return i.count}}])})(Dt.API),(function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(n,i,o,a,l,c){var u,d=this.decode.DCT_DECODE,h=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=l||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,u=(function(v){for(var b,g=256*v.charCodeAt(4)+v.charCodeAt(5),A=v.length,_={width:0,height:0,numcomponents:1},C=4;C<A;C+=2){if(C+=g,t.indexOf(v.charCodeAt(C+1))!==-1){b=256*v.charCodeAt(C+5)+v.charCodeAt(C+6),_={width:256*v.charCodeAt(C+7)+v.charCodeAt(C+8),height:b,numcomponents:v.charCodeAt(C+9)};break}g=256*v.charCodeAt(C+2)+v.charCodeAt(C+3)}return _})(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),u.numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}h={data:n,width:u.width,height:u.height,colorSpace:c,bitsPerComponent:8,filter:d,index:i,alias:o}}return h}})(Dt.API),Dt.API.processPNG=function(e,t,n,i){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var o,a=I6(e,{checkCrc:!0}),l=a.width,c=a.height,u=a.channels,d=a.palette,h=a.depth;o=d&&u===1?(function($){for(var j=$.width,X=$.height,z=$.data,U=$.palette,q=$.depth,I=!1,ie=[],J=[],Y=void 0,le=!1,pe=0,Ie=0;Ie<U.length;Ie++){var G=P2(U[Ie],4),O=G[0],ee=G[1],te=G[2],ce=G[3];ie.push(O,ee,te),ce!=null&&(ce===0?(pe++,J.length<1&&J.push(Ie)):ce<255&&(le=!0))}if(le||pe>1){I=!0,J=void 0;var ye=j*X;Y=new Uint8Array(ye);for(var we=new DataView(z.buffer),Te=0;Te<ye;Te++){var Ce=Pm(we,Te,q),De=P2(U[Ce],4)[3];Y[Te]=De}}else pe===0&&(J=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:I?8:void 0,colorBytes:z,alphaBytes:Y,needSMask:I,palette:ie,mask:J}})(a):u===2||u===4?(function($){for(var j=$.data,X=$.width,z=$.height,U=$.channels,q=$.depth,I=U===2?"DeviceGray":"DeviceRGB",ie=U-1,J=X*z,Y=ie,le=J*Y,pe=1*J,Ie=Math.ceil(le*q/8),G=Math.ceil(pe*q/8),O=new Uint8Array(Ie),ee=new Uint8Array(G),te=new DataView(j.buffer),ce=new DataView(O.buffer),ye=new DataView(ee.buffer),we=!1,Te=0;Te<J;Te++){for(var Ce=Te*U,De=0;De<Y;De++)z5(ce,Pm(te,Ce+De,q),Te*Y+De,q);var $e=Pm(te,Ce+Y,q);$e<(1<<q)-1&&(we=!0),z5(ye,$e,1*Te,q)}return{colorSpace:I,colorsPerPixel:ie,sMaskBitsPerComponent:we?q:void 0,colorBytes:O,alphaBytes:ee,needSMask:we}})(a):(function($){var j=$.data,X=$.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:X,colorsPerPixel:X==="DeviceGray"?1:3,colorBytes:j instanceof Uint16Array?(function(z){for(var U=z.length,q=new Uint8Array(2*U),I=new DataView(q.buffer,q.byteOffset,q.byteLength),ie=0;ie<U;ie++)I.setUint16(2*ie,z[ie],!1);return q})(j):j,needSMask:!1}})(a);var v,b,g,A=o,_=A.colorSpace,C=A.colorsPerPixel,E=A.sMaskBitsPerComponent,R=A.colorBytes,k=A.alphaBytes,M=A.needSMask,P=A.palette,W=A.mask,V=null;return i!==Dt.API.image_compression.NONE&&typeof sg=="function"?(V=(function($){var j;switch($){case Dt.API.image_compression.FAST:j=11;break;case Dt.API.image_compression.MEDIUM:j=13;break;case Dt.API.image_compression.SLOW:j=14;break;default:j=12}return j})(i),v=this.decode.FLATE_DECODE,b="/Predictor ".concat(V," /Colors ").concat(C," /BitsPerComponent ").concat(h," /Columns ").concat(l),e=M5(R,Math.ceil(l*C*h/8),C,h,i),M&&(g=M5(k,Math.ceil(l*E/8),1,E,i))):(v=void 0,b=void 0,e=R,M&&(g=k)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(g&&this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),{alias:n,data:e,index:t,filter:v,decodeParameters:b,transparency:W,palette:P,sMask:g,predictor:V,width:l,height:c,bitsPerComponent:h,sMaskBitsPerComponent:E,colorSpace:_}}},(function(e){e.processGIF89A=function(t,n,i,o){var a=new K6(t),l=a.width,c=a.height,u=[];a.decodeAndBlitFrameRGBA(0,u);var d={data:u,width:l,height:c},h=new Om(100).encode(d,100);return e.processJPEG.call(this,h,n,i,o)},e.processGIF87A=e.processGIF89A})(Dt.API),Ca.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:o,green:i,blue:n,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ca.prototype.parseBGR=function(){this.pos=this.offset;var e="bit"+this.bitPP,t=this.width*this.height*4;if(t>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(t);try{this[e]()}catch(n){Qn.log("bit decode error:"+n)}},Ca.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var i=this.bottom_up?e:this.height-1-e,o=0;o<t;o++)for(var a=this.datav.getUint8(this.pos++,!0),l=i*this.width*4+8*o*4,c=0;c<8&&8*o+c<this.width;c++){var u=this.palette[a>>7-c&1];this.data[l+4*c]=u.blue,this.data[l+4*c+1]=u.green,this.data[l+4*c+2]=u.red,this.data[l+4*c+3]=255}n!==0&&(this.pos+=4-n)}},Ca.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,o=0;o<e;o++){var a=this.datav.getUint8(this.pos++,!0),l=i*this.width*4+2*o*4,c=a>>4,u=15&a,d=this.palette[c];if(this.data[l]=d.blue,this.data[l+1]=d.green,this.data[l+2]=d.red,this.data[l+3]=255,2*o+1>=this.width)break;d=this.palette[u],this.data[l+4]=d.blue,this.data[l+4+1]=d.green,this.data[l+4+2]=d.red,this.data[l+4+3]=255}t!==0&&(this.pos+=4-t)}},Ca.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var o=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+4*i;if(o<this.palette.length){var l=this.palette[o];this.data[a]=l.red,this.data[a+1]=l.green,this.data[a+2]=l.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}e!==0&&(this.pos+=4-e)}},Ca.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(a&t)/t*255|0,c=(a>>5&t)/t*255|0,u=(a>>10&t)/t*255|0,d=a>>15?255:0,h=i*this.width*4+4*o;this.data[h]=u,this.data[h+1]=c,this.data[h+2]=l,this.data[h+3]=d}this.pos+=e}},Ca.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var o=this.bottom_up?i:this.height-1-i,a=0;a<this.width;a++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(l&t)/t*255|0,u=(l>>5&n)/n*255|0,d=(l>>11)/t*255|0,h=o*this.width*4+4*a;this.data[h]=d,this.data[h+1]=u,this.data[h+2]=c,this.data[h+3]=255}this.pos+=e}},Ca.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*n;this.data[l]=a,this.data[l+1]=o,this.data[l+2]=i,this.data[l+3]=255}this.pos+=this.width%4}},Ca.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),c=t*this.width*4+4*n;this.data[c]=a,this.data[c+1]=o,this.data[c+2]=i,this.data[c+3]=l}},Ca.prototype.getData=function(){return this.data},(function(e){e.processBMP=function(t,n,i,o){var a=new Ca(t,!1),l=a.width,c=a.height,u={data:a.getData(),width:l,height:c},d=new Om(100).encode(u,100);return e.processJPEG.call(this,d,n,i,o)}})(Dt.API),F5.prototype.getData=function(){return this.data},(function(e){e.processWEBP=function(t,n,i,o){var a=new F5(t),l=a.width,c=a.height,u={data:a.getData(),width:l,height:c},d=new Om(100).encode(u,100);return e.processJPEG.call(this,d,n,i,o)}})(Dt.API),Dt.API.processRGBA=function(e,t,n){for(var i=e.data,o=i.length,a=new Uint8Array(o/4*3),l=new Uint8Array(o/4),c=0,u=0,d=0;d<o;d+=4){var h=i[d],v=i[d+1],b=i[d+2],g=i[d+3];a[c++]=h,a[c++]=v,a[c++]=b,l[u++]=g}var A=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:A,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Dt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ku=Dt.API,Nh=ku.getCharWidthsArray=function(e,t){var n,i,o=(t=t||{}).font||this.internal.getFont(),a=t.fontSize||this.internal.getFontSize(),l=t.charSpace||this.internal.getCharSpace(),c=t.widths?t.widths:o.metadata.Unicode.widths,u=c.fof?c.fof:1,d=t.kerning?t.kerning:o.metadata.Unicode.kerning,h=d.fof?d.fof:1,v=t.doKerning!==!1,b=0,g=e.length,A=0,_=c[0]||u,C=[];for(n=0;n<g;n++)i=e.charCodeAt(n),typeof o.metadata.widthOfString=="function"?C.push((o.metadata.widthOfGlyph(o.metadata.characterToGlyph(i))+l*(1e3/a)||0)/1e3):(b=v&&qn(d[i])==="object"&&!isNaN(parseInt(d[i][A],10))?d[i][A]/h:0,C.push((c[i]||_)/u+b)),A=i;return C},I5=ku.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),i=t.font||this.internal.getFont(),o=t.charSpace||this.internal.getCharSpace();return ku.processArabic&&(e=ku.processArabic(e)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(e,n,o)/n:Nh.apply(this,arguments).reduce(function(a,l){return a+l},0)},R5=function(e,t,n,i){for(var o=[],a=0,l=e.length,c=0;a!==l&&c+t[a]<n;)c+=t[a],a++;o.push(e.slice(0,a));var u=a;for(c=0;a!==l;)c+t[a]>i&&(o.push(e.slice(u,a)),c=0,u=a),c+=t[a],a++;return u!==a&&o.push(e.slice(u,a)),o},L5=function(e,t,n){n||(n={});var i,o,a,l,c,u,d,h=[],v=[h],b=n.textIndent||0,g=0,A=0,_=e.split(" "),C=Nh.apply(this,[" ",n])[0];if(u=n.lineIndent===-1?_[0].length+2:n.lineIndent||0){var E=Array(u).join(" "),R=[];_.map(function(M){(M=M.split(/\s*\n/)).length>1?R=R.concat(M.map(function(P,W){return(W&&P.length?`
`:"")+P})):R.push(M[0])}),_=R,u=I5.apply(this,[E,n])}for(a=0,l=_.length;a<l;a++){var k=0;if(i=_[a],u&&i[0]==`
`&&(i=i.substr(1),k=1),b+g+(A=(o=Nh.apply(this,[i,n])).reduce(function(M,P){return M+P},0))>t||k){if(A>t){for(c=R5.apply(this,[i,o,t-(b+g),t]),h.push(c.shift()),h=[c.pop()];c.length;)v.push([c.shift()]);A=o.slice(i.length-(h[0]?h[0].length:0)).reduce(function(M,P){return M+P},0)}else h=[i];v.push(h),b=A+u,g=C}else h.push(i),b+=g+A,g=C}return d=u?function(M,P){return(P?E:"")+M.join(" ")}:function(M){return M.join(" ")},v.map(d)},ku.splitTextToSize=function(e,t,n){var i,o=(n=n||{}).fontSize||this.internal.getFontSize(),a=(function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var v=this.internal.getFont(h.fontName,h.fontStyle),b="Unicode";return v.metadata[b]?{widths:v.metadata[b].widths||{0:1},kerning:v.metadata[b].kerning||{}}:{font:v.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);i=Array.isArray(e)?e:String(e).split(/\r?\n/);var l=1*this.internal.scaleFactor*t/o;a.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/o:0,a.lineIndent=n.lineIndent;var c,u,d=[];for(c=0,u=i.length;c<u;c++)d=d.concat(L5.apply(this,[i[c],l,a]));return d},(function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",n="klmnopqrstuvwxyz",i={},o={},a=0;a<16;a++)i[n[a]]=t[a],o[t[a]]=n[a];var l=function(b){return"0x"+parseInt(b,10).toString(16)},c=e.__fontmetrics__.compress=function(b){var g,A,_,C,E=["{"];for(var R in b){if(g=b[R],isNaN(parseInt(R,10))?A="'"+R+"'":(R=parseInt(R,10),A=(A=l(R).slice(2)).slice(0,-1)+o[A.slice(-1)]),typeof g=="number")g<0?(_=l(g).slice(3),C="-"):(_=l(g).slice(2),C=""),_=C+_.slice(0,-1)+o[_.slice(-1)];else{if(qn(g)!=="object")throw new Error("Don't know what to do with value type "+qn(g)+".");_=c(g)}E.push(A+_)}return E.push("}"),E.join("")},u=e.__fontmetrics__.uncompress=function(b){if(typeof b!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,A,_,C,E={},R=1,k=E,M=[],P="",W="",V=b.length-1,$=1;$<V;$+=1)(C=b[$])=="'"?g?(_=g.join(""),g=void 0):g=[]:g?g.push(C):C=="{"?(M.push([k,_]),k={},_=void 0):C=="}"?((A=M.pop())[0][A[1]]=k,_=void 0,k=A[0]):C=="-"?R=-1:_===void 0?i.hasOwnProperty(C)?(P+=i[C],_=parseInt(P,16)*R,R=1,P=""):P+=C:i.hasOwnProperty(C)?(W+=i[C],k[_]=parseInt(W,16)*R,R=1,_=void 0,W=""):W+=C;return E},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},v={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(b){var g=b.font,A=v.Unicode[g.postScriptName];A&&(g.metadata.Unicode={},g.metadata.Unicode.widths=A.widths,g.metadata.Unicode.kerning=A.kerning);var _=h.Unicode[g.postScriptName];_&&(g.metadata.Unicode.encoding=_,g.encoding=_.codePages[0])}])})(Dt.API),(function(e){var t=function(n){for(var i=n.length,o=new Uint8Array(i),a=0;a<i;a++)o[a]=n.charCodeAt(a);return o};e.API.events.push(["addFont",function(n){var i=void 0,o=n.font,a=n.instance;if(!o.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");if(typeof(i=a.existsFileInVFS(o.postScriptName)===!1?a.loadFile(o.postScriptName):a.getFileFromVFS(o.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");(function(l,c){c=/^\x00\x01\x00\x00/.test(c)?t(c):t(Vh(c)),l.metadata=e.API.TTFFont.open(c),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(o,i)}}])})(Dt),Dt.API.addSvgAsImage=function(e,t,n,i,o,a,l,c){if(isNaN(t)||isNaN(n))throw Qn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(o))throw Qn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=i,u.height=o;var d=u.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,u.width,u.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},v=this;return(Xt.canvg?Promise.resolve(Xt.canvg):mm(()=>import("./index.es-BYnD-aUu.js"),[])).catch(function(b){return Promise.reject(new Error("Could not load canvg: "+b))}).then(function(b){return b.default?b.default:b}).then(function(b){return b.fromString(d,e,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(b){return b.render(h)}).then(function(){v.addImage(u.toDataURL("image/jpeg",1),t,n,i,o,l,c)})},Dt.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var o=0;o<this.internal.pages[i].length;o++)this.internal.pages[i][o]=this.internal.pages[i][o].replace(t,n);return this},Dt.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var i,o,a,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(l),u=[],d=0,h=0,v=0;function b(A,_){var C,E=!1;for(C=0;C<A.length;C+=1)A[C]===_&&(E=!0);return E}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var g=c.length;for(v=0;v<g;v+=1)n[c[v]].value=n[c[v]].defaultValue,n[c[v]].explicitSet=!1}if(qn(e)==="object"){for(o in e)if(a=e[o],b(c,o)&&a!==void 0){if(n[o].type==="boolean"&&typeof a=="boolean")n[o].value=a;else if(n[o].type==="name"&&b(n[o].valueSet,a))n[o].value=a;else if(n[o].type==="integer"&&Number.isInteger(a))n[o].value=a;else if(n[o].type==="array"){for(d=0;d<a.length;d+=1)if(i=!0,a[d].length===1&&typeof a[d][0]=="number")u.push(String(a[d]-1));else if(a[d].length>1){for(h=0;h<a[d].length;h+=1)typeof a[d][h]!="number"&&(i=!1);i===!0&&u.push([a[d][0]-1,a[d][1]-1].join(" "))}n[o].value="["+u.join(" ")+"]"}else n[o].value=n[o].defaultValue;n[o].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var A,_=[];for(A in n)n[A].explicitSet===!0&&(n[A].type==="name"?_.push("/"+A+" /"+n[A].value):_.push("/"+A+" "+n[A].value));_.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+_.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},Dt.API.addMetadata=function(e,t){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:e,namespaceUri:t??"http://jspdf.default.namespaceuri/",rawXml:typeof t=="boolean"&&t},this.internal.events.subscribe("putCatalog",Q6),this.internal.events.subscribe("postPutResources",Z6)),this},(function(e){var t=e.API,n=t.pdfEscape16=function(a,l){for(var c,u=l.metadata.Unicode.widths,d=["","0","00","000","0000"],h=[""],v=0,b=a.length;v<b;++v){if(c=l.metadata.characterToGlyph(a.charCodeAt(v)),l.metadata.glyIdsUsed.push(c),l.metadata.toUnicode[c]=a.charCodeAt(v),u.indexOf(c)==-1&&(u.push(c),u.push([parseInt(l.metadata.widthOfGlyph(c),10)])),c=="0")return h.join("");c=c.toString(16),h.push(d[4-c.length],c)}return h.join("")},i=function(a){var l,c,u,d,h,v,b;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],v=0,b=(c=Object.keys(a).sort(function(g,A){return g-A})).length;v<b;v++)l=c[v],u.length>=100&&(h+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),a[l]!==void 0&&a[l]!==null&&typeof a[l].toString=="function"&&(d=("0000"+a[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),u.push("<"+l+"><"+d+">"));return u.length&&(h+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),h+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(a){(function(l){var c=l.font,u=l.out,d=l.newObject,h=l.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="Identity-H"){for(var v=c.metadata.Unicode.widths,b=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),g="",A=0;A<b.length;A++)g+=String.fromCharCode(b[A]);var _=d();h({data:g,addLength1:!0,objectId:_}),u("endobj");var C=d();h({data:i(c.metadata.toUnicode),addLength1:!0,objectId:C}),u("endobj");var E=d();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+Mu(c.fontName)),u("/FontFile2 "+_+" 0 R"),u("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),u("/Flags "+c.metadata.flags),u("/StemV "+c.metadata.stemV),u("/ItalicAngle "+c.metadata.italicAngle),u("/Ascent "+c.metadata.ascender),u("/Descent "+c.metadata.decender),u("/CapHeight "+c.metadata.capHeight),u(">>"),u("endobj");var R=d();u("<<"),u("/Type /Font"),u("/BaseFont /"+Mu(c.fontName)),u("/FontDescriptor "+E+" 0 R"),u("/W "+e.API.PDFObject.convert(v)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+c.encoding+")"),u(">>"),u(">>"),u("endobj"),c.objectNumber=d(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+C+" 0 R"),u("/BaseFont /"+Mu(c.fontName)),u("/Encoding /"+c.encoding),u("/DescendantFonts ["+R+" 0 R]"),u(">>"),u("endobj"),c.isAlreadyPutted=!0}})(a)}]),t.events.push(["putFont",function(a){(function(l){var c=l.font,u=l.out,d=l.newObject,h=l.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var v=c.metadata.rawData,b="",g=0;g<v.length;g++)b+=String.fromCharCode(v[g]);var A=d();h({data:b,addLength1:!0,objectId:A}),u("endobj");var _=d();h({data:i(c.metadata.toUnicode),addLength1:!0,objectId:_}),u("endobj");var C=d();u("<<"),u("/Descent "+c.metadata.decender),u("/CapHeight "+c.metadata.capHeight),u("/StemV "+c.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+A+" 0 R"),u("/Flags 96"),u("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),u("/FontName /"+Mu(c.fontName)),u("/ItalicAngle "+c.metadata.italicAngle),u("/Ascent "+c.metadata.ascender),u(">>"),u("endobj"),c.objectNumber=d();for(var E=0;E<c.metadata.hmtx.widths.length;E++)c.metadata.hmtx.widths[E]=parseInt(c.metadata.hmtx.widths[E]*(1e3/c.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+_+" 0 R/BaseFont/"+Mu(c.fontName)+"/FontDescriptor "+C+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),u("endobj"),c.isAlreadyPutted=!0}})(a)}]);var o=function(a){var l,c=a.text||"",u=a.x,d=a.y,h=a.options||{},v=a.mutex||{},b=v.pdfEscape,g=v.activeFontKey,A=v.fonts,_=g,C="",E=0,R="",k=A[_].encoding;if(A[_].encoding!=="Identity-H")return{text:c,x:u,y:d,options:h,mutex:v};for(R=c,_=g,Array.isArray(c)&&(R=c[0]),E=0;E<R.length;E+=1)A[_].metadata.hasOwnProperty("cmap")&&(l=A[_].metadata.cmap.unicode.codeMap[R[E].charCodeAt(0)]),l||R[E].charCodeAt(0)<256&&A[_].metadata.hasOwnProperty("Unicode")?C+=R[E]:C+="";var M="";return parseInt(_.slice(1))<14||k==="WinAnsiEncoding"?M=b(C,_).split("").map(function(P){return P.charCodeAt(0).toString(16)}).join(""):k==="Identity-H"&&(M=n(C,A[_])),v.isHex=!0,{text:M,x:u,y:d,options:h,mutex:v}};t.events.push(["postProcessText",function(a){var l=a.text||"",c=[],u={text:l,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(l)){var d=0;for(d=0;d<l.length;d+=1)Array.isArray(l[d])&&l[d].length===3?c.push([o(Object.assign({},u,{text:l[d][0]})).text,l[d][1],l[d][2]]):c.push(o(Object.assign({},u,{text:l[d]})).text);a.text=c}else a.text=o(Object.assign({},u,{text:l})).text}])})(Dt),(function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0},e.addFileToVFS=function(n,i){return t.call(this),this.internal.vFS[n]=i,this},e.getFileFromVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}})(Dt.API),(function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(i){var o,a,l,c,u,d,h,v=t,b=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],A={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},_={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},C=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],E=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),R=!1,k=0;this.__bidiEngine__={};var M=function(z){var U=z.charCodeAt(),q=U>>8,I=_[q];return I!==void 0?v[256*I+(255&U)]:q===252||q===253?"AL":E.test(q)?"L":q===8?"R":"N"},P=function(z){for(var U,q=0;q<z.length;q++){if((U=M(z.charAt(q)))==="L")return!1;if(U==="R")return!0}return!1},W=function(z,U,q,I){var ie,J,Y,le,pe=U[I];switch(pe){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":R=!1;break;case"N":case"AN":break;case"EN":R&&(pe="AN");break;case"AL":R=!0,pe="R";break;case"WS":case"BN":pe="N";break;case"CS":I<1||I+1>=U.length||(ie=q[I-1])!=="EN"&&ie!=="AN"||(J=U[I+1])!=="EN"&&J!=="AN"?pe="N":R&&(J="AN"),pe=J===ie?J:"N";break;case"ES":pe=(ie=I>0?q[I-1]:"B")==="EN"&&I+1<U.length&&U[I+1]==="EN"?"EN":"N";break;case"ET":if(I>0&&q[I-1]==="EN"){pe="EN";break}if(R){pe="N";break}for(Y=I+1,le=U.length;Y<le&&U[Y]==="ET";)Y++;pe=Y<le&&U[Y]==="EN"?"EN":"N";break;case"NSM":if(l&&!c){for(le=U.length,Y=I+1;Y<le&&U[Y]==="NSM";)Y++;if(Y<le){var Ie=z[I],G=Ie>=1425&&Ie<=2303||Ie===64286;if(ie=U[Y],G&&(ie==="R"||ie==="AL")){pe="R";break}}}pe=I<1||(ie=U[I-1])==="B"?"N":q[I-1];break;case"B":R=!1,o=!0,pe=k;break;case"S":a=!0,pe="N"}return pe},V=function(z,U,q){var I=z.split("");return q&&$(I,q,{hiLevel:k}),I.reverse(),U&&U.reverse(),I.join("")},$=function(z,U,q){var I,ie,J,Y,le,pe=-1,Ie=z.length,G=0,O=[],ee=k?g:b,te=[];for(R=!1,o=!1,a=!1,ie=0;ie<Ie;ie++)te[ie]=M(z[ie]);for(J=0;J<Ie;J++){if(le=G,O[J]=W(z,te,O,J),I=240&(G=ee[le][A[O[J]]]),G&=15,U[J]=Y=ee[G][5],I>0)if(I===16){for(ie=pe;ie<J;ie++)U[ie]=1;pe=-1}else pe=-1;if(ee[G][6])pe===-1&&(pe=J);else if(pe>-1){for(ie=pe;ie<J;ie++)U[ie]=Y;pe=-1}te[J]==="B"&&(U[J]=0),q.hiLevel|=Y}a&&(function(ce,ye,we){for(var Te=0;Te<we;Te++)if(ce[Te]==="S"){ye[Te]=k;for(var Ce=Te-1;Ce>=0&&ce[Ce]==="WS";Ce--)ye[Ce]=k}})(te,U,Ie)},j=function(z,U,q,I,ie){if(!(ie.hiLevel<z)){if(z===1&&k===1&&!o)return U.reverse(),void(q&&q.reverse());for(var J,Y,le,pe,Ie=U.length,G=0;G<Ie;){if(I[G]>=z){for(le=G+1;le<Ie&&I[le]>=z;)le++;for(pe=G,Y=le-1;pe<Y;pe++,Y--)J=U[pe],U[pe]=U[Y],U[Y]=J,q&&(J=q[pe],q[pe]=q[Y],q[Y]=J);G=le}G++}}},X=function(z,U,q){var I=z.split(""),ie={hiLevel:k};return q||(q=[]),$(I,q,ie),(function(J,Y,le){if(le.hiLevel!==0&&h)for(var pe,Ie=0;Ie<J.length;Ie++)Y[Ie]===1&&(pe=C.indexOf(J[Ie]))>=0&&(J[Ie]=C[pe+1])})(I,q,ie),j(2,I,U,q,ie),j(1,I,U,q,ie),I.join("")};return this.__bidiEngine__.doBidiReorder=function(z,U,q){if((function(ie,J){if(J)for(var Y=0;Y<ie.length;Y++)J[Y]=Y;c===void 0&&(c=P(ie)),d===void 0&&(d=P(ie))})(z,U),l||!u||d)if(l&&u&&c^d)k=c?1:0,z=V(z,U,q);else if(!l&&u&&d)k=c?1:0,z=X(z,U,q),z=V(z,U);else if(!l||c||u||d){if(l&&!u&&c^d)z=V(z,U),c?(k=0,z=X(z,U,q)):(k=1,z=X(z,U,q),z=V(z,U));else if(l&&c&&!u&&d)k=1,z=X(z,U,q),z=V(z,U);else if(!l&&!u&&c^d){var I=h;c?(k=1,z=X(z,U,q),k=0,h=!1,z=X(z,U,q),h=I):(k=0,z=X(z,U,q),z=V(z,U),k=1,h=!1,z=X(z,U,q),h=I,z=V(z,U))}}else k=0,z=X(z,U,q);else k=c?1:0,z=X(z,U,q);return z},this.__bidiEngine__.setOptions=function(z){z&&(l=z.isInputVisual,u=z.isOutputVisual,c=z.isInputRtl,d=z.isOutputRtl,h=z.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(i){var o=i.text;i.x,i.y;var a=i.options||{};i.mutex,a.lang;var l=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,n.setOptions(a),Object.prototype.toString.call(o)==="[object Array]"){var c=0;for(l=[],c=0;c<o.length;c+=1)Object.prototype.toString.call(o[c])==="[object Array]"?l.push([n.doBidiReorder(o[c][0]),o[c][1],o[c][2]]):l.push([n.doBidiReorder(o[c])]);i.text=l}else i.text=n.doBidiReorder(o);n.setOptions({isInputVisual:!0})}])})(Dt),Dt.API.TTFFont=(function(){function e(t){var n;if(this.rawData=t,n=this.contents=new Bl(t),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new p8(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new e8(this.contents),this.head=new n8(this),this.name=new s8(this),this.cmap=new O_(this),this.toUnicode={},this.hhea=new i8(this),this.maxp=new l8(this),this.hmtx=new c8(this),this.post=new o8(this),this.os2=new r8(this),this.loca=new h8(this),this.glyf=new u8(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,n,i,o,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,c,u,d;for(d=[],l=0,c=(u=this.bbox).length;l<c;l++)t=u[l],d.push(Math.round(t*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(i=255&(o=this.post.italic_angle),32768&(n=o>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var n;return((n=this.cmap.unicode)!=null?n.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*n},e.prototype.widthOfString=function(t,n,i){var o,a,l,c;for(l=0,a=0,c=(t=""+t).length;0<=c?a<c:a>c;a=0<=c?++a:--a)o=t.charCodeAt(a),l+=this.widthOfGlyph(this.characterToGlyph(o))+i*(1e3/n)||0;return l*(n/1e3)},e.prototype.lineHeight=function(t,n){var i;return n==null&&(n=!1),i=n?this.lineGap:0,(this.ascender+i-this.decender)/1e3*t},e})();var Ua,Bl=(function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var n,i;for(i=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)i[n]=String.fromCharCode(this.readByte());return i.join("")},e.prototype.writeString=function(t){var n,i,o;for(o=[],n=0,i=t.length;0<=i?n<i:n>i;n=0<=i?++n:--n)o.push(this.writeByte(t.charCodeAt(n)));return o},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,n,i,o,a,l,c,u;return t=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),a=this.readByte(),l=this.readByte(),c=this.readByte(),u=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^n)+1099511627776*(255^i)+4294967296*(255^o)+16777216*(255^a)+65536*(255^l)+256*(255^c)+(255^u)+1):72057594037927940*t+281474976710656*n+1099511627776*i+4294967296*o+16777216*a+65536*l+256*c+u},e.prototype.writeLongLong=function(t){var n,i;return n=Math.floor(t/4294967296),i=4294967295&t,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var n,i;for(n=[],i=0;0<=t?i<t:i>t;i=0<=t?++i:--i)n.push(this.readByte());return n},e.prototype.write=function(t){var n,i,o,a;for(a=[],i=0,o=t.length;i<o;i++)n=t[i],a.push(this.writeByte(n));return a},e})(),e8=(function(){var e;function t(n){var i,o,a;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},o=0,a=this.tableCount;0<=a?o<a:o>a;o=0<=a?++o:--o)i={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[i.tag]=i}return t.prototype.encode=function(n){var i,o,a,l,c,u,d,h,v,b,g,A,_;for(_ in g=Object.keys(n).length,u=Math.log(2),v=16*Math.floor(Math.log(g)/u),l=Math.floor(v/u),h=16*g-v,(o=new Bl).writeInt(this.scalarType),o.writeShort(g),o.writeShort(v),o.writeShort(l),o.writeShort(h),a=16*g,d=o.pos+a,c=null,A=[],n)for(b=n[_],o.writeString(_),o.writeInt(e(b)),o.writeInt(d),o.writeInt(b.length),A=A.concat(b),_==="head"&&(c=d),d+=b.length;d%4;)A.push(0),d++;return o.write(A),i=2981146554-e(o.data),o.pos=c+8,o.writeUInt32(i),o.data},e=function(n){var i,o,a,l;for(n=U_.call(n);n.length%4;)n.push(0);for(a=new Bl(n),o=0,i=0,l=n.length;i<l;i=i+=4)o+=a.readUInt32();return 4294967295&o},t})(),t8={}.hasOwnProperty,ds=function(e,t){for(var n in t)t8.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};Ua=(function(){function e(t){var n;this.file=t,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e})();var n8=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,Ua),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var n;return(n=new Bl).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(t),n.writeShort(this.glyphDataFormat),n.data},e})(),B5=(function(){function e(t,n){var i,o,a,l,c,u,d,h,v,b,g,A,_,C,E,R,k;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=n+t.readInt(),v=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=t.readByte();break;case 4:for(g=t.readUInt16(),b=g/2,t.pos+=6,a=(function(){var M,P;for(P=[],u=M=0;0<=b?M<b:M>b;u=0<=b?++M:--M)P.push(t.readUInt16());return P})(),t.pos+=2,_=(function(){var M,P;for(P=[],u=M=0;0<=b?M<b:M>b;u=0<=b?++M:--M)P.push(t.readUInt16());return P})(),d=(function(){var M,P;for(P=[],u=M=0;0<=b?M<b:M>b;u=0<=b?++M:--M)P.push(t.readUInt16());return P})(),h=(function(){var M,P;for(P=[],u=M=0;0<=b?M<b:M>b;u=0<=b?++M:--M)P.push(t.readUInt16());return P})(),o=(this.length-t.pos+this.offset)/2,c=(function(){var M,P;for(P=[],u=M=0;0<=o?M<o:M>o;u=0<=o?++M:--M)P.push(t.readUInt16());return P})(),u=E=0,k=a.length;E<k;u=++E)for(C=a[u],i=R=A=_[u];A<=C?R<=C:R>=C;i=A<=C?++R:--R)h[u]===0?l=i+d[u]:(l=c[h[u]/2+(i-A)-(b-u)]||0)!==0&&(l+=d[u]),this.codeMap[i]=65535&l}t.pos=v}return e.encode=function(t,n){var i,o,a,l,c,u,d,h,v,b,g,A,_,C,E,R,k,M,P,W,V,$,j,X,z,U,q,I,ie,J,Y,le,pe,Ie,G,O,ee,te,ce,ye,we,Te,Ce,De,$e,at;switch(I=new Bl,l=Object.keys(t).sort(function(st,B){return st-B}),n){case"macroman":for(_=0,C=(function(){var st=[];for(A=0;A<256;++A)st.push(0);return st})(),R={0:0},a={},ie=0,pe=l.length;ie<pe;ie++)R[Ce=t[o=l[ie]]]==null&&(R[Ce]=++_),a[o]={old:t[o],new:R[t[o]]},C[o]=R[t[o]];return I.writeUInt16(1),I.writeUInt16(0),I.writeUInt32(12),I.writeUInt16(0),I.writeUInt16(262),I.writeUInt16(0),I.write(C),{charMap:a,subtable:I.data,maxGlyphID:_+1};case"unicode":for(U=[],v=[],k=0,R={},i={},E=d=null,J=0,Ie=l.length;J<Ie;J++)R[P=t[o=l[J]]]==null&&(R[P]=++k),i[o]={old:P,new:R[P]},c=R[P]-o,E!=null&&c===d||(E&&v.push(E),U.push(o),d=c),E=o;for(E&&v.push(E),v.push(65535),U.push(65535),X=2*(j=U.length),$=2*Math.pow(Math.log(j)/Math.LN2,2),b=Math.log($/2)/Math.LN2,V=2*j-$,u=[],W=[],g=[],A=Y=0,G=U.length;Y<G;A=++Y){if(z=U[A],h=v[A],z===65535){u.push(0),W.push(0);break}if(z-(q=i[z].new)>=32768)for(u.push(0),W.push(2*(g.length+j-A)),o=le=z;z<=h?le<=h:le>=h;o=z<=h?++le:--le)g.push(i[o].new);else u.push(q-z),W.push(0)}for(I.writeUInt16(3),I.writeUInt16(1),I.writeUInt32(12),I.writeUInt16(4),I.writeUInt16(16+8*j+2*g.length),I.writeUInt16(0),I.writeUInt16(X),I.writeUInt16($),I.writeUInt16(b),I.writeUInt16(V),we=0,O=v.length;we<O;we++)o=v[we],I.writeUInt16(o);for(I.writeUInt16(0),Te=0,ee=U.length;Te<ee;Te++)o=U[Te],I.writeUInt16(o);for(De=0,te=u.length;De<te;De++)c=u[De],I.writeUInt16(c);for($e=0,ce=W.length;$e<ce;$e++)M=W[$e],I.writeUInt16(M);for(at=0,ye=g.length;at<ye;at++)_=g[at],I.writeUInt16(_);return{charMap:i,subtable:I.data,maxGlyphID:k+1}}},e})(),O_=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,Ua),e.prototype.tag="cmap",e.prototype.parse=function(t){var n,i,o;for(t.pos=this.offset,this.version=t.readUInt16(),o=t.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=o?i<o:i>o;i=0<=o?++i:--i)n=new B5(t,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(t,n){var i,o;return n==null&&(n="macroman"),i=B5.encode(t,n),(o=new Bl).writeUInt16(0),o.writeUInt16(1),i.table=o.data.concat(i.subtable),i},e})(),i8=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,Ua),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e})(),r8=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,Ua),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=(function(){var n,i;for(i=[],n=0;n<10;++n)i.push(t.readByte());return i})(),this.charRange=(function(){var n,i;for(i=[],n=0;n<4;++n)i.push(t.readInt());return i})(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=(function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(t.readInt());return i})(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e})(),o8=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,Ua),e.prototype.tag="post",e.prototype.parse=function(t){var n,i,o;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(i=t.readUInt16(),this.glyphNameIndex=[],a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],o=[];t.pos<this.offset+this.length;)n=t.readByte(),o.push(this.names.push(t.readString(n)));return o;case 151552:return i=t.readUInt16(),this.offsets=t.read(i);case 262144:return this.map=(function(){var l,c,u;for(u=[],a=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;a=0<=c?++l:--l)u.push(t.readUInt32());return u}).call(this)}},e})(),a8=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},s8=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,Ua),e.prototype.tag="name",e.prototype.parse=function(t){var n,i,o,a,l,c,u,d,h,v,b;for(t.pos=this.offset,t.readShort(),n=t.readShort(),c=t.readShort(),i=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)i.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+c+t.readShort()});for(u={},a=h=0,v=i.length;h<v;a=++h)o=i[a],t.pos=o.offset,d=t.readString(o.length),l=new a8(d,o),u[b=o.nameID]==null&&(u[b]=[]),u[o.nameID].push(l);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},e})(),l8=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,Ua),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e})(),c8=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,Ua),e.prototype.tag="hmtx",e.prototype.parse=function(t){var n,i,o,a,l,c,u;for(t.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var d,h;for(h=[],n=d=0;0<=o?d<o:d>o;n=0<=o?++d:--d)h.push(t.readInt16());return h})(),this.widths=(function(){var d,h,v,b;for(b=[],d=0,h=(v=this.metrics).length;d<h;d++)a=v[d],b.push(a.advance);return b}).call(this),i=this.widths[this.widths.length-1],u=[],n=l=0;0<=o?l<o:l>o;n=0<=o?++l:--l)u.push(this.widths.push(i));return u},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e})(),U_=[].slice,u8=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,Ua),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var n,i,o,a,l,c,u,d,h,v;return t in this.cache?this.cache[t]:(a=this.file.loca,n=this.file.contents,i=a.indexOf(t),(o=a.lengthOf(t))===0?this.cache[t]=null:(n.pos=this.offset+i,l=(c=new Bl(n.read(o))).readShort(),d=c.readShort(),v=c.readShort(),u=c.readShort(),h=c.readShort(),this.cache[t]=l===-1?new f8(c,d,v,u,h):new d8(c,l,d,v,u,h),this.cache[t]))},e.prototype.encode=function(t,n,i){var o,a,l,c,u;for(l=[],a=[],c=0,u=n.length;c<u;c++)o=t[n[c]],a.push(l.length),o&&(l=l.concat(o.encode(i)));return a.push(l.length),{table:l,offsets:a}},e})(),d8=(function(){function e(t,n,i,o,a,l){this.raw=t,this.numberOfContours=n,this.xMin=i,this.yMin=o,this.xMax=a,this.yMax=l,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e})(),f8=(function(){function e(t,n,i,o,a){var l,c;for(this.raw=t,this.xMin=n,this.yMin=i,this.xMax=o,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;c=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&c;)l.pos+=1&c?4:2,128&c?l.pos+=8:64&c?l.pos+=4:8&c&&(l.pos+=2)}return e.prototype.encode=function(){var t,n,i;for(n=new Bl(U_.call(this.raw.data)),t=0,i=this.glyphIDs.length;t<i;++t)n.pos=this.glyphOffsets[t];return n.data},e})(),h8=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,Ua),e.prototype.tag="loca",e.prototype.parse=function(t){var n,i;return t.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var o,a;for(a=[],i=0,o=this.length;i<o;i+=2)a.push(2*t.readUInt16());return a}).call(this):(function(){var o,a;for(a=[],i=0,o=this.length;i<o;i+=4)a.push(t.readUInt32());return a}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,n){for(var i=new Uint32Array(this.offsets.length),o=0,a=0,l=0;l<i.length;++l)if(i[l]=o,a<n.length&&n[a]==l){++a,i[l]=o;var c=this.offsets[l],u=this.offsets[l+1]-c;u>0&&(o+=u)}for(var d=new Array(4*i.length),h=0;h<i.length;++h)d[4*h+3]=255&i[h],d[4*h+2]=(65280&i[h])>>8,d[4*h+1]=(16711680&i[h])>>16,d[4*h]=(4278190080&i[h])>>24;return d},e})(),p8=(function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,n,i,o,a;for(n in o=this.font.cmap.tables[0].codeMap,t={},a=this.subset)i=a[n],t[n]=o[i];return t},e.prototype.glyphsFor=function(t){var n,i,o,a,l,c,u;for(o={},l=0,c=t.length;l<c;l++)o[a=t[l]]=this.font.glyf.glyphFor(a);for(a in n=[],o)(i=o[a])!=null&&i.compound&&n.push.apply(n,i.glyphIDs);if(n.length>0)for(a in u=this.glyphsFor(n))i=u[a],o[a]=i;return o},e.prototype.encode=function(t,n){var i,o,a,l,c,u,d,h,v,b,g,A,_,C,E;for(o in i=O_.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(t),g={0:0},E=i.charMap)g[(u=E[o]).old]=u.new;for(A in b=i.maxGlyphID,l)A in g||(g[A]=b++);return h=(function(R){var k,M;for(k in M={},R)M[R[k]]=k;return M})(g),v=Object.keys(h).sort(function(R,k){return R-k}),_=(function(){var R,k,M;for(M=[],R=0,k=v.length;R<k;R++)c=v[R],M.push(h[c]);return M})(),a=this.font.glyf.encode(l,_,g),d=this.font.loca.encode(a.offsets,_),C={cmap:this.font.cmap.raw(),glyf:a.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(C["OS/2"]=this.font.os2.raw()),this.font.directory.encode(C)},e})();Dt.API.PDFObject=(function(){var e;function t(){}return e=function(n,i){return(Array(i+1).join("0")+n).slice(-i)},t.convert=function(n){var i,o,a,l;if(Array.isArray(n))return"["+(function(){var c,u,d;for(d=[],c=0,u=n.length;c<u;c++)i=n[c],d.push(t.convert(i));return d})().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(o in a=["<<"],n)l=n[o],a.push("/"+o+" "+t.convert(l));return a.push(">>"),a.join(`
`)}return""+n},t})();const m8="ink_tracker_images",Wu="images",g8=1;let Ah=null;function z_(){return Ah||(Ah=new Promise((e,t)=>{const n=indexedDB.open(m8,g8);n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result),n.onupgradeneeded=i=>{const o=i.target.result;o.objectStoreNames.contains(Wu)||o.createObjectStore(Wu,{keyPath:"id"})}}),Ah)}async function ss(e,t){const o=(await z_()).transaction(Wu,"readwrite").objectStore(Wu);return await new Promise((a,l)=>{const c=o.put({id:e,data:t});c.onsuccess=()=>a(),c.onerror=()=>l(c.error)}),`idb://${e}`}async function ka(e){const i=(await z_()).transaction(Wu,"readonly").objectStore(Wu);return new Promise((o,a)=>{const l=i.get(e);l.onsuccess=()=>{var c;return o(((c=l.result)==null?void 0:c.data)||null)},l.onerror=()=>a(l.error)})}const Ip=[{id:"classic-noir",name:"Classic Film Noir",prompt:"classic film noir comic book style, high contrast black and white ink, deep shadows, cinematic lighting, gritty texture, professional linework"},{id:"sin-city",name:"Sin City Style",prompt:"stark Sin City style high contrast black and white, heavy ink, deep blacks, selective red accents, silhouette lighting, minimalist grit"},{id:"crime-noir",name:"Gritty Crime Noir",prompt:"gritty urban crime comic art, hard-boiled detective noir, rainy city streets, fedoras and trench coats, dramatic shadows, moody palette"},{id:"will-eisner",name:"Spirit Noir (Eisner)",prompt:"Will Eisner Spirit-style noir, expressive cinematic storytelling, creative environmental integration, atmospheric urban settings, soft ink washes"},{id:"bronze-superhero",name:"Bronze Age (1970s)",prompt:"1970s bronze age superhero comic book art, dynamic action poses, thick ink outlines, vibrant flat colors with Ben-Day dots, expressive faces"},{id:"silver-superhero",name:"Silver Age (1960s)",prompt:"1960s silver age superhero comic book art, clean heroic proportions, bright primary colors, classic four-color printing look, optimistic heroic style"},{id:"kirby-cosmic",name:"Kirby Cosmic",prompt:"Jack Kirby style cosmic superhero art, bold blocky shapes, Kirby crackle energy, epic scale, hyper-dynamic anatomy, geometric power"},{id:"alex-ross",name:"Painted Realism (Ross)",prompt:"Alex Ross style hyper-realistic painted superhero art, photorealistic gouache painting, classical heroic lighting, masterpiece quality, cinematic realism"},{id:"frank-miller",name:"Gritty Miller Style",prompt:"Frank Miller gritty comic art, heavy expressionistic ink work, blocky angular shadows, dark brooding atmosphere, muscular silhouettes"},{id:"ec-horror",name:"EC Horror (50s)",prompt:"classic 1950s horror comic book style, detailed macabre illustrations, grotesque monsters, heavy ink shading, EC comics aesthetic, vibrant retro colors"},{id:"vertigo-horror",name:"Vertigo Horror (90s)",prompt:"moody 1990s Vertigo horror comic art, psychological dark fantasy, painterly textures, atmospheric and surreal lighting, sophisticated color palette"},{id:"mignola-hellboy",name:"Hellboy Style (Mignola)",prompt:"Mike Mignola style folk horror, blocky heavy shadows, simplified geometric shapes, high contrast flat colors, gothic atmosphere, minimalist shapes"},{id:"underground-comix",name:"Underground Comix",prompt:"1960s underground comix style, R. Crumb-inspired raw ink work, heavy cross-hatching, satirical distorted proportions, detailed messy textures"},{id:"indie-minimalist",name:"Indie Minimalist",prompt:"indie graphic novel style, clean minimalist line art, emotional realism, sophisticated composition, muted color palette, Chris Ware influence"},{id:"clear-line",name:"Clear-Line (Tintin)",prompt:"European clear-line (ligne claire) style, precise uniform ink outlines, flat colors, no hatching, clean readable backgrounds, Herg aesthetic"},{id:"european-bd",name:"European BD Adventure",prompt:"modern European BD adventure art, realistic proportions, intricate background details, sophisticated color grading, Moebius influence"},{id:"modern-alt",name:"Modern Indie Alt",prompt:"modern indie alt-comic style, loose sketchy line work, contemporary emotional storytelling, minimal shading, Adrian Tomine vibe"},{id:"erotic-realism",name:"Photorealistic",prompt:"ultra photorealistic sensual erotic portrait, detailed realistic skin texture and anatomy, soft intimate lighting, cinematic chiaroscuro, tasteful artistic sensual pose, high detail masterpiece, no cartoon elements"},{id:"pulp-adventure",name:"Retro Pulp Adventure",prompt:"retro 1930s pulp magazine cover art, dynamic adventure serials, warm vintage palette, hand-painted texture, dramatic heroic action"},{id:"cyberpunk-noir",name:"Western Cyberpunk Noir",prompt:"Western cyberpunk neon-noir comic art, intricate mechanical details, glowing accents, gritty high-tech low-life aesthetic, intense lighting"},{id:"norman-rockwell",name:"Norman Rockwell",prompt:"Norman Rockwell illustration style, folksy Americana, warm nostalgic palette, Saturday Evening Post aesthetic, detailed realistic figures, idyllic small-town scenes, homespun warmth with subtle underlying tension, masterful composition"},{id:"kinkade-luminous",name:"Kinkade Luminous",prompt:"Thomas Kinkade style, luminous glowing cottages, idyllic pastoral landscapes, soft diffused golden light, painterly warmth, ethereal glow effects, cozy nostalgic atmosphere, romanticized nature"},{id:"lisa-frank",name:"Lisa Frank",prompt:"Lisa Frank style, hypersaturated neon rainbow colors, sparkles and glitter effects, 90s aesthetic, kawaii cute characters, gradient backgrounds, maximalist whimsy, unicorns and dolphins, bold outlines"},{id:"hellraiser",name:"Hellraiser",prompt:"Clive Barker Hellraiser aesthetic, cenobite body horror, leather and chains, puzzle box motifs, sadomasochistic nightmare imagery, dim crimson and black palette, intricate geometric torture designs, flesh and metal fusion"},{id:"spawn-mcfarlane",name:"Spawn (McFarlane)",prompt:"Todd McFarlane Spawn style, elaborate flowing capes with impossible detail, hellfire green necroplasm glow, gritty urban supernatural, heavy dramatic shadows, dynamic exaggerated poses, chains skulls and spikes, 90s Image comics energy"},{id:"dune-epic",name:"Dune",prompt:"Dune aesthetic, epic desert landscapes, ornate stillsuits with intricate detail, sandworm scale and grandeur, spice-blue eyes, arid orange ochre and deep blue palette, Frank Herbert vision, baroque sci-fi grandeur, harsh sunlight and deep shadows"},{id:"custom",name:" Custom Style",prompt:""}],nf={[Yt.WIDE]:{label:"Wide (16:9)",class:"aspect-panel-wide",ratio:"16:9"},[Yt.STD]:{label:"Standard (4:3)",class:"aspect-panel-std",ratio:"4:3"},[Yt.SQUARE]:{label:"Square (1:1)",class:"aspect-panel-square",ratio:"1:1"},[Yt.TALL]:{label:"Tall (3:4)",class:"aspect-panel-tall",ratio:"3:4"},[Yt.PORTRAIT]:{label:"Portrait (9:16)",class:"aspect-panel-portrait",ratio:"9:16"}},q5=1200,ko={Plus:()=>p.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),Trash:()=>p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),Magic:()=>p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),Edit:()=>p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),Folder:()=>p.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),X:()=>p.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),Loader:()=>p.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[p.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),p.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})},H5={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15,sixteen:16,seventeen:17,eighteen:18,nineteen:19,twenty:20,twentyone:21,twentytwo:22,twentythree:23,twentyfour:24,twentyfive:25,twentysix:26,twentyseven:27,twentyeight:28,twentynine:29,thirty:30};function v8(e){const t=e.toLowerCase().trim().replace(/[-\s]+/g,"");if(H5[t])return H5[t];const n=parseInt(e,10);return isNaN(n)?0:n}const y8=[/^#{1,3}\s*PAGE\s+(\w+)/i,/^\*\*PAGE\s+(\w+)\*\*/i,/^(?:PAGE|PG)\s+(\w+)(?:\s*$|\s*\()/i],b8=[/^Panel\s+(\d+)\s*(.*)/i,/^\*\*Panel\s+(\d+)\*\*\s*(.*)/i,/^Panel\s+(\d+)\s*[\[\(]([^\]\)]+)[\]\)]\s*(.*)/i,/^(?:PANEL|FRAME)\s*(\d+)\s*[:\-]?\s*(.*)/i],x8=/^(\d+)\.\s*(.*)/,w8=/^>\s*(?:\*\*)?([A-Z][A-Z0-9\s\-'.]{0,30})(?:\s*[\(\[<]([^\)\]>]+)[\)\]>])?\s*(?:\*\*)?\s*[:\-]\s*(.+)$/,_8=/^\*\*([A-Z][A-Z0-9\s\-'.]{0,30})(?:\s*[\(\[<]([^\)\]>]+)[\)\]>])?\s*[:\-]\*\*\s*(.+)$/,S8=/^\*\*([A-Z][A-Z0-9\s\-'.]{0,30})(?:\s*[\(\[<]([^\)\]>]+)[\)\]>])?\*\*\s*[:\-]\s*(.+)$/,E8=/^([A-Z][A-Z0-9\s\-'.]{1,25})(?:\s*[\(\[<]([^\)\]>]+)[\)\]>])?\s*[:\-\]\s*(.+)$/,N8=/^>\s*(?:\*\*)?CAPTION(?:\s*[\(\[<]([^\)\]>]+)[\)\]>])?\s*(?:\*\*)?\s*[:\-]\s*(.+)$/i,A8=/^\*\*CAPTION(?:\s*[\(\[<]([^\)\]>]+)[\)\]>])?\s*[:\-]\*\*\s*(.+)$/i,C8=/^CAPTION\s*[:\-]\s*(.+)$/i,T8=/^>\s*(?:\*\*)?SFX\s*(?:\*\*)?\s*[:\-]\s*(.+)$/i,k8=/^\*\*SFX\s*[:\-]\*\*\s*(.+)$/i,I8=/^SFX\s*[:\-]\s*(.+)$/i,R8=/^>\s*(?:\*\*)?(?:ON\s+SCREEN|ON\s+WALL|ON\s+BOARD|LABEL|ON\s+PHONE|ON\s+TV|READOUT|DRONE\s+SCREEN|DRONE\s+FEED)(?:\s*[\(\[<]([^\)\]>]+)[\)\]>])?\s*(?:\*\*)?\s*[:\-]\s*(.+)$/i,L8=["thought","thought caption","thinking","inner","v.o.","vo","internal"],M8=[/^\*\(([^)]+)\)\*$/,/^\(([^)]+)\)$/,/^(?:Artist\s*note|NOTE|PROMPT|REF)\s*[:\-]\s*(.+)$/i],D8=/^#\s+(.+)$/,P8=/^##\s+Issue\s+#?(\d+)(?:\s*[:\-]\s*["]?(.+?)["]?)?$/i,O8=/^###\s+CAST\s+OF\s+CHARACTERS/i,U8=/^\*\*([A-Z][A-Z\s\-'.]+)\*\*\s+(.+)$/,z8=/^>\s*CAPTION:\s*(.+)$/i,j8=/(?:inset|micro-flash|flash|intercut)/i;function F8(e,t){const n=`${e} ${t}`.toLowerCase();return n.includes("micro-flash")||n.includes("inset")?"inset":n.includes("echo")||n.includes("shatter")||n.includes("fracture")?"echo":n.includes("hitch")||n.includes("stutter")||n.includes("smear")?"hitch":n.includes("overflow")||n.includes("bruise")||n.includes("lattice")?"overflow":n.includes("split")?"split":n.includes("splash")||n.includes("full-page")||n.includes("full page")?"splash":n.includes("shattered")||n.includes("fragments")?"shattered":n.includes("large")||n.includes("larger")?"large":n.includes("full-width")||n.includes("full width")?"full-width":"standard"}function B8(e,t=""){const n=`${e} ${t}`.toLowerCase();return n.includes("wide")||n.includes("landscape")||n.includes("double")||n.includes("establishing")||n.includes("panoramic")||n.includes("16:9")||n.includes("exterior")||n.includes("full-width")?Yt.WIDE:n.includes("tall")||n.includes("vertical")||n.includes("9:16")||n.includes("portrait")?Yt.PORTRAIT:n.includes("close")||n.includes("face")||n.includes("tight")||n.includes("4:3")||n.includes("standard")?Yt.STD:n.includes("square")||n.includes("1:1")?Yt.SQUARE:(n.includes("large panel")||n.includes("splash"),Yt.WIDE)}function Ch(e){const t=(e||"").toLowerCase();return L8.some(n=>t.includes(n))}function Th(e){const t=(e||"").toLowerCase();return t.includes("phone")||t.includes("text")||t.includes("comms")||t.includes("radio")}function kh(e){return e.replace(/\*+$/,"").trim()}function q8(e){let t=e.match(w8);if(t){const[,n,i,o]=t,a=Ch(i||"")?"thought":Th(i||"")?"phone":"dialogue";return{character:n.trim().toUpperCase(),modifier:i||"",text:kh(o),type:a}}if(t=e.match(_8),t){const[,n,i,o]=t,a=Ch(i||"")?"thought":Th(i||"")?"phone":"dialogue";return{character:n.trim().toUpperCase(),modifier:i||"",text:kh(o),type:a}}if(t=e.match(S8),t){const[,n,i,o]=t,a=Ch(i||"")?"thought":Th(i||"")?"phone":"dialogue";return{character:n.trim().toUpperCase(),modifier:i||"",text:kh(o),type:a}}if(t=e.match(E8),t){const[,n,i,o]=t;if(["CAPTION","SFX","ON SCREEN","ON WALL","LABEL","NOTE","ARTIST"].some(l=>n.toUpperCase().includes(l)))return null;const a=Ch(i||"")?"thought":Th(i||"")?"phone":"dialogue";return{character:n.trim().toUpperCase(),modifier:i||"",text:kh(o),type:a}}return null}function H8(e){let t=e.match(N8);return t||(t=e.match(A8),t)?t[2].trim():(t=e.match(z8),t||(t=e.match(C8),t)?t[1].trim():null)}function G8(e){let t=e.match(T8);return t||(t=e.match(k8),t)||(t=e.match(I8),t)?t[1].trim():null}function V8(e){const t=e.match(R8);return t?{text:t[2].trim(),subtype:t[1]||void 0}:null}function $8(e){for(const t of M8){const n=e.match(t);if(n)return n[1].trim()}return null}function j_(e){const t=[],n=[],i=[],o=new Map;let a;try{const c=e.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`);let u=0,d=[],h="",v=0,b="",g="",A=[],_=[],C=!1,E=!1,R=null,k=0,M=0;const P=()=>{if(v>0&&(b.trim()||A.length>0)){const j=F8(b,g),X=B8(b,g);d.push({panelNumber:v,description:b.trim(),bubbles:[...A],artistNotes:[..._],visualMarker:j,aspectRatio:X,panelModifier:g||void 0,startOffset:k,endOffset:M})}b="",g="",A=[],_=[],R=null},W=()=>{P(),u>0&&d.length>0&&i.push({pageNumber:u,panels:[...d],pageNotes:h||void 0}),d=[],h=""};for(let j=0;j<c.length;j++){const X=c[j].trim(),z=c[j];if(!X){R=null,E=!1;continue}if(X==="---"||X==="***")continue;const U=X.match(D8);if(U&&!a){a={title:U[1].trim()};continue}const q=X.match(P8);if(q){a||(a={title:""}),a.issueNumber=parseInt(q[1],10),q[2]&&(a.subtitle=q[2].trim());continue}if(X.startsWith("**Written by")){const J=X.match(/\*\*Written by\s+(.+)\*\*/i);J&&a&&(a.writer=J[1].trim());continue}if(X.match(/^\d+\s+Pages?\s*/i)){const J=X.match(/^(\d+)\s+Pages?/i);J&&a&&(a.pageCount=parseInt(J[1],10));continue}if(X.startsWith("**Timeline:")){const J=X.match(/\*\*Timeline:\s*(.+)\*\*/i);J&&a&&(a.timeline=J[1].trim());continue}if(O8.test(X)){C=!0;continue}if(X.match(/^###\s*ARTIST/i)||X.match(/^###\s*COLORIST/i)){E=!0;continue}if(C){const J=X.match(U8);if(J){const Y=J[1].trim().toUpperCase(),le=J[2].trim();if(!o.has(Y))o.set(Y,{count:0,first:"",description:le});else{const pe=o.get(Y);pe.description=le}continue}(X.startsWith("##")||X.startsWith("###"))&&(C=!1)}let I=null;for(const J of y8)if(I=X.match(J),I)break;if(I){W(),u=v8(I[1]),C=!1,E=!1;continue}let ie=null;for(const J of b8)if(ie=X.match(J),ie)break;if(ie||(ie=X.match(x8)),ie){P(),v=parseInt(ie[1],10),k=M,ie.length>=4&&ie[2]&&!ie[2].match(/^\d/)?(g=ie[2].trim(),b=(ie[3]||"").trim()):(g="",b=(ie[2]||"").trim()),C=!1,E=!1;continue}if(v>0){const J=$8(X);if(J){_.push(J);continue}const Y=H8(X);if(Y){A.push({type:"caption",text:Y});continue}const le=G8(X);if(le){A.push({type:"sfx",text:le});continue}const pe=V8(X);if(pe){A.push({type:"screen-text",text:pe.text,modifier:pe.subtype});continue}const Ie=q8(X);if(Ie){const G=o.get(Ie.character);G?G.count++:o.set(Ie.character,{count:1,first:b}),A.push({type:Ie.type,text:Ie.text,character:Ie.character,modifier:Ie.modifier||void 0}),R=null;continue}if(R&&(z.startsWith("  ")||z.startsWith("	"))){const G=X.trim(),O=o.get(R);O?O.count++:o.set(R,{count:1,first:b}),A.push({type:"dialogue",text:G,character:R});continue}if(/^[A-Z][A-Z\s\-']{1,25}$/.test(X)&&!X.includes(":")){R=X.trim().toUpperCase();continue}if(j8.test(X)){b+=" "+X;continue}if(X.startsWith(">")){const G=X.replace(/^>\s*/,"").trim();G&&(b+=" "+G)}else b?b+=" "+X:b=X}else E&&u>0&&(h+=X+`
`);M+=z.length+1}if(W(),i.length===0)return t.push('No story structure detected. Ensure pages start with "PAGE 1" or "PAGE ONE" and panels with "Panel 1".'),{success:!1,pages:[],characters:[],errors:t,warnings:n};i.sort((j,X)=>j.pageNumber-X.pageNumber);const V=["CAPTION","SFX","TITLE","SUBTITLE","TEXT","NARRATION","DESCRIPTION","ACTION","SOUND","ON SCREEN","ON WALL","LABEL","READOUT"],$=Array.from(o.entries()).map(([j,X])=>({name:j,description:X.description,lineCount:X.count,firstAppearance:X.first||void 0})).filter(j=>!V.some(X=>j.name.toUpperCase().includes(X))).filter(j=>j.lineCount>0||j.description).sort((j,X)=>X.lineCount-j.lineCount);return{success:!0,issue:a,pages:i,characters:$,errors:t,warnings:n}}catch(l){return t.push(`Parser exception: ${l instanceof Error?l.message:"Unknown"}`),{success:!1,pages:[],characters:[],errors:t,warnings:n}}}const Y8=[/^(INT\.|EXT\.|INT\/EXT\.|EXT\/INT\.|I\/E\.|E\/I\.)\s*(.+?)\s*[-]\s*(.+)$/i,/^(INT\.|EXT\.|INT\/EXT\.|EXT\/INT\.|I\/E\.|E\/I\.)\s*(.+)$/i],W8=[/^(ANGLE ON)\s*[-:]?\s*(.*)$/i,/^(CLOSE UP|CLOSE ON|CLOSEUP|CU|ECU|EXTREME CLOSE UP)\s*[-:]?\s*(.*)$/i,/^(WIDE SHOT|WIDE ON|WIDE|WS|EWS|EXTREME WIDE)\s*[-:]?\s*(.*)$/i,/^(ESTABLISHING|ESTABLISHING SHOT)\s*[-:]?\s*(.*)$/i,/^(POV|POV SHOT)\s*[-:]?\s*(.*)$/i,/^(INSERT|INSERT SHOT)\s*[-:]?\s*(.*)$/i,/^(TWO SHOT|2 SHOT|2-SHOT)\s*[-:]?\s*(.*)$/i,/^(THREE SHOT|3 SHOT|3-SHOT)\s*[-:]?\s*(.*)$/i,/^(OVER THE SHOULDER|OTS|O\.T\.S\.)\s*[-:]?\s*(.*)$/i,/^(TRACKING|TRACKING SHOT|DOLLY|STEADICAM)\s*[-:]?\s*(.*)$/i,/^(PAN TO|PAN|TILT)\s*[-:]?\s*(.*)$/i,/^(PUSH IN|PULL BACK|PULL OUT|ZOOM)\s*[-:]?\s*(.*)$/i,/^(MEDIUM SHOT|MED SHOT|MS|MCU|MEDIUM CLOSE UP)\s*[-:]?\s*(.*)$/i,/^(LONG SHOT|LS|FULL SHOT)\s*[-:]?\s*(.*)$/i,/^(LOW ANGLE|HIGH ANGLE|DUTCH ANGLE|BIRD'S EYE|WORM'S EYE)\s*[-:]?\s*(.*)$/i,/^(AERIAL|CRANE|HELICOPTER SHOT)\s*[-:]?\s*(.*)$/i,/^(REVERSE ANGLE|REVERSE)\s*[-:]?\s*(.*)$/i,/^(BACK TO SCENE|BACK TO)\s*[-:]?\s*(.*)$/i],X8=/^([A-Z][A-Z0-9\s\-'.]+?)(?:\s*\(([^)]+)\))?\s*$/,G5={voiceover:/\b(V\.?O\.?|VOICE\s*OVER|VOICEOVER)\b/i,offscreen:/\b(O\.?S\.?|OFF\s*SCREEN|OFFSCREEN|OFF)\b/i},J8=[/^(CUT TO):?$/i,/^(FADE TO):?$/i,/^(FADE IN):?\.?$/i,/^(FADE OUT):?\.?$/i,/^(DISSOLVE TO):?$/i,/^(SMASH CUT TO):?$/i,/^(SMASH CUT):?$/i,/^(MATCH CUT TO):?$/i,/^(MATCH CUT):?$/i,/^(JUMP CUT TO):?$/i,/^(WIPE TO):?$/i,/^(IRIS IN|IRIS OUT):?$/i,/^(TIME CUT):?$/i,/^(INTERCUT):?$/i,/^(SPLIT SCREEN):?$/i,/^(FREEZE FRAME):?$/i,/^(END OF|THE END|FADE TO BLACK):?\.?$/i],K8=/^(?:SFX|SOUND|SND|AUDIO)\s*[:-]\s*(.+)$/i;function Z8(e){return/^\([^)]+\)$/.test(e.trim())}function Q8(e){const t=e.match(/^\(([^)]+)\)$/);return t?t[1]:void 0}function eI(e){return e?G5.voiceover.test(e)?"voiceover":(G5.offscreen.test(e),"spoken"):"spoken"}function tI(e){for(const t of J8){const n=e.match(t);if(n)return n[1].toUpperCase()}return null}function nI(e){for(const t of W8){const n=e.match(t);if(n)return{type:iI(n[1]),subject:(n[2]||"").trim()}}return null}function iI(e){const t=e.toUpperCase().trim();return t.includes("CLOSE")?"CLOSE UP":t.includes("WIDE")||t==="EWS"?"WIDE SHOT":t.includes("ESTABLISH")?"ESTABLISHING":t==="POV"||t==="POV SHOT"?"POV":t.includes("INSERT")?"INSERT":t.includes("TWO")||t.includes("2")?"TWO SHOT":t.includes("THREE")||t.includes("3")?"THREE SHOT":t.includes("OVER")||t==="OTS"||t==="O.T.S."?"OVER THE SHOULDER":t.includes("TRACK")||t.includes("DOLLY")||t.includes("STEADY")?"TRACKING":t.includes("PAN")?"PAN":t.includes("MEDIUM")||t==="MS"||t==="MCU"?"MEDIUM SHOT":t.includes("LONG")||t==="LS"||t==="FULL SHOT"?"LONG SHOT":t.includes("LOW ANGLE")?"LOW ANGLE":t.includes("HIGH ANGLE")?"HIGH ANGLE":t.includes("AERIAL")||t.includes("CRANE")||t.includes("HELICOPTER")?"AERIAL":t.includes("REVERSE")?"REVERSE ANGLE":t.includes("BACK TO")?"BACK TO SCENE":t}function rI(e,t){if(e.length>35)return!1;const n=e.replace(/[^\w\s]/g,"").trim();return!(!/^[A-Z][A-Z0-9\s\-'.]+$/.test(n)||["THE","END","FADE","CUT","DISSOLVE","INT","EXT","DAY","NIGHT","MORNING","EVENING","AFTERNOON","CONTINUOUS","LATER","SAME","ANGLE","CLOSE","WIDE","INSERT","POV","BACK","SCENE","SHOT","TRACKING","ESTABLISHING","SFX","SOUND","MUSIC","SUPER","TITLE","CONTINUED","MORE","CONTD","OVER","FREEZE","FRAME"].includes(n))}function oI(e){for(const t of Y8){const n=e.match(t);if(n){const i=n[1].toUpperCase().replace(".","").trim(),o=(n[2]||"").trim(),a=n[3]?n[3].trim().toUpperCase():void 0;return{sceneType:i,location:o,timeOfDay:a}}}return null}function aI(e){const t=e.match(K8);return t?t[1].trim():null}function F_(e){const t=[],n=new Map,i={},o=[];try{const a=e.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`);let l=null,c=null,u=null,d=null,h=[],v=0,b=0;const g=()=>{c&&l&&(h.length>0&&!c.description?c.description=h.join(" ").trim():h.length>0&&(c.description+=" "+h.join(" ").trim()),h=[],(c.description.trim()||c.dialogue.length>0)&&(l.panels.push(c),c.visualMarker&&(i[c.visualMarker]=(i[c.visualMarker]||0)+1))),c=null,u=null,d=null},A=()=>{g(),l&&l.panels.length>0&&t.push(l),l=null},_=(E="",R)=>{g(),b++,c={panelNumber:b,description:E.trim(),characters:[],dialogue:[],visualMarker:R,shotType:R}};for(let E=0;E<a.length;E++){const R=a[E],k=R.trim();if(!k){u=null,d=null;continue}if(k==="---"||k==="***"||k==="===")continue;const M=oI(k);if(M){A(),v++,b=0,l={pageNumber:v,panels:[],sceneType:M.sceneType,location:M.location,timeOfDay:M.timeOfDay},_(`${M.sceneType}. ${M.location}${M.timeOfDay?" - "+M.timeOfDay:""}`,"ESTABLISHING");continue}const P=nI(k);if(P){l||(v++,b=0,l={pageNumber:v,panels:[]});const $=P.subject||"";_($,P.type);continue}const W=tI(k);if(W){c!==null&&(c.transition=W,c.artistNotes=c.artistNotes?`${c.artistNotes}; ${W}`:W);continue}const V=aI(k);if(V){c!==null&&(c.artistNotes=c.artistNotes?`${c.artistNotes}; SFX: ${V}`:`SFX: ${V}`);continue}if(Z8(k)){d=Q8(k)||null;continue}if(rI(k,R)){const $=k.match(X8);if($){u=$[1].trim().toUpperCase(),$[2]&&(d=$[2]);const j=n.get(u);j?j.count++:n.set(u,{count:1}),c!==null&&!c.characters.includes(u)&&c.characters.push(u);continue}}if(u){const $=eI(d||void 0);c||(l||(v++,b=0,l={pageNumber:v,panels:[]}),_(""));const j={character:u,text:k,type:$,parenthetical:d||void 0};c.dialogue.push(j),d=null;continue}l||(v++,b=0,l={pageNumber:v,panels:[]}),c||_(""),h.push(k)}A(),t.length===0&&o.push({message:'No scenes detected. Screenplay scenes should start with INT. or EXT. (e.g., "INT. COFFEE SHOP - DAY")',severity:"error"});const C=Array.from(n.entries()).map(([E,R])=>({name:E,panelCount:R.count,description:R.description})).sort((E,R)=>R.panelCount-E.panelCount);return{pages:t,characters:C,visualMarkers:i,errors:o}}catch(a){return o.push({message:`Screenplay parser exception: ${a instanceof Error?a.message:"Unknown error"}`,severity:"error"}),{pages:[],characters:[],visualMarkers:{},errors:o}}}const sI=[/^ACT\s+(ONE|TWO|THREE|FOUR|FIVE|1|2|3|4|5|I|II|III|IV|V)\s*$/i,/^ACT\s+(ONE|TWO|THREE|FOUR|FIVE|1|2|3|4|5|I|II|III|IV|V)\s*[:-]/i,/^#\s*ACT\s+(ONE|TWO|THREE|FOUR|FIVE|1|2|3|4|5|I|II|III|IV|V)/i],lI=[/^SCENE\s+(ONE|TWO|THREE|FOUR|FIVE|SIX|SEVEN|EIGHT|NINE|TEN|\d+)\s*$/i,/^SCENE\s+(ONE|TWO|THREE|FOUR|FIVE|SIX|SEVEN|EIGHT|NINE|TEN|\d+)\s*[:-]/i,/^#\s*SCENE\s+(ONE|TWO|THREE|FOUR|FIVE|SIX|SEVEN|EIGHT|NINE|TEN|\d+)/i,/^Scene\s+(\d+)/i],cI=[/^\(([^)]+)\)\s*$/,/^\[([^\]]+)\]\s*$/,/^\(([^)]+)\)$/,/^\[([^\]]+)\]$/],uI=[/^([A-Z][A-Z0-9\s\-'.]+?)(?:\s*\(([^)]+)\))?\s*:\s*(.+)$/,/^([A-Z][A-Za-z0-9\s\-'.]+?)(?:\s*\(([^)]+)\))?\s*:\s*(.+)$/,/^([A-Z][A-Z0-9\s\-'.]+?)(?:\s*\(([^)]+)\))?\s*\.\s+(.+)$/],dI=["enters","enter","entering","exits","exit","exiting","crosses","cross","crossing","moves","move","moving","sits","sit","sitting","stands","stand","standing","rises","rise","rising","turns","turn","turning","gestures","gesture","gesturing","walks","walk","walking","runs","run","running","falls","fall","falling","kneels","kneel","kneeling","lies","lie","lying","picks up","puts down","opens","closes","grabs","takes","hands"],fI=[/^LIGHTS?\s*[:-]\s*(.+)$/i,/^SOUND\s*[:-]\s*(.+)$/i,/^MUSIC\s*[:-]\s*(.+)$/i,/^SFX\s*[:-]\s*(.+)$/i,/^CUE\s*[:-]\s*(.+)$/i,/^\[(?:Lights?|Sound|Music|SFX|Cue)\s+([^\]]+)\]$/i],hI=[/\b(O\.?S\.?|OFF\s*STAGE?|OFFSTAGE|OFF)\b/i,/\b(V\.?O\.?|VOICE\s*OVER|VOICEOVER)\b/i],V5={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,i:1,ii:2,iii:3,iv:4,v:5};function pI(e){const t=e.toLowerCase().trim();if(V5[t])return V5[t];const n=parseInt(e,10);return isNaN(n)?0:n}function mI(e){const t=e.toLowerCase();return dI.some(n=>new RegExp(`\\b${n}\\b`,"i").test(t))}function gI(e){const t=e.toLowerCase();return/\b(enters?|entering|exits?|exiting)\b/.test(t)}function vI(e){for(const t of sI){const n=e.match(t);if(n){const i=n[1].toUpperCase();return{1:"ONE",2:"TWO",3:"THREE",4:"FOUR",5:"FIVE",I:"ONE",II:"TWO",III:"THREE",IV:"FOUR",V:"FIVE"}[i]||i}}return null}function yI(e){for(const t of lI){const n=e.match(t);if(n)return pI(n[1])}return null}function bI(e){for(const t of cI){const n=e.match(t);if(n)return n[1].trim()}return null}function xI(e){var t;for(const n of uI){const i=e.match(n);if(i){const o=i[1].trim().toUpperCase(),a=(t=i[2])==null?void 0:t.trim(),l=i[3].trim();return["SCENE","ACT","LIGHTS","SOUND","MUSIC","SFX","CUE","END"].includes(o)?null:{character:o,modifier:a,text:l}}}return null}function wI(e){for(const t of fI){const n=e.match(t);if(n)return n[1].trim()}return null}function _I(e){if(!e)return"spoken";for(const t of hI)if(t.test(e))return"voiceover";return"spoken"}function SI(e){const t=[],n=new Map,i={},o=[];try{const a=e.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`);let l=null,c=null,u=null,d=0,h=0,v=[];const b=()=>{if(c&&l){if(v.length>0){const C=v.join(" ").trim();c.description?c.description+=" "+C:c.description=C}v=[],(c.description.trim()||c.dialogue.length>0)&&(l.panels.push(c),c.visualMarker&&(i[c.visualMarker]=(i[c.visualMarker]||0)+1))}c=null},g=()=>{b(),l&&l.panels.length>0&&t.push(l),l=null},A=(C="",E)=>{b(),h++,c={panelNumber:h,description:C.trim(),characters:[],dialogue:[],visualMarker:E}};for(let C=0;C<a.length;C++){const R=a[C].trim();if(!R||R==="---"||R==="***"||R==="===")continue;const k=vI(R);if(k){u=k;continue}const M=yI(R);if(M){g(),d++,h=0,l={pageNumber:d,panels:[],actNumber:u||void 0},A(`Scene ${M}${u?` (Act ${u})`:""}`,"SCENE");continue}const P=wI(R);if(P){c!==null&&(c.artistNotes=c.artistNotes?`${c.artistNotes}; ${P}`:P);continue}const W=bI(R);if(W){if(l||(d++,h=0,l={pageNumber:d,panels:[],actNumber:u||void 0}),gI(W)){c&&b(),A(W,"BLOCKING");const $=W.match(/^([A-Z][A-Za-z\s\-'.]+)\s+(?:enters?|exits?)/i);if($&&c!==null){const j=$[1].trim().toUpperCase();c.characters.includes(j)||c.characters.push(j)}}else mI(W)?c?v.push(W):A(W,"BLOCKING"):c?v.push(W):A(W);continue}const V=xI(R);if(V){l||(d++,h=0,l={pageNumber:d,panels:[],actNumber:u||void 0}),c||A("");const $=n.get(V.character);$?$.count++:n.set(V.character,{count:1}),c.characters.includes(V.character)||c.characters.push(V.character);const j={character:V.character,text:V.text,type:_I(V.modifier),parenthetical:V.modifier};c.dialogue.push(j);continue}c?v.push(R):l&&A(R)}g(),t.length===0&&o.push({message:'No scenes detected. Stage plays should have "SCENE 1" or "Scene One" markers.',severity:"error"});const _=Array.from(n.entries()).map(([C,E])=>({name:C,panelCount:E.count,description:E.description})).sort((C,E)=>E.panelCount-C.panelCount);return{pages:t,characters:_,visualMarkers:i,errors:o}}catch(a){return o.push({message:`Stage play parser exception: ${a instanceof Error?a.message:"Unknown error"}`,severity:"error"}),{pages:[],characters:[],visualMarkers:{},errors:o}}}const EI=[/^EPISODE\s+(\d+)/i,/^EPISODE\s+(\d+)x(\d+)/i,/^EP\.?.?(\d+)/i],NI=/["'"](.+?)["'";]/,AI=[/^(TEASER|COLD OPEN)\s*$/i,/^ACT\s+(ONE|TWO|THREE|FOUR|FIVE|1|2|3|4|5)\s*$/i,/^(TAG|EPILOGUE)\s*$/i,/^END\s+OF?\s+(TEASER|ACT|EPISODE)\s*$/i,/^END\s+(TEASER|TAG)\s*$/i];function CI(e){for(const t of EI){const n=e.match(t);if(n)return n[2]?`${n[1]}x${n[2]}`:n[1]}return null}function $5(e){const t=e.match(NI);return t?t[1].trim():null}function TI(e){for(const t of AI){const n=e.match(t);if(n){if(n[1]){const i=n[1].toUpperCase();return{1:"ONE",2:"TWO",3:"THREE",4:"FOUR",5:"FIVE"}[i]||i}return n[0].trim().toUpperCase()}}return null}function kI(e){const t={acts:[]},n=e.split(`
`);let i=0;for(let o=0;o<n.length;o++){const a=n[o].trim();if(!a)continue;if(!t.episodeNumber){const c=CI(a);if(c){t.episodeNumber=c;const u=$5(a);u&&(t.episodeTitle=u);continue}}if(!t.episodeTitle){const c=$5(a);if(c){t.episodeTitle=c;continue}}const l=TI(a);if(l){t.acts.push({type:l,pageNumber:i,lineNumber:o});continue}/^(INT\.|EXT\.|INT\/EXT\.|EXT\/INT\.)/i.test(a)&&i++}return t}function II(e,t){if(t.length===0)return e;const n=new Map;return t.forEach(i=>{const o=n.get(i.pageNumber)||[];o.push(i),n.set(i.pageNumber,o)}),e.map(i=>{const o=n.get(i.pageNumber);if(o&&i.panels.length>0){const a=i.panels[0],l=o.map(c=>`${c.type}`).join(", ");return{...i,panels:[{...a,artistNotes:a.artistNotes?`${l}; ${a.artistNotes}`:l},...i.panels.slice(1)]}}return i})}function RI(e){const t=[];try{const n=kI(e),i=F_(e),o=II(i.pages,n.acts);return!n.episodeNumber&&i.pages.length>0&&t.push({message:'No episode number detected. Consider adding "EPISODE 103" or similar at the beginning.'}),n.acts.length===0&&i.pages.length>0&&t.push({message:'No act breaks detected. TV scripts typically include "TEASER", "ACT ONE", etc.'}),{...i,pages:o,errors:[...i.errors,...t],metadata:n}}catch(n){return t.push({message:`TV parser exception: ${n instanceof Error?n.message:"Unknown error"}`}),{pages:[],characters:[],visualMarkers:{},errors:t}}}const o1={gemini:{label:"Gemini",color:"text-blue-400",bgColor:"border-blue-500"},leonardo:{label:"Leonardo",color:"text-orange-400",bgColor:"border-orange-500"},grok:{label:"Grok",color:"text-gray-400",bgColor:"border-gray-500"},fal:{label:"FAL Flux",color:"text-ember-400",bgColor:"border-ember-500"},seaart:{label:"SeaArt",color:"text-pink-400",bgColor:"border-pink-500"},openai:{label:"OpenAI",color:"text-green-400",bgColor:"border-green-500"}},df=["Composing the scene...","Balancing lights and shadows...","Rendering character details...","Applying art style...","Refining composition...","Adding atmospheric depth...","Inking the final lines..."],LI=({provider:e})=>{const t=o1[e],[n,i]=de.useState(0);return de.useEffect(()=>{const o=setInterval(()=>{i(a=>(a+1)%df.length)},3e3);return()=>clearInterval(o)},[]),p.jsxs("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3 z-10 rounded-lg",children:[p.jsx("div",{className:`w-10 h-10 rounded-full border-[3px] border-t-transparent animate-spin ${t.bgColor}`}),p.jsxs("p",{className:`text-xs font-mono font-bold uppercase tracking-widest ${t.color}`,children:["Generating with ",t.label]}),p.jsx("p",{className:"text-[10px] text-steel-500 font-mono animate-pulse max-w-[200px] text-center",children:df[n]})]})},MI=({provider:e,current:t,total:n,onCancel:i})=>{const o=o1[e],a=n>0?Math.round(t/n*100):0,[l,c]=de.useState(0);return de.useEffect(()=>{const u=setInterval(()=>{c(d=>(d+1)%df.length)},3500);return()=>clearInterval(u)},[]),p.jsxs("div",{className:"flex flex-col items-center gap-2 min-w-[220px]",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:`w-3 h-3 rounded-full border-2 border-t-transparent animate-spin ${o.bgColor}`}),p.jsxs("span",{className:`text-[10px] font-mono font-bold uppercase tracking-widest ${o.color}`,children:["Generating with ",o.label]})]}),p.jsx("div",{className:"w-full h-1.5 bg-ink-800 rounded-full overflow-hidden",children:p.jsx("div",{className:"h-full rounded-full transition-all duration-500 ease-out",style:{width:`${a}%`,background:"linear-gradient(90deg, var(--tw-gradient-stops))",backgroundColor:e==="gemini"?"#60a5fa":e==="leonardo"?"#fb923c":e==="grok"?"#9ca3af":e==="fal"?"#f97316":e==="seaart"?"#f472b6":"#4ade80"}})}),p.jsxs("div",{className:"flex items-center justify-between w-full",children:[p.jsxs("span",{className:"text-[10px] font-mono text-steel-400",children:["Panel ",t,"/",n]}),p.jsxs("span",{className:"text-[9px] font-mono text-steel-600",children:[a,"%"]})]}),p.jsx("p",{className:"text-[9px] text-steel-600 font-mono italic text-center",children:df[l]}),p.jsx("button",{onClick:i,className:"text-[10px] font-mono text-red-500 hover:text-red-400 uppercase tracking-widest transition-colors",children:"Cancel"})]})},DI={reading:"Reading script...",parsing:"Parsing structure...","extracting-characters":"Extracting characters...","building-pages":"Building storyboard pages...",done:"Complete!"},Y5=["reading","parsing","extracting-characters","building-pages","done"],PI=({stage:e,projectType:t})=>{const n=Y5.indexOf(e),i=t==="screenplay"?"Screenplay":t==="stage-play"?"Stage Play":t==="tv-series"?"TV Script":"Comic Script";return p.jsxs("div",{className:"flex flex-col items-center gap-4 py-8",children:[p.jsx("div",{className:"w-10 h-10 rounded-full border-[3px] border-cyan-500 border-t-transparent animate-spin"}),p.jsxs("p",{className:"text-sm font-mono text-steel-300 font-bold uppercase tracking-widest",children:["Parsing ",i]}),p.jsx("div",{className:"flex flex-col gap-2 w-64",children:Y5.filter(o=>o!=="done").map((o,a)=>{const l=a<n,c=a===n;return p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center text-[10px] font-bold flex-shrink-0 transition-all ${l?"bg-green-500 text-white":c?"bg-cyan-500 text-white animate-pulse":"bg-ink-800 text-steel-600"}`,children:l?"":a+1}),p.jsx("span",{className:`text-xs font-mono transition-colors ${l?"text-green-400":c?"text-cyan-400":"text-steel-600"}`,children:DI[o]})]},o)})})]})},OI=({batching:e,exporting:t,isGeneratingAll:n,provider:i,currentPanel:o=0,totalPanels:a=0,showGutters:l=!1})=>{const[c,u]=de.useState(0);de.useEffect(()=>{const b=setInterval(()=>{u(g=>(g+1)%df.length)},3e3);return()=>clearInterval(b)},[]);const d=e||t||n,h=i?o1[i]:null;if(!d)return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),p.jsx("span",{className:"text-[10px] font-mono uppercase tracking-[0.3em] font-bold",children:"Terminal Ready"})]});if(t)return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500 animate-ping"}),p.jsx("span",{className:"text-[10px] font-mono uppercase tracking-[0.3em] font-bold",children:"Exporting..."})]});const v=a>0?Math.round(o/a*100):0;return p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:`w-3 h-3 rounded-full animate-ping ${h?"":"bg-ember-500"}`,style:h?{backgroundColor:i==="gemini"?"#60a5fa":i==="leonardo"?"#fb923c":i==="grok"?"#9ca3af":i==="fal"?"#f97316":i==="seaart"?"#f472b6":"#4ade80"}:void 0}),p.jsxs("div",{className:"flex flex-col",children:[p.jsx("span",{className:`text-[10px] font-mono uppercase tracking-[0.2em] font-bold ${(h==null?void 0:h.color)||"text-ember-500"}`,children:n?`Generating with ${(h==null?void 0:h.label)||"AI"} (${o}/${a})`:e?`Auto-inking with ${(h==null?void 0:h.label)||"AI"}...`:"Processing..."}),n&&a>0&&p.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[p.jsx("div",{className:`h-1 rounded-full overflow-hidden flex-1 ${l?"bg-gray-300":"bg-ink-700"}`,style:{width:80},children:p.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${v}%`,backgroundColor:i==="gemini"?"#60a5fa":i==="leonardo"?"#fb923c":i==="grok"?"#9ca3af":i==="fal"?"#f97316":i==="seaart"?"#f472b6":"#4ade80"}})}),p.jsxs("span",{className:"text-[9px] font-mono text-steel-500",children:[v,"%"]})]})]})]})};function UI({project:e,onClose:t,onImport:n}){const[i,o]=de.useState(""),[a,l]=de.useState(null),[c,u]=de.useState([]),[d,h]=de.useState(!1),[v,b]=de.useState("reading"),g=async()=>{h(!0),b("reading"),await new Promise(P=>setTimeout(P,300)),b("parsing");let M;switch(e.projectType){case"screenplay":const P=F_(i);M={success:P.errors.length===0||P.pages.length>0,pages:P.pages.map($=>({pageNumber:$.pageNumber,panels:$.panels.map(j=>({panelNumber:j.panelNumber,description:j.description,bubbles:j.dialogue.map(X=>({type:X.type==="spoken"?"dialogue":X.type==="voiceover"?"caption":X.type,text:X.text,character:X.character,modifier:X.parenthetical})),artistNotes:j.artistNotes?[j.artistNotes]:[],visualMarker:j.visualMarker||"standard",aspectRatio:"wide"})),pageNotes:$.location?`${$.sceneType||""} ${$.location} - ${$.timeOfDay||""}`.trim():void 0})),characters:P.characters.map($=>({name:$.name,lineCount:$.panelCount,description:$.description})),errors:P.errors.map($=>$.message),warnings:[]};break;case"stage-play":const W=SI(i);M={success:W.errors.length===0||W.pages.length>0,pages:W.pages.map($=>({pageNumber:$.pageNumber,panels:$.panels.map(j=>({panelNumber:j.panelNumber,description:j.description,bubbles:j.dialogue.map(X=>({type:X.type==="spoken"?"dialogue":X.type==="voiceover"?"caption":X.type,text:X.text,character:X.character,modifier:X.parenthetical})),artistNotes:j.artistNotes?[j.artistNotes]:[],visualMarker:j.visualMarker||"standard",aspectRatio:"wide"})),pageNotes:$.actNumber?`Act ${$.actNumber}`:void 0})),characters:W.characters.map($=>({name:$.name,lineCount:$.panelCount,description:$.description})),errors:W.errors.map($=>$.message),warnings:[]};break;case"tv-series":const V=RI(i);M={success:V.errors.length===0||V.pages.length>0,pages:V.pages.map($=>({pageNumber:$.pageNumber,panels:$.panels.map(j=>({panelNumber:j.panelNumber,description:j.description,bubbles:j.dialogue.map(X=>({type:X.type==="spoken"?"dialogue":X.type==="voiceover"?"caption":X.type,text:X.text,character:X.character,modifier:X.parenthetical})),artistNotes:j.artistNotes?[j.artistNotes]:[],visualMarker:j.visualMarker||"standard",aspectRatio:"wide"})),pageNotes:$.location?`${$.sceneType||""} ${$.location} - ${$.timeOfDay||""}`.trim():void 0})),characters:V.characters.map($=>({name:$.name,lineCount:$.panelCount,description:$.description})),errors:V.errors.map($=>$.message),warnings:[]};break;case"comic":default:M=j_(i);break}await new Promise(P=>setTimeout(P,200)),b("extracting-characters"),await new Promise(P=>setTimeout(P,300)),b("building-pages"),await new Promise(P=>setTimeout(P,200)),b("done"),l(M),u(M.characters),h(!1)},A=()=>{if(a!=null&&a.success){const M={...a,characters:c};n(M,i),t()}},_=M=>{var W;const P=(W=M.target.files)==null?void 0:W[0];if(P){const V=new FileReader;V.onload=$=>{var j;o(((j=$.target)==null?void 0:j.result)||""),l(null),u([])},V.readAsText(P)}},C=()=>{const M=e.projectType;return M==="screenplay"||M==="tv-series"||M==="stage-play"?"Scenes":"Pages"},E=()=>{const M=e.projectType;return M==="screenplay"||M==="tv-series"?"Shots":M==="stage-play"?"Beats":"Panels"},R=()=>{switch(e.projectType){case"screenplay":return"Format: INT. LOCATION - TIME / Action description / CHARACTER NAME / Dialogue / CLOSE UP, WIDE SHOT, etc.";case"stage-play":return"Format: ACT ONE / SCENE 1 / (Stage directions) / CHARACTER: Dialogue / (enters), (exits)";case"tv-series":return"Format: EPISODE 101 / TEASER / INT. LOCATION - TIME / (follows screenplay format)";case"comic":default:return"Format: PAGE 1 / Panel 1 / CAPTION: / CHARACTER: dialogue / SFX:"}},k=(a==null?void 0:a.pages.reduce((M,P)=>M+P.panels.length,0))||0;return a!=null&&a.pages.reduce((M,P)=>(P.panels.forEach(W=>{W.visualMarker!=="standard"&&(M[W.visualMarker]=(M[W.visualMarker]||0)+1)}),M),{}),p.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-xl flex items-center justify-center z-[600] p-8",children:p.jsxs("div",{className:"w-full max-w-5xl bg-ink-950 border border-ink-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[p.jsxs("div",{className:"p-6 border-b border-ink-700 flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h2",{className:"font-display text-3xl tracking-widest text-ember-500 uppercase",children:"Script Import"}),p.jsx("p",{className:"text-[10px] font-mono text-steel-500 mt-1 uppercase tracking-widest",children:"Paste script or upload .txt file"})]}),p.jsx("button",{onClick:t,className:"w-10 h-10 flex items-center justify-center rounded-full bg-ink-800 hover:bg-red-500 text-steel-400 hover:text-white transition-all text-xl font-bold",children:""})]}),p.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[p.jsxs("div",{className:"flex-1 flex flex-col p-6 border-r border-ink-700",children:[p.jsx("div",{className:"mb-4",children:p.jsx("input",{type:"file",accept:".txt,.md",onChange:_,className:"text-[10px] text-steel-400 file:mr-3 file:py-2 file:px-4 file:border file:border-ink-700 file:bg-ink-800 file:text-ember-500 file:font-bold file:text-[9px] file:uppercase file:cursor-pointer file:rounded-lg hover:file:bg-ink-700"})}),p.jsx("textarea",{value:i,onChange:M=>{o(M.target.value),l(null),u([])},placeholder:"Paste your script here...",className:"flex-1 w-full bg-ink-950 border border-ink-700 rounded-xl p-4 font-mono text-xs text-steel-300 outline-none resize-none focus:border-ember-500 transition-colors"}),p.jsx("p",{className:"text-[9px] font-mono text-steel-600 mt-2 italic",children:R()})]}),p.jsxs("div",{className:"w-96 flex flex-col p-6 bg-ink-950/50",children:[p.jsx("button",{onClick:g,disabled:!i.trim()||d,className:"w-full py-3 mb-6 bg-ember-500 hover:bg-ember-400 text-ink-950 font-bold text-xs uppercase tracking-widest rounded-lg disabled:opacity-30 transition-all flex items-center justify-center gap-2",children:d?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-ink-950 border-t-transparent animate-spin"}),"Parsing..."]}):"Parse Script"}),d&&p.jsx(PI,{stage:v,projectType:e.projectType}),a&&!d&&p.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4",children:[p.jsxs("div",{className:`p-4 border rounded-lg ${a.success?"bg-green-950/30 border-green-700/50":"bg-red-950/30 border-red-700/50"}`,children:[p.jsx("p",{className:`font-bold text-sm ${a.success?"text-green-400":"text-red-400"}`,children:a.success?" Parse Successful":" Parse Failed"}),a.errors.map((M,P)=>p.jsx("p",{className:"text-xs text-red-300 mt-1",children:M},P))]}),a.success&&p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[p.jsxs("div",{className:"bg-ink-800 rounded-lg p-3 text-center",children:[p.jsx("p",{className:"text-2xl font-display text-ember-500",children:a.pages.length}),p.jsx("p",{className:"text-[9px] font-mono text-steel-500 uppercase",children:C()})]}),p.jsxs("div",{className:"bg-ink-800 rounded-lg p-3 text-center",children:[p.jsx("p",{className:"text-2xl font-display text-ember-500",children:k}),p.jsx("p",{className:"text-[9px] font-mono text-steel-500 uppercase",children:E()})]}),p.jsxs("div",{className:"bg-ink-800 rounded-lg p-3 text-center",children:[p.jsx("p",{className:"text-2xl font-display text-ember-500",children:c.length}),p.jsx("p",{className:"text-[9px] font-mono text-steel-500 uppercase",children:"Characters"})]})]}),p.jsxs("button",{onClick:A,className:"w-full py-4 bg-green-600 hover:bg-green-500 text-white font-bold text-sm uppercase tracking-widest rounded-lg transition-all mt-4",children:["Import ",a.pages.length," ",C(),"  Storyboard"]})]})]})]})]})]})})}const zI=({className:e})=>p.jsxs("svg",{className:e,viewBox:"0 0 120 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[p.jsx("rect",{x:"20",y:"30",width:"50",height:"65",rx:"3",stroke:"currentColor",strokeWidth:"1.5",strokeDasharray:"4 3",opacity:"0.3"}),p.jsx("rect",{x:"28",y:"22",width:"50",height:"65",rx:"3",stroke:"currentColor",strokeWidth:"1.5",strokeDasharray:"4 3",opacity:"0.5"}),p.jsx("rect",{x:"36",y:"14",width:"50",height:"65",rx:"3",stroke:"currentColor",strokeWidth:"2",fill:"currentColor",fillOpacity:"0.05"}),p.jsx("line",{x1:"36",y1:"40",x2:"86",y2:"40",stroke:"currentColor",strokeWidth:"1",opacity:"0.3"}),p.jsx("line",{x1:"60",y1:"14",x2:"60",y2:"79",stroke:"currentColor",strokeWidth:"1",opacity:"0.3"}),p.jsx("path",{d:"M98 20l2 6 6 2-6 2-2 6-2-6-6-2 6-2 2-6z",fill:"currentColor",opacity:"0.6"}),p.jsx("path",{d:"M14 50l1.5 4 4 1.5-4 1.5-1.5 4-1.5-4-4-1.5 4-1.5 1.5-4z",fill:"currentColor",opacity:"0.4"})]}),W5=({className:e})=>p.jsxs("svg",{className:e,viewBox:"0 0 160 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[p.jsx("rect",{x:"20",y:"15",width:"120",height:"85",rx:"4",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"6 4",opacity:"0.3"}),p.jsx("rect",{x:"30",y:"25",width:"45",height:"30",rx:"2",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.5"}),p.jsx("rect",{x:"80",y:"25",width:"50",height:"30",rx:"2",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.5"}),p.jsx("rect",{x:"30",y:"60",width:"100",height:"30",rx:"2",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.5"}),p.jsxs("g",{transform:"translate(75, 42) rotate(-45)",opacity:"0.7",children:[p.jsx("rect",{x:"0",y:"0",width:"4",height:"18",rx:"1",fill:"currentColor",fillOpacity:"0.3"}),p.jsx("polygon",{points:"0,18 2,24 4,18",fill:"currentColor",fillOpacity:"0.5"})]}),p.jsx("path",{d:"M148 10l1.5 4.5 4.5 1.5-4.5 1.5-1.5 4.5-1.5-4.5-4.5-1.5 4.5-1.5 1.5-4.5z",fill:"currentColor",opacity:"0.4"})]}),X5=({className:e})=>p.jsxs("svg",{className:e,viewBox:"0 0 120 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[p.jsx("circle",{cx:"40",cy:"35",r:"12",stroke:"currentColor",strokeWidth:"1.5",strokeDasharray:"4 3",opacity:"0.4"}),p.jsx("path",{d:"M22 72c0-10 8-18 18-18s18 8 18 18",stroke:"currentColor",strokeWidth:"1.5",strokeDasharray:"4 3",opacity:"0.4"}),p.jsx("circle",{cx:"75",cy:"30",r:"14",stroke:"currentColor",strokeWidth:"2",opacity:"0.6"}),p.jsx("path",{d:"M55 72c0-12 9-20 20-20s20 8 20 20",stroke:"currentColor",strokeWidth:"2",opacity:"0.6"}),p.jsx("text",{x:"73",y:"37",textAnchor:"middle",fontSize:"16",fontWeight:"bold",fill:"currentColor",opacity:"0.5",children:"?"}),p.jsx("path",{d:"M105 22l1.5 4 4 1.5-4 1.5-1.5 4-1.5-4-4-1.5 4-1.5 1.5-4z",fill:"currentColor",opacity:"0.5"}),p.jsx("path",{d:"M10 55l1 3 3 1-3 1-1 3-1-3-3-1 3-1 1-3z",fill:"currentColor",opacity:"0.3"})]}),jI=({className:e})=>p.jsxs("svg",{className:e,viewBox:"0 0 80 60",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[p.jsx("rect",{x:"8",y:"12",width:"28",height:"38",rx:"2",stroke:"currentColor",strokeWidth:"1",strokeDasharray:"3 2",opacity:"0.3"}),p.jsx("rect",{x:"14",y:"6",width:"28",height:"38",rx:"2",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.5"}),p.jsx("line",{x1:"18",y1:"14",x2:"38",y2:"14",stroke:"currentColor",strokeWidth:"1",opacity:"0.3"}),p.jsx("line",{x1:"18",y1:"19",x2:"34",y2:"19",stroke:"currentColor",strokeWidth:"1",opacity:"0.3"}),p.jsx("line",{x1:"18",y1:"24",x2:"36",y2:"24",stroke:"currentColor",strokeWidth:"1",opacity:"0.3"}),p.jsx("circle",{cx:"58",cy:"30",r:"12",stroke:"currentColor",strokeWidth:"1.5",strokeDasharray:"4 3",opacity:"0.4"}),p.jsx("line",{x1:"58",y1:"24",x2:"58",y2:"36",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.5"}),p.jsx("line",{x1:"52",y1:"30",x2:"64",y2:"30",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.5"})]}),FI={projects:{illustration:zI,title:"Your stories begin here",description:"Every great comic starts with a blank page. Create your first project to set up your style, characters, and storyboard.",tips:["Each project holds its own art style and API keys","Import a script or build panels from scratch","Characters you define carry across every panel"],actionDefault:"Create First Project"},panels:{illustration:W5,title:"Empty page",description:"Add a frame to get started.",tips:[],actionDefault:"Add Frame"},characters:{illustration:X5,title:"Your cast awaits",description:"Define your characters once and they stay consistent across every panel. The more detail you add, the better the AI maintains their look.",tips:["Add physical details like hair color, build, and clothing","Characters are automatically woven into generation prompts","Assign characters to specific panels for consistency"],actionDefault:"Add First Character"},cast:{illustration:X5,title:"No cast yet",description:"Add characters to maintain visual consistency across panels.",tips:["Click + to add a character with their description","Open Character Bank for detailed appearance fields"]},issues:{illustration:jI,title:"No chapters yet",description:"Create your first issue or chapter to start organizing your story into pages.",tips:["Click + to create an issue or chapter","Each issue holds multiple pages of panels"]},"page-spread":{illustration:W5,title:"Empty page",description:"Add frames to bring this page to life.",tips:[]}},ff=({variant:e,showGutters:t=!1,onAction:n,actionLabel:i,compact:o=!1})=>{const a=FI[e],l=a.illustration;return o?p.jsxs("div",{className:`flex flex-col items-center text-center py-6 px-3 rounded-xl border border-dashed transition-colors ${t?"border-gray-300 bg-gray-50":"border-ink-700 bg-ink-800/30"}`,children:[p.jsx(l,{className:`w-16 h-12 mb-3 ${t?"text-gray-400":"text-steel-600"}`}),p.jsx("p",{className:`font-mono text-[10px] uppercase tracking-widest mb-1 ${t?"text-gray-500":"text-steel-500"}`,children:a.title}),p.jsx("p",{className:`text-[10px] leading-relaxed mb-3 max-w-[200px] ${t?"text-gray-400":"text-steel-600"}`,children:a.description}),a.tips.length>0&&p.jsx("ul",{className:"space-y-1 mb-3",children:a.tips.map((c,u)=>p.jsxs("li",{className:`text-[9px] flex items-start gap-1.5 text-left ${t?"text-gray-400":"text-steel-700"}`,children:[p.jsx("span",{className:`mt-0.5 w-1 h-1 rounded-full flex-shrink-0 ${t?"bg-gray-400":"bg-ember-500/50"}`}),c]},u))}),n&&p.jsx("button",{onClick:n,className:"mt-1 px-4 py-1.5 text-[9px] font-mono uppercase tracking-widest rounded-lg border transition-all hover:scale-105 active:scale-95 bg-ember-500/10 text-ember-500 border-ember-500/30 hover:bg-ember-500/20",children:i||a.actionDefault||"Get Started"})]}):p.jsxs("div",{className:"flex flex-col items-center justify-center text-center animate-fade-in select-none py-12",children:[p.jsx(l,{className:`mb-8 ${e==="panels"?"w-48 h-36":"w-36 h-28"} ${t?"text-gray-400":"text-steel-600"}`}),p.jsx("h2",{className:`font-display text-3xl tracking-widest uppercase mb-3 ${t?"text-gray-400":"text-ink-600"}`,children:a.title}),p.jsx("p",{className:`text-sm max-w-md leading-relaxed mb-6 ${t?"text-gray-400":"text-steel-600"}`,children:a.description}),a.tips.length>0&&p.jsxs("div",{className:`rounded-xl border px-6 py-4 mb-6 max-w-sm ${t?"border-gray-300 bg-gray-50":"border-ink-800 bg-ink-900/60"}`,children:[p.jsx("p",{className:`text-[10px] font-mono uppercase tracking-widest mb-3 ${t?"text-gray-500":"text-steel-500"}`,children:"Quick tips"}),p.jsx("ul",{className:"space-y-2 text-left",children:a.tips.map((c,u)=>p.jsxs("li",{className:`text-xs flex items-start gap-2 ${t?"text-gray-500":"text-steel-500"}`,children:[p.jsx("span",{className:`mt-1.5 w-1.5 h-1.5 rounded-full flex-shrink-0 ${t?"bg-gray-400":"bg-ember-500/60"}`}),c]},u))})]}),n&&p.jsx("button",{onClick:n,className:`px-8 py-3 font-display text-lg tracking-widest uppercase rounded-full shadow-lg transition-all hover:scale-105 active:scale-95 ${t?"bg-black text-white hover:bg-gray-800":"bg-ember-500 hover:bg-ember-400 text-ink-950"}`,children:i||a.actionDefault||"Get Started"})]})};var BI={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let qI,HI;function GI(){return{geminiUrl:qI,vertexUrl:HI}}function VI(e,t,n,i){var o,a;if(!(e!=null&&e.baseUrl)){const l=GI();return t?(o=l.vertexUrl)!==null&&o!==void 0?o:n:(a=l.geminiUrl)!==null&&a!==void 0?a:i}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ws{}function xt(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(i,o)=>{if(Object.prototype.hasOwnProperty.call(t,o)){const a=t[o];return a!=null?String(a):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function w(e,t,n){for(let a=0;a<t.length-1;a++){const l=t[a];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in e))if(Array.isArray(n))e[c]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[c])){const u=e[c];if(Array.isArray(n))for(let d=0;d<u.length;d++){const h=u[d];w(h,t.slice(a+1),n[d])}else for(const d of u)w(d,t.slice(a+1),n)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in e||(e[c]=[{}]);const u=e[c];w(u[0],t.slice(a+1),n);return}(!e[l]||typeof e[l]!="object")&&(e[l]={}),e=e[l]}const i=t[t.length-1],o=e[i];if(o!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===o)return;if(typeof o=="object"&&typeof n=="object"&&o!==null&&n!==null)Object.assign(o,n);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(e,n):e[i]=n}function y(e,t,n=void 0){try{if(t.length===1&&t[0]==="_self")return e;for(let i=0;i<t.length;i++){if(typeof e!="object"||e===null)return n;const o=t[i];if(o.endsWith("[]")){const a=o.slice(0,-2);if(a in e){const l=e[a];return Array.isArray(l)?l.map(c=>y(c,t.slice(i+1),n)):n}else return n}else e=e[o]}return e}catch(i){if(i instanceof TypeError)return n;throw i}}function $I(e,t){for(const[n,i]of Object.entries(t)){const o=n.split("."),a=i.split("."),l=new Set;let c=-1;for(let u=0;u<o.length;u++)if(o[u]==="*"){c=u;break}if(c!==-1&&a.length>c)for(let u=c;u<a.length;u++){const d=a[u];d!=="*"&&!d.endsWith("[]")&&!d.endsWith("[0]")&&l.add(d)}mg(e,o,a,0,l)}}function mg(e,t,n,i,o){if(i>=t.length||typeof e!="object"||e===null)return;const a=t[i];if(a.endsWith("[]")){const l=a.slice(0,-2),c=e;if(l in c&&Array.isArray(c[l]))for(const u of c[l])mg(u,t,n,i+1,o)}else if(a==="*"){if(typeof e=="object"&&e!==null&&!Array.isArray(e)){const l=e,c=Object.keys(l).filter(d=>!d.startsWith("_")&&!o.has(d)),u={};for(const d of c)u[d]=l[d];for(const[d,h]of Object.entries(u)){const v=[];for(const b of n.slice(i))b==="*"?v.push(d):v.push(b);w(l,v,h)}for(const d of c)delete l[d]}}else{const l=e;a in l&&mg(l[a],t,n,i+1,o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function a1(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YI(e){const t={},n=y(e,["operationName"]);n!=null&&w(t,["operationName"],n);const i=y(e,["resourceName"]);return i!=null&&w(t,["_url","resourceName"],i),t}function WI(e){const t={},n=y(e,["name"]);n!=null&&w(t,["name"],n);const i=y(e,["metadata"]);i!=null&&w(t,["metadata"],i);const o=y(e,["done"]);o!=null&&w(t,["done"],o);const a=y(e,["error"]);a!=null&&w(t,["error"],a);const l=y(e,["response","generateVideoResponse"]);return l!=null&&w(t,["response"],JI(l)),t}function XI(e){const t={},n=y(e,["name"]);n!=null&&w(t,["name"],n);const i=y(e,["metadata"]);i!=null&&w(t,["metadata"],i);const o=y(e,["done"]);o!=null&&w(t,["done"],o);const a=y(e,["error"]);a!=null&&w(t,["error"],a);const l=y(e,["response"]);return l!=null&&w(t,["response"],KI(l)),t}function JI(e){const t={},n=y(e,["generatedSamples"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>ZI(l))),w(t,["generatedVideos"],a)}const i=y(e,["raiMediaFilteredCount"]);i!=null&&w(t,["raiMediaFilteredCount"],i);const o=y(e,["raiMediaFilteredReasons"]);return o!=null&&w(t,["raiMediaFilteredReasons"],o),t}function KI(e){const t={},n=y(e,["videos"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>QI(l))),w(t,["generatedVideos"],a)}const i=y(e,["raiMediaFilteredCount"]);i!=null&&w(t,["raiMediaFilteredCount"],i);const o=y(e,["raiMediaFilteredReasons"]);return o!=null&&w(t,["raiMediaFilteredReasons"],o),t}function ZI(e){const t={},n=y(e,["video"]);return n!=null&&w(t,["video"],oR(n)),t}function QI(e){const t={},n=y(e,["_self"]);return n!=null&&w(t,["video"],aR(n)),t}function eR(e){const t={},n=y(e,["operationName"]);return n!=null&&w(t,["_url","operationName"],n),t}function tR(e){const t={},n=y(e,["operationName"]);return n!=null&&w(t,["_url","operationName"],n),t}function nR(e){const t={},n=y(e,["name"]);n!=null&&w(t,["name"],n);const i=y(e,["metadata"]);i!=null&&w(t,["metadata"],i);const o=y(e,["done"]);o!=null&&w(t,["done"],o);const a=y(e,["error"]);a!=null&&w(t,["error"],a);const l=y(e,["response"]);return l!=null&&w(t,["response"],iR(l)),t}function iR(e){const t={},n=y(e,["sdkHttpResponse"]);n!=null&&w(t,["sdkHttpResponse"],n);const i=y(e,["parent"]);i!=null&&w(t,["parent"],i);const o=y(e,["documentName"]);return o!=null&&w(t,["documentName"],o),t}function B_(e){const t={},n=y(e,["name"]);n!=null&&w(t,["name"],n);const i=y(e,["metadata"]);i!=null&&w(t,["metadata"],i);const o=y(e,["done"]);o!=null&&w(t,["done"],o);const a=y(e,["error"]);a!=null&&w(t,["error"],a);const l=y(e,["response"]);return l!=null&&w(t,["response"],rR(l)),t}function rR(e){const t={},n=y(e,["sdkHttpResponse"]);n!=null&&w(t,["sdkHttpResponse"],n);const i=y(e,["parent"]);i!=null&&w(t,["parent"],i);const o=y(e,["documentName"]);return o!=null&&w(t,["documentName"],o),t}function oR(e){const t={},n=y(e,["uri"]);n!=null&&w(t,["uri"],n);const i=y(e,["encodedVideo"]);i!=null&&w(t,["videoBytes"],a1(i));const o=y(e,["encoding"]);return o!=null&&w(t,["mimeType"],o),t}function aR(e){const t={},n=y(e,["gcsUri"]);n!=null&&w(t,["uri"],n);const i=y(e,["bytesBase64Encoded"]);i!=null&&w(t,["videoBytes"],a1(i));const o=y(e,["mimeType"]);return o!=null&&w(t,["mimeType"],o),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var J5;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(J5||(J5={}));var K5;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(K5||(K5={}));var Z5;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(Z5||(Z5={}));var Ul;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(Ul||(Ul={}));var Q5;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Q5||(Q5={}));var eb;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(eb||(eb={}));var tb;(function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(tb||(tb={}));var nb;(function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(nb||(nb={}));var ib;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(ib||(ib={}));var rb;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(rb||(rb={}));var ob;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"})(ob||(ob={}));var ab;(function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e.MINIMAL="MINIMAL"})(ab||(ab={}));var sb;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(sb||(sb={}));var lb;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(lb||(lb={}));var cb;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(cb||(cb={}));var ub;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE",e.IMAGE_RECITATION="IMAGE_RECITATION",e.IMAGE_OTHER="IMAGE_OTHER"})(ub||(ub={}));var db;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(db||(db={}));var fb;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(fb||(fb={}));var hb;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(hb||(hb={}));var pb;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"})(pb||(pb={}));var mb;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(mb||(mb={}));var fp;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(fp||(fp={}));var gb;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(gb||(gb={}));var vb;(function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(vb||(vb={}));var yb;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(yb||(yb={}));var gg;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(gg||(gg={}));var bb;(function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"})(bb||(bb={}));var xb;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",e.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(xb||(xb={}));var vg;(function(e){e.COLLECTION="COLLECTION"})(vg||(vg={}));var wb;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(wb||(wb={}));var _b;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(_b||(_b={}));var Sb;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(Sb||(Sb={}));var Eb;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(Eb||(Eb={}));var Nb;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(Nb||(Nb={}));var Ab;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Ab||(Ab={}));var Cb;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Cb||(Cb={}));var Tb;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Tb||(Tb={}));var kb;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(kb||(kb={}));var Ib;(function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"})(Ib||(Ib={}));var Rb;(function(e){e.ASSET="ASSET",e.STYLE="STYLE"})(Rb||(Rb={}));var Lb;(function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"})(Lb||(Lb={}));var Mb;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(Mb||(Mb={}));var Db;(function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING",e.DISTILLATION="DISTILLATION"})(Db||(Db={}));var Pb;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"})(Pb||(Pb={}));var Ob;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(Ob||(Ob={}));var Ub;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED",e.REGISTERED="REGISTERED"})(Ub||(Ub={}));var zb;(function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"})(zb||(zb={}));var jb;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(jb||(jb={}));var Fb;(function(e){e.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",e.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",e.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(Fb||(Fb={}));var Bb;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.ACTIVITY_START="ACTIVITY_START",e.ACTIVITY_END="ACTIVITY_END"})(Bb||(Bb={}));var qb;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(qb||(qb={}));var Hb;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Hb||(Hb={}));var Gb;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(Gb||(Gb={}));var Vb;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Vb||(Vb={}));var $b;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})($b||($b={}));var Yb;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})(Yb||(Yb={}));var Ou;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(Ou||(Ou={}));class yg{constructor(t){const n={};for(const i of t.headers.entries())n[i[0]]=i[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class $d{get text(){var t,n,i,o,a,l,c,u;if(((o=(i=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",h=!1;const v=[];for(const b of(u=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&u!==void 0?u:[]){for(const[g,A]of Object.entries(b))g!=="text"&&g!=="thought"&&g!=="thoughtSignature"&&(A!==null||A!==void 0)&&v.push(g);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;h=!0,d+=b.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?d:void 0}get data(){var t,n,i,o,a,l,c,u;if(((o=(i=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const h=[];for(const v of(u=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&u!==void 0?u:[]){for(const[b,g]of Object.entries(v))b!=="inlineData"&&(g!==null||g!==void 0)&&h.push(b);v.inlineData&&typeof v.inlineData.data=="string"&&(d+=atob(v.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var t,n,i,o,a,l,c,u;if(((o=(i=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(u=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||u===void 0?void 0:u.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var t,n,i,o,a,l,c,u,d;if(((o=(i=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(u=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||u===void 0?void 0:u.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var t,n,i,o,a,l,c,u,d;if(((o=(i=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(u=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||u===void 0?void 0:u.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.output}}class Wb{}class Xb{}class sR{}class lR{}class cR{}class uR{}class Jb{}class Kb{}class Zb{}class dR{}class hp{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const i=new hp;let o;const a=t;return n?o=XI(a):o=WI(a),Object.assign(i,o),i}}class Qb{}class ex{}class tx{}class nx{}class fR{}class hR{}class pR{}class s1{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const i=new s1,a=nR(t);return Object.assign(i,a),i}}class mR{}class gR{}class vR{}class yR{}class ix{}class bR{get text(){var t,n,i;let o="",a=!1;const l=[];for(const c of(i=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[u,d]of Object.entries(c))u!=="text"&&u!=="thought"&&d!==null&&l.push(u);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;a=!0,o+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?o:void 0}get data(){var t,n,i;let o="";const a=[];for(const l of(i=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[c,u]of Object.entries(l))c!=="inlineData"&&u!==null&&a.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(o+=atob(l.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class xR{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class l1{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const i=new l1,a=B_(t);return Object.assign(i,a),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ln(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function q_(e,t){const n=Ln(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function H_(e){return Array.isArray(e)?e.map(t=>pp(t)):[pp(e)]}function pp(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function G_(e){const t=pp(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function V_(e){const t=pp(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function rx(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function $_(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>rx(t)):[rx(e)]}function bg(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function ox(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function ax(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Ar(e){if(e==null)throw new Error("ContentUnion is required");return bg(e)?e:{role:"user",parts:$_(e)}}function c1(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const i=Ar(n);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(e.isVertexAI()){const n=Ar(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>Ar(n)):[Ar(t)]}function Ko(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(ox(e)||ax(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ar(e)]}const t=[],n=[],i=bg(e[0]);for(const o of e){const a=bg(o);if(a!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)t.push(o);else{if(ox(o)||ax(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(o)}}return i||t.push({role:"user",parts:$_(n)}),t}function wR(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(i=>i!=="null");if(n.length===1)t.type=Object.values(Ul).includes(n[0].toUpperCase())?n[0].toUpperCase():Ul.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const i of n)t.anyOf.push({type:Object.values(Ul).includes(i.toUpperCase())?i.toUpperCase():Ul.TYPE_UNSPECIFIED})}}function Gu(e){const t={},n=["items"],i=["anyOf"],o=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=e.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(t.nullable=!0,e=a[1]):a[1].type==="null"&&(t.nullable=!0,e=a[0])),e.type instanceof Array&&wR(e.type,t);for(const[l,c]of Object.entries(e))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;t.type=Object.values(Ul).includes(c.toUpperCase())?c.toUpperCase():Ul.TYPE_UNSPECIFIED}else if(n.includes(l))t[l]=Gu(c);else if(i.includes(l)){const u=[];for(const d of c){if(d.type=="null"){t.nullable=!0;continue}u.push(Gu(d))}t[l]=u}else if(o.includes(l)){const u={};for(const[d,h]of Object.entries(c))u[d]=Gu(h);t[l]=u}else{if(l==="additionalProperties")continue;t[l]=c}return t}function u1(e){return Gu(e)}function d1(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function f1(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function nd(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=Gu(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=Gu(t.response));return e}function id(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function _R(e,t,n,i=1){const o=!t.startsWith(`${n}/`)&&t.split("/").length===i;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:o?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:o?`${n}/${t}`:t}function Xs(e,t){if(typeof t!="string")throw new Error("name must be a string");return _R(e,t,"cachedContents")}function Y_(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Hl(e){return a1(e)}function SR(e){return e!=null&&typeof e=="object"&&"name"in e}function ER(e){return e!=null&&typeof e=="object"&&"video"in e}function NR(e){return e!=null&&typeof e=="object"&&"uri"in e}function W_(e){var t;let n;if(SR(e)&&(n=e.name),!(NR(e)&&(n=e.uri,n===void 0))&&!(ER(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const o=n.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${n}`);n=o[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function X_(e,t){let n;return e.isVertexAI()?n=t?"publishers/google/models":"models":n=t?"models":"tunedModels",n}function J_(e){for(const t of["models","tunedModels","publisherModels"])if(AR(e,t))return e[t];return[]}function AR(e,t){return e!==null&&typeof e=="object"&&t in e}function CR(e,t={}){const n=e,i={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(i.responseJsonSchema=n.outputSchema),t.behavior&&(i.behavior=t.behavior),{functionDeclarations:[i]}}function TR(e,t={}){const n=[],i=new Set;for(const o of e){const a=o.name;if(i.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);i.add(a);const l=CR(o,t);l.functionDeclarations&&n.push(...l.functionDeclarations)}return{functionDeclarations:n}}function K_(e,t){let n;if(typeof t=="string")if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))n={format:"bigquery",bigqueryUri:t};else throw new Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))n={fileName:t};else throw new Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;const i=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,o=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(o>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||o!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function kR(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function Z_(e){if(typeof e!="object"||e===null)return{};const t=e,n=t.inlinedResponses;if(typeof n!="object"||n===null)return e;const o=n.inlinedResponses;if(!Array.isArray(o)||o.length===0)return e;let a=!1;for(const l of o){if(typeof l!="object"||l===null)continue;const u=l.response;if(typeof u!="object"||u===null)continue;if(u.embedding!==void 0){a=!0;break}}return a&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function rd(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function Q_(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function IR(e){const t={},n=y(e,["responsesFile"]);n!=null&&w(t,["fileName"],n);const i=y(e,["inlinedResponses","inlinedResponses"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>uL(l))),w(t,["inlinedResponses"],a)}const o=y(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>l)),w(t,["inlinedEmbedContentResponses"],a)}return t}function RR(e){const t={},n=y(e,["predictionsFormat"]);n!=null&&w(t,["format"],n);const i=y(e,["gcsDestination","outputUriPrefix"]);i!=null&&w(t,["gcsUri"],i);const o=y(e,["bigqueryDestination","outputUri"]);return o!=null&&w(t,["bigqueryUri"],o),t}function LR(e){const t={},n=y(e,["format"]);n!=null&&w(t,["predictionsFormat"],n);const i=y(e,["gcsUri"]);i!=null&&w(t,["gcsDestination","outputUriPrefix"],i);const o=y(e,["bigqueryUri"]);if(o!=null&&w(t,["bigqueryDestination","outputUri"],o),y(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(y(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(y(e,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}function Jh(e){const t={},n=y(e,["name"]);n!=null&&w(t,["name"],n);const i=y(e,["metadata","displayName"]);i!=null&&w(t,["displayName"],i);const o=y(e,["metadata","state"]);o!=null&&w(t,["state"],Q_(o));const a=y(e,["metadata","createTime"]);a!=null&&w(t,["createTime"],a);const l=y(e,["metadata","endTime"]);l!=null&&w(t,["endTime"],l);const c=y(e,["metadata","updateTime"]);c!=null&&w(t,["updateTime"],c);const u=y(e,["metadata","model"]);u!=null&&w(t,["model"],u);const d=y(e,["metadata","output"]);return d!=null&&w(t,["dest"],IR(Z_(d))),t}function xg(e){const t={},n=y(e,["name"]);n!=null&&w(t,["name"],n);const i=y(e,["displayName"]);i!=null&&w(t,["displayName"],i);const o=y(e,["state"]);o!=null&&w(t,["state"],Q_(o));const a=y(e,["error"]);a!=null&&w(t,["error"],a);const l=y(e,["createTime"]);l!=null&&w(t,["createTime"],l);const c=y(e,["startTime"]);c!=null&&w(t,["startTime"],c);const u=y(e,["endTime"]);u!=null&&w(t,["endTime"],u);const d=y(e,["updateTime"]);d!=null&&w(t,["updateTime"],d);const h=y(e,["model"]);h!=null&&w(t,["model"],h);const v=y(e,["inputConfig"]);v!=null&&w(t,["src"],MR(v));const b=y(e,["outputConfig"]);b!=null&&w(t,["dest"],RR(Z_(b)));const g=y(e,["completionStats"]);return g!=null&&w(t,["completionStats"],g),t}function MR(e){const t={},n=y(e,["instancesFormat"]);n!=null&&w(t,["format"],n);const i=y(e,["gcsSource","uris"]);i!=null&&w(t,["gcsUri"],i);const o=y(e,["bigquerySource","inputUri"]);return o!=null&&w(t,["bigqueryUri"],o),t}function DR(e,t){const n={};if(y(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(y(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(y(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=y(t,["fileName"]);i!=null&&w(n,["fileName"],i);const o=y(t,["inlinedRequests"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>cL(e,l))),w(n,["requests","requests"],a)}return n}function PR(e){const t={},n=y(e,["format"]);n!=null&&w(t,["instancesFormat"],n);const i=y(e,["gcsUri"]);i!=null&&w(t,["gcsSource","uris"],i);const o=y(e,["bigqueryUri"]);if(o!=null&&w(t,["bigquerySource","inputUri"],o),y(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(y(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function OR(e){const t={},n=y(e,["data"]);if(n!=null&&w(t,["data"],n),y(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=y(e,["mimeType"]);return i!=null&&w(t,["mimeType"],i),t}function UR(e,t){const n={},i=y(t,["name"]);return i!=null&&w(n,["_url","name"],rd(e,i)),n}function zR(e,t){const n={},i=y(t,["name"]);return i!=null&&w(n,["_url","name"],rd(e,i)),n}function jR(e){const t={},n=y(e,["content"]);n!=null&&w(t,["content"],n);const i=y(e,["citationMetadata"]);i!=null&&w(t,["citationMetadata"],FR(i));const o=y(e,["tokenCount"]);o!=null&&w(t,["tokenCount"],o);const a=y(e,["finishReason"]);a!=null&&w(t,["finishReason"],a);const l=y(e,["avgLogprobs"]);l!=null&&w(t,["avgLogprobs"],l);const c=y(e,["groundingMetadata"]);c!=null&&w(t,["groundingMetadata"],c);const u=y(e,["index"]);u!=null&&w(t,["index"],u);const d=y(e,["logprobsResult"]);d!=null&&w(t,["logprobsResult"],d);const h=y(e,["safetyRatings"]);if(h!=null){let b=h;Array.isArray(b)&&(b=b.map(g=>g)),w(t,["safetyRatings"],b)}const v=y(e,["urlContextMetadata"]);return v!=null&&w(t,["urlContextMetadata"],v),t}function FR(e){const t={},n=y(e,["citationSources"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>o)),w(t,["citations"],i)}return t}function eS(e){const t={},n=y(e,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>vL(a))),w(t,["parts"],o)}const i=y(e,["role"]);return i!=null&&w(t,["role"],i),t}function BR(e,t){const n={},i=y(e,["displayName"]);if(t!==void 0&&i!=null&&w(t,["batch","displayName"],i),y(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function qR(e,t){const n={},i=y(e,["displayName"]);t!==void 0&&i!=null&&w(t,["displayName"],i);const o=y(e,["dest"]);return t!==void 0&&o!=null&&w(t,["outputConfig"],LR(kR(o))),n}function sx(e,t){const n={},i=y(t,["model"]);i!=null&&w(n,["_url","model"],Ln(e,i));const o=y(t,["src"]);o!=null&&w(n,["batch","inputConfig"],DR(e,K_(e,o)));const a=y(t,["config"]);return a!=null&&BR(a,n),n}function HR(e,t){const n={},i=y(t,["model"]);i!=null&&w(n,["model"],Ln(e,i));const o=y(t,["src"]);o!=null&&w(n,["inputConfig"],PR(K_(e,o)));const a=y(t,["config"]);return a!=null&&qR(a,n),n}function GR(e,t){const n={},i=y(e,["displayName"]);return t!==void 0&&i!=null&&w(t,["batch","displayName"],i),n}function VR(e,t){const n={},i=y(t,["model"]);i!=null&&w(n,["_url","model"],Ln(e,i));const o=y(t,["src"]);o!=null&&w(n,["batch","inputConfig"],ZR(e,o));const a=y(t,["config"]);return a!=null&&GR(a,n),n}function $R(e,t){const n={},i=y(t,["name"]);return i!=null&&w(n,["_url","name"],rd(e,i)),n}function YR(e,t){const n={},i=y(t,["name"]);return i!=null&&w(n,["_url","name"],rd(e,i)),n}function WR(e){const t={},n=y(e,["sdkHttpResponse"]);n!=null&&w(t,["sdkHttpResponse"],n);const i=y(e,["name"]);i!=null&&w(t,["name"],i);const o=y(e,["done"]);o!=null&&w(t,["done"],o);const a=y(e,["error"]);return a!=null&&w(t,["error"],a),t}function XR(e){const t={},n=y(e,["sdkHttpResponse"]);n!=null&&w(t,["sdkHttpResponse"],n);const i=y(e,["name"]);i!=null&&w(t,["name"],i);const o=y(e,["done"]);o!=null&&w(t,["done"],o);const a=y(e,["error"]);return a!=null&&w(t,["error"],a),t}function JR(e,t){const n={},i=y(t,["contents"]);if(i!=null){let a=c1(e,i);Array.isArray(a)&&(a=a.map(l=>l)),w(n,["requests[]","request","content"],a)}const o=y(t,["config"]);return o!=null&&(w(n,["_self"],KR(o,n)),$I(n,{"requests[].*":"requests[].request.*"})),n}function KR(e,t){const n={},i=y(e,["taskType"]);t!==void 0&&i!=null&&w(t,["requests[]","taskType"],i);const o=y(e,["title"]);t!==void 0&&o!=null&&w(t,["requests[]","title"],o);const a=y(e,["outputDimensionality"]);if(t!==void 0&&a!=null&&w(t,["requests[]","outputDimensionality"],a),y(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(y(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function ZR(e,t){const n={},i=y(t,["fileName"]);i!=null&&w(n,["file_name"],i);const o=y(t,["inlinedRequests"]);return o!=null&&w(n,["requests"],JR(e,o)),n}function QR(e){const t={};if(y(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=y(e,["fileUri"]);n!=null&&w(t,["fileUri"],n);const i=y(e,["mimeType"]);return i!=null&&w(t,["mimeType"],i),t}function eL(e){const t={},n=y(e,["id"]);n!=null&&w(t,["id"],n);const i=y(e,["args"]);i!=null&&w(t,["args"],i);const o=y(e,["name"]);if(o!=null&&w(t,["name"],o),y(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(y(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function tL(e){const t={},n=y(e,["allowedFunctionNames"]);n!=null&&w(t,["allowedFunctionNames"],n);const i=y(e,["mode"]);if(i!=null&&w(t,["mode"],i),y(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function nL(e,t,n){const i={},o=y(t,["systemInstruction"]);n!==void 0&&o!=null&&w(n,["systemInstruction"],eS(Ar(o)));const a=y(t,["temperature"]);a!=null&&w(i,["temperature"],a);const l=y(t,["topP"]);l!=null&&w(i,["topP"],l);const c=y(t,["topK"]);c!=null&&w(i,["topK"],c);const u=y(t,["candidateCount"]);u!=null&&w(i,["candidateCount"],u);const d=y(t,["maxOutputTokens"]);d!=null&&w(i,["maxOutputTokens"],d);const h=y(t,["stopSequences"]);h!=null&&w(i,["stopSequences"],h);const v=y(t,["responseLogprobs"]);v!=null&&w(i,["responseLogprobs"],v);const b=y(t,["logprobs"]);b!=null&&w(i,["logprobs"],b);const g=y(t,["presencePenalty"]);g!=null&&w(i,["presencePenalty"],g);const A=y(t,["frequencyPenalty"]);A!=null&&w(i,["frequencyPenalty"],A);const _=y(t,["seed"]);_!=null&&w(i,["seed"],_);const C=y(t,["responseMimeType"]);C!=null&&w(i,["responseMimeType"],C);const E=y(t,["responseSchema"]);E!=null&&w(i,["responseSchema"],u1(E));const R=y(t,["responseJsonSchema"]);if(R!=null&&w(i,["responseJsonSchema"],R),y(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(y(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=y(t,["safetySettings"]);if(n!==void 0&&k!=null){let q=k;Array.isArray(q)&&(q=q.map(I=>yL(I))),w(n,["safetySettings"],q)}const M=y(t,["tools"]);if(n!==void 0&&M!=null){let q=id(M);Array.isArray(q)&&(q=q.map(I=>xL(nd(I)))),w(n,["tools"],q)}const P=y(t,["toolConfig"]);if(n!==void 0&&P!=null&&w(n,["toolConfig"],bL(P)),y(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const W=y(t,["cachedContent"]);n!==void 0&&W!=null&&w(n,["cachedContent"],Xs(e,W));const V=y(t,["responseModalities"]);V!=null&&w(i,["responseModalities"],V);const $=y(t,["mediaResolution"]);$!=null&&w(i,["mediaResolution"],$);const j=y(t,["speechConfig"]);if(j!=null&&w(i,["speechConfig"],d1(j)),y(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const X=y(t,["thinkingConfig"]);X!=null&&w(i,["thinkingConfig"],X);const z=y(t,["imageConfig"]);z!=null&&w(i,["imageConfig"],lL(z));const U=y(t,["enableEnhancedCivicAnswers"]);if(U!=null&&w(i,["enableEnhancedCivicAnswers"],U),y(t,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return i}function iL(e){const t={},n=y(e,["sdkHttpResponse"]);n!=null&&w(t,["sdkHttpResponse"],n);const i=y(e,["candidates"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(d=>jR(d))),w(t,["candidates"],u)}const o=y(e,["modelVersion"]);o!=null&&w(t,["modelVersion"],o);const a=y(e,["promptFeedback"]);a!=null&&w(t,["promptFeedback"],a);const l=y(e,["responseId"]);l!=null&&w(t,["responseId"],l);const c=y(e,["usageMetadata"]);return c!=null&&w(t,["usageMetadata"],c),t}function rL(e,t){const n={},i=y(t,["name"]);return i!=null&&w(n,["_url","name"],rd(e,i)),n}function oL(e,t){const n={},i=y(t,["name"]);return i!=null&&w(n,["_url","name"],rd(e,i)),n}function aL(e){const t={};if(y(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=y(e,["enableWidget"]);return n!=null&&w(t,["enableWidget"],n),t}function sL(e){const t={};if(y(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(y(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=y(e,["timeRangeFilter"]);return n!=null&&w(t,["timeRangeFilter"],n),t}function lL(e){const t={},n=y(e,["aspectRatio"]);n!=null&&w(t,["aspectRatio"],n);const i=y(e,["imageSize"]);if(i!=null&&w(t,["imageSize"],i),y(e,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(y(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(y(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function cL(e,t){const n={},i=y(t,["model"]);i!=null&&w(n,["request","model"],Ln(e,i));const o=y(t,["contents"]);if(o!=null){let c=Ko(o);Array.isArray(c)&&(c=c.map(u=>eS(u))),w(n,["request","contents"],c)}const a=y(t,["metadata"]);a!=null&&w(n,["metadata"],a);const l=y(t,["config"]);return l!=null&&w(n,["request","generationConfig"],nL(e,l,y(n,["request"],{}))),n}function uL(e){const t={},n=y(e,["response"]);n!=null&&w(t,["response"],iL(n));const i=y(e,["metadata"]);i!=null&&w(t,["metadata"],i);const o=y(e,["error"]);return o!=null&&w(t,["error"],o),t}function dL(e,t){const n={},i=y(e,["pageSize"]);t!==void 0&&i!=null&&w(t,["_query","pageSize"],i);const o=y(e,["pageToken"]);if(t!==void 0&&o!=null&&w(t,["_query","pageToken"],o),y(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function fL(e,t){const n={},i=y(e,["pageSize"]);t!==void 0&&i!=null&&w(t,["_query","pageSize"],i);const o=y(e,["pageToken"]);t!==void 0&&o!=null&&w(t,["_query","pageToken"],o);const a=y(e,["filter"]);return t!==void 0&&a!=null&&w(t,["_query","filter"],a),n}function hL(e){const t={},n=y(e,["config"]);return n!=null&&dL(n,t),t}function pL(e){const t={},n=y(e,["config"]);return n!=null&&fL(n,t),t}function mL(e){const t={},n=y(e,["sdkHttpResponse"]);n!=null&&w(t,["sdkHttpResponse"],n);const i=y(e,["nextPageToken"]);i!=null&&w(t,["nextPageToken"],i);const o=y(e,["operations"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>Jh(l))),w(t,["batchJobs"],a)}return t}function gL(e){const t={},n=y(e,["sdkHttpResponse"]);n!=null&&w(t,["sdkHttpResponse"],n);const i=y(e,["nextPageToken"]);i!=null&&w(t,["nextPageToken"],i);const o=y(e,["batchPredictionJobs"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>xg(l))),w(t,["batchJobs"],a)}return t}function vL(e){const t={},n=y(e,["mediaResolution"]);n!=null&&w(t,["mediaResolution"],n);const i=y(e,["codeExecutionResult"]);i!=null&&w(t,["codeExecutionResult"],i);const o=y(e,["executableCode"]);o!=null&&w(t,["executableCode"],o);const a=y(e,["fileData"]);a!=null&&w(t,["fileData"],QR(a));const l=y(e,["functionCall"]);l!=null&&w(t,["functionCall"],eL(l));const c=y(e,["functionResponse"]);c!=null&&w(t,["functionResponse"],c);const u=y(e,["inlineData"]);u!=null&&w(t,["inlineData"],OR(u));const d=y(e,["text"]);d!=null&&w(t,["text"],d);const h=y(e,["thought"]);h!=null&&w(t,["thought"],h);const v=y(e,["thoughtSignature"]);v!=null&&w(t,["thoughtSignature"],v);const b=y(e,["videoMetadata"]);return b!=null&&w(t,["videoMetadata"],b),t}function yL(e){const t={},n=y(e,["category"]);if(n!=null&&w(t,["category"],n),y(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=y(e,["threshold"]);return i!=null&&w(t,["threshold"],i),t}function bL(e){const t={},n=y(e,["retrievalConfig"]);n!=null&&w(t,["retrievalConfig"],n);const i=y(e,["functionCallingConfig"]);return i!=null&&w(t,["functionCallingConfig"],tL(i)),t}function xL(e){const t={};if(y(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=y(e,["computerUse"]);n!=null&&w(t,["computerUse"],n);const i=y(e,["fileSearch"]);i!=null&&w(t,["fileSearch"],i);const o=y(e,["codeExecution"]);if(o!=null&&w(t,["codeExecution"],o),y(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=y(e,["functionDeclarations"]);if(a!=null){let h=a;Array.isArray(h)&&(h=h.map(v=>v)),w(t,["functionDeclarations"],h)}const l=y(e,["googleMaps"]);l!=null&&w(t,["googleMaps"],aL(l));const c=y(e,["googleSearch"]);c!=null&&w(t,["googleSearch"],sL(c));const u=y(e,["googleSearchRetrieval"]);u!=null&&w(t,["googleSearchRetrieval"],u);const d=y(e,["urlContext"]);return d!=null&&w(t,["urlContext"],d),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var $s;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"})($s||($s={}));class Pc{constructor(t,n,i,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,i,o)}init(t,n,i){var o,a;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!i||Object.keys(i).length===0?l={config:{}}:typeof i=="object"?l=Object.assign({},i):l=i,l.config&&(l.config.pageToken=n.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(a=(o=l.config)===null||o===void 0?void 0:o.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wL extends Ws{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Pc($s.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(t){const n=sx(this.apiClient,t),i=n._url,o=xt("{model}:batchGenerateContent",i),c=n.batch.inputConfig.requests,u=c.requests,d=[];for(const h of u){const v=Object.assign({},h);if(v.systemInstruction){const b=v.systemInstruction;delete v.systemInstruction;const g=v.request;g.systemInstruction=b,v.request=g}d.push(v)}return c.requests=d,delete n.config,delete n._url,delete n._query,{path:o,body:n}}getGcsUri(t){if(typeof t=="string")return t.startsWith("gs://")?t:void 0;if(!Array.isArray(t)&&t.gcsUri&&t.gcsUri.length>0)return t.gcsUri[0]}getBigqueryUri(t){if(typeof t=="string")return t.startsWith("bq://")?t:void 0;if(!Array.isArray(t))return t.bigqueryUri}formatDestination(t,n){const i=n?Object.assign({},n):{},o=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${o}`),i.dest===void 0){const a=this.getGcsUri(t),l=this.getBigqueryUri(t);if(a)a.endsWith(".jsonl")?i.dest=`${a.slice(0,-6)}/dest`:i.dest=`${a}_dest_${o}`;else if(l)i.dest=`${l}_dest_${o}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=HR(this.apiClient,t);return c=xt("batchPredictionJobs",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),l.then(h=>xg(h))}else{const d=sx(this.apiClient,t);return c=xt("{model}:batchGenerateContent",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),l.then(h=>Jh(h))}}async createEmbeddingsInternal(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=VR(this.apiClient,t);return a=xt("{model}:asyncBatchEmbedContent",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>Jh(u))}}async get(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=oL(this.apiClient,t);return c=xt("batchPredictionJobs/{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),l.then(h=>xg(h))}else{const d=rL(this.apiClient,t);return c=xt("batches/{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),l.then(h=>Jh(h))}}async cancel(t){var n,i,o,a;let l="",c={};if(this.apiClient.isVertexAI()){const u=zR(this.apiClient,t);l=xt("batchPredictionJobs/{name}:cancel",u._url),c=u._query,delete u._url,delete u._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal})}else{const u=UR(this.apiClient,t);l=xt("batches/{name}:cancel",u._url),c=u._query,delete u._url,delete u._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=pL(t);return c=xt("batchPredictionJobs",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=gL(h),b=new ix;return Object.assign(b,v),b})}else{const d=hL(t);return c=xt("batches",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=mL(h),b=new ix;return Object.assign(b,v),b})}}async delete(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=YR(this.apiClient,t);return c=xt("batchPredictionJobs/{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>XR(h))}else{const d=$R(this.apiClient,t);return c=xt("batches/{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>WR(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _L(e){const t={},n=y(e,["data"]);if(n!=null&&w(t,["data"],n),y(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=y(e,["mimeType"]);return i!=null&&w(t,["mimeType"],i),t}function lx(e){const t={},n=y(e,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>VL(a))),w(t,["parts"],o)}const i=y(e,["role"]);return i!=null&&w(t,["role"],i),t}function SL(e,t){const n={},i=y(e,["ttl"]);t!==void 0&&i!=null&&w(t,["ttl"],i);const o=y(e,["expireTime"]);t!==void 0&&o!=null&&w(t,["expireTime"],o);const a=y(e,["displayName"]);t!==void 0&&a!=null&&w(t,["displayName"],a);const l=y(e,["contents"]);if(t!==void 0&&l!=null){let h=Ko(l);Array.isArray(h)&&(h=h.map(v=>lx(v))),w(t,["contents"],h)}const c=y(e,["systemInstruction"]);t!==void 0&&c!=null&&w(t,["systemInstruction"],lx(Ar(c)));const u=y(e,["tools"]);if(t!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(v=>YL(v))),w(t,["tools"],h)}const d=y(e,["toolConfig"]);if(t!==void 0&&d!=null&&w(t,["toolConfig"],$L(d)),y(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function EL(e,t){const n={},i=y(e,["ttl"]);t!==void 0&&i!=null&&w(t,["ttl"],i);const o=y(e,["expireTime"]);t!==void 0&&o!=null&&w(t,["expireTime"],o);const a=y(e,["displayName"]);t!==void 0&&a!=null&&w(t,["displayName"],a);const l=y(e,["contents"]);if(t!==void 0&&l!=null){let v=Ko(l);Array.isArray(v)&&(v=v.map(b=>b)),w(t,["contents"],v)}const c=y(e,["systemInstruction"]);t!==void 0&&c!=null&&w(t,["systemInstruction"],Ar(c));const u=y(e,["tools"]);if(t!==void 0&&u!=null){let v=u;Array.isArray(v)&&(v=v.map(b=>WL(b))),w(t,["tools"],v)}const d=y(e,["toolConfig"]);t!==void 0&&d!=null&&w(t,["toolConfig"],d);const h=y(e,["kmsKeyName"]);return t!==void 0&&h!=null&&w(t,["encryption_spec","kmsKeyName"],h),n}function NL(e,t){const n={},i=y(t,["model"]);i!=null&&w(n,["model"],q_(e,i));const o=y(t,["config"]);return o!=null&&SL(o,n),n}function AL(e,t){const n={},i=y(t,["model"]);i!=null&&w(n,["model"],q_(e,i));const o=y(t,["config"]);return o!=null&&EL(o,n),n}function CL(e,t){const n={},i=y(t,["name"]);return i!=null&&w(n,["_url","name"],Xs(e,i)),n}function TL(e,t){const n={},i=y(t,["name"]);return i!=null&&w(n,["_url","name"],Xs(e,i)),n}function kL(e){const t={},n=y(e,["sdkHttpResponse"]);return n!=null&&w(t,["sdkHttpResponse"],n),t}function IL(e){const t={},n=y(e,["sdkHttpResponse"]);return n!=null&&w(t,["sdkHttpResponse"],n),t}function RL(e){const t={};if(y(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=y(e,["fileUri"]);n!=null&&w(t,["fileUri"],n);const i=y(e,["mimeType"]);return i!=null&&w(t,["mimeType"],i),t}function LL(e){const t={},n=y(e,["id"]);n!=null&&w(t,["id"],n);const i=y(e,["args"]);i!=null&&w(t,["args"],i);const o=y(e,["name"]);if(o!=null&&w(t,["name"],o),y(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(y(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function ML(e){const t={},n=y(e,["allowedFunctionNames"]);n!=null&&w(t,["allowedFunctionNames"],n);const i=y(e,["mode"]);if(i!=null&&w(t,["mode"],i),y(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function DL(e){const t={},n=y(e,["description"]);n!=null&&w(t,["description"],n);const i=y(e,["name"]);i!=null&&w(t,["name"],i);const o=y(e,["parameters"]);o!=null&&w(t,["parameters"],o);const a=y(e,["parametersJsonSchema"]);a!=null&&w(t,["parametersJsonSchema"],a);const l=y(e,["response"]);l!=null&&w(t,["response"],l);const c=y(e,["responseJsonSchema"]);if(c!=null&&w(t,["responseJsonSchema"],c),y(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function PL(e,t){const n={},i=y(t,["name"]);return i!=null&&w(n,["_url","name"],Xs(e,i)),n}function OL(e,t){const n={},i=y(t,["name"]);return i!=null&&w(n,["_url","name"],Xs(e,i)),n}function UL(e){const t={};if(y(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=y(e,["enableWidget"]);return n!=null&&w(t,["enableWidget"],n),t}function zL(e){const t={};if(y(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(y(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=y(e,["timeRangeFilter"]);return n!=null&&w(t,["timeRangeFilter"],n),t}function jL(e,t){const n={},i=y(e,["pageSize"]);t!==void 0&&i!=null&&w(t,["_query","pageSize"],i);const o=y(e,["pageToken"]);return t!==void 0&&o!=null&&w(t,["_query","pageToken"],o),n}function FL(e,t){const n={},i=y(e,["pageSize"]);t!==void 0&&i!=null&&w(t,["_query","pageSize"],i);const o=y(e,["pageToken"]);return t!==void 0&&o!=null&&w(t,["_query","pageToken"],o),n}function BL(e){const t={},n=y(e,["config"]);return n!=null&&jL(n,t),t}function qL(e){const t={},n=y(e,["config"]);return n!=null&&FL(n,t),t}function HL(e){const t={},n=y(e,["sdkHttpResponse"]);n!=null&&w(t,["sdkHttpResponse"],n);const i=y(e,["nextPageToken"]);i!=null&&w(t,["nextPageToken"],i);const o=y(e,["cachedContents"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>l)),w(t,["cachedContents"],a)}return t}function GL(e){const t={},n=y(e,["sdkHttpResponse"]);n!=null&&w(t,["sdkHttpResponse"],n);const i=y(e,["nextPageToken"]);i!=null&&w(t,["nextPageToken"],i);const o=y(e,["cachedContents"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>l)),w(t,["cachedContents"],a)}return t}function VL(e){const t={},n=y(e,["mediaResolution"]);n!=null&&w(t,["mediaResolution"],n);const i=y(e,["codeExecutionResult"]);i!=null&&w(t,["codeExecutionResult"],i);const o=y(e,["executableCode"]);o!=null&&w(t,["executableCode"],o);const a=y(e,["fileData"]);a!=null&&w(t,["fileData"],RL(a));const l=y(e,["functionCall"]);l!=null&&w(t,["functionCall"],LL(l));const c=y(e,["functionResponse"]);c!=null&&w(t,["functionResponse"],c);const u=y(e,["inlineData"]);u!=null&&w(t,["inlineData"],_L(u));const d=y(e,["text"]);d!=null&&w(t,["text"],d);const h=y(e,["thought"]);h!=null&&w(t,["thought"],h);const v=y(e,["thoughtSignature"]);v!=null&&w(t,["thoughtSignature"],v);const b=y(e,["videoMetadata"]);return b!=null&&w(t,["videoMetadata"],b),t}function $L(e){const t={},n=y(e,["retrievalConfig"]);n!=null&&w(t,["retrievalConfig"],n);const i=y(e,["functionCallingConfig"]);return i!=null&&w(t,["functionCallingConfig"],ML(i)),t}function YL(e){const t={};if(y(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=y(e,["computerUse"]);n!=null&&w(t,["computerUse"],n);const i=y(e,["fileSearch"]);i!=null&&w(t,["fileSearch"],i);const o=y(e,["codeExecution"]);if(o!=null&&w(t,["codeExecution"],o),y(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=y(e,["functionDeclarations"]);if(a!=null){let h=a;Array.isArray(h)&&(h=h.map(v=>v)),w(t,["functionDeclarations"],h)}const l=y(e,["googleMaps"]);l!=null&&w(t,["googleMaps"],UL(l));const c=y(e,["googleSearch"]);c!=null&&w(t,["googleSearch"],zL(c));const u=y(e,["googleSearchRetrieval"]);u!=null&&w(t,["googleSearchRetrieval"],u);const d=y(e,["urlContext"]);return d!=null&&w(t,["urlContext"],d),t}function WL(e){const t={},n=y(e,["retrieval"]);n!=null&&w(t,["retrieval"],n);const i=y(e,["computerUse"]);if(i!=null&&w(t,["computerUse"],i),y(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=y(e,["codeExecution"]);o!=null&&w(t,["codeExecution"],o);const a=y(e,["enterpriseWebSearch"]);a!=null&&w(t,["enterpriseWebSearch"],a);const l=y(e,["functionDeclarations"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(b=>DL(b))),w(t,["functionDeclarations"],v)}const c=y(e,["googleMaps"]);c!=null&&w(t,["googleMaps"],c);const u=y(e,["googleSearch"]);u!=null&&w(t,["googleSearch"],u);const d=y(e,["googleSearchRetrieval"]);d!=null&&w(t,["googleSearchRetrieval"],d);const h=y(e,["urlContext"]);return h!=null&&w(t,["urlContext"],h),t}function XL(e,t){const n={},i=y(e,["ttl"]);t!==void 0&&i!=null&&w(t,["ttl"],i);const o=y(e,["expireTime"]);return t!==void 0&&o!=null&&w(t,["expireTime"],o),n}function JL(e,t){const n={},i=y(e,["ttl"]);t!==void 0&&i!=null&&w(t,["ttl"],i);const o=y(e,["expireTime"]);return t!==void 0&&o!=null&&w(t,["expireTime"],o),n}function KL(e,t){const n={},i=y(t,["name"]);i!=null&&w(n,["_url","name"],Xs(e,i));const o=y(t,["config"]);return o!=null&&XL(o,n),n}function ZL(e,t){const n={},i=y(t,["name"]);i!=null&&w(n,["_url","name"],Xs(e,i));const o=y(t,["config"]);return o!=null&&JL(o,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class QL extends Ws{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Pc($s.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(n),n)}async create(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=AL(this.apiClient,t);return c=xt("cachedContents",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),l.then(h=>h)}else{const d=NL(this.apiClient,t);return c=xt("cachedContents",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),l.then(h=>h)}}async get(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=OL(this.apiClient,t);return c=xt("{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),l.then(h=>h)}else{const d=PL(this.apiClient,t);return c=xt("{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),l.then(h=>h)}}async delete(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=TL(this.apiClient,t);return c=xt("{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=IL(h),b=new tx;return Object.assign(b,v),b})}else{const d=CL(this.apiClient,t);return c=xt("{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=kL(h),b=new tx;return Object.assign(b,v),b})}}async update(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=ZL(this.apiClient,t);return c=xt("{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),l.then(h=>h)}else{const d=KL(this.apiClient,t);return c=xt("{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),l.then(h=>h)}}async listInternal(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=qL(t);return c=xt("cachedContents",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=GL(h),b=new nx;return Object.assign(b,v),b})}else{const d=BL(t);return c=xt("cachedContents",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=HL(h),b=new nx;return Object.assign(b,v),b})}}}function mp(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]]);return n}function cx(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Kt(e){return this instanceof Kt?(this.v=e,this):new Kt(e)}function La(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(e,t||[]),o,a=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),o[Symbol.asyncIterator]=function(){return this},o;function l(g){return function(A){return Promise.resolve(A).then(g,v)}}function c(g,A){i[g]&&(o[g]=function(_){return new Promise(function(C,E){a.push([g,_,C,E])>1||u(g,_)})},A&&(o[g]=A(o[g])))}function u(g,A){try{d(i[g](A))}catch(_){b(a[0][3],_)}}function d(g){g.value instanceof Kt?Promise.resolve(g.value.v).then(h,v):b(a[0][2],g)}function h(g){u("next",g)}function v(g){u("throw",g)}function b(g,A){g(A),a.shift(),a.length&&u(a[0][0],a[0][1])}}function Ma(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof cx=="function"?cx(e):e[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(a){n[a]=e[a]&&function(l){return new Promise(function(c,u){l=e[a](l),o(c,u,l.done,l.value)})}}function o(a,l,c,u){Promise.resolve(u).then(function(d){a({value:d,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eM(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:tS(n)}function tS(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0)return!1;return!0}function tM(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function ux(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let i=0;for(;i<n;)if(e[i].role==="user")t.push(e[i]),i++;else{const o=[];let a=!0;for(;i<n&&e[i].role==="model";)o.push(e[i]),a&&!tS(e[i])&&(a=!1),i++;a?t.push(...o):t.pop()}return t}class nM{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new iM(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class iM{constructor(t,n,i,o={},a=[]){this.apiClient=t,this.modelsModule=n,this.model=i,this.config=o,this.history=a,this.sendPromise=Promise.resolve(),tM(a)}async sendMessage(t){var n;await this.sendPromise;const i=Ar(t.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var a,l,c;const u=await o,d=(l=(a=u.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content,h=u.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let b=[];h!=null&&(b=(c=h.slice(v))!==null&&c!==void 0?c:[]);const g=d?[d]:[];this.recordHistory(i,g,b)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(t){var n;await this.sendPromise;const i=Ar(t.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const a=await o;return this.processStreamResponse(a,i)}getHistory(t=!1){const n=t?ux(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){return La(this,arguments,function*(){var o,a,l,c,u,d;const h=[];try{for(var v=!0,b=Ma(t),g;g=yield Kt(b.next()),o=g.done,!o;v=!0){c=g.value,v=!1;const A=c;if(eM(A)){const _=(d=(u=A.candidates)===null||u===void 0?void 0:u[0])===null||d===void 0?void 0:d.content;_!==void 0&&h.push(_)}yield yield Kt(A)}}catch(A){a={error:A}}finally{try{!v&&!o&&(l=b.return)&&(yield Kt(l.call(b)))}finally{if(a)throw a.error}}this.recordHistory(n,h)})}recordHistory(t,n,i){let o=[];n.length>0&&n.every(a=>a.role!==void 0)?o=n:o.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...ux(i)):this.history.push(t),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hf extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,hf.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rM(e){const t={},n=y(e,["file"]);return n!=null&&w(t,["file"],n),t}function oM(e){const t={},n=y(e,["sdkHttpResponse"]);return n!=null&&w(t,["sdkHttpResponse"],n),t}function aM(e){const t={},n=y(e,["name"]);return n!=null&&w(t,["_url","file"],W_(n)),t}function sM(e){const t={},n=y(e,["sdkHttpResponse"]);return n!=null&&w(t,["sdkHttpResponse"],n),t}function lM(e){const t={},n=y(e,["name"]);return n!=null&&w(t,["_url","file"],W_(n)),t}function cM(e){const t={},n=y(e,["uris"]);return n!=null&&w(t,["uris"],n),t}function uM(e,t){const n={},i=y(e,["pageSize"]);t!==void 0&&i!=null&&w(t,["_query","pageSize"],i);const o=y(e,["pageToken"]);return t!==void 0&&o!=null&&w(t,["_query","pageToken"],o),n}function dM(e){const t={},n=y(e,["config"]);return n!=null&&uM(n,t),t}function fM(e){const t={},n=y(e,["sdkHttpResponse"]);n!=null&&w(t,["sdkHttpResponse"],n);const i=y(e,["nextPageToken"]);i!=null&&w(t,["nextPageToken"],i);const o=y(e,["files"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>l)),w(t,["files"],a)}return t}function hM(e){const t={},n=y(e,["sdkHttpResponse"]);n!=null&&w(t,["sdkHttpResponse"],n);const i=y(e,["files"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>a)),w(t,["files"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pM extends Ws{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Pc($s.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>n)}async download(t){await this.apiClient.downloadFile(t)}async registerFiles(t){throw new Error("registerFiles is only supported in Node.js environments.")}async _registerFiles(t){return this.registerFilesInternal(t)}async listInternal(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=dM(t);return a=xt("files",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:u.headers},h})),o.then(u=>{const d=fM(u),h=new mR;return Object.assign(h,d),h})}}async createInternal(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=rM(t);return a=xt("upload/v1beta/files",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>{const d=oM(u),h=new gR;return Object.assign(h,d),h})}}async get(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=lM(t);return a=xt("files/{file}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async delete(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=aM(t);return a=xt("files/{file}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:u.headers},h})),o.then(u=>{const d=sM(u),h=new vR;return Object.assign(h,d),h})}}async registerFilesInternal(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=cM(t);return a=xt("files:register",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>{const d=hM(u),h=new yR;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Kh(e){const t={},n=y(e,["data"]);if(n!=null&&w(t,["data"],n),y(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=y(e,["mimeType"]);return i!=null&&w(t,["mimeType"],i),t}function mM(e){const t={},n=y(e,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>RM(a))),w(t,["parts"],o)}const i=y(e,["role"]);return i!=null&&w(t,["role"],i),t}function gM(e){const t={};if(y(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=y(e,["fileUri"]);n!=null&&w(t,["fileUri"],n);const i=y(e,["mimeType"]);return i!=null&&w(t,["mimeType"],i),t}function vM(e){const t={},n=y(e,["id"]);n!=null&&w(t,["id"],n);const i=y(e,["args"]);i!=null&&w(t,["args"],i);const o=y(e,["name"]);if(o!=null&&w(t,["name"],o),y(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(y(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function yM(e){const t={},n=y(e,["description"]);n!=null&&w(t,["description"],n);const i=y(e,["name"]);i!=null&&w(t,["name"],i);const o=y(e,["parameters"]);o!=null&&w(t,["parameters"],o);const a=y(e,["parametersJsonSchema"]);a!=null&&w(t,["parametersJsonSchema"],a);const l=y(e,["response"]);l!=null&&w(t,["response"],l);const c=y(e,["responseJsonSchema"]);if(c!=null&&w(t,["responseJsonSchema"],c),y(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function bM(e){const t={},n=y(e,["modelSelectionConfig"]);n!=null&&w(t,["modelConfig"],n);const i=y(e,["responseJsonSchema"]);i!=null&&w(t,["responseJsonSchema"],i);const o=y(e,["audioTimestamp"]);o!=null&&w(t,["audioTimestamp"],o);const a=y(e,["candidateCount"]);a!=null&&w(t,["candidateCount"],a);const l=y(e,["enableAffectiveDialog"]);l!=null&&w(t,["enableAffectiveDialog"],l);const c=y(e,["frequencyPenalty"]);c!=null&&w(t,["frequencyPenalty"],c);const u=y(e,["logprobs"]);u!=null&&w(t,["logprobs"],u);const d=y(e,["maxOutputTokens"]);d!=null&&w(t,["maxOutputTokens"],d);const h=y(e,["mediaResolution"]);h!=null&&w(t,["mediaResolution"],h);const v=y(e,["presencePenalty"]);v!=null&&w(t,["presencePenalty"],v);const b=y(e,["responseLogprobs"]);b!=null&&w(t,["responseLogprobs"],b);const g=y(e,["responseMimeType"]);g!=null&&w(t,["responseMimeType"],g);const A=y(e,["responseModalities"]);A!=null&&w(t,["responseModalities"],A);const _=y(e,["responseSchema"]);_!=null&&w(t,["responseSchema"],_);const C=y(e,["routingConfig"]);C!=null&&w(t,["routingConfig"],C);const E=y(e,["seed"]);E!=null&&w(t,["seed"],E);const R=y(e,["speechConfig"]);R!=null&&w(t,["speechConfig"],R);const k=y(e,["stopSequences"]);k!=null&&w(t,["stopSequences"],k);const M=y(e,["temperature"]);M!=null&&w(t,["temperature"],M);const P=y(e,["thinkingConfig"]);P!=null&&w(t,["thinkingConfig"],P);const W=y(e,["topK"]);W!=null&&w(t,["topK"],W);const V=y(e,["topP"]);if(V!=null&&w(t,["topP"],V),y(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function xM(e){const t={};if(y(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=y(e,["enableWidget"]);return n!=null&&w(t,["enableWidget"],n),t}function wM(e){const t={};if(y(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(y(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=y(e,["timeRangeFilter"]);return n!=null&&w(t,["timeRangeFilter"],n),t}function _M(e,t){const n={},i=y(e,["generationConfig"]);t!==void 0&&i!=null&&w(t,["setup","generationConfig"],i);const o=y(e,["responseModalities"]);t!==void 0&&o!=null&&w(t,["setup","generationConfig","responseModalities"],o);const a=y(e,["temperature"]);t!==void 0&&a!=null&&w(t,["setup","generationConfig","temperature"],a);const l=y(e,["topP"]);t!==void 0&&l!=null&&w(t,["setup","generationConfig","topP"],l);const c=y(e,["topK"]);t!==void 0&&c!=null&&w(t,["setup","generationConfig","topK"],c);const u=y(e,["maxOutputTokens"]);t!==void 0&&u!=null&&w(t,["setup","generationConfig","maxOutputTokens"],u);const d=y(e,["mediaResolution"]);t!==void 0&&d!=null&&w(t,["setup","generationConfig","mediaResolution"],d);const h=y(e,["seed"]);t!==void 0&&h!=null&&w(t,["setup","generationConfig","seed"],h);const v=y(e,["speechConfig"]);t!==void 0&&v!=null&&w(t,["setup","generationConfig","speechConfig"],f1(v));const b=y(e,["thinkingConfig"]);t!==void 0&&b!=null&&w(t,["setup","generationConfig","thinkingConfig"],b);const g=y(e,["enableAffectiveDialog"]);t!==void 0&&g!=null&&w(t,["setup","generationConfig","enableAffectiveDialog"],g);const A=y(e,["systemInstruction"]);t!==void 0&&A!=null&&w(t,["setup","systemInstruction"],mM(Ar(A)));const _=y(e,["tools"]);if(t!==void 0&&_!=null){let W=id(_);Array.isArray(W)&&(W=W.map(V=>MM(nd(V)))),w(t,["setup","tools"],W)}const C=y(e,["sessionResumption"]);t!==void 0&&C!=null&&w(t,["setup","sessionResumption"],LM(C));const E=y(e,["inputAudioTranscription"]);t!==void 0&&E!=null&&w(t,["setup","inputAudioTranscription"],E);const R=y(e,["outputAudioTranscription"]);t!==void 0&&R!=null&&w(t,["setup","outputAudioTranscription"],R);const k=y(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&w(t,["setup","realtimeInputConfig"],k);const M=y(e,["contextWindowCompression"]);t!==void 0&&M!=null&&w(t,["setup","contextWindowCompression"],M);const P=y(e,["proactivity"]);if(t!==void 0&&P!=null&&w(t,["setup","proactivity"],P),y(e,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function SM(e,t){const n={},i=y(e,["generationConfig"]);t!==void 0&&i!=null&&w(t,["setup","generationConfig"],bM(i));const o=y(e,["responseModalities"]);t!==void 0&&o!=null&&w(t,["setup","generationConfig","responseModalities"],o);const a=y(e,["temperature"]);t!==void 0&&a!=null&&w(t,["setup","generationConfig","temperature"],a);const l=y(e,["topP"]);t!==void 0&&l!=null&&w(t,["setup","generationConfig","topP"],l);const c=y(e,["topK"]);t!==void 0&&c!=null&&w(t,["setup","generationConfig","topK"],c);const u=y(e,["maxOutputTokens"]);t!==void 0&&u!=null&&w(t,["setup","generationConfig","maxOutputTokens"],u);const d=y(e,["mediaResolution"]);t!==void 0&&d!=null&&w(t,["setup","generationConfig","mediaResolution"],d);const h=y(e,["seed"]);t!==void 0&&h!=null&&w(t,["setup","generationConfig","seed"],h);const v=y(e,["speechConfig"]);t!==void 0&&v!=null&&w(t,["setup","generationConfig","speechConfig"],f1(v));const b=y(e,["thinkingConfig"]);t!==void 0&&b!=null&&w(t,["setup","generationConfig","thinkingConfig"],b);const g=y(e,["enableAffectiveDialog"]);t!==void 0&&g!=null&&w(t,["setup","generationConfig","enableAffectiveDialog"],g);const A=y(e,["systemInstruction"]);t!==void 0&&A!=null&&w(t,["setup","systemInstruction"],Ar(A));const _=y(e,["tools"]);if(t!==void 0&&_!=null){let V=id(_);Array.isArray(V)&&(V=V.map($=>DM(nd($)))),w(t,["setup","tools"],V)}const C=y(e,["sessionResumption"]);t!==void 0&&C!=null&&w(t,["setup","sessionResumption"],C);const E=y(e,["inputAudioTranscription"]);t!==void 0&&E!=null&&w(t,["setup","inputAudioTranscription"],E);const R=y(e,["outputAudioTranscription"]);t!==void 0&&R!=null&&w(t,["setup","outputAudioTranscription"],R);const k=y(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&w(t,["setup","realtimeInputConfig"],k);const M=y(e,["contextWindowCompression"]);t!==void 0&&M!=null&&w(t,["setup","contextWindowCompression"],M);const P=y(e,["proactivity"]);t!==void 0&&P!=null&&w(t,["setup","proactivity"],P);const W=y(e,["explicitVadSignal"]);return t!==void 0&&W!=null&&w(t,["setup","explicitVadSignal"],W),n}function EM(e,t){const n={},i=y(t,["model"]);i!=null&&w(n,["setup","model"],Ln(e,i));const o=y(t,["config"]);return o!=null&&w(n,["config"],_M(o,n)),n}function NM(e,t){const n={},i=y(t,["model"]);i!=null&&w(n,["setup","model"],Ln(e,i));const o=y(t,["config"]);return o!=null&&w(n,["config"],SM(o,n)),n}function AM(e){const t={},n=y(e,["musicGenerationConfig"]);return n!=null&&w(t,["musicGenerationConfig"],n),t}function CM(e){const t={},n=y(e,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>o)),w(t,["weightedPrompts"],i)}return t}function TM(e){const t={},n=y(e,["media"]);if(n!=null){let d=H_(n);Array.isArray(d)&&(d=d.map(h=>Kh(h))),w(t,["mediaChunks"],d)}const i=y(e,["audio"]);i!=null&&w(t,["audio"],Kh(V_(i)));const o=y(e,["audioStreamEnd"]);o!=null&&w(t,["audioStreamEnd"],o);const a=y(e,["video"]);a!=null&&w(t,["video"],Kh(G_(a)));const l=y(e,["text"]);l!=null&&w(t,["text"],l);const c=y(e,["activityStart"]);c!=null&&w(t,["activityStart"],c);const u=y(e,["activityEnd"]);return u!=null&&w(t,["activityEnd"],u),t}function kM(e){const t={},n=y(e,["media"]);if(n!=null){let d=H_(n);Array.isArray(d)&&(d=d.map(h=>h)),w(t,["mediaChunks"],d)}const i=y(e,["audio"]);i!=null&&w(t,["audio"],V_(i));const o=y(e,["audioStreamEnd"]);o!=null&&w(t,["audioStreamEnd"],o);const a=y(e,["video"]);a!=null&&w(t,["video"],G_(a));const l=y(e,["text"]);l!=null&&w(t,["text"],l);const c=y(e,["activityStart"]);c!=null&&w(t,["activityStart"],c);const u=y(e,["activityEnd"]);return u!=null&&w(t,["activityEnd"],u),t}function IM(e){const t={},n=y(e,["setupComplete"]);n!=null&&w(t,["setupComplete"],n);const i=y(e,["serverContent"]);i!=null&&w(t,["serverContent"],i);const o=y(e,["toolCall"]);o!=null&&w(t,["toolCall"],o);const a=y(e,["toolCallCancellation"]);a!=null&&w(t,["toolCallCancellation"],a);const l=y(e,["usageMetadata"]);l!=null&&w(t,["usageMetadata"],PM(l));const c=y(e,["goAway"]);c!=null&&w(t,["goAway"],c);const u=y(e,["sessionResumptionUpdate"]);u!=null&&w(t,["sessionResumptionUpdate"],u);const d=y(e,["voiceActivityDetectionSignal"]);d!=null&&w(t,["voiceActivityDetectionSignal"],d);const h=y(e,["voiceActivity"]);return h!=null&&w(t,["voiceActivity"],OM(h)),t}function RM(e){const t={},n=y(e,["mediaResolution"]);n!=null&&w(t,["mediaResolution"],n);const i=y(e,["codeExecutionResult"]);i!=null&&w(t,["codeExecutionResult"],i);const o=y(e,["executableCode"]);o!=null&&w(t,["executableCode"],o);const a=y(e,["fileData"]);a!=null&&w(t,["fileData"],gM(a));const l=y(e,["functionCall"]);l!=null&&w(t,["functionCall"],vM(l));const c=y(e,["functionResponse"]);c!=null&&w(t,["functionResponse"],c);const u=y(e,["inlineData"]);u!=null&&w(t,["inlineData"],Kh(u));const d=y(e,["text"]);d!=null&&w(t,["text"],d);const h=y(e,["thought"]);h!=null&&w(t,["thought"],h);const v=y(e,["thoughtSignature"]);v!=null&&w(t,["thoughtSignature"],v);const b=y(e,["videoMetadata"]);return b!=null&&w(t,["videoMetadata"],b),t}function LM(e){const t={},n=y(e,["handle"]);if(n!=null&&w(t,["handle"],n),y(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function MM(e){const t={};if(y(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=y(e,["computerUse"]);n!=null&&w(t,["computerUse"],n);const i=y(e,["fileSearch"]);i!=null&&w(t,["fileSearch"],i);const o=y(e,["codeExecution"]);if(o!=null&&w(t,["codeExecution"],o),y(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=y(e,["functionDeclarations"]);if(a!=null){let h=a;Array.isArray(h)&&(h=h.map(v=>v)),w(t,["functionDeclarations"],h)}const l=y(e,["googleMaps"]);l!=null&&w(t,["googleMaps"],xM(l));const c=y(e,["googleSearch"]);c!=null&&w(t,["googleSearch"],wM(c));const u=y(e,["googleSearchRetrieval"]);u!=null&&w(t,["googleSearchRetrieval"],u);const d=y(e,["urlContext"]);return d!=null&&w(t,["urlContext"],d),t}function DM(e){const t={},n=y(e,["retrieval"]);n!=null&&w(t,["retrieval"],n);const i=y(e,["computerUse"]);if(i!=null&&w(t,["computerUse"],i),y(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=y(e,["codeExecution"]);o!=null&&w(t,["codeExecution"],o);const a=y(e,["enterpriseWebSearch"]);a!=null&&w(t,["enterpriseWebSearch"],a);const l=y(e,["functionDeclarations"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(b=>yM(b))),w(t,["functionDeclarations"],v)}const c=y(e,["googleMaps"]);c!=null&&w(t,["googleMaps"],c);const u=y(e,["googleSearch"]);u!=null&&w(t,["googleSearch"],u);const d=y(e,["googleSearchRetrieval"]);d!=null&&w(t,["googleSearchRetrieval"],d);const h=y(e,["urlContext"]);return h!=null&&w(t,["urlContext"],h),t}function PM(e){const t={},n=y(e,["promptTokenCount"]);n!=null&&w(t,["promptTokenCount"],n);const i=y(e,["cachedContentTokenCount"]);i!=null&&w(t,["cachedContentTokenCount"],i);const o=y(e,["candidatesTokenCount"]);o!=null&&w(t,["responseTokenCount"],o);const a=y(e,["toolUsePromptTokenCount"]);a!=null&&w(t,["toolUsePromptTokenCount"],a);const l=y(e,["thoughtsTokenCount"]);l!=null&&w(t,["thoughtsTokenCount"],l);const c=y(e,["totalTokenCount"]);c!=null&&w(t,["totalTokenCount"],c);const u=y(e,["promptTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(A=>A)),w(t,["promptTokensDetails"],g)}const d=y(e,["cacheTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(A=>A)),w(t,["cacheTokensDetails"],g)}const h=y(e,["candidatesTokensDetails"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(A=>A)),w(t,["responseTokensDetails"],g)}const v=y(e,["toolUsePromptTokensDetails"]);if(v!=null){let g=v;Array.isArray(g)&&(g=g.map(A=>A)),w(t,["toolUsePromptTokensDetails"],g)}const b=y(e,["trafficType"]);return b!=null&&w(t,["trafficType"],b),t}function OM(e){const t={},n=y(e,["type"]);return n!=null&&w(t,["voiceActivityType"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function UM(e,t){const n={},i=y(e,["data"]);if(i!=null&&w(n,["data"],i),y(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=y(e,["mimeType"]);return o!=null&&w(n,["mimeType"],o),n}function zM(e,t){const n={},i=y(e,["content"]);i!=null&&w(n,["content"],i);const o=y(e,["citationMetadata"]);o!=null&&w(n,["citationMetadata"],jM(o));const a=y(e,["tokenCount"]);a!=null&&w(n,["tokenCount"],a);const l=y(e,["finishReason"]);l!=null&&w(n,["finishReason"],l);const c=y(e,["avgLogprobs"]);c!=null&&w(n,["avgLogprobs"],c);const u=y(e,["groundingMetadata"]);u!=null&&w(n,["groundingMetadata"],u);const d=y(e,["index"]);d!=null&&w(n,["index"],d);const h=y(e,["logprobsResult"]);h!=null&&w(n,["logprobsResult"],h);const v=y(e,["safetyRatings"]);if(v!=null){let g=v;Array.isArray(g)&&(g=g.map(A=>A)),w(n,["safetyRatings"],g)}const b=y(e,["urlContextMetadata"]);return b!=null&&w(n,["urlContextMetadata"],b),n}function jM(e,t){const n={},i=y(e,["citationSources"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>a)),w(n,["citations"],o)}return n}function FM(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["contents"]);if(a!=null){let l=Ko(a);Array.isArray(l)&&(l=l.map(c=>c)),w(i,["contents"],l)}return i}function BM(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["tokensInfo"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>l)),w(n,["tokensInfo"],a)}return n}function qM(e,t){const n={},i=y(e,["values"]);i!=null&&w(n,["values"],i);const o=y(e,["statistics"]);return o!=null&&w(n,["statistics"],HM(o)),n}function HM(e,t){const n={},i=y(e,["truncated"]);i!=null&&w(n,["truncated"],i);const o=y(e,["token_count"]);return o!=null&&w(n,["tokenCount"],o),n}function Rp(e,t){const n={},i=y(e,["parts"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>ZD(l))),w(n,["parts"],a)}const o=y(e,["role"]);return o!=null&&w(n,["role"],o),n}function GM(e,t){const n={},i=y(e,["controlType"]);i!=null&&w(n,["controlType"],i);const o=y(e,["enableControlImageComputation"]);return o!=null&&w(n,["computeControl"],o),n}function VM(e,t){const n={};if(y(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(y(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(y(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return n}function $M(e,t,n){const i={},o=y(e,["systemInstruction"]);t!==void 0&&o!=null&&w(t,["systemInstruction"],Ar(o));const a=y(e,["tools"]);if(t!==void 0&&a!=null){let c=a;Array.isArray(c)&&(c=c.map(u=>oS(u))),w(t,["tools"],c)}const l=y(e,["generationConfig"]);return t!==void 0&&l!=null&&w(t,["generationConfig"],UD(l)),i}function YM(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["contents"]);if(a!=null){let c=Ko(a);Array.isArray(c)&&(c=c.map(u=>Rp(u))),w(i,["contents"],c)}const l=y(t,["config"]);return l!=null&&VM(l),i}function WM(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["contents"]);if(a!=null){let c=Ko(a);Array.isArray(c)&&(c=c.map(u=>u)),w(i,["contents"],c)}const l=y(t,["config"]);return l!=null&&$M(l,i),i}function XM(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["totalTokens"]);o!=null&&w(n,["totalTokens"],o);const a=y(e,["cachedContentTokenCount"]);return a!=null&&w(n,["cachedContentTokenCount"],a),n}function JM(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["totalTokens"]);return o!=null&&w(n,["totalTokens"],o),n}function KM(e,t,n){const i={},o=y(t,["model"]);return o!=null&&w(i,["_url","name"],Ln(e,o)),i}function ZM(e,t,n){const i={},o=y(t,["model"]);return o!=null&&w(i,["_url","name"],Ln(e,o)),i}function QM(e,t){const n={},i=y(e,["sdkHttpResponse"]);return i!=null&&w(n,["sdkHttpResponse"],i),n}function eD(e,t){const n={},i=y(e,["sdkHttpResponse"]);return i!=null&&w(n,["sdkHttpResponse"],i),n}function tD(e,t,n){const i={},o=y(e,["outputGcsUri"]);t!==void 0&&o!=null&&w(t,["parameters","storageUri"],o);const a=y(e,["negativePrompt"]);t!==void 0&&a!=null&&w(t,["parameters","negativePrompt"],a);const l=y(e,["numberOfImages"]);t!==void 0&&l!=null&&w(t,["parameters","sampleCount"],l);const c=y(e,["aspectRatio"]);t!==void 0&&c!=null&&w(t,["parameters","aspectRatio"],c);const u=y(e,["guidanceScale"]);t!==void 0&&u!=null&&w(t,["parameters","guidanceScale"],u);const d=y(e,["seed"]);t!==void 0&&d!=null&&w(t,["parameters","seed"],d);const h=y(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&w(t,["parameters","safetySetting"],h);const v=y(e,["personGeneration"]);t!==void 0&&v!=null&&w(t,["parameters","personGeneration"],v);const b=y(e,["includeSafetyAttributes"]);t!==void 0&&b!=null&&w(t,["parameters","includeSafetyAttributes"],b);const g=y(e,["includeRaiReason"]);t!==void 0&&g!=null&&w(t,["parameters","includeRaiReason"],g);const A=y(e,["language"]);t!==void 0&&A!=null&&w(t,["parameters","language"],A);const _=y(e,["outputMimeType"]);t!==void 0&&_!=null&&w(t,["parameters","outputOptions","mimeType"],_);const C=y(e,["outputCompressionQuality"]);t!==void 0&&C!=null&&w(t,["parameters","outputOptions","compressionQuality"],C);const E=y(e,["addWatermark"]);t!==void 0&&E!=null&&w(t,["parameters","addWatermark"],E);const R=y(e,["labels"]);t!==void 0&&R!=null&&w(t,["labels"],R);const k=y(e,["editMode"]);t!==void 0&&k!=null&&w(t,["parameters","editMode"],k);const M=y(e,["baseSteps"]);return t!==void 0&&M!=null&&w(t,["parameters","editConfig","baseSteps"],M),i}function nD(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["prompt"]);a!=null&&w(i,["instances[0]","prompt"],a);const l=y(t,["referenceImages"]);if(l!=null){let u=l;Array.isArray(u)&&(u=u.map(d=>r7(d))),w(i,["instances[0]","referenceImages"],u)}const c=y(t,["config"]);return c!=null&&tD(c,i),i}function iD(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["predictions"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>Lp(l))),w(n,["generatedImages"],a)}return n}function rD(e,t,n){const i={},o=y(e,["taskType"]);t!==void 0&&o!=null&&w(t,["requests[]","taskType"],o);const a=y(e,["title"]);t!==void 0&&a!=null&&w(t,["requests[]","title"],a);const l=y(e,["outputDimensionality"]);if(t!==void 0&&l!=null&&w(t,["requests[]","outputDimensionality"],l),y(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(y(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return i}function oD(e,t,n){const i={},o=y(e,["taskType"]);t!==void 0&&o!=null&&w(t,["instances[]","task_type"],o);const a=y(e,["title"]);t!==void 0&&a!=null&&w(t,["instances[]","title"],a);const l=y(e,["outputDimensionality"]);t!==void 0&&l!=null&&w(t,["parameters","outputDimensionality"],l);const c=y(e,["mimeType"]);t!==void 0&&c!=null&&w(t,["instances[]","mimeType"],c);const u=y(e,["autoTruncate"]);return t!==void 0&&u!=null&&w(t,["parameters","autoTruncate"],u),i}function aD(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["contents"]);if(a!=null){let u=c1(e,a);Array.isArray(u)&&(u=u.map(d=>d)),w(i,["requests[]","content"],u)}const l=y(t,["config"]);l!=null&&rD(l,i);const c=y(t,["model"]);return c!==void 0&&w(i,["requests[]","model"],Ln(e,c)),i}function sD(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["contents"]);if(a!=null){let c=c1(e,a);Array.isArray(c)&&(c=c.map(u=>u)),w(i,["instances[]","content"],c)}const l=y(t,["config"]);return l!=null&&oD(l,i),i}function lD(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["embeddings"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>c)),w(n,["embeddings"],l)}const a=y(e,["metadata"]);return a!=null&&w(n,["metadata"],a),n}function cD(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["predictions[]","embeddings"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>qM(c))),w(n,["embeddings"],l)}const a=y(e,["metadata"]);return a!=null&&w(n,["metadata"],a),n}function uD(e,t){const n={},i=y(e,["endpoint"]);i!=null&&w(n,["name"],i);const o=y(e,["deployedModelId"]);return o!=null&&w(n,["deployedModelId"],o),n}function dD(e,t){const n={};if(y(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=y(e,["fileUri"]);i!=null&&w(n,["fileUri"],i);const o=y(e,["mimeType"]);return o!=null&&w(n,["mimeType"],o),n}function fD(e,t){const n={},i=y(e,["id"]);i!=null&&w(n,["id"],i);const o=y(e,["args"]);o!=null&&w(n,["args"],o);const a=y(e,["name"]);if(a!=null&&w(n,["name"],a),y(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(y(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return n}function hD(e,t){const n={},i=y(e,["allowedFunctionNames"]);i!=null&&w(n,["allowedFunctionNames"],i);const o=y(e,["mode"]);if(o!=null&&w(n,["mode"],o),y(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return n}function pD(e,t){const n={},i=y(e,["description"]);i!=null&&w(n,["description"],i);const o=y(e,["name"]);o!=null&&w(n,["name"],o);const a=y(e,["parameters"]);a!=null&&w(n,["parameters"],a);const l=y(e,["parametersJsonSchema"]);l!=null&&w(n,["parametersJsonSchema"],l);const c=y(e,["response"]);c!=null&&w(n,["response"],c);const u=y(e,["responseJsonSchema"]);if(u!=null&&w(n,["responseJsonSchema"],u),y(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return n}function mD(e,t,n,i){const o={},a=y(t,["systemInstruction"]);n!==void 0&&a!=null&&w(n,["systemInstruction"],Rp(Ar(a)));const l=y(t,["temperature"]);l!=null&&w(o,["temperature"],l);const c=y(t,["topP"]);c!=null&&w(o,["topP"],c);const u=y(t,["topK"]);u!=null&&w(o,["topK"],u);const d=y(t,["candidateCount"]);d!=null&&w(o,["candidateCount"],d);const h=y(t,["maxOutputTokens"]);h!=null&&w(o,["maxOutputTokens"],h);const v=y(t,["stopSequences"]);v!=null&&w(o,["stopSequences"],v);const b=y(t,["responseLogprobs"]);b!=null&&w(o,["responseLogprobs"],b);const g=y(t,["logprobs"]);g!=null&&w(o,["logprobs"],g);const A=y(t,["presencePenalty"]);A!=null&&w(o,["presencePenalty"],A);const _=y(t,["frequencyPenalty"]);_!=null&&w(o,["frequencyPenalty"],_);const C=y(t,["seed"]);C!=null&&w(o,["seed"],C);const E=y(t,["responseMimeType"]);E!=null&&w(o,["responseMimeType"],E);const R=y(t,["responseSchema"]);R!=null&&w(o,["responseSchema"],u1(R));const k=y(t,["responseJsonSchema"]);if(k!=null&&w(o,["responseJsonSchema"],k),y(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(y(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const M=y(t,["safetySettings"]);if(n!==void 0&&M!=null){let I=M;Array.isArray(I)&&(I=I.map(ie=>o7(ie))),w(n,["safetySettings"],I)}const P=y(t,["tools"]);if(n!==void 0&&P!=null){let I=id(P);Array.isArray(I)&&(I=I.map(ie=>f7(nd(ie)))),w(n,["tools"],I)}const W=y(t,["toolConfig"]);if(n!==void 0&&W!=null&&w(n,["toolConfig"],d7(W)),y(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const V=y(t,["cachedContent"]);n!==void 0&&V!=null&&w(n,["cachedContent"],Xs(e,V));const $=y(t,["responseModalities"]);$!=null&&w(o,["responseModalities"],$);const j=y(t,["mediaResolution"]);j!=null&&w(o,["mediaResolution"],j);const X=y(t,["speechConfig"]);if(X!=null&&w(o,["speechConfig"],d1(X)),y(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const z=y(t,["thinkingConfig"]);z!=null&&w(o,["thinkingConfig"],z);const U=y(t,["imageConfig"]);U!=null&&w(o,["imageConfig"],qD(U));const q=y(t,["enableEnhancedCivicAnswers"]);if(q!=null&&w(o,["enableEnhancedCivicAnswers"],q),y(t,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return o}function gD(e,t,n,i){const o={},a=y(t,["systemInstruction"]);n!==void 0&&a!=null&&w(n,["systemInstruction"],Ar(a));const l=y(t,["temperature"]);l!=null&&w(o,["temperature"],l);const c=y(t,["topP"]);c!=null&&w(o,["topP"],c);const u=y(t,["topK"]);u!=null&&w(o,["topK"],u);const d=y(t,["candidateCount"]);d!=null&&w(o,["candidateCount"],d);const h=y(t,["maxOutputTokens"]);h!=null&&w(o,["maxOutputTokens"],h);const v=y(t,["stopSequences"]);v!=null&&w(o,["stopSequences"],v);const b=y(t,["responseLogprobs"]);b!=null&&w(o,["responseLogprobs"],b);const g=y(t,["logprobs"]);g!=null&&w(o,["logprobs"],g);const A=y(t,["presencePenalty"]);A!=null&&w(o,["presencePenalty"],A);const _=y(t,["frequencyPenalty"]);_!=null&&w(o,["frequencyPenalty"],_);const C=y(t,["seed"]);C!=null&&w(o,["seed"],C);const E=y(t,["responseMimeType"]);E!=null&&w(o,["responseMimeType"],E);const R=y(t,["responseSchema"]);R!=null&&w(o,["responseSchema"],u1(R));const k=y(t,["responseJsonSchema"]);k!=null&&w(o,["responseJsonSchema"],k);const M=y(t,["routingConfig"]);M!=null&&w(o,["routingConfig"],M);const P=y(t,["modelSelectionConfig"]);P!=null&&w(o,["modelConfig"],P);const W=y(t,["safetySettings"]);if(n!==void 0&&W!=null){let le=W;Array.isArray(le)&&(le=le.map(pe=>pe)),w(n,["safetySettings"],le)}const V=y(t,["tools"]);if(n!==void 0&&V!=null){let le=id(V);Array.isArray(le)&&(le=le.map(pe=>oS(nd(pe)))),w(n,["tools"],le)}const $=y(t,["toolConfig"]);n!==void 0&&$!=null&&w(n,["toolConfig"],$);const j=y(t,["labels"]);n!==void 0&&j!=null&&w(n,["labels"],j);const X=y(t,["cachedContent"]);n!==void 0&&X!=null&&w(n,["cachedContent"],Xs(e,X));const z=y(t,["responseModalities"]);z!=null&&w(o,["responseModalities"],z);const U=y(t,["mediaResolution"]);U!=null&&w(o,["mediaResolution"],U);const q=y(t,["speechConfig"]);q!=null&&w(o,["speechConfig"],d1(q));const I=y(t,["audioTimestamp"]);I!=null&&w(o,["audioTimestamp"],I);const ie=y(t,["thinkingConfig"]);ie!=null&&w(o,["thinkingConfig"],ie);const J=y(t,["imageConfig"]);if(J!=null&&w(o,["imageConfig"],HD(J)),y(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const Y=y(t,["modelArmorConfig"]);return n!==void 0&&Y!=null&&w(n,["modelArmorConfig"],Y),o}function dx(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["contents"]);if(a!=null){let c=Ko(a);Array.isArray(c)&&(c=c.map(u=>Rp(u))),w(i,["contents"],c)}const l=y(t,["config"]);return l!=null&&w(i,["generationConfig"],mD(e,l,i)),i}function fx(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["contents"]);if(a!=null){let c=Ko(a);Array.isArray(c)&&(c=c.map(u=>u)),w(i,["contents"],c)}const l=y(t,["config"]);return l!=null&&w(i,["generationConfig"],gD(e,l,i)),i}function hx(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["candidates"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(h=>zM(h))),w(n,["candidates"],d)}const a=y(e,["modelVersion"]);a!=null&&w(n,["modelVersion"],a);const l=y(e,["promptFeedback"]);l!=null&&w(n,["promptFeedback"],l);const c=y(e,["responseId"]);c!=null&&w(n,["responseId"],c);const u=y(e,["usageMetadata"]);return u!=null&&w(n,["usageMetadata"],u),n}function px(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["candidates"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(v=>v)),w(n,["candidates"],h)}const a=y(e,["createTime"]);a!=null&&w(n,["createTime"],a);const l=y(e,["modelVersion"]);l!=null&&w(n,["modelVersion"],l);const c=y(e,["promptFeedback"]);c!=null&&w(n,["promptFeedback"],c);const u=y(e,["responseId"]);u!=null&&w(n,["responseId"],u);const d=y(e,["usageMetadata"]);return d!=null&&w(n,["usageMetadata"],d),n}function vD(e,t,n){const i={};if(y(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(y(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const o=y(e,["numberOfImages"]);t!==void 0&&o!=null&&w(t,["parameters","sampleCount"],o);const a=y(e,["aspectRatio"]);t!==void 0&&a!=null&&w(t,["parameters","aspectRatio"],a);const l=y(e,["guidanceScale"]);if(t!==void 0&&l!=null&&w(t,["parameters","guidanceScale"],l),y(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=y(e,["safetyFilterLevel"]);t!==void 0&&c!=null&&w(t,["parameters","safetySetting"],c);const u=y(e,["personGeneration"]);t!==void 0&&u!=null&&w(t,["parameters","personGeneration"],u);const d=y(e,["includeSafetyAttributes"]);t!==void 0&&d!=null&&w(t,["parameters","includeSafetyAttributes"],d);const h=y(e,["includeRaiReason"]);t!==void 0&&h!=null&&w(t,["parameters","includeRaiReason"],h);const v=y(e,["language"]);t!==void 0&&v!=null&&w(t,["parameters","language"],v);const b=y(e,["outputMimeType"]);t!==void 0&&b!=null&&w(t,["parameters","outputOptions","mimeType"],b);const g=y(e,["outputCompressionQuality"]);if(t!==void 0&&g!=null&&w(t,["parameters","outputOptions","compressionQuality"],g),y(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(y(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const A=y(e,["imageSize"]);if(t!==void 0&&A!=null&&w(t,["parameters","sampleImageSize"],A),y(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return i}function yD(e,t,n){const i={},o=y(e,["outputGcsUri"]);t!==void 0&&o!=null&&w(t,["parameters","storageUri"],o);const a=y(e,["negativePrompt"]);t!==void 0&&a!=null&&w(t,["parameters","negativePrompt"],a);const l=y(e,["numberOfImages"]);t!==void 0&&l!=null&&w(t,["parameters","sampleCount"],l);const c=y(e,["aspectRatio"]);t!==void 0&&c!=null&&w(t,["parameters","aspectRatio"],c);const u=y(e,["guidanceScale"]);t!==void 0&&u!=null&&w(t,["parameters","guidanceScale"],u);const d=y(e,["seed"]);t!==void 0&&d!=null&&w(t,["parameters","seed"],d);const h=y(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&w(t,["parameters","safetySetting"],h);const v=y(e,["personGeneration"]);t!==void 0&&v!=null&&w(t,["parameters","personGeneration"],v);const b=y(e,["includeSafetyAttributes"]);t!==void 0&&b!=null&&w(t,["parameters","includeSafetyAttributes"],b);const g=y(e,["includeRaiReason"]);t!==void 0&&g!=null&&w(t,["parameters","includeRaiReason"],g);const A=y(e,["language"]);t!==void 0&&A!=null&&w(t,["parameters","language"],A);const _=y(e,["outputMimeType"]);t!==void 0&&_!=null&&w(t,["parameters","outputOptions","mimeType"],_);const C=y(e,["outputCompressionQuality"]);t!==void 0&&C!=null&&w(t,["parameters","outputOptions","compressionQuality"],C);const E=y(e,["addWatermark"]);t!==void 0&&E!=null&&w(t,["parameters","addWatermark"],E);const R=y(e,["labels"]);t!==void 0&&R!=null&&w(t,["labels"],R);const k=y(e,["imageSize"]);t!==void 0&&k!=null&&w(t,["parameters","sampleImageSize"],k);const M=y(e,["enhancePrompt"]);return t!==void 0&&M!=null&&w(t,["parameters","enhancePrompt"],M),i}function bD(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["prompt"]);a!=null&&w(i,["instances[0]","prompt"],a);const l=y(t,["config"]);return l!=null&&vD(l,i),i}function xD(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["prompt"]);a!=null&&w(i,["instances[0]","prompt"],a);const l=y(t,["config"]);return l!=null&&yD(l,i),i}function wD(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["predictions"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>MD(c))),w(n,["generatedImages"],l)}const a=y(e,["positivePromptSafetyAttributes"]);return a!=null&&w(n,["positivePromptSafetyAttributes"],iS(a)),n}function _D(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["predictions"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>Lp(c))),w(n,["generatedImages"],l)}const a=y(e,["positivePromptSafetyAttributes"]);return a!=null&&w(n,["positivePromptSafetyAttributes"],rS(a)),n}function SD(e,t,n){const i={},o=y(e,["numberOfVideos"]);if(t!==void 0&&o!=null&&w(t,["parameters","sampleCount"],o),y(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(y(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=y(e,["durationSeconds"]);if(t!==void 0&&a!=null&&w(t,["parameters","durationSeconds"],a),y(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=y(e,["aspectRatio"]);t!==void 0&&l!=null&&w(t,["parameters","aspectRatio"],l);const c=y(e,["resolution"]);t!==void 0&&c!=null&&w(t,["parameters","resolution"],c);const u=y(e,["personGeneration"]);if(t!==void 0&&u!=null&&w(t,["parameters","personGeneration"],u),y(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=y(e,["negativePrompt"]);t!==void 0&&d!=null&&w(t,["parameters","negativePrompt"],d);const h=y(e,["enhancePrompt"]);if(t!==void 0&&h!=null&&w(t,["parameters","enhancePrompt"],h),y(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const v=y(e,["lastFrame"]);t!==void 0&&v!=null&&w(t,["instances[0]","lastFrame"],Mp(v));const b=y(e,["referenceImages"]);if(t!==void 0&&b!=null){let g=b;Array.isArray(g)&&(g=g.map(A=>N7(A))),w(t,["instances[0]","referenceImages"],g)}if(y(e,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(y(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return i}function ED(e,t,n){const i={},o=y(e,["numberOfVideos"]);t!==void 0&&o!=null&&w(t,["parameters","sampleCount"],o);const a=y(e,["outputGcsUri"]);t!==void 0&&a!=null&&w(t,["parameters","storageUri"],a);const l=y(e,["fps"]);t!==void 0&&l!=null&&w(t,["parameters","fps"],l);const c=y(e,["durationSeconds"]);t!==void 0&&c!=null&&w(t,["parameters","durationSeconds"],c);const u=y(e,["seed"]);t!==void 0&&u!=null&&w(t,["parameters","seed"],u);const d=y(e,["aspectRatio"]);t!==void 0&&d!=null&&w(t,["parameters","aspectRatio"],d);const h=y(e,["resolution"]);t!==void 0&&h!=null&&w(t,["parameters","resolution"],h);const v=y(e,["personGeneration"]);t!==void 0&&v!=null&&w(t,["parameters","personGeneration"],v);const b=y(e,["pubsubTopic"]);t!==void 0&&b!=null&&w(t,["parameters","pubsubTopic"],b);const g=y(e,["negativePrompt"]);t!==void 0&&g!=null&&w(t,["parameters","negativePrompt"],g);const A=y(e,["enhancePrompt"]);t!==void 0&&A!=null&&w(t,["parameters","enhancePrompt"],A);const _=y(e,["generateAudio"]);t!==void 0&&_!=null&&w(t,["parameters","generateAudio"],_);const C=y(e,["lastFrame"]);t!==void 0&&C!=null&&w(t,["instances[0]","lastFrame"],za(C));const E=y(e,["referenceImages"]);if(t!==void 0&&E!=null){let M=E;Array.isArray(M)&&(M=M.map(P=>A7(P))),w(t,["instances[0]","referenceImages"],M)}const R=y(e,["mask"]);t!==void 0&&R!=null&&w(t,["instances[0]","mask"],E7(R));const k=y(e,["compressionQuality"]);return t!==void 0&&k!=null&&w(t,["parameters","compressionQuality"],k),i}function ND(e,t){const n={},i=y(e,["name"]);i!=null&&w(n,["name"],i);const o=y(e,["metadata"]);o!=null&&w(n,["metadata"],o);const a=y(e,["done"]);a!=null&&w(n,["done"],a);const l=y(e,["error"]);l!=null&&w(n,["error"],l);const c=y(e,["response","generateVideoResponse"]);return c!=null&&w(n,["response"],kD(c)),n}function AD(e,t){const n={},i=y(e,["name"]);i!=null&&w(n,["name"],i);const o=y(e,["metadata"]);o!=null&&w(n,["metadata"],o);const a=y(e,["done"]);a!=null&&w(n,["done"],a);const l=y(e,["error"]);l!=null&&w(n,["error"],l);const c=y(e,["response"]);return c!=null&&w(n,["response"],ID(c)),n}function CD(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["prompt"]);a!=null&&w(i,["instances[0]","prompt"],a);const l=y(t,["image"]);l!=null&&w(i,["instances[0]","image"],Mp(l));const c=y(t,["video"]);c!=null&&w(i,["instances[0]","video"],aS(c));const u=y(t,["source"]);u!=null&&RD(u,i);const d=y(t,["config"]);return d!=null&&SD(d,i),i}function TD(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["prompt"]);a!=null&&w(i,["instances[0]","prompt"],a);const l=y(t,["image"]);l!=null&&w(i,["instances[0]","image"],za(l));const c=y(t,["video"]);c!=null&&w(i,["instances[0]","video"],sS(c));const u=y(t,["source"]);u!=null&&LD(u,i);const d=y(t,["config"]);return d!=null&&ED(d,i),i}function kD(e,t){const n={},i=y(e,["generatedSamples"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>PD(c))),w(n,["generatedVideos"],l)}const o=y(e,["raiMediaFilteredCount"]);o!=null&&w(n,["raiMediaFilteredCount"],o);const a=y(e,["raiMediaFilteredReasons"]);return a!=null&&w(n,["raiMediaFilteredReasons"],a),n}function ID(e,t){const n={},i=y(e,["videos"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>OD(c))),w(n,["generatedVideos"],l)}const o=y(e,["raiMediaFilteredCount"]);o!=null&&w(n,["raiMediaFilteredCount"],o);const a=y(e,["raiMediaFilteredReasons"]);return a!=null&&w(n,["raiMediaFilteredReasons"],a),n}function RD(e,t,n){const i={},o=y(e,["prompt"]);t!==void 0&&o!=null&&w(t,["instances[0]","prompt"],o);const a=y(e,["image"]);t!==void 0&&a!=null&&w(t,["instances[0]","image"],Mp(a));const l=y(e,["video"]);return t!==void 0&&l!=null&&w(t,["instances[0]","video"],aS(l)),i}function LD(e,t,n){const i={},o=y(e,["prompt"]);t!==void 0&&o!=null&&w(t,["instances[0]","prompt"],o);const a=y(e,["image"]);t!==void 0&&a!=null&&w(t,["instances[0]","image"],za(a));const l=y(e,["video"]);return t!==void 0&&l!=null&&w(t,["instances[0]","video"],sS(l)),i}function MD(e,t){const n={},i=y(e,["_self"]);i!=null&&w(n,["image"],GD(i));const o=y(e,["raiFilteredReason"]);o!=null&&w(n,["raiFilteredReason"],o);const a=y(e,["_self"]);return a!=null&&w(n,["safetyAttributes"],iS(a)),n}function Lp(e,t){const n={},i=y(e,["_self"]);i!=null&&w(n,["image"],nS(i));const o=y(e,["raiFilteredReason"]);o!=null&&w(n,["raiFilteredReason"],o);const a=y(e,["_self"]);a!=null&&w(n,["safetyAttributes"],rS(a));const l=y(e,["prompt"]);return l!=null&&w(n,["enhancedPrompt"],l),n}function DD(e,t){const n={},i=y(e,["_self"]);i!=null&&w(n,["mask"],nS(i));const o=y(e,["labels"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>l)),w(n,["labels"],a)}return n}function PD(e,t){const n={},i=y(e,["video"]);return i!=null&&w(n,["video"],_7(i)),n}function OD(e,t){const n={},i=y(e,["_self"]);return i!=null&&w(n,["video"],S7(i)),n}function UD(e,t){const n={},i=y(e,["modelSelectionConfig"]);i!=null&&w(n,["modelConfig"],i);const o=y(e,["responseJsonSchema"]);o!=null&&w(n,["responseJsonSchema"],o);const a=y(e,["audioTimestamp"]);a!=null&&w(n,["audioTimestamp"],a);const l=y(e,["candidateCount"]);l!=null&&w(n,["candidateCount"],l);const c=y(e,["enableAffectiveDialog"]);c!=null&&w(n,["enableAffectiveDialog"],c);const u=y(e,["frequencyPenalty"]);u!=null&&w(n,["frequencyPenalty"],u);const d=y(e,["logprobs"]);d!=null&&w(n,["logprobs"],d);const h=y(e,["maxOutputTokens"]);h!=null&&w(n,["maxOutputTokens"],h);const v=y(e,["mediaResolution"]);v!=null&&w(n,["mediaResolution"],v);const b=y(e,["presencePenalty"]);b!=null&&w(n,["presencePenalty"],b);const g=y(e,["responseLogprobs"]);g!=null&&w(n,["responseLogprobs"],g);const A=y(e,["responseMimeType"]);A!=null&&w(n,["responseMimeType"],A);const _=y(e,["responseModalities"]);_!=null&&w(n,["responseModalities"],_);const C=y(e,["responseSchema"]);C!=null&&w(n,["responseSchema"],C);const E=y(e,["routingConfig"]);E!=null&&w(n,["routingConfig"],E);const R=y(e,["seed"]);R!=null&&w(n,["seed"],R);const k=y(e,["speechConfig"]);k!=null&&w(n,["speechConfig"],k);const M=y(e,["stopSequences"]);M!=null&&w(n,["stopSequences"],M);const P=y(e,["temperature"]);P!=null&&w(n,["temperature"],P);const W=y(e,["thinkingConfig"]);W!=null&&w(n,["thinkingConfig"],W);const V=y(e,["topK"]);V!=null&&w(n,["topK"],V);const $=y(e,["topP"]);if($!=null&&w(n,["topP"],$),y(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return n}function zD(e,t,n){const i={},o=y(t,["model"]);return o!=null&&w(i,["_url","name"],Ln(e,o)),i}function jD(e,t,n){const i={},o=y(t,["model"]);return o!=null&&w(i,["_url","name"],Ln(e,o)),i}function FD(e,t){const n={};if(y(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const i=y(e,["enableWidget"]);return i!=null&&w(n,["enableWidget"],i),n}function BD(e,t){const n={};if(y(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(y(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const i=y(e,["timeRangeFilter"]);return i!=null&&w(n,["timeRangeFilter"],i),n}function qD(e,t){const n={},i=y(e,["aspectRatio"]);i!=null&&w(n,["aspectRatio"],i);const o=y(e,["imageSize"]);if(o!=null&&w(n,["imageSize"],o),y(e,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(y(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(y(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return n}function HD(e,t){const n={},i=y(e,["aspectRatio"]);i!=null&&w(n,["aspectRatio"],i);const o=y(e,["imageSize"]);o!=null&&w(n,["imageSize"],o);const a=y(e,["personGeneration"]);a!=null&&w(n,["personGeneration"],a);const l=y(e,["outputMimeType"]);l!=null&&w(n,["imageOutputOptions","mimeType"],l);const c=y(e,["outputCompressionQuality"]);return c!=null&&w(n,["imageOutputOptions","compressionQuality"],c),n}function GD(e,t){const n={},i=y(e,["bytesBase64Encoded"]);i!=null&&w(n,["imageBytes"],Hl(i));const o=y(e,["mimeType"]);return o!=null&&w(n,["mimeType"],o),n}function nS(e,t){const n={},i=y(e,["gcsUri"]);i!=null&&w(n,["gcsUri"],i);const o=y(e,["bytesBase64Encoded"]);o!=null&&w(n,["imageBytes"],Hl(o));const a=y(e,["mimeType"]);return a!=null&&w(n,["mimeType"],a),n}function Mp(e,t){const n={};if(y(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const i=y(e,["imageBytes"]);i!=null&&w(n,["bytesBase64Encoded"],Hl(i));const o=y(e,["mimeType"]);return o!=null&&w(n,["mimeType"],o),n}function za(e,t){const n={},i=y(e,["gcsUri"]);i!=null&&w(n,["gcsUri"],i);const o=y(e,["imageBytes"]);o!=null&&w(n,["bytesBase64Encoded"],Hl(o));const a=y(e,["mimeType"]);return a!=null&&w(n,["mimeType"],a),n}function VD(e,t,n,i){const o={},a=y(t,["pageSize"]);n!==void 0&&a!=null&&w(n,["_query","pageSize"],a);const l=y(t,["pageToken"]);n!==void 0&&l!=null&&w(n,["_query","pageToken"],l);const c=y(t,["filter"]);n!==void 0&&c!=null&&w(n,["_query","filter"],c);const u=y(t,["queryBase"]);return n!==void 0&&u!=null&&w(n,["_url","models_url"],X_(e,u)),o}function $D(e,t,n,i){const o={},a=y(t,["pageSize"]);n!==void 0&&a!=null&&w(n,["_query","pageSize"],a);const l=y(t,["pageToken"]);n!==void 0&&l!=null&&w(n,["_query","pageToken"],l);const c=y(t,["filter"]);n!==void 0&&c!=null&&w(n,["_query","filter"],c);const u=y(t,["queryBase"]);return n!==void 0&&u!=null&&w(n,["_url","models_url"],X_(e,u)),o}function YD(e,t,n){const i={},o=y(t,["config"]);return o!=null&&VD(e,o,i),i}function WD(e,t,n){const i={},o=y(t,["config"]);return o!=null&&$D(e,o,i),i}function XD(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["nextPageToken"]);o!=null&&w(n,["nextPageToken"],o);const a=y(e,["_self"]);if(a!=null){let l=J_(a);Array.isArray(l)&&(l=l.map(c=>wg(c))),w(n,["models"],l)}return n}function JD(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["nextPageToken"]);o!=null&&w(n,["nextPageToken"],o);const a=y(e,["_self"]);if(a!=null){let l=J_(a);Array.isArray(l)&&(l=l.map(c=>_g(c))),w(n,["models"],l)}return n}function KD(e,t){const n={},i=y(e,["maskMode"]);i!=null&&w(n,["maskMode"],i);const o=y(e,["segmentationClasses"]);o!=null&&w(n,["maskClasses"],o);const a=y(e,["maskDilation"]);return a!=null&&w(n,["dilation"],a),n}function wg(e,t){const n={},i=y(e,["name"]);i!=null&&w(n,["name"],i);const o=y(e,["displayName"]);o!=null&&w(n,["displayName"],o);const a=y(e,["description"]);a!=null&&w(n,["description"],a);const l=y(e,["version"]);l!=null&&w(n,["version"],l);const c=y(e,["_self"]);c!=null&&w(n,["tunedModelInfo"],h7(c));const u=y(e,["inputTokenLimit"]);u!=null&&w(n,["inputTokenLimit"],u);const d=y(e,["outputTokenLimit"]);d!=null&&w(n,["outputTokenLimit"],d);const h=y(e,["supportedGenerationMethods"]);h!=null&&w(n,["supportedActions"],h);const v=y(e,["temperature"]);v!=null&&w(n,["temperature"],v);const b=y(e,["maxTemperature"]);b!=null&&w(n,["maxTemperature"],b);const g=y(e,["topP"]);g!=null&&w(n,["topP"],g);const A=y(e,["topK"]);A!=null&&w(n,["topK"],A);const _=y(e,["thinking"]);return _!=null&&w(n,["thinking"],_),n}function _g(e,t){const n={},i=y(e,["name"]);i!=null&&w(n,["name"],i);const o=y(e,["displayName"]);o!=null&&w(n,["displayName"],o);const a=y(e,["description"]);a!=null&&w(n,["description"],a);const l=y(e,["versionId"]);l!=null&&w(n,["version"],l);const c=y(e,["deployedModels"]);if(c!=null){let b=c;Array.isArray(b)&&(b=b.map(g=>uD(g))),w(n,["endpoints"],b)}const u=y(e,["labels"]);u!=null&&w(n,["labels"],u);const d=y(e,["_self"]);d!=null&&w(n,["tunedModelInfo"],p7(d));const h=y(e,["defaultCheckpointId"]);h!=null&&w(n,["defaultCheckpointId"],h);const v=y(e,["checkpoints"]);if(v!=null){let b=v;Array.isArray(b)&&(b=b.map(g=>g)),w(n,["checkpoints"],b)}return n}function ZD(e,t){const n={},i=y(e,["mediaResolution"]);i!=null&&w(n,["mediaResolution"],i);const o=y(e,["codeExecutionResult"]);o!=null&&w(n,["codeExecutionResult"],o);const a=y(e,["executableCode"]);a!=null&&w(n,["executableCode"],a);const l=y(e,["fileData"]);l!=null&&w(n,["fileData"],dD(l));const c=y(e,["functionCall"]);c!=null&&w(n,["functionCall"],fD(c));const u=y(e,["functionResponse"]);u!=null&&w(n,["functionResponse"],u);const d=y(e,["inlineData"]);d!=null&&w(n,["inlineData"],UM(d));const h=y(e,["text"]);h!=null&&w(n,["text"],h);const v=y(e,["thought"]);v!=null&&w(n,["thought"],v);const b=y(e,["thoughtSignature"]);b!=null&&w(n,["thoughtSignature"],b);const g=y(e,["videoMetadata"]);return g!=null&&w(n,["videoMetadata"],g),n}function QD(e,t){const n={},i=y(e,["productImage"]);return i!=null&&w(n,["image"],za(i)),n}function e7(e,t,n){const i={},o=y(e,["numberOfImages"]);t!==void 0&&o!=null&&w(t,["parameters","sampleCount"],o);const a=y(e,["baseSteps"]);t!==void 0&&a!=null&&w(t,["parameters","baseSteps"],a);const l=y(e,["outputGcsUri"]);t!==void 0&&l!=null&&w(t,["parameters","storageUri"],l);const c=y(e,["seed"]);t!==void 0&&c!=null&&w(t,["parameters","seed"],c);const u=y(e,["safetyFilterLevel"]);t!==void 0&&u!=null&&w(t,["parameters","safetySetting"],u);const d=y(e,["personGeneration"]);t!==void 0&&d!=null&&w(t,["parameters","personGeneration"],d);const h=y(e,["addWatermark"]);t!==void 0&&h!=null&&w(t,["parameters","addWatermark"],h);const v=y(e,["outputMimeType"]);t!==void 0&&v!=null&&w(t,["parameters","outputOptions","mimeType"],v);const b=y(e,["outputCompressionQuality"]);t!==void 0&&b!=null&&w(t,["parameters","outputOptions","compressionQuality"],b);const g=y(e,["enhancePrompt"]);t!==void 0&&g!=null&&w(t,["parameters","enhancePrompt"],g);const A=y(e,["labels"]);return t!==void 0&&A!=null&&w(t,["labels"],A),i}function t7(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["source"]);a!=null&&i7(a,i);const l=y(t,["config"]);return l!=null&&e7(l,i),i}function n7(e,t){const n={},i=y(e,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>Lp(a))),w(n,["generatedImages"],o)}return n}function i7(e,t,n){const i={},o=y(e,["prompt"]);t!==void 0&&o!=null&&w(t,["instances[0]","prompt"],o);const a=y(e,["personImage"]);t!==void 0&&a!=null&&w(t,["instances[0]","personImage","image"],za(a));const l=y(e,["productImages"]);if(t!==void 0&&l!=null){let c=l;Array.isArray(c)&&(c=c.map(u=>QD(u))),w(t,["instances[0]","productImages"],c)}return i}function r7(e,t){const n={},i=y(e,["referenceImage"]);i!=null&&w(n,["referenceImage"],za(i));const o=y(e,["referenceId"]);o!=null&&w(n,["referenceId"],o);const a=y(e,["referenceType"]);a!=null&&w(n,["referenceType"],a);const l=y(e,["maskImageConfig"]);l!=null&&w(n,["maskImageConfig"],KD(l));const c=y(e,["controlImageConfig"]);c!=null&&w(n,["controlImageConfig"],GM(c));const u=y(e,["styleImageConfig"]);u!=null&&w(n,["styleImageConfig"],u);const d=y(e,["subjectImageConfig"]);return d!=null&&w(n,["subjectImageConfig"],d),n}function iS(e,t){const n={},i=y(e,["safetyAttributes","categories"]);i!=null&&w(n,["categories"],i);const o=y(e,["safetyAttributes","scores"]);o!=null&&w(n,["scores"],o);const a=y(e,["contentType"]);return a!=null&&w(n,["contentType"],a),n}function rS(e,t){const n={},i=y(e,["safetyAttributes","categories"]);i!=null&&w(n,["categories"],i);const o=y(e,["safetyAttributes","scores"]);o!=null&&w(n,["scores"],o);const a=y(e,["contentType"]);return a!=null&&w(n,["contentType"],a),n}function o7(e,t){const n={},i=y(e,["category"]);if(i!=null&&w(n,["category"],i),y(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const o=y(e,["threshold"]);return o!=null&&w(n,["threshold"],o),n}function a7(e,t){const n={},i=y(e,["image"]);return i!=null&&w(n,["image"],za(i)),n}function s7(e,t,n){const i={},o=y(e,["mode"]);t!==void 0&&o!=null&&w(t,["parameters","mode"],o);const a=y(e,["maxPredictions"]);t!==void 0&&a!=null&&w(t,["parameters","maxPredictions"],a);const l=y(e,["confidenceThreshold"]);t!==void 0&&l!=null&&w(t,["parameters","confidenceThreshold"],l);const c=y(e,["maskDilation"]);t!==void 0&&c!=null&&w(t,["parameters","maskDilation"],c);const u=y(e,["binaryColorThreshold"]);t!==void 0&&u!=null&&w(t,["parameters","binaryColorThreshold"],u);const d=y(e,["labels"]);return t!==void 0&&d!=null&&w(t,["labels"],d),i}function l7(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["source"]);a!=null&&u7(a,i);const l=y(t,["config"]);return l!=null&&s7(l,i),i}function c7(e,t){const n={},i=y(e,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>DD(a))),w(n,["generatedMasks"],o)}return n}function u7(e,t,n){const i={},o=y(e,["prompt"]);t!==void 0&&o!=null&&w(t,["instances[0]","prompt"],o);const a=y(e,["image"]);t!==void 0&&a!=null&&w(t,["instances[0]","image"],za(a));const l=y(e,["scribbleImage"]);return t!==void 0&&l!=null&&w(t,["instances[0]","scribble"],a7(l)),i}function d7(e,t){const n={},i=y(e,["retrievalConfig"]);i!=null&&w(n,["retrievalConfig"],i);const o=y(e,["functionCallingConfig"]);return o!=null&&w(n,["functionCallingConfig"],hD(o)),n}function f7(e,t){const n={};if(y(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=y(e,["computerUse"]);i!=null&&w(n,["computerUse"],i);const o=y(e,["fileSearch"]);o!=null&&w(n,["fileSearch"],o);const a=y(e,["codeExecution"]);if(a!=null&&w(n,["codeExecution"],a),y(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=y(e,["functionDeclarations"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(b=>b)),w(n,["functionDeclarations"],v)}const c=y(e,["googleMaps"]);c!=null&&w(n,["googleMaps"],FD(c));const u=y(e,["googleSearch"]);u!=null&&w(n,["googleSearch"],BD(u));const d=y(e,["googleSearchRetrieval"]);d!=null&&w(n,["googleSearchRetrieval"],d);const h=y(e,["urlContext"]);return h!=null&&w(n,["urlContext"],h),n}function oS(e,t){const n={},i=y(e,["retrieval"]);i!=null&&w(n,["retrieval"],i);const o=y(e,["computerUse"]);if(o!=null&&w(n,["computerUse"],o),y(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=y(e,["codeExecution"]);a!=null&&w(n,["codeExecution"],a);const l=y(e,["enterpriseWebSearch"]);l!=null&&w(n,["enterpriseWebSearch"],l);const c=y(e,["functionDeclarations"]);if(c!=null){let b=c;Array.isArray(b)&&(b=b.map(g=>pD(g))),w(n,["functionDeclarations"],b)}const u=y(e,["googleMaps"]);u!=null&&w(n,["googleMaps"],u);const d=y(e,["googleSearch"]);d!=null&&w(n,["googleSearch"],d);const h=y(e,["googleSearchRetrieval"]);h!=null&&w(n,["googleSearchRetrieval"],h);const v=y(e,["urlContext"]);return v!=null&&w(n,["urlContext"],v),n}function h7(e,t){const n={},i=y(e,["baseModel"]);i!=null&&w(n,["baseModel"],i);const o=y(e,["createTime"]);o!=null&&w(n,["createTime"],o);const a=y(e,["updateTime"]);return a!=null&&w(n,["updateTime"],a),n}function p7(e,t){const n={},i=y(e,["labels","google-vertex-llm-tuning-base-model-id"]);i!=null&&w(n,["baseModel"],i);const o=y(e,["createTime"]);o!=null&&w(n,["createTime"],o);const a=y(e,["updateTime"]);return a!=null&&w(n,["updateTime"],a),n}function m7(e,t,n){const i={},o=y(e,["displayName"]);t!==void 0&&o!=null&&w(t,["displayName"],o);const a=y(e,["description"]);t!==void 0&&a!=null&&w(t,["description"],a);const l=y(e,["defaultCheckpointId"]);return t!==void 0&&l!=null&&w(t,["defaultCheckpointId"],l),i}function g7(e,t,n){const i={},o=y(e,["displayName"]);t!==void 0&&o!=null&&w(t,["displayName"],o);const a=y(e,["description"]);t!==void 0&&a!=null&&w(t,["description"],a);const l=y(e,["defaultCheckpointId"]);return t!==void 0&&l!=null&&w(t,["defaultCheckpointId"],l),i}function v7(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","name"],Ln(e,o));const a=y(t,["config"]);return a!=null&&m7(a,i),i}function y7(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["config"]);return a!=null&&g7(a,i),i}function b7(e,t,n){const i={},o=y(e,["outputGcsUri"]);t!==void 0&&o!=null&&w(t,["parameters","storageUri"],o);const a=y(e,["safetyFilterLevel"]);t!==void 0&&a!=null&&w(t,["parameters","safetySetting"],a);const l=y(e,["personGeneration"]);t!==void 0&&l!=null&&w(t,["parameters","personGeneration"],l);const c=y(e,["includeRaiReason"]);t!==void 0&&c!=null&&w(t,["parameters","includeRaiReason"],c);const u=y(e,["outputMimeType"]);t!==void 0&&u!=null&&w(t,["parameters","outputOptions","mimeType"],u);const d=y(e,["outputCompressionQuality"]);t!==void 0&&d!=null&&w(t,["parameters","outputOptions","compressionQuality"],d);const h=y(e,["enhanceInputImage"]);t!==void 0&&h!=null&&w(t,["parameters","upscaleConfig","enhanceInputImage"],h);const v=y(e,["imagePreservationFactor"]);t!==void 0&&v!=null&&w(t,["parameters","upscaleConfig","imagePreservationFactor"],v);const b=y(e,["labels"]);t!==void 0&&b!=null&&w(t,["labels"],b);const g=y(e,["numberOfImages"]);t!==void 0&&g!=null&&w(t,["parameters","sampleCount"],g);const A=y(e,["mode"]);return t!==void 0&&A!=null&&w(t,["parameters","mode"],A),i}function x7(e,t,n){const i={},o=y(t,["model"]);o!=null&&w(i,["_url","model"],Ln(e,o));const a=y(t,["image"]);a!=null&&w(i,["instances[0]","image"],za(a));const l=y(t,["upscaleFactor"]);l!=null&&w(i,["parameters","upscaleConfig","upscaleFactor"],l);const c=y(t,["config"]);return c!=null&&b7(c,i),i}function w7(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["predictions"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>Lp(l))),w(n,["generatedImages"],a)}return n}function _7(e,t){const n={},i=y(e,["uri"]);i!=null&&w(n,["uri"],i);const o=y(e,["encodedVideo"]);o!=null&&w(n,["videoBytes"],Hl(o));const a=y(e,["encoding"]);return a!=null&&w(n,["mimeType"],a),n}function S7(e,t){const n={},i=y(e,["gcsUri"]);i!=null&&w(n,["uri"],i);const o=y(e,["bytesBase64Encoded"]);o!=null&&w(n,["videoBytes"],Hl(o));const a=y(e,["mimeType"]);return a!=null&&w(n,["mimeType"],a),n}function E7(e,t){const n={},i=y(e,["image"]);i!=null&&w(n,["_self"],za(i));const o=y(e,["maskMode"]);return o!=null&&w(n,["maskMode"],o),n}function N7(e,t){const n={},i=y(e,["image"]);i!=null&&w(n,["image"],Mp(i));const o=y(e,["referenceType"]);return o!=null&&w(n,["referenceType"],o),n}function A7(e,t){const n={},i=y(e,["image"]);i!=null&&w(n,["image"],za(i));const o=y(e,["referenceType"]);return o!=null&&w(n,["referenceType"],o),n}function aS(e,t){const n={},i=y(e,["uri"]);i!=null&&w(n,["uri"],i);const o=y(e,["videoBytes"]);o!=null&&w(n,["encodedVideo"],Hl(o));const a=y(e,["mimeType"]);return a!=null&&w(n,["encoding"],a),n}function sS(e,t){const n={},i=y(e,["uri"]);i!=null&&w(n,["gcsUri"],i);const o=y(e,["videoBytes"]);o!=null&&w(n,["bytesBase64Encoded"],Hl(o));const a=y(e,["mimeType"]);return a!=null&&w(n,["mimeType"],a),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function C7(e,t){const n={},i=y(e,["displayName"]);return t!==void 0&&i!=null&&w(t,["displayName"],i),n}function T7(e){const t={},n=y(e,["config"]);return n!=null&&C7(n,t),t}function k7(e,t){const n={},i=y(e,["force"]);return t!==void 0&&i!=null&&w(t,["_query","force"],i),n}function I7(e){const t={},n=y(e,["name"]);n!=null&&w(t,["_url","name"],n);const i=y(e,["config"]);return i!=null&&k7(i,t),t}function R7(e){const t={},n=y(e,["name"]);return n!=null&&w(t,["_url","name"],n),t}function L7(e,t){const n={},i=y(e,["customMetadata"]);if(t!==void 0&&i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),w(t,["customMetadata"],a)}const o=y(e,["chunkingConfig"]);return t!==void 0&&o!=null&&w(t,["chunkingConfig"],o),n}function M7(e){const t={},n=y(e,["name"]);n!=null&&w(t,["name"],n);const i=y(e,["metadata"]);i!=null&&w(t,["metadata"],i);const o=y(e,["done"]);o!=null&&w(t,["done"],o);const a=y(e,["error"]);a!=null&&w(t,["error"],a);const l=y(e,["response"]);return l!=null&&w(t,["response"],P7(l)),t}function D7(e){const t={},n=y(e,["fileSearchStoreName"]);n!=null&&w(t,["_url","file_search_store_name"],n);const i=y(e,["fileName"]);i!=null&&w(t,["fileName"],i);const o=y(e,["config"]);return o!=null&&L7(o,t),t}function P7(e){const t={},n=y(e,["sdkHttpResponse"]);n!=null&&w(t,["sdkHttpResponse"],n);const i=y(e,["parent"]);i!=null&&w(t,["parent"],i);const o=y(e,["documentName"]);return o!=null&&w(t,["documentName"],o),t}function O7(e,t){const n={},i=y(e,["pageSize"]);t!==void 0&&i!=null&&w(t,["_query","pageSize"],i);const o=y(e,["pageToken"]);return t!==void 0&&o!=null&&w(t,["_query","pageToken"],o),n}function U7(e){const t={},n=y(e,["config"]);return n!=null&&O7(n,t),t}function z7(e){const t={},n=y(e,["sdkHttpResponse"]);n!=null&&w(t,["sdkHttpResponse"],n);const i=y(e,["nextPageToken"]);i!=null&&w(t,["nextPageToken"],i);const o=y(e,["fileSearchStores"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>l)),w(t,["fileSearchStores"],a)}return t}function lS(e,t){const n={},i=y(e,["mimeType"]);t!==void 0&&i!=null&&w(t,["mimeType"],i);const o=y(e,["displayName"]);t!==void 0&&o!=null&&w(t,["displayName"],o);const a=y(e,["customMetadata"]);if(t!==void 0&&a!=null){let c=a;Array.isArray(c)&&(c=c.map(u=>u)),w(t,["customMetadata"],c)}const l=y(e,["chunkingConfig"]);return t!==void 0&&l!=null&&w(t,["chunkingConfig"],l),n}function j7(e){const t={},n=y(e,["fileSearchStoreName"]);n!=null&&w(t,["_url","file_search_store_name"],n);const i=y(e,["config"]);return i!=null&&lS(i,t),t}function F7(e){const t={},n=y(e,["sdkHttpResponse"]);return n!=null&&w(t,["sdkHttpResponse"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const B7="Content-Type",q7="X-Server-Timeout",H7="User-Agent",Sg="x-goog-api-client",G7="1.40.0",V7=`google-genai-sdk/${G7}`,$7="v1beta1",Y7="v1beta";class W7{constructor(t){var n,i,o;this.clientOptions=Object.assign({},t),this.customBaseUrl=(n=t.httpOptions)===null||n===void 0?void 0:n.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const a={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const c=t.project&&t.location||!!t.apiKey;this.customBaseUrl&&!c?(a.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?a.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(a.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),a.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:$7}else{if(!this.clientOptions.apiKey)throw new hf({message:"API key must be set when using the Gemini API.",status:403});a.apiVersion=(o=this.clientOptions.apiVersion)!==null&&o!==void 0?o:Y7,a.baseUrl="https://generativelanguage.googleapis.com/"}a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,t.httpOptions))}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const t=new Headers;return await this.clientOptions.auth.addAuthHeaders(t),t}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&i.push(t.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,i){const o=[this.getRequestUrlInternal(n)];return i&&o.push(this.getBaseResourcePath()),t!==""&&o.push(t),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(t,n){return!(n.baseUrl&&n.baseUrlResourceScope===vg.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const i=this.shouldPrependVertexProjectPath(t,n),o=this.constructUrl(t.path,n,i);if(t.queryParams)for(const[l,c]of Object.entries(t.queryParams))o.searchParams.append(l,String(c));let a={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=t.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,n,o.toString(),t.abortSignal),this.unaryApiCall(o,a,t.httpMethod)}patchHttpOptions(t,n){const i=JSON.parse(JSON.stringify(t));for(const[o,a]of Object.entries(n))typeof a=="object"?i[o]=Object.assign(Object.assign({},i[o]),a):a!==void 0&&(i[o]=a);return i}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const i=this.shouldPrependVertexProjectPath(t,n),o=this.constructUrl(t.path,n,i);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let a={};return a.body=t.body,a=await this.includeExtraHttpOptionsToRequestInit(a,n,o.toString(),t.abortSignal),this.streamApiCall(o,a,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,i,o){if(n&&n.timeout||o){const a=new AbortController,l=a.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const c=setTimeout(()=>a.abort(),n.timeout);c&&typeof c.unref=="function"&&c.unref()}o&&o.addEventListener("abort",()=>{a.abort()}),t.signal=l}return n&&n.extraBody!==null&&X7(t,n.extraBody),t.headers=await this.getHeadersInternal(n,i),t}async unaryApiCall(t,n,i){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:i})).then(async o=>(await mx(o),new yg(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(t,n,i){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:i})).then(async o=>(await mx(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(t){return La(this,arguments,function*(){var i;const o=(i=t==null?void 0:t.body)===null||i===void 0?void 0:i.getReader(),a=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let l="";const c="data:",u=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:d,value:h}=yield Kt(o.read());if(d){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const v=a.decode(h,{stream:!0});try{const A=JSON.parse(v);if("error"in A){const _=JSON.parse(JSON.stringify(A.error)),C=_.status,E=_.code,R=`got status: ${C}. ${JSON.stringify(A)}`;if(E>=400&&E<600)throw new hf({message:R,status:E})}}catch(A){if(A.name==="ApiError")throw A}l+=v;let b=-1,g=0;for(;;){b=-1,g=0;for(const C of u){const E=l.indexOf(C);E!==-1&&(b===-1||E<b)&&(b=E,g=C.length)}if(b===-1)break;const A=l.substring(0,b);l=l.substring(b+g);const _=A.trim();if(_.startsWith(c)){const C=_.substring(c.length).trim();try{const E=new Response(C,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield Kt(new yg(E))}catch(E){throw new Error(`exception parsing stream chunk ${C}. ${E}`)}}}}}finally{o.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const t={},n=V7+" "+this.clientOptions.userAgentExtra;return t[H7]=n,t[Sg]=n,t[B7]="application/json",t}async getHeadersInternal(t,n){const i=new Headers;if(t&&t.headers){for(const[o,a]of Object.entries(t.headers))i.append(o,a);t.timeout&&t.timeout>0&&i.append(q7,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,n),i}getFileName(t){var n;let i="";return typeof t=="string"&&(i=t.replace(/[/\\]+$/,""),i=(n=i.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),i}async uploadFile(t,n){var i;const o={};n!=null&&(o.mimeType=n.mimeType,o.name=n.name,o.displayName=n.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const a=this.clientOptions.uploader,l=await a.stat(t);o.sizeBytes=String(l.size);const c=(i=n==null?void 0:n.mimeType)!==null&&i!==void 0?i:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=c;const u={file:o},d=this.getFileName(t),h=xt("upload/v1beta/files",u._url),v=await this.fetchUploadUrl(h,o.sizeBytes,o.mimeType,d,u,n==null?void 0:n.httpOptions);return a.upload(t,v,this)}async uploadFileToFileSearchStore(t,n,i){var o;const a=this.clientOptions.uploader,l=await a.stat(n),c=String(l.size),u=(o=i==null?void 0:i.mimeType)!==null&&o!==void 0?o:l.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const d=`upload/v1beta/${t}:uploadToFileSearchStore`,h=this.getFileName(n),v={};i!=null&&lS(i,v);const b=await this.fetchUploadUrl(d,c,u,h,v,i==null?void 0:i.httpOptions);return a.uploadToFileSearchStore(n,b,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,n,i,o,a,l){var c;let u={};l?u=l:u={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${i}`},o?{"X-Goog-Upload-File-Name":o}:{})};const d=await this.request({path:t,body:JSON.stringify(a),httpMethod:"POST",httpOptions:u});if(!d||!(d!=null&&d.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const h=(c=d==null?void 0:d.headers)===null||c===void 0?void 0:c["x-goog-upload-url"];if(h===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return h}}async function mx(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const n=e.status;let i;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?i=await e.json():i={error:{message:await e.text(),code:e.status,status:e.statusText}};const o=JSON.stringify(i);throw n>=400&&n<600?new hf({message:o,status:n}):new Error(o)}}function X7(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof e.body=="string"&&e.body.length>0)try{const a=JSON.parse(e.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))n=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(a,l){const c=Object.assign({},a);for(const u in l)if(Object.prototype.hasOwnProperty.call(l,u)){const d=l[u],h=c[u];d&&typeof d=="object"&&!Array.isArray(d)&&h&&typeof h=="object"&&!Array.isArray(h)?c[u]=i(h,d):(h&&d&&typeof h!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${u}". Original type: ${typeof h}, New type: ${typeof d}. Overwriting.`),c[u]=d)}return c}const o=i(n,t);e.body=JSON.stringify(o)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const J7="mcp_used/unknown";let K7=!1;function cS(e){for(const t of e)if(Z7(t)||typeof t=="object"&&"inputSchema"in t)return!0;return K7}function uS(e){var t;const n=(t=e[Sg])!==null&&t!==void 0?t:"";e[Sg]=(n+` ${J7}`).trimStart()}function Z7(e){return e!==null&&typeof e=="object"&&e instanceof h1}function Q7(e){return La(this,arguments,function*(n,i=100){let o,a=0;for(;a<i;){const l=yield Kt(n.listTools({cursor:o}));for(const c of l.tools)yield yield Kt(c),a++;if(!l.nextCursor)break;o=l.nextCursor}})}class h1{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new h1(t,n)}async initialize(){var t,n,i,o;if(this.mcpTools.length>0)return;const a={},l=[];for(const h of this.mcpClients)try{for(var c=!0,u=(n=void 0,Ma(Q7(h))),d;d=await u.next(),t=d.done,!t;c=!0){o=d.value,c=!1;const v=o;l.push(v);const b=v.name;if(a[b])throw new Error(`Duplicate function name ${b} found in MCP tools. Please ensure function names are unique.`);a[b]=h}}catch(v){n={error:v}}finally{try{!c&&!t&&(i=u.return)&&await i.call(u)}finally{if(n)throw n.error}}this.mcpTools=l,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),TR(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const i of t)if(i.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[i.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const l=await o.callTool({name:i.name,arguments:i.args},void 0,a);n.push({functionResponse:{name:i.name,response:l.isError?{error:l}:l}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function eP(e,t,n){const i=new xR;let o;n.data instanceof Blob?o=JSON.parse(await n.data.text()):o=JSON.parse(n.data),Object.assign(i,o),t(i)}class tP{constructor(t,n,i){this.apiClient=t,this.auth=n,this.webSocketFactory=i}async connect(t){var n,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),l=rP(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),u=`${o}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${c}`;let d=()=>{};const h=new Promise(k=>{d=k}),v=t.callbacks,b=function(){d({})},g=this.apiClient,A={onopen:b,onmessage:k=>{eP(g,v.onmessage,k)},onerror:(n=v==null?void 0:v.onerror)!==null&&n!==void 0?n:function(k){},onclose:(i=v==null?void 0:v.onclose)!==null&&i!==void 0?i:function(k){}},_=this.webSocketFactory.create(u,iP(l),A);_.connect(),await h;const R={setup:{model:Ln(this.apiClient,t.model)}};return _.send(JSON.stringify(R)),new nP(_,this.apiClient)}}class nP{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=CM(t);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=AM(t);this.conn.send(JSON.stringify(n))}sendPlaybackControl(t){const n={playbackControl:t};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Ou.PLAY)}pause(){this.sendPlaybackControl(Ou.PAUSE)}stop(){this.sendPlaybackControl(Ou.STOP)}resetContext(){this.sendPlaybackControl(Ou.RESET_CONTEXT)}close(){this.conn.close()}}function iP(e){const t={};return e.forEach((n,i)=>{t[i]=n}),t}function rP(e){const t=new Headers;for(const[n,i]of Object.entries(e))t.append(n,i);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const oP="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function aP(e,t,n){const i=new bR;let o;n.data instanceof Blob?o=await n.data.text():n.data instanceof ArrayBuffer?o=new TextDecoder().decode(n.data):o=n.data;const a=JSON.parse(o);if(e.isVertexAI()){const l=IM(a);Object.assign(i,l)}else Object.assign(i,a);t(i)}class sP{constructor(t,n,i){this.apiClient=t,this.auth=n,this.webSocketFactory=i,this.music=new tP(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,i,o,a,l,c;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const u=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let h;const v=this.apiClient.getHeaders();t.config&&t.config.tools&&cS(t.config.tools)&&uS(v);const b=dP(v);if(this.apiClient.isVertexAI()){const j=this.apiClient.getProject(),X=this.apiClient.getLocation(),z=this.apiClient.getApiKey(),U=!!j&&!!X||!!z;this.apiClient.getCustomBaseUrl()&&!U?h=u:(h=`${u}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(b,h))}else{const j=this.apiClient.getApiKey();let X="BidiGenerateContent",z="key";j!=null&&j.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),X="BidiGenerateContentConstrained",z="access_token"),h=`${u}/ws/google.ai.generativelanguage.${d}.GenerativeService.${X}?${z}=${j}`}let g=()=>{};const A=new Promise(j=>{g=j}),_=t.callbacks,C=function(){var j;(j=_==null?void 0:_.onopen)===null||j===void 0||j.call(_),g({})},E=this.apiClient,R={onopen:C,onmessage:j=>{aP(E,_.onmessage,j)},onerror:(n=_==null?void 0:_.onerror)!==null&&n!==void 0?n:function(j){},onclose:(i=_==null?void 0:_.onclose)!==null&&i!==void 0?i:function(j){}},k=this.webSocketFactory.create(h,uP(b),R);k.connect(),await A;let M=Ln(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&M.startsWith("publishers/")){const j=this.apiClient.getProject(),X=this.apiClient.getLocation();j&&X&&(M=`projects/${j}/locations/${X}/`+M)}let P={};this.apiClient.isVertexAI()&&((o=t.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[fp.AUDIO]}:t.config.responseModalities=[fp.AUDIO]),!((a=t.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const W=(c=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],V=[];for(const j of W)if(this.isCallableTool(j)){const X=j;V.push(await X.tool())}else V.push(j);V.length>0&&(t.config.tools=V);const $={model:M,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?P=NM(this.apiClient,$):P=EM(this.apiClient,$),delete P.config,k.send(JSON.stringify(P)),new cP(k,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const lP={turnComplete:!0};class cP{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let i=[];try{i=Ko(n.turns),t.isVertexAI()||(i=i.map(o=>Rp(o)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:i,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let i=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?i=n.functionResponses:i=[n.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const a of i){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!t.isVertexAI()&&!("id"in a))throw new Error(oP)}return{toolResponse:{functionResponses:i}}}sendClientContent(t){t=Object.assign(Object.assign({},lP),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:kM(t)}:n={realtimeInput:TM(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function uP(e){const t={};return e.forEach((n,i)=>{t[i]=n}),t}function dP(e){const t=new Headers;for(const[n,i]of Object.entries(e))t.append(n,i);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gx=10;function vx(e){var t,n,i;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let o=!1;for(const l of(n=e==null?void 0:e.tools)!==null&&n!==void 0?n:[])if(Vu(l)){o=!0;break}if(!o)return!0;const a=(i=e==null?void 0:e.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function Vu(e){return"callTool"in e&&typeof e.callTool=="function"}function fP(e){var t,n,i;return(i=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(o=>Vu(o)))!==null&&i!==void 0?i:!1}function yx(e){var t;const n=[];return!((t=e==null?void 0:e.config)===null||t===void 0)&&t.tools&&e.config.tools.forEach((i,o)=>{if(Vu(i))return;const a=i;a.functionDeclarations&&a.functionDeclarations.length>0&&n.push(o)}),n}function bx(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hP extends Ws{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>{var i,o,a,l,c;const u=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!fP(n)||vx(n.config))return await this.generateContentInternal(u);const d=yx(n);if(d.length>0){const _=d.map(C=>`tools[${C}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${_}.`)}let h,v;const b=Ko(u.contents),g=(a=(o=(i=u.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&a!==void 0?a:gx;let A=0;for(;A<g&&(h=await this.generateContentInternal(u),!(!h.functionCalls||h.functionCalls.length===0));){const _=h.candidates[0].content,C=[];for(const E of(c=(l=n.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(Vu(E)){const k=await E.callTool(h.functionCalls);C.push(...k)}A++,v={role:"user",parts:C},u.contents=Ko(u.contents),u.contents.push(_),u.contents.push(v),bx(u.config)&&(b.push(_),b.push(v))}return bx(u.config)&&(h.automaticFunctionCallingHistory=b),h},this.generateContentStream=async n=>{var i,o,a,l,c;if(this.maybeMoveToResponseJsonSchem(n),vx(n.config)){const v=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(v)}const u=yx(n);if(u.length>0){const v=u.map(b=>`tools[${b}]`).join(", ");throw new Error(`Incompatible tools found at ${v}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const d=(a=(o=(i=n==null?void 0:n.config)===null||i===void 0?void 0:i.toolConfig)===null||o===void 0?void 0:o.functionCallingConfig)===null||a===void 0?void 0:a.streamFunctionCallArguments,h=(c=(l=n==null?void 0:n.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||c===void 0?void 0:c.disable;if(d&&!h)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(i=>{var o;let a;const l=[];if(i!=null&&i.generatedImages)for(const u of i.generatedImages)u&&(u!=null&&u.safetyAttributes)&&((o=u==null?void 0:u.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?a=u==null?void 0:u.safetyAttributes:l.push(u);let c;return a?c={generatedImages:l,positivePromptSafetyAttributes:a,sdkHttpResponse:i.sdkHttpResponse}:c={generatedImages:l,sdkHttpResponse:i.sdkHttpResponse},c}),this.list=async n=>{var i;const l={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((i=l.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Pc($s.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async n=>{const i={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(i.referenceImages=n.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async n=>{let i={numberOfImages:1,mode:"upscale"};n.config&&(i=Object.assign(Object.assign({},i),n.config));const o={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:i};return await this.upscaleImageInternal(o)},this.generateVideos=async n=>{var i,o,a,l,c,u;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=n.video)===null||i===void 0)&&i.uri&&(!((o=n.video)===null||o===void 0)&&o.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.uri&&(!((u=(c=n.source)===null||c===void 0?void 0:c.video)===null||u===void 0)&&u.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var n,i,o;const a=(n=t.config)===null||n===void 0?void 0:n.tools;if(!a)return t;const l=await Promise.all(a.map(async u=>Vu(u)?await u.tool():u)),c={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:l})};if(c.config.tools=l,t.config&&t.config.tools&&cS(t.config.tools)){const u=(o=(i=t.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&o!==void 0?o:{};let d=Object.assign({},u);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),uS(d),c.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:d})}return c}async initAfcToolsMap(t){var n,i,o;const a=new Map;for(const l of(i=(n=t.config)===null||n===void 0?void 0:n.tools)!==null&&i!==void 0?i:[])if(Vu(l)){const c=l,u=await c.tool();for(const d of(o=u.functionDeclarations)!==null&&o!==void 0?o:[]){if(!d.name)throw new Error("Function declaration name is required.");if(a.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);a.set(d.name,c)}}return a}async processAfcStream(t){var n,i,o;const a=(o=(i=(n=t.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:gx;let l=!1,c=0;const u=await this.initAfcToolsMap(t);return(function(d,h,v){return La(this,arguments,function*(){for(var b,g,A,_,C,E;c<a;){l&&(c++,l=!1);const P=yield Kt(d.processParamsMaybeAddMcpUsage(v)),W=yield Kt(d.generateContentStreamInternal(P)),V=[],$=[];try{for(var R=!0,k=(g=void 0,Ma(W)),M;M=yield Kt(k.next()),b=M.done,!b;R=!0){_=M.value,R=!1;const j=_;if(yield yield Kt(j),j.candidates&&(!((C=j.candidates[0])===null||C===void 0)&&C.content)){$.push(j.candidates[0].content);for(const X of(E=j.candidates[0].content.parts)!==null&&E!==void 0?E:[])if(c<a&&X.functionCall){if(!X.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(X.functionCall.name)){const z=yield Kt(h.get(X.functionCall.name).callTool([X.functionCall]));V.push(...z)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${X.functionCall.name}`)}}}}catch(j){g={error:j}}finally{try{!R&&!b&&(A=k.return)&&(yield Kt(A.call(k)))}finally{if(g)throw g.error}}if(V.length>0){l=!0;const j=new $d;j.candidates=[{content:{role:"user",parts:V}}],yield yield Kt(j);const X=[];X.push(...$),X.push({role:"user",parts:V});const z=Ko(v.contents).concat(X);v.contents=z}else break}})})(this,u,t)}async generateContentInternal(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=fx(this.apiClient,t);return c=xt("{model}:generateContent",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=px(h),b=new $d;return Object.assign(b,v),b})}else{const d=dx(this.apiClient,t);return c=xt("{model}:generateContent",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=hx(h),b=new $d;return Object.assign(b,v),b})}}async generateContentStreamInternal(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=fx(this.apiClient,t);return c=xt("{model}:streamGenerateContent?alt=sse",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.requestStream({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(v){return La(this,arguments,function*(){var b,g,A,_;try{for(var C=!0,E=Ma(v),R;R=yield Kt(E.next()),b=R.done,!b;C=!0){_=R.value,C=!1;const k=_,M=px(yield Kt(k.json()),t);M.sdkHttpResponse={headers:k.headers};const P=new $d;Object.assign(P,M),yield yield Kt(P)}}catch(k){g={error:k}}finally{try{!C&&!b&&(A=E.return)&&(yield Kt(A.call(E)))}finally{if(g)throw g.error}}})})}else{const d=dx(this.apiClient,t);return c=xt("{model}:streamGenerateContent?alt=sse",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.requestStream({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}),l.then(function(v){return La(this,arguments,function*(){var b,g,A,_;try{for(var C=!0,E=Ma(v),R;R=yield Kt(E.next()),b=R.done,!b;C=!0){_=R.value,C=!1;const k=_,M=hx(yield Kt(k.json()),t);M.sdkHttpResponse={headers:k.headers};const P=new $d;Object.assign(P,M),yield yield Kt(P)}}catch(k){g={error:k}}finally{try{!C&&!b&&(A=E.return)&&(yield Kt(A.call(E)))}finally{if(g)throw g.error}}})})}}async embedContent(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=sD(this.apiClient,t);return c=xt("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=cD(h),b=new Wb;return Object.assign(b,v),b})}else{const d=aD(this.apiClient,t);return c=xt("{model}:batchEmbedContents",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=lD(h),b=new Wb;return Object.assign(b,v),b})}}async generateImagesInternal(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=xD(this.apiClient,t);return c=xt("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=_D(h),b=new Xb;return Object.assign(b,v),b})}else{const d=bD(this.apiClient,t);return c=xt("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=wD(h),b=new Xb;return Object.assign(b,v),b})}}async editImageInternal(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=nD(this.apiClient,t);return a=xt("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:u.headers},h})),o.then(u=>{const d=iD(u),h=new sR;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=x7(this.apiClient,t);return a=xt("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:u.headers},h})),o.then(u=>{const d=w7(u),h=new lR;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=t7(this.apiClient,t);return a=xt("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>{const d=n7(u),h=new cR;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=l7(this.apiClient,t);return a=xt("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>{const d=c7(u),h=new uR;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=jD(this.apiClient,t);return c=xt("{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),l.then(h=>_g(h))}else{const d=zD(this.apiClient,t);return c=xt("{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),l.then(h=>wg(h))}}async listInternal(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=WD(this.apiClient,t);return c=xt("{models_url}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=JD(h),b=new Jb;return Object.assign(b,v),b})}else{const d=YD(this.apiClient,t);return c=xt("{models_url}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=XD(h),b=new Jb;return Object.assign(b,v),b})}}async update(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=y7(this.apiClient,t);return c=xt("{model}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),l.then(h=>_g(h))}else{const d=v7(this.apiClient,t);return c=xt("{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),l.then(h=>wg(h))}}async delete(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=ZM(this.apiClient,t);return c=xt("{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=eD(h),b=new Kb;return Object.assign(b,v),b})}else{const d=KM(this.apiClient,t);return c=xt("{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=QM(h),b=new Kb;return Object.assign(b,v),b})}}async countTokens(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=WM(this.apiClient,t);return c=xt("{model}:countTokens",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=JM(h),b=new Zb;return Object.assign(b,v),b})}else{const d=YM(this.apiClient,t);return c=xt("{model}:countTokens",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=XM(h),b=new Zb;return Object.assign(b,v),b})}}async computeTokens(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=FM(this.apiClient,t);return a=xt("{model}:computeTokens",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:u.headers},h})),o.then(u=>{const d=BM(u),h=new dR;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=TD(this.apiClient,t);return c=xt("{model}:predictLongRunning",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),l.then(h=>{const v=AD(h),b=new hp;return Object.assign(b,v),b})}else{const d=CD(this.apiClient,t);return c=xt("{model}:predictLongRunning",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),l.then(h=>{const v=ND(h),b=new hp;return Object.assign(b,v),b})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pP extends Ws{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,i=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=n.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:o,config:{httpOptions:a}});return n._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:n.name,config:i});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!1})}}async get(t){const n=t.operation,i=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=n.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:o,config:{httpOptions:a}});return n._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:n.name,config:i});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!1})}}async getVideosOperationInternal(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=tR(t);return c=xt("{operationName}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),l}else{const d=eR(t);return c=xt("{operationName}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),l}}async fetchPredictVideosOperationInternal(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=YI(t);return a=xt("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mP(e){const t={},n=y(e,["data"]);if(n!=null&&w(t,["data"],n),y(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=y(e,["mimeType"]);return i!=null&&w(t,["mimeType"],i),t}function gP(e){const t={},n=y(e,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>NP(a))),w(t,["parts"],o)}const i=y(e,["role"]);return i!=null&&w(t,["role"],i),t}function vP(e,t,n){const i={},o=y(t,["expireTime"]);n!==void 0&&o!=null&&w(n,["expireTime"],o);const a=y(t,["newSessionExpireTime"]);n!==void 0&&a!=null&&w(n,["newSessionExpireTime"],a);const l=y(t,["uses"]);n!==void 0&&l!=null&&w(n,["uses"],l);const c=y(t,["liveConnectConstraints"]);n!==void 0&&c!=null&&w(n,["bidiGenerateContentSetup"],EP(e,c));const u=y(t,["lockAdditionalFields"]);return n!==void 0&&u!=null&&w(n,["fieldMask"],u),i}function yP(e,t){const n={},i=y(t,["config"]);return i!=null&&w(n,["config"],vP(e,i,n)),n}function bP(e){const t={};if(y(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=y(e,["fileUri"]);n!=null&&w(t,["fileUri"],n);const i=y(e,["mimeType"]);return i!=null&&w(t,["mimeType"],i),t}function xP(e){const t={},n=y(e,["id"]);n!=null&&w(t,["id"],n);const i=y(e,["args"]);i!=null&&w(t,["args"],i);const o=y(e,["name"]);if(o!=null&&w(t,["name"],o),y(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(y(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function wP(e){const t={};if(y(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=y(e,["enableWidget"]);return n!=null&&w(t,["enableWidget"],n),t}function _P(e){const t={};if(y(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(y(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=y(e,["timeRangeFilter"]);return n!=null&&w(t,["timeRangeFilter"],n),t}function SP(e,t){const n={},i=y(e,["generationConfig"]);t!==void 0&&i!=null&&w(t,["setup","generationConfig"],i);const o=y(e,["responseModalities"]);t!==void 0&&o!=null&&w(t,["setup","generationConfig","responseModalities"],o);const a=y(e,["temperature"]);t!==void 0&&a!=null&&w(t,["setup","generationConfig","temperature"],a);const l=y(e,["topP"]);t!==void 0&&l!=null&&w(t,["setup","generationConfig","topP"],l);const c=y(e,["topK"]);t!==void 0&&c!=null&&w(t,["setup","generationConfig","topK"],c);const u=y(e,["maxOutputTokens"]);t!==void 0&&u!=null&&w(t,["setup","generationConfig","maxOutputTokens"],u);const d=y(e,["mediaResolution"]);t!==void 0&&d!=null&&w(t,["setup","generationConfig","mediaResolution"],d);const h=y(e,["seed"]);t!==void 0&&h!=null&&w(t,["setup","generationConfig","seed"],h);const v=y(e,["speechConfig"]);t!==void 0&&v!=null&&w(t,["setup","generationConfig","speechConfig"],f1(v));const b=y(e,["thinkingConfig"]);t!==void 0&&b!=null&&w(t,["setup","generationConfig","thinkingConfig"],b);const g=y(e,["enableAffectiveDialog"]);t!==void 0&&g!=null&&w(t,["setup","generationConfig","enableAffectiveDialog"],g);const A=y(e,["systemInstruction"]);t!==void 0&&A!=null&&w(t,["setup","systemInstruction"],gP(Ar(A)));const _=y(e,["tools"]);if(t!==void 0&&_!=null){let W=id(_);Array.isArray(W)&&(W=W.map(V=>CP(nd(V)))),w(t,["setup","tools"],W)}const C=y(e,["sessionResumption"]);t!==void 0&&C!=null&&w(t,["setup","sessionResumption"],AP(C));const E=y(e,["inputAudioTranscription"]);t!==void 0&&E!=null&&w(t,["setup","inputAudioTranscription"],E);const R=y(e,["outputAudioTranscription"]);t!==void 0&&R!=null&&w(t,["setup","outputAudioTranscription"],R);const k=y(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&w(t,["setup","realtimeInputConfig"],k);const M=y(e,["contextWindowCompression"]);t!==void 0&&M!=null&&w(t,["setup","contextWindowCompression"],M);const P=y(e,["proactivity"]);if(t!==void 0&&P!=null&&w(t,["setup","proactivity"],P),y(e,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function EP(e,t){const n={},i=y(t,["model"]);i!=null&&w(n,["setup","model"],Ln(e,i));const o=y(t,["config"]);return o!=null&&w(n,["config"],SP(o,n)),n}function NP(e){const t={},n=y(e,["mediaResolution"]);n!=null&&w(t,["mediaResolution"],n);const i=y(e,["codeExecutionResult"]);i!=null&&w(t,["codeExecutionResult"],i);const o=y(e,["executableCode"]);o!=null&&w(t,["executableCode"],o);const a=y(e,["fileData"]);a!=null&&w(t,["fileData"],bP(a));const l=y(e,["functionCall"]);l!=null&&w(t,["functionCall"],xP(l));const c=y(e,["functionResponse"]);c!=null&&w(t,["functionResponse"],c);const u=y(e,["inlineData"]);u!=null&&w(t,["inlineData"],mP(u));const d=y(e,["text"]);d!=null&&w(t,["text"],d);const h=y(e,["thought"]);h!=null&&w(t,["thought"],h);const v=y(e,["thoughtSignature"]);v!=null&&w(t,["thoughtSignature"],v);const b=y(e,["videoMetadata"]);return b!=null&&w(t,["videoMetadata"],b),t}function AP(e){const t={},n=y(e,["handle"]);if(n!=null&&w(t,["handle"],n),y(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function CP(e){const t={};if(y(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=y(e,["computerUse"]);n!=null&&w(t,["computerUse"],n);const i=y(e,["fileSearch"]);i!=null&&w(t,["fileSearch"],i);const o=y(e,["codeExecution"]);if(o!=null&&w(t,["codeExecution"],o),y(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=y(e,["functionDeclarations"]);if(a!=null){let h=a;Array.isArray(h)&&(h=h.map(v=>v)),w(t,["functionDeclarations"],h)}const l=y(e,["googleMaps"]);l!=null&&w(t,["googleMaps"],wP(l));const c=y(e,["googleSearch"]);c!=null&&w(t,["googleSearch"],_P(c));const u=y(e,["googleSearchRetrieval"]);u!=null&&w(t,["googleSearchRetrieval"],u);const d=y(e,["urlContext"]);return d!=null&&w(t,["urlContext"],d),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function TP(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const i=e[n];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const o=Object.keys(i).map(a=>`${n}.${a}`);t.push(...o)}else t.push(n)}return t.join(",")}function kP(e,t){let n=null;const i=e.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const a=i.setup;typeof a=="object"&&a!==null?(e.bidiGenerateContentSetup=a,n=a):delete e.bidiGenerateContentSetup}else i!==void 0&&delete e.bidiGenerateContentSetup;const o=e.fieldMask;if(n){const a=TP(n);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)a?e.fieldMask=a:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];o.length>0&&(c=o.map(d=>l.includes(d)?`generationConfig.${d}`:d));const u=[];a&&u.push(a),c.length>0&&u.push(...c),u.length>0?e.fieldMask=u.join(","):delete e.fieldMask}else delete e.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?e.fieldMask=o.join(","):delete e.fieldMask;return e}class IP extends Ws{constructor(t){super(),this.apiClient=t}async create(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=yP(this.apiClient,t);a=xt("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const u=kP(c,t.config);return o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>d)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RP(e,t){const n={},i=y(e,["force"]);return t!==void 0&&i!=null&&w(t,["_query","force"],i),n}function LP(e){const t={},n=y(e,["name"]);n!=null&&w(t,["_url","name"],n);const i=y(e,["config"]);return i!=null&&RP(i,t),t}function MP(e){const t={},n=y(e,["name"]);return n!=null&&w(t,["_url","name"],n),t}function DP(e,t){const n={},i=y(e,["pageSize"]);t!==void 0&&i!=null&&w(t,["_query","pageSize"],i);const o=y(e,["pageToken"]);return t!==void 0&&o!=null&&w(t,["_query","pageToken"],o),n}function PP(e){const t={},n=y(e,["parent"]);n!=null&&w(t,["_url","parent"],n);const i=y(e,["config"]);return i!=null&&DP(i,t),t}function OP(e){const t={},n=y(e,["sdkHttpResponse"]);n!=null&&w(t,["sdkHttpResponse"],n);const i=y(e,["nextPageToken"]);i!=null&&w(t,["nextPageToken"],i);const o=y(e,["documents"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>l)),w(t,["documents"],a)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class UP extends Ws{constructor(t){super(),this.apiClient=t,this.list=async n=>new Pc($s.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:n.parent,config:i.config}),await this.listInternal(n),n)}async get(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=MP(t);return a=xt("{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async delete(t){var n,i;let o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=LP(t);o=xt("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=PP(t);return a=xt("{parent}/documents",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>{const d=OP(u),h=new fR;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zP extends Ws{constructor(t,n=new UP(t)){super(),this.apiClient=t,this.documents=n,this.list=async(i={})=>new Pc($s.PAGED_ITEM_FILE_SEARCH_STORES,o=>this.listInternal(o),await this.listInternal(i),i)}async uploadToFileSearchStore(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(t.fileSearchStoreName,t.file,t.config)}async create(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=T7(t);return a=xt("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async get(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=R7(t);return a=xt("{name}",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async delete(t){var n,i;let o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=I7(t);o=xt("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=U7(t);return a=xt("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>{const d=z7(u),h=new hR;return Object.assign(h,d),h})}}async uploadToFileSearchStoreInternal(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=j7(t);return a=xt("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>{const d=F7(u),h=new pR;return Object.assign(h,d),h})}}async importFile(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=D7(t);return a=xt("{file_search_store_name}:importFile",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>{const d=M7(u),h=new s1;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let dS=function(){const{crypto:e}=globalThis;if(e!=null&&e.randomUUID)return dS=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^n()&15>>+i/4).toString(16))};const jP=()=>dS();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Eg(e){return typeof e=="object"&&e!==null&&("name"in e&&e.name==="AbortError"||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const Ng=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null){try{if(Object.prototype.toString.call(e)==="[object Error]"){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return new Error(JSON.stringify(e))}catch{}}return new Error(e)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qo extends Error{}class Fr extends Qo{constructor(t,n,i,o){super(`${Fr.makeMessage(t,n,i)}`),this.status=t,this.headers=o,this.error=n}static makeMessage(t,n,i){const o=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):i;return t&&o?`${t} ${o}`:t?`${t} status code (no body)`:o||"(no status code or body)"}static generate(t,n,i,o){if(!t||!o)return new Dp({message:i,cause:Ng(n)});const a=n;return t===400?new hS(t,a,i,o):t===401?new pS(t,a,i,o):t===403?new mS(t,a,i,o):t===404?new gS(t,a,i,o):t===409?new vS(t,a,i,o):t===422?new yS(t,a,i,o):t===429?new bS(t,a,i,o):t>=500?new xS(t,a,i,o):new Fr(t,a,i,o)}}class Ag extends Fr{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class Dp extends Fr{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),n&&(this.cause=n)}}class fS extends Dp{constructor({message:t}={}){super({message:t??"Request timed out."})}}class hS extends Fr{}class pS extends Fr{}class mS extends Fr{}class gS extends Fr{}class vS extends Fr{}class yS extends Fr{}class bS extends Fr{}class xS extends Fr{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const FP=/^[a-z][a-z0-9+.-]*:/i,BP=e=>FP.test(e);let Cg=e=>(Cg=Array.isArray,Cg(e));const qP=Cg;let HP=qP;const xx=HP;function GP(e){if(!e)return!0;for(const t in e)return!1;return!0}function VP(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const $P=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new Qo(`${e} must be an integer`);if(t<0)throw new Qo(`${e} must be a positive integer`);return t},YP=e=>{try{return JSON.parse(e)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const WP=e=>new Promise(t=>setTimeout(t,e));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Du="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XP(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const JP=()=>{var e,t,n,i,o;const a=XP();if(a==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Du,"X-Stainless-OS":_x(Deno.build.os),"X-Stainless-Arch":wx(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(t=(e=Deno.version)===null||e===void 0?void 0:e.deno)!==null&&t!==void 0?t:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Du,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(a==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Du,"X-Stainless-OS":_x((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":wx((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(o=globalThis.process.version)!==null&&o!==void 0?o:"unknown"};const l=KP();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Du,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Du,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function KP(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const i=n.exec(navigator.userAgent);if(i){const o=i[1]||0,a=i[2]||0,l=i[3]||0;return{browser:t,version:`${o}.${a}.${l}`}}}return null}const wx=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",_x=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let Ih;const ZP=()=>Ih??(Ih=JP());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QP(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function wS(...e){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function e9(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return wS({start(){},async pull(n){const{done:i,value:o}=await t.next();i?n.close():n.enqueue(o)},async cancel(){var n;await((n=t.return)===null||n===void 0?void 0:n.call(t))}})}function _S(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function t9(e){var t,n;if(e===null||typeof e!="object")return;if(e[Symbol.asyncIterator]){await((n=(t=e[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(t));return}const i=e.getReader(),o=i.cancel();i.releaseLock(),await o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const n9=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const SS=()=>{var e;if(typeof File>"u"){const{process:t}=globalThis,n=typeof((e=t==null?void 0:t.versions)===null||e===void 0?void 0:e.node)=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Um(e,t,n){return SS(),new File(e,t??"unknown_file",n)}function i9(e){return(typeof e=="object"&&e!==null&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}const r9=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ES=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",o9=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&ES(e),a9=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function";async function s9(e,t,n){if(SS(),e=await e,o9(e))return e instanceof File?e:Um([await e.arrayBuffer()],e.name);if(a9(e)){const o=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),Um(await Tg(o),t,n)}const i=await Tg(e);if(t||(t=i9(e)),!(n!=null&&n.type)){const o=i.find(a=>typeof a=="object"&&"type"in a&&a.type);typeof o=="string"&&(n=Object.assign(Object.assign({},n),{type:o}))}return Um(i,t,n)}async function Tg(e){var t,n,i,o,a;let l=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)l.push(e);else if(ES(e))l.push(e instanceof Blob?e:await e.arrayBuffer());else if(r9(e))try{for(var c=!0,u=Ma(e),d;d=await u.next(),t=d.done,!t;c=!0){o=d.value,c=!1;const h=o;l.push(...await Tg(h))}}catch(h){n={error:h}}finally{try{!c&&!t&&(i=u.return)&&await i.call(u)}finally{if(n)throw n.error}}else{const h=(a=e==null?void 0:e.constructor)===null||a===void 0?void 0:a.name;throw new Error(`Unexpected data type: ${typeof e}${h?`; constructor: ${h}`:""}${l9(e)}`)}return l}function l9(e){return typeof e!="object"||e===null?"":`; props: [${Object.getOwnPropertyNames(e).map(n=>`"${n}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class NS{constructor(t){this._client=t}}NS._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AS(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Sx=Object.freeze(Object.create(null)),c9=(e=AS)=>(function(n,...i){if(n.length===1)return n[0];let o=!1;const a=[],l=n.reduce((h,v,b)=>{var g,A,_;/[?#]/.test(v)&&(o=!0);const C=i[b];let E=(o?encodeURIComponent:e)(""+C);return b!==i.length&&(C==null||typeof C=="object"&&C.toString===((_=Object.getPrototypeOf((A=Object.getPrototypeOf((g=C.hasOwnProperty)!==null&&g!==void 0?g:Sx))!==null&&A!==void 0?A:Sx))===null||_===void 0?void 0:_.toString))&&(E=C+"",a.push({start:h.length+v.length,length:E.length,error:`Value of type ${Object.prototype.toString.call(C).slice(8,-1)} is not a valid path parameter`})),h+v+(b===i.length?"":E)},""),c=l.split(/[?#]/,1)[0],u=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let d;for(;(d=u.exec(c))!==null;)a.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(a.sort((h,v)=>h.start-v.start),a.length>0){let h=0;const v=a.reduce((b,g)=>{const A=" ".repeat(g.start-h),_="^".repeat(g.length);return h=g.start+g.length,b+A+_},"");throw new Qo(`Path parameters result in path with invalid segments:
${a.map(b=>b.error).join(`
`)}
${l}
${v}`)}return l}),Rh=c9(AS);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class CS extends NS{create(t,n){var i;const{api_version:o=this._client.apiVersion}=t,a=mp(t,["api_version"]);if("model"in a&&"agent_config"in a)throw new Qo("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in a&&"generation_config"in a)throw new Qo("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Rh`/${o}/interactions`,Object.assign(Object.assign({body:a},n),{stream:(i=t.stream)!==null&&i!==void 0?i:!1}))}delete(t,n={},i){const{api_version:o=this._client.apiVersion}=n??{};return this._client.delete(Rh`/${o}/interactions/${t}`,i)}cancel(t,n={},i){const{api_version:o=this._client.apiVersion}=n??{};return this._client.post(Rh`/${o}/interactions/${t}/cancel`,i)}get(t,n={},i){var o;const a=n??{},{api_version:l=this._client.apiVersion}=a,c=mp(a,["api_version"]);return this._client.get(Rh`/${l}/interactions/${t}`,Object.assign(Object.assign({query:c},i),{stream:(o=n==null?void 0:n.stream)!==null&&o!==void 0?o:!1}))}}CS._key=Object.freeze(["interactions"]);class TS extends CS{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function u9(e){let t=0;for(const o of e)t+=o.length;const n=new Uint8Array(t);let i=0;for(const o of e)n.set(o,i),i+=o.length;return n}let Lh;function p1(e){let t;return(Lh??(t=new globalThis.TextEncoder,Lh=t.encode.bind(t)))(e)}let Mh;function Ex(e){let t;return(Mh??(t=new globalThis.TextDecoder,Mh=t.decode.bind(t)))(e)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Pp{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(t){if(t==null)return[];const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?p1(t):t;this.buffer=u9([this.buffer,n]);const i=[];let o;for(;(o=d9(this.buffer,this.carriageReturnIndex))!=null;){if(o.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=o.index;continue}if(this.carriageReturnIndex!=null&&(o.index!==this.carriageReturnIndex+1||o.carriage)){i.push(Ex(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const a=this.carriageReturnIndex!==null?o.preceding-1:o.preceding,l=Ex(this.buffer.subarray(0,a));i.push(l),this.buffer=this.buffer.subarray(o.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}}Pp.NEWLINE_CHARS=new Set([`
`,"\r"]);Pp.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function d9(e,t){for(let o=t??0;o<e.length;o++){if(e[o]===10)return{preceding:o,index:o+1,carriage:!1};if(e[o]===13)return{preceding:o,index:o+1,carriage:!0}}return null}function f9(e){for(let i=0;i<e.length-1;i++){if(e[i]===10&&e[i+1]===10||e[i]===13&&e[i+1]===13)return i+2;if(e[i]===13&&e[i+1]===10&&i+3<e.length&&e[i+2]===13&&e[i+3]===10)return i+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gp={off:0,error:200,warn:300,info:400,debug:500},Nx=(e,t,n)=>{if(e){if(VP(gp,e))return e;Or(n).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(gp))}`)}};function Jd(){}function Dh(e,t,n){return!t||gp[e]>gp[n]?Jd:t[e].bind(t)}const h9={error:Jd,warn:Jd,info:Jd,debug:Jd};let Ax=new WeakMap;function Or(e){var t;const n=e.logger,i=(t=e.logLevel)!==null&&t!==void 0?t:"off";if(!n)return h9;const o=Ax.get(n);if(o&&o[0]===i)return o[1];const a={error:Dh("error",n,i),warn:Dh("warn",n,i),info:Dh("info",n,i),debug:Dh("debug",n,i)};return Ax.set(n,[i,a]),a}const Ec=e=>(e.options&&(e.options=Object.assign({},e.options),delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([t,n])=>[t,t.toLowerCase()==="x-goog-api-key"||t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Uu{constructor(t,n,i){this.iterator=t,this.controller=n,this.client=i}static fromSSEResponse(t,n,i){let o=!1;const a=i?Or(i):console;function l(){return La(this,arguments,function*(){var u,d,h,v;if(o)throw new Qo("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let b=!1;try{try{for(var g=!0,A=Ma(p9(t,n)),_;_=yield Kt(A.next()),u=_.done,!u;g=!0){v=_.value,g=!1;const C=v;if(!b)if(C.data.startsWith("[DONE]")){b=!0;continue}else try{yield yield Kt(JSON.parse(C.data))}catch(E){throw a.error("Could not parse message into JSON:",C.data),a.error("From chunk:",C.raw),E}}}catch(C){d={error:C}}finally{try{!g&&!u&&(h=A.return)&&(yield Kt(h.call(A)))}finally{if(d)throw d.error}}b=!0}catch(C){if(Eg(C))return yield Kt(void 0);throw C}finally{b||n.abort()}})}return new Uu(l,n,i)}static fromReadableStream(t,n,i){let o=!1;function a(){return La(this,arguments,function*(){var u,d,h,v;const b=new Pp,g=_S(t);try{for(var A=!0,_=Ma(g),C;C=yield Kt(_.next()),u=C.done,!u;A=!0){v=C.value,A=!1;const E=v;for(const R of b.decode(E))yield yield Kt(R)}}catch(E){d={error:E}}finally{try{!A&&!u&&(h=_.return)&&(yield Kt(h.call(_)))}finally{if(d)throw d.error}}for(const E of b.flush())yield yield Kt(E)})}function l(){return La(this,arguments,function*(){var u,d,h,v;if(o)throw new Qo("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let b=!1;try{try{for(var g=!0,A=Ma(a()),_;_=yield Kt(A.next()),u=_.done,!u;g=!0){v=_.value,g=!1;const C=v;b||C&&(yield yield Kt(JSON.parse(C)))}}catch(C){d={error:C}}finally{try{!g&&!u&&(h=A.return)&&(yield Kt(h.call(A)))}finally{if(d)throw d.error}}b=!0}catch(C){if(Eg(C))return yield Kt(void 0);throw C}finally{b||n.abort()}})}return new Uu(l,n,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],n=[],i=this.iterator(),o=a=>({next:()=>{if(a.length===0){const l=i.next();t.push(l),n.push(l)}return a.shift()}});return[new Uu(()=>o(t),this.controller,this.client),new Uu(()=>o(n),this.controller,this.client)]}toReadableStream(){const t=this;let n;return wS({async start(){n=t[Symbol.asyncIterator]()},async pull(i){try{const{value:o,done:a}=await n.next();if(a)return i.close();const l=p1(JSON.stringify(o)+`
`);i.enqueue(l)}catch(o){i.error(o)}},async cancel(){var i;await((i=n.return)===null||i===void 0?void 0:i.call(n))}})}}function p9(e,t){return La(this,arguments,function*(){var i,o,a,l;if(!e.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Qo("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Qo("Attempted to iterate over a response with no body");const c=new g9,u=new Pp,d=_S(e.body);try{for(var h=!0,v=Ma(m9(d)),b;b=yield Kt(v.next()),i=b.done,!i;h=!0){l=b.value,h=!1;const g=l;for(const A of u.decode(g)){const _=c.decode(A);_&&(yield yield Kt(_))}}}catch(g){o={error:g}}finally{try{!h&&!i&&(a=v.return)&&(yield Kt(a.call(v)))}finally{if(o)throw o.error}}for(const g of u.flush()){const A=c.decode(g);A&&(yield yield Kt(A))}})}function m9(e){return La(this,arguments,function*(){var n,i,o,a;let l=new Uint8Array;try{for(var c=!0,u=Ma(e),d;d=yield Kt(u.next()),n=d.done,!n;c=!0){a=d.value,c=!1;const h=a;if(h==null)continue;const v=h instanceof ArrayBuffer?new Uint8Array(h):typeof h=="string"?p1(h):h;let b=new Uint8Array(l.length+v.length);b.set(l),b.set(v,l.length),l=b;let g;for(;(g=f9(l))!==-1;)yield yield Kt(l.slice(0,g)),l=l.slice(g)}}catch(h){i={error:h}}finally{try{!c&&!n&&(o=u.return)&&(yield Kt(o.call(u)))}finally{if(i)throw i.error}}l.length>0&&(yield yield Kt(l))})}class g9{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,i,o]=v9(t,":");return o.startsWith(" ")&&(o=o.substring(1)),n==="event"?this.event=o:n==="data"&&this.data.push(o),null}}function v9(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function y9(e,t){const{response:n,requestLogID:i,retryOfRequestLogID:o,startTime:a}=t,l=await(async()=>{var c;if(t.options.stream)return Or(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(n,t.controller,e):Uu.fromSSEResponse(n,t.controller,e);if(n.status===204)return null;if(t.options.__binaryResponse)return n;const u=n.headers.get("content-type"),d=(c=u==null?void 0:u.split(";")[0])===null||c===void 0?void 0:c.trim();return(d==null?void 0:d.includes("application/json"))||(d==null?void 0:d.endsWith("+json"))?n.headers.get("content-length")==="0"?void 0:await n.json():await n.text()})();return Or(e).debug(`[${i}] response parsed`,Ec({retryOfRequestLogID:o,url:n.url,status:n.status,body:l,durationMs:Date.now()-a})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class m1 extends Promise{constructor(t,n,i=y9){super(o=>{o(null)}),this.responsePromise=n,this.parseResponse=i,this.client=t}_thenUnwrap(t){return new m1(this.client,this.responsePromise,async(n,i)=>t(await this.parseResponse(n,i),i))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(this.client,t))),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kS=Symbol("brand.privateNullableHeaders");function*b9(e){if(!e)return;if(kS in e){const{values:i,nulls:o}=e;yield*i.entries();for(const a of o)yield[a,null];return}let t=!1,n;e instanceof Headers?n=e.entries():xx(e)?n=e:(t=!0,n=Object.entries(e??{}));for(let i of n){const o=i[0];if(typeof o!="string")throw new TypeError("expected header name to be a string");const a=xx(i[1])?i[1]:[i[1]];let l=!1;for(const c of a)c!==void 0&&(t&&!l&&(l=!0,yield[o,null]),yield[o,c])}}const Yd=e=>{const t=new Headers,n=new Set;for(const i of e){const o=new Set;for(const[a,l]of b9(i)){const c=a.toLowerCase();o.has(c)||(t.delete(a),o.add(c)),l===null?(t.delete(a),n.add(c)):(t.append(a,l),n.delete(c))}}return{[kS]:!0,values:t,nulls:n}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zm=e=>{var t,n,i,o,a,l;if(typeof globalThis.process<"u")return(i=(n=(t=BI)===null||t===void 0?void 0:t[e])===null||n===void 0?void 0:n.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(l=(a=(o=globalThis.Deno.env)===null||o===void 0?void 0:o.get)===null||a===void 0?void 0:a.call(o,e))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var IS;class Op{constructor(t){var n,i,o,a,l,c,u,{baseURL:d=zm("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:h=(n=zm("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:v="v1beta"}=t,b=mp(t,["baseURL","apiKey","apiVersion"]);const g=Object.assign(Object.assign({apiKey:h,apiVersion:v},b),{baseURL:d||"https://generativelanguage.googleapis.com"});this.baseURL=g.baseURL,this.timeout=(i=g.timeout)!==null&&i!==void 0?i:Op.DEFAULT_TIMEOUT,this.logger=(o=g.logger)!==null&&o!==void 0?o:console;const A="warn";this.logLevel=A,this.logLevel=(l=(a=Nx(g.logLevel,"ClientOptions.logLevel",this))!==null&&a!==void 0?a:Nx(zm("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:A,this.fetchOptions=g.fetchOptions,this.maxRetries=(c=g.maxRetries)!==null&&c!==void 0?c:2,this.fetch=(u=g.fetch)!==null&&u!==void 0?u:QP(),this.encoder=n9,this._options=g,this.apiKey=h,this.apiVersion=v,this.clientAdapter=g.clientAdapter}withOptions(t){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),t))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:n}){if(!(t.has("authorization")||t.has("x-goog-api-key"))&&!(this.apiKey&&t.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(t){const n=Yd([t.headers]);if(!(n.values.has("authorization")||n.values.has("x-goog-api-key"))){if(this.apiKey)return Yd([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Yd([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(t){return Object.entries(t).filter(([n,i])=>typeof i<"u").map(([n,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(n)}=`;throw new Qo(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Du}`}defaultIdempotencyKey(){return`stainless-node-retry-${jP()}`}makeStatusError(t,n,i,o){return Fr.generate(t,n,i,o)}buildURL(t,n,i){const o=!this.baseURLOverridden()&&i||this.baseURL,a=BP(t)?new URL(t):new URL(o+(o.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),l=this.defaultQuery();return GP(l)||(n=Object.assign(Object.assign({},l),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(a.search=this.stringifyQuery(n)),a.toString()}async prepareOptions(t){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!t.path.startsWith(`/${this.apiVersion}/projects/`)){const n=t.path.slice(this.apiVersion.length+1);t.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${n}`}}async prepareRequest(t,{url:n,options:i}){}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,i){return this.request(Promise.resolve(i).then(o=>Object.assign({method:t,path:n},o)))}request(t,n=null){return new m1(this,this.makeRequest(t,n,void 0))}async makeRequest(t,n,i){var o,a,l;const c=await t,u=(o=c.maxRetries)!==null&&o!==void 0?o:this.maxRetries;n==null&&(n=u),await this.prepareOptions(c);const{req:d,url:h,timeout:v}=await this.buildRequest(c,{retryCount:u-n});await this.prepareRequest(d,{url:h,options:c});const b="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),g=i===void 0?"":`, retryOf: ${i}`,A=Date.now();if(Or(this).debug(`[${b}] sending request`,Ec({retryOfRequestLogID:i,method:c.method,url:h,options:c,headers:d.headers})),!((a=c.signal)===null||a===void 0)&&a.aborted)throw new Ag;const _=new AbortController,C=await this.fetchWithTimeout(h,d,v,_).catch(Ng),E=Date.now();if(C instanceof globalThis.Error){const k=`retrying, ${n} attempts remaining`;if(!((l=c.signal)===null||l===void 0)&&l.aborted)throw new Ag;const M=Eg(C)||/timed? ?out/i.test(String(C)+("cause"in C?String(C.cause):""));if(n)return Or(this).info(`[${b}] connection ${M?"timed out":"failed"} - ${k}`),Or(this).debug(`[${b}] connection ${M?"timed out":"failed"} (${k})`,Ec({retryOfRequestLogID:i,url:h,durationMs:E-A,message:C.message})),this.retryRequest(c,n,i??b);throw Or(this).info(`[${b}] connection ${M?"timed out":"failed"} - error; no more retries left`),Or(this).debug(`[${b}] connection ${M?"timed out":"failed"} (error; no more retries left)`,Ec({retryOfRequestLogID:i,url:h,durationMs:E-A,message:C.message})),M?new fS:new Dp({cause:C})}const R=`[${b}${g}] ${d.method} ${h} ${C.ok?"succeeded":"failed"} with status ${C.status} in ${E-A}ms`;if(!C.ok){const k=await this.shouldRetry(C);if(n&&k){const j=`retrying, ${n} attempts remaining`;return await t9(C.body),Or(this).info(`${R} - ${j}`),Or(this).debug(`[${b}] response error (${j})`,Ec({retryOfRequestLogID:i,url:C.url,status:C.status,headers:C.headers,durationMs:E-A})),this.retryRequest(c,n,i??b,C.headers)}const M=k?"error; no more retries left":"error; not retryable";Or(this).info(`${R} - ${M}`);const P=await C.text().catch(j=>Ng(j).message),W=YP(P),V=W?void 0:P;throw Or(this).debug(`[${b}] response error (${M})`,Ec({retryOfRequestLogID:i,url:C.url,status:C.status,headers:C.headers,message:V,durationMs:Date.now()-A})),this.makeStatusError(C.status,W,V,C.headers)}return Or(this).info(R),Or(this).debug(`[${b}] response start`,Ec({retryOfRequestLogID:i,url:C.url,status:C.status,headers:C.headers,durationMs:E-A})),{response:C,options:c,controller:_,requestLogID:b,retryOfRequestLogID:i,startTime:A}}async fetchWithTimeout(t,n,i,o){const a=n||{},{signal:l,method:c}=a,u=mp(a,["signal","method"]),d=o.abort.bind(o);l&&l.addEventListener("abort",d,{once:!0});const h=setTimeout(d,i),v=globalThis.ReadableStream&&u.body instanceof globalThis.ReadableStream||typeof u.body=="object"&&u.body!==null&&Symbol.asyncIterator in u.body,b=Object.assign(Object.assign(Object.assign({signal:o.signal},v?{duplex:"half"}:{}),{method:"GET"}),u);c&&(b.method=c.toUpperCase());try{return await this.fetch.call(void 0,t,b)}finally{clearTimeout(h)}}async shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,i,o){var a;let l;const c=o==null?void 0:o.get("retry-after-ms");if(c){const d=parseFloat(c);Number.isNaN(d)||(l=d)}const u=o==null?void 0:o.get("retry-after");if(u&&!l){const d=parseFloat(u);Number.isNaN(d)?l=Date.parse(u)-Date.now():l=d*1e3}if(!(l&&0<=l&&l<60*1e3)){const d=(a=t.maxRetries)!==null&&a!==void 0?a:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(n,d)}return await WP(l),this.makeRequest(t,n-1,i)}calculateDefaultRetryTimeoutMillis(t,n){const a=n-t,l=Math.min(.5*Math.pow(2,a),8),c=1-Math.random()*.25;return l*c*1e3}async buildRequest(t,{retryCount:n=0}={}){var i,o,a;const l=Object.assign({},t),{method:c,path:u,query:d,defaultBaseURL:h}=l,v=this.buildURL(u,d,h);"timeout"in l&&$P("timeout",l.timeout),l.timeout=(i=l.timeout)!==null&&i!==void 0?i:this.timeout;const{bodyHeaders:b,body:g}=this.buildBody({options:l}),A=await this.buildHeaders({options:t,method:c,bodyHeaders:b,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:c,headers:A},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&g instanceof globalThis.ReadableStream&&{duplex:"half"}),g&&{body:g}),(o=this.fetchOptions)!==null&&o!==void 0?o:{}),(a=l.fetchOptions)!==null&&a!==void 0?a:{}),url:v,timeout:l.timeout}}async buildHeaders({options:t,method:n,bodyHeaders:i,retryCount:o}){let a={};this.idempotencyHeader&&n!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=t.idempotencyKey);const l=await this.authHeaders(t);let c=Yd([a,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o)},t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{}),ZP()),this._options.defaultHeaders,i,t.headers,l]);return this.validateHeaders(c),c.values}buildBody({options:{body:t,headers:n}}){if(!t)return{bodyHeaders:void 0,body:void 0};const i=Yd([n]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&i.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:e9(t)}:this.encoder({body:t,headers:i})}}Op.DEFAULT_TIMEOUT=6e4;class cr extends Op{constructor(){super(...arguments),this.interactions=new TS(this)}}IS=cr;cr.GeminiNextGenAPIClient=IS;cr.GeminiNextGenAPIClientError=Qo;cr.APIError=Fr;cr.APIConnectionError=Dp;cr.APIConnectionTimeoutError=fS;cr.APIUserAbortError=Ag;cr.NotFoundError=gS;cr.ConflictError=vS;cr.RateLimitError=bS;cr.BadRequestError=hS;cr.AuthenticationError=pS;cr.InternalServerError=xS;cr.PermissionDeniedError=mS;cr.UnprocessableEntityError=yS;cr.toFile=s9;cr.Interactions=TS;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function x9(e,t){const n={},i=y(e,["name"]);return i!=null&&w(n,["_url","name"],i),n}function w9(e,t){const n={},i=y(e,["name"]);return i!=null&&w(n,["_url","name"],i),n}function _9(e,t){const n={},i=y(e,["sdkHttpResponse"]);return i!=null&&w(n,["sdkHttpResponse"],i),n}function S9(e,t){const n={},i=y(e,["sdkHttpResponse"]);return i!=null&&w(n,["sdkHttpResponse"],i),n}function E9(e,t,n){const i={};if(y(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const o=y(e,["tunedModelDisplayName"]);if(t!==void 0&&o!=null&&w(t,["displayName"],o),y(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=y(e,["epochCount"]);t!==void 0&&a!=null&&w(t,["tuningTask","hyperparameters","epochCount"],a);const l=y(e,["learningRateMultiplier"]);if(l!=null&&w(i,["tuningTask","hyperparameters","learningRateMultiplier"],l),y(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(y(e,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(y(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");if(y(e,["tuningMode"])!==void 0)throw new Error("tuningMode parameter is not supported in Gemini API.");if(y(e,["customBaseModel"])!==void 0)throw new Error("customBaseModel parameter is not supported in Gemini API.");const c=y(e,["batchSize"]);t!==void 0&&c!=null&&w(t,["tuningTask","hyperparameters","batchSize"],c);const u=y(e,["learningRate"]);if(t!==void 0&&u!=null&&w(t,["tuningTask","hyperparameters","learningRate"],u),y(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(y(e,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");if(y(e,["baseTeacherModel"])!==void 0)throw new Error("baseTeacherModel parameter is not supported in Gemini API.");if(y(e,["tunedTeacherModelSource"])!==void 0)throw new Error("tunedTeacherModelSource parameter is not supported in Gemini API.");if(y(e,["sftLossWeightMultiplier"])!==void 0)throw new Error("sftLossWeightMultiplier parameter is not supported in Gemini API.");if(y(e,["outputUri"])!==void 0)throw new Error("outputUri parameter is not supported in Gemini API.");return i}function N9(e,t,n){const i={};let o=y(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const P=y(e,["validationDataset"]);t!==void 0&&P!=null&&w(t,["supervisedTuningSpec"],jm(P))}else if(o==="PREFERENCE_TUNING"){const P=y(e,["validationDataset"]);t!==void 0&&P!=null&&w(t,["preferenceOptimizationSpec"],jm(P))}else if(o==="DISTILLATION"){const P=y(e,["validationDataset"]);t!==void 0&&P!=null&&w(t,["distillationSpec"],jm(P))}const a=y(e,["tunedModelDisplayName"]);t!==void 0&&a!=null&&w(t,["tunedModelDisplayName"],a);const l=y(e,["description"]);t!==void 0&&l!=null&&w(t,["description"],l);let c=y(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const P=y(e,["epochCount"]);t!==void 0&&P!=null&&w(t,["supervisedTuningSpec","hyperParameters","epochCount"],P)}else if(c==="PREFERENCE_TUNING"){const P=y(e,["epochCount"]);t!==void 0&&P!=null&&w(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],P)}else if(c==="DISTILLATION"){const P=y(e,["epochCount"]);t!==void 0&&P!=null&&w(t,["distillationSpec","hyperParameters","epochCount"],P)}let u=y(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const P=y(e,["learningRateMultiplier"]);t!==void 0&&P!=null&&w(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],P)}else if(u==="PREFERENCE_TUNING"){const P=y(e,["learningRateMultiplier"]);t!==void 0&&P!=null&&w(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],P)}else if(u==="DISTILLATION"){const P=y(e,["learningRateMultiplier"]);t!==void 0&&P!=null&&w(t,["distillationSpec","hyperParameters","learningRateMultiplier"],P)}let d=y(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const P=y(e,["exportLastCheckpointOnly"]);t!==void 0&&P!=null&&w(t,["supervisedTuningSpec","exportLastCheckpointOnly"],P)}else if(d==="PREFERENCE_TUNING"){const P=y(e,["exportLastCheckpointOnly"]);t!==void 0&&P!=null&&w(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],P)}else if(d==="DISTILLATION"){const P=y(e,["exportLastCheckpointOnly"]);t!==void 0&&P!=null&&w(t,["distillationSpec","exportLastCheckpointOnly"],P)}let h=y(n,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const P=y(e,["adapterSize"]);t!==void 0&&P!=null&&w(t,["supervisedTuningSpec","hyperParameters","adapterSize"],P)}else if(h==="PREFERENCE_TUNING"){const P=y(e,["adapterSize"]);t!==void 0&&P!=null&&w(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],P)}else if(h==="DISTILLATION"){const P=y(e,["adapterSize"]);t!==void 0&&P!=null&&w(t,["distillationSpec","hyperParameters","adapterSize"],P)}let v=y(n,["config","method"]);if(v===void 0&&(v="SUPERVISED_FINE_TUNING"),v==="SUPERVISED_FINE_TUNING"){const P=y(e,["tuningMode"]);t!==void 0&&P!=null&&w(t,["supervisedTuningSpec","tuningMode"],P)}const b=y(e,["customBaseModel"]);t!==void 0&&b!=null&&w(t,["customBaseModel"],b);let g=y(n,["config","method"]);if(g===void 0&&(g="SUPERVISED_FINE_TUNING"),g==="SUPERVISED_FINE_TUNING"){const P=y(e,["batchSize"]);t!==void 0&&P!=null&&w(t,["supervisedTuningSpec","hyperParameters","batchSize"],P)}let A=y(n,["config","method"]);if(A===void 0&&(A="SUPERVISED_FINE_TUNING"),A==="SUPERVISED_FINE_TUNING"){const P=y(e,["learningRate"]);t!==void 0&&P!=null&&w(t,["supervisedTuningSpec","hyperParameters","learningRate"],P)}const _=y(e,["labels"]);t!==void 0&&_!=null&&w(t,["labels"],_);const C=y(e,["beta"]);t!==void 0&&C!=null&&w(t,["preferenceOptimizationSpec","hyperParameters","beta"],C);const E=y(e,["baseTeacherModel"]);t!==void 0&&E!=null&&w(t,["distillationSpec","baseTeacherModel"],E);const R=y(e,["tunedTeacherModelSource"]);t!==void 0&&R!=null&&w(t,["distillationSpec","tunedTeacherModelSource"],R);const k=y(e,["sftLossWeightMultiplier"]);t!==void 0&&k!=null&&w(t,["distillationSpec","hyperParameters","sftLossWeightMultiplier"],k);const M=y(e,["outputUri"]);return t!==void 0&&M!=null&&w(t,["outputUri"],M),i}function A9(e,t){const n={},i=y(e,["baseModel"]);i!=null&&w(n,["baseModel"],i);const o=y(e,["preTunedModel"]);o!=null&&w(n,["preTunedModel"],o);const a=y(e,["trainingDataset"]);a!=null&&U9(a);const l=y(e,["config"]);return l!=null&&E9(l,n),n}function C9(e,t){const n={},i=y(e,["baseModel"]);i!=null&&w(n,["baseModel"],i);const o=y(e,["preTunedModel"]);o!=null&&w(n,["preTunedModel"],o);const a=y(e,["trainingDataset"]);a!=null&&z9(a,n,t);const l=y(e,["config"]);return l!=null&&N9(l,n,t),n}function T9(e,t){const n={},i=y(e,["name"]);return i!=null&&w(n,["_url","name"],i),n}function k9(e,t){const n={},i=y(e,["name"]);return i!=null&&w(n,["_url","name"],i),n}function I9(e,t,n){const i={},o=y(e,["pageSize"]);t!==void 0&&o!=null&&w(t,["_query","pageSize"],o);const a=y(e,["pageToken"]);t!==void 0&&a!=null&&w(t,["_query","pageToken"],a);const l=y(e,["filter"]);return t!==void 0&&l!=null&&w(t,["_query","filter"],l),i}function R9(e,t,n){const i={},o=y(e,["pageSize"]);t!==void 0&&o!=null&&w(t,["_query","pageSize"],o);const a=y(e,["pageToken"]);t!==void 0&&a!=null&&w(t,["_query","pageToken"],a);const l=y(e,["filter"]);return t!==void 0&&l!=null&&w(t,["_query","filter"],l),i}function L9(e,t){const n={},i=y(e,["config"]);return i!=null&&I9(i,n),n}function M9(e,t){const n={},i=y(e,["config"]);return i!=null&&R9(i,n),n}function D9(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["nextPageToken"]);o!=null&&w(n,["nextPageToken"],o);const a=y(e,["tunedModels"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>RS(c))),w(n,["tuningJobs"],l)}return n}function P9(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["nextPageToken"]);o!=null&&w(n,["nextPageToken"],o);const a=y(e,["tuningJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>kg(c))),w(n,["tuningJobs"],l)}return n}function O9(e,t){const n={},i=y(e,["name"]);i!=null&&w(n,["model"],i);const o=y(e,["name"]);return o!=null&&w(n,["endpoint"],o),n}function U9(e,t){const n={};if(y(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(y(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=y(e,["examples"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>a)),w(n,["examples","examples"],o)}return n}function z9(e,t,n){const i={};let o=y(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const l=y(e,["gcsUri"]);t!==void 0&&l!=null&&w(t,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(o==="PREFERENCE_TUNING"){const l=y(e,["gcsUri"]);t!==void 0&&l!=null&&w(t,["preferenceOptimizationSpec","trainingDatasetUri"],l)}else if(o==="DISTILLATION"){const l=y(e,["gcsUri"]);t!==void 0&&l!=null&&w(t,["distillationSpec","promptDatasetUri"],l)}let a=y(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const l=y(e,["vertexDatasetResource"]);t!==void 0&&l!=null&&w(t,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(a==="PREFERENCE_TUNING"){const l=y(e,["vertexDatasetResource"]);t!==void 0&&l!=null&&w(t,["preferenceOptimizationSpec","trainingDatasetUri"],l)}else if(a==="DISTILLATION"){const l=y(e,["vertexDatasetResource"]);t!==void 0&&l!=null&&w(t,["distillationSpec","promptDatasetUri"],l)}if(y(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function RS(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["name"]);o!=null&&w(n,["name"],o);const a=y(e,["state"]);a!=null&&w(n,["state"],Y_(a));const l=y(e,["createTime"]);l!=null&&w(n,["createTime"],l);const c=y(e,["tuningTask","startTime"]);c!=null&&w(n,["startTime"],c);const u=y(e,["tuningTask","completeTime"]);u!=null&&w(n,["endTime"],u);const d=y(e,["updateTime"]);d!=null&&w(n,["updateTime"],d);const h=y(e,["description"]);h!=null&&w(n,["description"],h);const v=y(e,["baseModel"]);v!=null&&w(n,["baseModel"],v);const b=y(e,["_self"]);return b!=null&&w(n,["tunedModel"],O9(b)),n}function kg(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["name"]);o!=null&&w(n,["name"],o);const a=y(e,["state"]);a!=null&&w(n,["state"],Y_(a));const l=y(e,["createTime"]);l!=null&&w(n,["createTime"],l);const c=y(e,["startTime"]);c!=null&&w(n,["startTime"],c);const u=y(e,["endTime"]);u!=null&&w(n,["endTime"],u);const d=y(e,["updateTime"]);d!=null&&w(n,["updateTime"],d);const h=y(e,["error"]);h!=null&&w(n,["error"],h);const v=y(e,["description"]);v!=null&&w(n,["description"],v);const b=y(e,["baseModel"]);b!=null&&w(n,["baseModel"],b);const g=y(e,["tunedModel"]);g!=null&&w(n,["tunedModel"],g);const A=y(e,["preTunedModel"]);A!=null&&w(n,["preTunedModel"],A);const _=y(e,["supervisedTuningSpec"]);_!=null&&w(n,["supervisedTuningSpec"],_);const C=y(e,["preferenceOptimizationSpec"]);C!=null&&w(n,["preferenceOptimizationSpec"],C);const E=y(e,["distillationSpec"]);E!=null&&w(n,["distillationSpec"],E);const R=y(e,["tuningDataStats"]);R!=null&&w(n,["tuningDataStats"],R);const k=y(e,["encryptionSpec"]);k!=null&&w(n,["encryptionSpec"],k);const M=y(e,["partnerModelTuningSpec"]);M!=null&&w(n,["partnerModelTuningSpec"],M);const P=y(e,["customBaseModel"]);P!=null&&w(n,["customBaseModel"],P);const W=y(e,["experiment"]);W!=null&&w(n,["experiment"],W);const V=y(e,["labels"]);V!=null&&w(n,["labels"],V);const $=y(e,["outputUri"]);$!=null&&w(n,["outputUri"],$);const j=y(e,["pipelineJob"]);j!=null&&w(n,["pipelineJob"],j);const X=y(e,["serviceAccount"]);X!=null&&w(n,["serviceAccount"],X);const z=y(e,["tunedModelDisplayName"]);z!=null&&w(n,["tunedModelDisplayName"],z);const U=y(e,["veoTuningSpec"]);return U!=null&&w(n,["veoTuningSpec"],U),n}function j9(e,t){const n={},i=y(e,["sdkHttpResponse"]);i!=null&&w(n,["sdkHttpResponse"],i);const o=y(e,["name"]);o!=null&&w(n,["name"],o);const a=y(e,["metadata"]);a!=null&&w(n,["metadata"],a);const l=y(e,["done"]);l!=null&&w(n,["done"],l);const c=y(e,["error"]);return c!=null&&w(n,["error"],c),n}function jm(e,t){const n={},i=y(e,["gcsUri"]);i!=null&&w(n,["validationDatasetUri"],i);const o=y(e,["vertexDatasetResource"]);return o!=null&&w(n,["validationDatasetUri"],o),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class F9 extends Ws{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Pc($s.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var i;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const o={tunedModelName:n.baseModel};!((i=n.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(o.checkpointId=n.config.preTunedModelCheckpointId);const a=Object.assign(Object.assign({},n),{preTunedModel:o});return a.baseModel=void 0,await this.tuneInternal(a)}else{const o=Object.assign({},n);return await this.tuneInternal(o)}else{const o=Object.assign({},n),a=await this.tuneMldevInternal(o);let l="";return a.metadata!==void 0&&a.metadata.tunedModel!==void 0?l=a.metadata.tunedModel:a.name!==void 0&&a.name.includes("/operations/")&&(l=a.name.split("/operations/")[0]),{name:l,state:gg.JOB_STATE_QUEUED}}}}async getInternal(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=k9(t);return c=xt("{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>kg(h))}else{const d=T9(t);return c=xt("{name}",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>RS(h))}}async listInternal(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=M9(t);return c=xt("tuningJobs",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=P9(h),b=new Qb;return Object.assign(b,v),b})}else{const d=L9(t);return c=xt("tunedModels",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=D9(h),b=new Qb;return Object.assign(b,v),b})}}async cancel(t){var n,i,o,a;let l,c="",u={};if(this.apiClient.isVertexAI()){const d=w9(t);return c=xt("{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=S9(h),b=new ex;return Object.assign(b,v),b})}else{const d=x9(t);return c=xt("{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(o=t.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:h.headers},b})),l.then(h=>{const v=_9(h),b=new ex;return Object.assign(b,v),b})}}async tuneInternal(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const c=C9(t,t);return a=xt("tuningJobs",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:u.headers},h})),o.then(u=>kg(u))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,i;let o,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=A9(t);return a=xt("tunedModels",c._url),l=c._query,delete c._url,delete c._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:u.headers},h})),o.then(u=>j9(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class B9{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const q9=1024*1024*8,H9=3,G9=1e3,V9=2,vp="x-goog-upload-status";async function $9(e,t,n){var i;const o=await LS(e,t,n),a=await(o==null?void 0:o.json());if(((i=o==null?void 0:o.headers)===null||i===void 0?void 0:i[vp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return a.file}async function Y9(e,t,n){var i;const o=await LS(e,t,n),a=await(o==null?void 0:o.json());if(((i=o==null?void 0:o.headers)===null||i===void 0?void 0:i[vp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=B_(a),c=new l1;return Object.assign(c,l),c}async function LS(e,t,n){var i,o;let a=0,l=0,c=new yg(new Response),u="upload";for(a=e.size;l<a;){const d=Math.min(q9,a-l),h=e.slice(l,l+d);l+d>=a&&(u+=", finalize");let v=0,b=G9;for(;v<H9&&(c=await n.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(l),"Content-Length":String(d)}}}),!(!((i=c==null?void 0:c.headers)===null||i===void 0)&&i[vp]));)v++,await X9(b),b=b*V9;if(l+=d,((o=c==null?void 0:c.headers)===null||o===void 0?void 0:o[vp])!=="active")break;if(a<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return c}async function W9(e){return{size:e.size,type:e.type}}function X9(e){return new Promise(t=>setTimeout(t,e))}class J9{async upload(t,n,i){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await $9(t,n,i)}async uploadToFileSearchStore(t,n,i){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Y9(t,n,i)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await W9(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class K9{create(t,n,i){return new Z9(t,n,i)}}class Z9{constructor(t,n,i){this.url=t,this.headers=n,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Cx="x-goog-api-key";class Q9{constructor(t){this.apiKey=t}async addAuthHeaders(t,n){if(t.get(Cx)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(Cx,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const eO="gl-node/";class MS{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const t=this.httpOptions;t!=null&&t.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new cr({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:t==null?void 0:t.timeout});return this._interactions=n.interactions,this._interactions}constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const i=VI(t.httpOptions,t.vertexai,void 0,void 0);i&&(t.httpOptions?t.httpOptions.baseUrl=i:t.httpOptions={baseUrl:i}),this.apiVersion=t.apiVersion,this.httpOptions=t.httpOptions;const o=new Q9(this.apiKey);this.apiClient=new W7({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:eO+"web",uploader:new J9,downloader:new B9}),this.models=new hP(this.apiClient),this.live=new sP(this.apiClient,o,new K9),this.batches=new wL(this.apiClient),this.chats=new nM(this.models,this.apiClient),this.caches=new QL(this.apiClient),this.files=new pM(this.apiClient),this.operations=new pP(this.apiClient),this.authTokens=new IP(this.apiClient),this.tunings=new F9(this.apiClient),this.fileSearchStores=new zP(this.apiClient)}}const Up=async(e,t,n,i,o=.7)=>{var l,c,u;if(!(n!=null&&n.trim()))throw new Error("Gemini API key is missing or empty. Please enter your API key in the sidebar.");if(i)return tO(i,e,n,o);const a=new MS({apiKey:n.trim()});try{const d=await a.models.generateContent({model:"gemini-2.0-flash-exp-image-generation",contents:{parts:[{text:e}]},config:{responseModalities:["Text","Image"]}});if((u=(c=(l=d.candidates)==null?void 0:l[0])==null?void 0:c.content)!=null&&u.parts){for(const h of d.candidates[0].content.parts)if(h.inlineData)return`data:${h.inlineData.mimeType};base64,${h.inlineData.data}`}}catch(d){throw console.error("Gemini image generation failed:",d),d}},tO=async(e,t,n,i=.7)=>{var u,d,h;if(!(n!=null&&n.trim()))throw new Error("Gemini API key is missing or empty.");const o=new MS({apiKey:n.trim()}),a=e.split(",")[1]||e,l=i>.75?"Maintain the original composition and character details very strictly.":i<.4?"Be very creative and transformative, deviating significantly from the reference structure.":"Maintain character consistency and general scene structure.",c=`${t}. ${l}`;try{const v=await o.models.generateContent({model:"gemini-2.0-flash-exp-image-generation",contents:{parts:[{inlineData:{data:a,mimeType:"image/png"}},{text:c}]},config:{responseModalities:["Text","Image"]}});if((h=(d=(u=v.candidates)==null?void 0:u[0])==null?void 0:d.content)!=null&&h.parts){for(const b of v.candidates[0].content.parts)if(b.inlineData)return`data:${b.inlineData.mimeType};base64,${b.inlineData.data}`}}catch(v){throw console.error("Gemini image editing failed:",v),v}},nO="de7d3faf-762f-48e0-b3b7-9d0ac3a3fcf3";function iO(e){switch(String(e).toLowerCase()){case"wide":return{width:1472,height:832};case"std":return{width:1360,height:1024};case"tall":return{width:1024,height:1360};case"portrait":return{width:832,height:1472};case"square":default:return{width:1024,height:1024}}}async function zp(e,t,n,i,o=.7){var c;if(!(n!=null&&n.trim()))throw new Error("Leonardo API key is missing or empty.");const{width:a,height:l}=iO(t);try{const u={modelId:nO,prompt:e,num_images:1,width:a,height:l,alchemy:!0,contrast:3.5,enhancePrompt:!1,public:!1},d=await fetch("https://cloud.leonardo.ai/api/rest/v1/generations",{method:"POST",headers:{Authorization:`Bearer ${n.trim()}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(u)});if(!d.ok){const g=await d.text();let A=g;try{const _=JSON.parse(g);A=_.error||_.message||g}catch{}throw new Error(`Leonardo API error ${d.status}: ${A}`)}const v=(c=(await d.json()).sdGenerationJob)==null?void 0:c.generationId;if(!v)throw new Error("No generation ID returned from Leonardo API.");return await rO(n,v)}catch(u){throw console.error("Leonardo generation failed:",u),u}}async function rO(e,t,n=60,i=2e3){var o,a;for(let l=0;l<n;l++){await oO(i);const c=await fetch(`https://cloud.leonardo.ai/api/rest/v1/generations/${t}`,{method:"GET",headers:{Authorization:`Bearer ${e.trim()}`,Accept:"application/json"}});if(!c.ok){const h=await c.text();throw new Error(`Leonardo status check failed ${c.status}: ${h}`)}const u=await c.json(),d=(o=u.generations_by_pk)==null?void 0:o.status;if(d==="COMPLETE"){const h=(a=u.generations_by_pk)==null?void 0:a.generated_images;if(h&&h.length>0)return h[0].url;throw new Error("Generation complete but no images returned.")}if(d==="FAILED")throw new Error("Leonardo generation failed.")}throw new Error("Leonardo generation timed out after 2 minutes.")}function oO(e){return new Promise(t=>setTimeout(t,e))}function aO(e){switch(String(e).toLowerCase()){case"wide":return{width:1344,height:768};case"std":return{width:1152,height:896};case"tall":return{width:896,height:1152};case"portrait":return{width:768,height:1344};case"square":default:return{width:1024,height:1024}}}async function jp(e,t,n,i,o=.7){var c,u,d,h,v;if(!(n!=null&&n.trim()))throw new Error("Grok (xAI) API key is missing or empty. Please enter your API key in the sidebar.");const{width:a,height:l}=aO(t);try{const b=await fetch("https://api.x.ai/v1/images/generations",{method:"POST",headers:{Authorization:`Bearer ${n.trim()}`,"Content-Type":"application/json"},body:JSON.stringify({model:"grok-2-image",prompt:e.trim(),n:1,size:`${a}x${l}`,response_format:"url"})});if(!b.ok){const C=await b.text();let E=C;try{const R=JSON.parse(C);E=((c=R.error)==null?void 0:c.message)||R.message||C}catch{}throw new Error(`Grok API error ${b.status}: ${E}`)}const g=await b.json();if(g.error)throw new Error(`Grok API error: ${g.error.message}`);const A=(d=(u=g.data)==null?void 0:u[0])==null?void 0:d.url,_=(v=(h=g.data)==null?void 0:h[0])==null?void 0:v.b64_json;if(_)return`data:image/png;base64,${_}`;if(!A)throw new Error("No image URL returned from Grok API.");return A}catch(b){throw console.error("Grok image generation failed:",b),b}}async function Fp(e,t,n,i="fal-ai/flux-pro",o,a=.7){var h,v;if(!(n!=null&&n.trim()))throw new Error("fal.ai API key is missing or empty.");const l=String(t).toLowerCase();let c="square_hd";l==="wide"?c="landscape_16_9":l==="std"?c="landscape_4_3":l==="tall"?c="portrait_4_3":l==="portrait"&&(c="portrait_16_9");const u=!!o,d=u?"fal-ai/flux/dev/image-to-image":i;try{const b={prompt:e,num_images:1,enable_safety_checker:!0,sync_mode:!0};u&&o?(b.image_url=o,b.strength=a):b.image_size=c;const g=await fetch(`https://fal.run/${d}`,{method:"POST",headers:{Authorization:`Key ${n.trim()}`,"Content-Type":"application/json"},body:JSON.stringify(b)});if(!g.ok){const C=await g.text();let E=C;try{const R=JSON.parse(C);E=R.detail||R.message||C}catch{}throw new Error(`fal.ai error ${g.status}: ${E}`)}const A=await g.json(),_=(v=(h=A==null?void 0:A.images)==null?void 0:h[0])==null?void 0:v.url;if(!_)throw new Error("No image URL returned from fal.ai response.");return _}catch(b){throw console.error("fal.ai generation failed:",b),b}}function sO(e){switch(String(e).toLowerCase()){case"wide":return{width:1344,height:768};case"std":return{width:1152,height:896};case"tall":return{width:896,height:1152};case"portrait":return{width:768,height:1344};case"square":default:return{width:1024,height:1024}}}async function Bp(e,t,n,i,o=.7){var c;if(!(n!=null&&n.trim()))throw new Error("SeaArt API key is missing or empty. Please enter your API key in the sidebar.");const{width:a,height:l}=sO(t);try{const u={prompt:e.trim(),negative_prompt:"blurry, low quality, distorted",width:a,height:l,num:1,guidance:7,steps:30};if(i){const g=i.includes(",")?i.split(",")[1]:i;u.init_image=g,u.strength=o}const d=await fetch("https://www.seaart.ai/api/v1/task/create",{method:"POST",headers:{Authorization:`Bearer ${n.trim()}`,"Content-Type":"application/json"},body:JSON.stringify(u)});if(!d.ok){const g=await d.text();let A=g;try{const _=JSON.parse(g);A=_.msg||_.error||g}catch{}throw new Error(`SeaArt API error ${d.status}: ${A}`)}const h=await d.json();if(h.error||!((c=h.data)!=null&&c.task_id))throw new Error(`SeaArt API error: ${h.msg||h.error||"No task ID returned"}`);const v=h.data.task_id;return await lO(n,v)}catch(u){throw console.error("SeaArt image generation failed:",u),u}}async function lO(e,t,n=60,i=2e3){var o,a;for(let l=0;l<n;l++){await cO(i);const c=await fetch(`https://www.seaart.ai/api/v1/task/${t}`,{method:"GET",headers:{Authorization:`Bearer ${e.trim()}`,Accept:"application/json"}});if(!c.ok){const h=await c.text();throw new Error(`SeaArt status check failed ${c.status}: ${h}`)}const u=await c.json(),d=(o=u.data)==null?void 0:o.status;if(d===3){const h=(a=u.data)==null?void 0:a.items;if(h&&h.length>0&&h[0].img_url)return h[0].img_url;throw new Error("Generation complete but no image URL returned.")}if(d===4)throw new Error("SeaArt generation failed.")}throw new Error("SeaArt generation timed out after 2 minutes.")}function cO(e){return new Promise(t=>setTimeout(t,e))}function uO(e){switch(String(e).toLowerCase()){case"wide":return"1536x1024";case"tall":case"portrait":return"1024x1536";case"std":case"square":default:return"1024x1024"}}async function qp(e,t,n,i,o){var l,c,u;if(!(n!=null&&n.trim()))throw new Error("OpenAI API key is missing or empty. Please enter your API key in the sidebar.");const a=uO(t);try{const d=await fetch("https://api.openai.com/v1/images/generations",{method:"POST",headers:{Authorization:`Bearer ${n.trim()}`,"Content-Type":"application/json"},body:JSON.stringify({model:"gpt-image-1",prompt:e.trim(),n:1,size:a,quality:"medium",moderation:"low"})});if(!d.ok){const b=await d.text();let g=b;try{const A=JSON.parse(b);g=((l=A.error)==null?void 0:l.message)||A.message||b}catch{}throw d.status===403||g.toLowerCase().includes("verification")?new Error(`OpenAI API error ${d.status}: ${g}. Note: OpenAI requires Organization Verification before using GPT Image models. Please verify your organization at https://platform.openai.com/settings/organization/general`):new Error(`OpenAI API error ${d.status}: ${g}`)}const h=await d.json();if(h.error)throw new Error(`OpenAI API error: ${h.error.message}`);const v=(u=(c=h.data)==null?void 0:c[0])==null?void 0:u.b64_json;if(!v)throw new Error("No image data returned from OpenAI API.");return`data:image/png;base64,${v}`}catch(d){throw console.error("OpenAI image generation failed:",d),d}}console.warn("Supabase credentials not found. Cloud sync disabled.");const dO=()=>!1,DS=de.createContext(null),g1=()=>{const e=de.useContext(DS);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},fO=({children:e})=>{const[t,n]=de.useState(null),[i,o]=de.useState(null),[a,l]=de.useState(!0);de.useEffect(()=>{{l(!1);return}},[]);const c=async()=>{},u=async()=>{};return p.jsx(DS.Provider,{value:{user:t,session:i,loading:a,signInWithGoogle:c,signOut:u},children:e})},Fm=6,Ph=24;function hO({panels:e}){const[t,n]=de.useState([]);de.useEffect(()=>{let a=!0;return(async()=>{const c=await Promise.all(e.slice(0,Fm).map(async u=>{if(!u.imageUrl)return null;if(u.imageUrl.startsWith("idb://")){const d=u.imageUrl.replace("idb://","");try{return await ka(d)}catch(h){return console.error("Error loading thumbnail:",h),null}}return u.imageUrl}));a&&n(c)})(),()=>{a=!1}},[e]);const i=e.slice(0,Fm),o=Math.max(0,e.length-Fm);return p.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[i.map((a,l)=>{const c=t[l];return p.jsx("div",{className:"border border-ink-700 bg-ink-800 rounded",style:{width:`${Ph}px`,height:`${Ph}px`,minWidth:`${Ph}px`,minHeight:`${Ph}px`},children:c?p.jsx("img",{src:c,alt:`Panel ${l+1}`,className:"w-full h-full object-cover rounded",loading:"lazy"}):p.jsx("div",{className:"w-full h-full bg-ink-800"})},a.id)}),o>0&&p.jsxs("span",{className:"text-[9px] font-mono text-steel-600 ml-1",children:["+",o]})]})}function PS(e,t,n){const i=e.slice();return i.splice(n<0?i.length+n:n,0,i.splice(t,1)[0]),i}function pO(e,t){return e.reduce((n,i,o)=>{const a=t.get(i);return a&&(n[o]=a),n},Array(e.length))}function Oh(e){return e!==null&&e>=0}function mO(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function gO(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const OS=e=>{let{rects:t,activeIndex:n,overIndex:i,index:o}=e;const a=PS(t,i,n),l=t[o],c=a[o];return!c||!l?null:{x:c.left-l.left,y:c.top-l.top,scaleX:c.width/l.width,scaleY:c.height/l.height}},Uh={scaleX:1,scaleY:1},vO=e=>{var t;let{activeIndex:n,activeNodeRect:i,index:o,rects:a,overIndex:l}=e;const c=(t=a[n])!=null?t:i;if(!c)return null;if(o===n){const d=a[l];return d?{x:0,y:n<l?d.top+d.height-(c.top+c.height):d.top-c.top,...Uh}:null}const u=yO(a,o,n);return o>n&&o<=l?{x:0,y:-c.height-u,...Uh}:o<n&&o>=l?{x:0,y:c.height+u,...Uh}:{x:0,y:0,...Uh}};function yO(e,t,n){const i=e[t],o=e[t-1],a=e[t+1];return i?n<t?o?i.top-(o.top+o.height):a?a.top-(i.top+i.height):0:a?a.top-(i.top+i.height):o?i.top-(o.top+o.height):0:0}const US="Sortable",zS=kn.createContext({activeIndex:-1,containerId:US,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:OS,disabled:{draggable:!1,droppable:!1}});function bO(e){let{children:t,id:n,items:i,strategy:o=OS,disabled:a=!1}=e;const{active:l,dragOverlay:c,droppableRects:u,over:d,measureDroppableContainers:h}=oC(),v=yf(US,n),b=c.rect!==null,g=de.useMemo(()=>i.map(W=>typeof W=="object"&&"id"in W?W.id:W),[i]),A=l!=null,_=l?g.indexOf(l.id):-1,C=d?g.indexOf(d.id):-1,E=de.useRef(g),R=!mO(g,E.current),k=C!==-1&&_===-1||R,M=gO(a);us(()=>{R&&A&&h(g)},[R,g,A,h]),de.useEffect(()=>{E.current=g},[g]);const P=de.useMemo(()=>({activeIndex:_,containerId:v,disabled:M,disableTransforms:k,items:g,overIndex:C,useDragOverlay:b,sortedRects:pO(g,u),strategy:o}),[_,v,M.draggable,M.droppable,k,g,C,u,b,o]);return kn.createElement(zS.Provider,{value:P},t)}const xO=e=>{let{id:t,items:n,activeIndex:i,overIndex:o}=e;return PS(n,i,o).indexOf(t)},wO=e=>{let{containerId:t,isSorting:n,wasDragging:i,index:o,items:a,newIndex:l,previousItems:c,previousContainerId:u,transition:d}=e;return!d||!i||c!==a&&o===l?!1:n?!0:l!==o&&t===u},_O={duration:200,easing:"ease"},jS="transform",SO=sf.Transition.toString({property:jS,duration:0,easing:"linear"}),EO={roleDescription:"sortable"};function NO(e){let{disabled:t,index:n,node:i,rect:o}=e;const[a,l]=de.useState(null),c=de.useRef(n);return us(()=>{if(!t&&n!==c.current&&i.current){const u=o.current;if(u){const d=ed(i.current,{ignoreTransform:!0}),h={x:u.left-d.left,y:u.top-d.top,scaleX:u.width/d.width,scaleY:u.height/d.height};(h.x||h.y)&&l(h)}}n!==c.current&&(c.current=n)},[t,n,i,o]),de.useEffect(()=>{a&&l(null)},[a]),a}function AO(e){let{animateLayoutChanges:t=wO,attributes:n,disabled:i,data:o,getNewIndex:a=xO,id:l,strategy:c,resizeObserverConfig:u,transition:d=_O}=e;const{items:h,containerId:v,activeIndex:b,disabled:g,disableTransforms:A,sortedRects:_,overIndex:C,useDragOverlay:E,strategy:R}=de.useContext(zS),k=CO(i,g),M=h.indexOf(l),P=de.useMemo(()=>({sortable:{containerId:v,index:M,items:h},...o}),[v,o,M,h]),W=de.useMemo(()=>h.slice(h.indexOf(l)),[h,l]),{rect:V,node:$,isOver:j,setNodeRef:X}=lC({id:l,data:P,disabled:k.droppable,resizeObserverConfig:{updateMeasurementsFor:W,...u}}),{active:z,activatorEvent:U,activeNodeRect:q,attributes:I,setNodeRef:ie,listeners:J,isDragging:Y,over:le,setActivatorNodeRef:pe,transform:Ie}=Lw({id:l,data:P,attributes:{...EO,...n},disabled:k.draggable}),G=q3(X,ie),O=!!z,ee=O&&!A&&Oh(b)&&Oh(C),te=!E&&Y,ce=te&&ee?Ie:null,we=ee?ce??(c??R)({rects:_,activeNodeRect:q,activeIndex:b,overIndex:C,index:M}):null,Te=Oh(b)&&Oh(C)?a({id:l,items:h,activeIndex:b,overIndex:C}):M,Ce=z==null?void 0:z.id,De=de.useRef({activeId:Ce,items:h,newIndex:Te,containerId:v}),$e=h!==De.current.items,at=t({active:z,containerId:v,isDragging:Y,isSorting:O,id:l,index:M,items:h,newIndex:De.current.newIndex,previousItems:De.current.items,previousContainerId:De.current.containerId,transition:d,wasDragging:De.current.activeId!=null}),st=NO({disabled:!at,index:M,node:$,rect:V});return de.useEffect(()=>{O&&De.current.newIndex!==Te&&(De.current.newIndex=Te),v!==De.current.containerId&&(De.current.containerId=v),h!==De.current.items&&(De.current.items=h)},[O,Te,v,h]),de.useEffect(()=>{if(Ce===De.current.activeId)return;if(Ce!=null&&De.current.activeId==null){De.current.activeId=Ce;return}const K=setTimeout(()=>{De.current.activeId=Ce},50);return()=>clearTimeout(K)},[Ce]),{active:z,activeIndex:b,attributes:I,data:P,rect:V,index:M,newIndex:Te,items:h,isOver:j,isSorting:O,isDragging:Y,listeners:J,node:$,overIndex:C,over:le,setNodeRef:G,setActivatorNodeRef:pe,setDroppableNodeRef:X,setDraggableNodeRef:ie,transform:st??we,transition:B()};function B(){if(st||$e&&De.current.newIndex===M)return SO;if(!(te&&!Vg(U)||!d)&&(O||at))return sf.Transition.toString({...d,property:jS})}}function CO(e,t){var n,i;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(i=e==null?void 0:e.droppable)!=null?i:t.droppable}}function yp(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const TO=[bn.Down,bn.Right,bn.Up,bn.Left],kO=(e,t)=>{let{context:{active:n,collisionRect:i,droppableRects:o,droppableContainers:a,over:l,scrollableAncestors:c}}=t;if(TO.includes(e.code)){if(e.preventDefault(),!n||!i)return;const u=[];a.getEnabled().forEach(v=>{if(!v||v!=null&&v.disabled)return;const b=o.get(v.id);if(b)switch(e.code){case bn.Down:i.top<b.top&&u.push(v);break;case bn.Up:i.top>b.top&&u.push(v);break;case bn.Left:i.left>b.left&&u.push(v);break;case bn.Right:i.left<b.left&&u.push(v);break}});const d=r4({collisionRect:i,droppableRects:o,droppableContainers:u});let h=bw(d,"id");if(h===(l==null?void 0:l.id)&&d.length>1&&(h=d[1].id),h!=null){const v=a.get(n.id),b=a.get(h),g=b?o.get(b.id):null,A=b==null?void 0:b.node.current;if(A&&g&&v&&b){const C=wp(A).some((W,V)=>c[V]!==W),E=FS(v,b),R=IO(v,b),k=C||!E?{x:0,y:0}:{x:R?i.width-g.width:0,y:R?i.height-g.height:0},M={x:g.left,y:g.top};return k.x&&k.y?M:af(M,k)}}}};function FS(e,t){return!yp(e)||!yp(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function IO(e,t){return!yp(e)||!yp(t)||!FS(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const RO=({page:e,isActive:t,dispatch:n,panelCount:i})=>{const{attributes:o,listeners:a,setNodeRef:l,transform:c,transition:u,isDragging:d}=AO({id:e.id}),h={transform:sf.Transform.toString(c),transition:u,opacity:d?.5:1};return p.jsxs("div",{ref:l,style:h,className:"flex items-center gap-2",children:[p.jsx("button",{...o,...a,className:"cursor-grab active:cursor-grabbing touch-none p-1 text-steel-600 hover:text-ember-500 transition-colors",title:"Drag to reorder",children:p.jsx(_A,{size:14})}),p.jsxs("button",{onClick:()=>n({type:"SET_ACTIVE_PAGE",id:e.id}),className:`flex-1 text-left px-3 py-1.5 rounded text-[11px] font-mono transition-all ${t?"bg-ember-500 text-ink-950 font-bold":"text-steel-500 hover:bg-ink-700"}`,children:[p.jsxs("div",{className:"flex justify-between items-center w-full",children:[p.jsxs("span",{children:["PAGE ",e.number]}),p.jsxs("span",{className:"opacity-40 text-[9px]",children:[i,"F"]})]}),i>0&&p.jsx(hO,{panels:e.panels})]})]})},LO=({state:e,dispatch:t,onOpenProjects:n,onOpenScriptImport:i})=>{var U,q;const{user:o,signInWithGoogle:a}=g1(),l=e.projects.find(I=>I.id===e.activeProjectId),c=l==null?void 0:l.issues.find(I=>I.id===e.activeIssueId),u=c==null?void 0:c.pages.find(I=>I.id===e.activePageId),d=(l==null?void 0:l.issueType)==="issue"?"Issue":"Chapter",h=gw(Jm(_p,{activationConstraint:{distance:8}}),Jm(Yg,{coordinateGetter:kO})),v=I=>{const{active:ie,over:J}=I;if(!J||ie.id===J.id||!c)return;const Y=c.pages.findIndex(pe=>pe.id===ie.id),le=c.pages.findIndex(pe=>pe.id===J.id);Y!==-1&&le!==-1&&t({type:"REORDER_PAGES",issueId:c.id,oldIndex:Y,newIndex:le})},b={"Noir & Crime":["classic-noir","sin-city","crime-noir","will-eisner"],Superhero:["bronze-superhero","silver-superhero","kirby-cosmic","alex-ross","frank-miller"],"Horror & Dark Fantasy":["ec-horror","vertigo-horror","mignola-hellboy","hellraiser","spawn-mcfarlane"],"Indie & European":["underground-comix","indie-minimalist","clear-line","european-bd","modern-alt"],"Americana & Whimsy":["norman-rockwell","kinkade-luminous","lisa-frank"],"Sci-Fi & Experimental":["dune-epic","erotic-realism","pulp-adventure","cyberpunk-noir"],Custom:["custom"]},[g,A]=de.useState("");de.useEffect(()=>{(l==null?void 0:l.imageProvider)==="gemini"?A((l==null?void 0:l.geminiApiKey)||""):(l==null?void 0:l.imageProvider)==="leonardo"?A((l==null?void 0:l.leonardoApiKey)||""):(l==null?void 0:l.imageProvider)==="grok"?A((l==null?void 0:l.grokApiKey)||""):(l==null?void 0:l.imageProvider)==="fal"?A((l==null?void 0:l.falApiKey)||""):(l==null?void 0:l.imageProvider)==="seaart"?A((l==null?void 0:l.seaartApiKey)||""):(l==null?void 0:l.imageProvider)==="openai"?A((l==null?void 0:l.openaiApiKey)||""):A("")},[l==null?void 0:l.geminiApiKey,l==null?void 0:l.leonardoApiKey,l==null?void 0:l.grokApiKey,l==null?void 0:l.falApiKey,l==null?void 0:l.seaartApiKey,l==null?void 0:l.openaiApiKey,l==null?void 0:l.imageProvider]);const[_,C]=de.useState(!1),[E,R]=de.useState(""),[k,M]=de.useState(""),P=()=>{E.trim()&&(t({type:"ADD_CHARACTER",name:E.trim(),description:k.trim()}),R(""),M(""),C(!1))},W=async()=>{var J;if((l==null?void 0:l.imageProvider)!=="fal"){t({type:"UPDATE_PROJECT",id:l.id,updates:{imageProvider:"fal"}});return}if(!(l!=null&&l.falApiKey)){alert("FAL API key is missing. Enter it below and click SET.");return}if(!u||u.panels.length===0){alert("No active page or frames. Add a frame first.");return}const I=u.panels[0],ie=(J=I.prompt)==null?void 0:J.trim();if(!ie){alert("No prompt/description in the active frame. Add one first.");return}try{const Y=await Fp(ie,I.aspectRatio||"square",l.falApiKey,l.fluxModel||"fal-ai/flux-pro",void 0,.7);if(!Y)throw new Error("No image URL returned from FAL");const le=await ss(I.id,Y);t({type:"UPDATE_PANEL",panelId:I.id,updates:{imageUrl:le}}),console.log("FAL image generated and saved:",Y)}catch(Y){const le=Y instanceof Error?Y.message:"Check console for details";console.error("FAL generation failed:",Y),alert(`FAL generation failed: ${le}`)}},V=async()=>{var J;if((l==null?void 0:l.imageProvider)!=="leonardo"){t({type:"UPDATE_PROJECT",id:l.id,updates:{imageProvider:"leonardo"}});return}if(!(l!=null&&l.leonardoApiKey)){alert("Leonardo API key is missing. Enter it above and click SET.");return}if(!u||u.panels.length===0){alert("No active page or frames. Add a frame first.");return}const I=u.panels[0],ie=(J=I.prompt)==null?void 0:J.trim();if(!ie){alert("No prompt/description in the active frame. Add one first.");return}try{const Y=await zp(ie,I.aspectRatio||"square",l.leonardoApiKey,void 0,.7);if(!Y)throw new Error("No image URL returned from Leonardo");const le=await ss(I.id,Y);t({type:"UPDATE_PANEL",panelId:I.id,updates:{imageUrl:le}}),console.log("Leonardo image generated and saved:",Y)}catch(Y){const le=Y instanceof Error?Y.message:"Check console for details";console.error("Leonardo generation failed:",Y),alert(`Leonardo generation failed: ${le}`)}},$=async()=>{var J;if((l==null?void 0:l.imageProvider)!=="gemini"){t({type:"UPDATE_PROJECT",id:l.id,updates:{imageProvider:"gemini"}});return}if(!(l!=null&&l.geminiApiKey)){alert("Gemini API key is missing. Enter it below and click SET.");return}if(!u||u.panels.length===0){alert("No active page or frames. Add a frame first.");return}const I=u.panels[0],ie=(J=I.prompt)==null?void 0:J.trim();if(!ie){alert("No prompt/description in the active frame. Add one first.");return}try{const Y=await Up(ie,I.aspectRatio||"square",l.geminiApiKey,void 0,.7);if(!Y)throw new Error("No image URL returned from Gemini");const le=await ss(I.id,Y);t({type:"UPDATE_PANEL",panelId:I.id,updates:{imageUrl:le}}),console.log("Gemini image generated and saved:",Y)}catch(Y){const le=Y instanceof Error?Y.message:"Check console for details";console.error("Gemini generation failed:",Y),alert(`Gemini generation failed: ${le}`)}},j=async()=>{var J;if((l==null?void 0:l.imageProvider)!=="grok"){t({type:"UPDATE_PROJECT",id:l.id,updates:{imageProvider:"grok"}});return}if(!(l!=null&&l.grokApiKey)){alert("Grok (xAI) API key is missing. Enter it below and click SET.");return}if(!u||u.panels.length===0){alert("No active page or frames. Add a frame first.");return}const I=u.panels[0],ie=(J=I.prompt)==null?void 0:J.trim();if(!ie){alert("No prompt/description in the active frame. Add one first.");return}try{const Y=await jp(ie,I.aspectRatio||"square",l.grokApiKey,void 0,.7);if(!Y)throw new Error("No image URL returned from Grok");const le=await ss(I.id,Y);t({type:"UPDATE_PANEL",panelId:I.id,updates:{imageUrl:le}}),console.log("Grok image generated and saved:",Y)}catch(Y){const le=Y instanceof Error?Y.message:"Check console for details";console.error("Grok generation failed:",Y),alert(`Grok generation failed: ${le}`)}},X=async()=>{var J;if((l==null?void 0:l.imageProvider)!=="seaart"){t({type:"UPDATE_PROJECT",id:l.id,updates:{imageProvider:"seaart"}});return}if(!(l!=null&&l.seaartApiKey)){alert("SeaArt API key is missing. Enter it below and click SET.");return}if(!u||u.panels.length===0){alert("No active page or frames. Add a frame first.");return}const I=u.panels[0],ie=(J=I.prompt)==null?void 0:J.trim();if(!ie){alert("No prompt/description in the active frame. Add one first.");return}try{const Y=await Bp(ie,I.aspectRatio||"square",l.seaartApiKey,void 0,.7);if(!Y)throw new Error("No image URL returned from SeaArt");const le=await ss(I.id,Y);t({type:"UPDATE_PANEL",panelId:I.id,updates:{imageUrl:le}}),console.log("SeaArt image generated and saved:",Y)}catch(Y){const le=Y instanceof Error?Y.message:"Check console for details";console.error("SeaArt generation failed:",Y),alert(`SeaArt generation failed: ${le}`)}},z=async()=>{var J;if((l==null?void 0:l.imageProvider)!=="openai"){t({type:"UPDATE_PROJECT",id:l.id,updates:{imageProvider:"openai"}});return}if(!(l!=null&&l.openaiApiKey)){alert("OpenAI API key is missing. Enter it below and click SET.");return}if(!u||u.panels.length===0){alert("No active page or frames. Add a frame first.");return}const I=u.panels[0],ie=(J=I.prompt)==null?void 0:J.trim();if(!ie){alert("No prompt/description in the active frame. Add one first.");return}try{const Y=await qp(ie,I.aspectRatio||"square",l.openaiApiKey,void 0,.7);if(!Y)throw new Error("No image URL returned from OpenAI");const le=await ss(I.id,Y);t({type:"UPDATE_PANEL",panelId:I.id,updates:{imageUrl:le}}),console.log("OpenAI image generated and saved:",Y)}catch(Y){const le=Y instanceof Error?Y.message:"Check console for details";console.error("OpenAI generation failed:",Y),alert(`OpenAI generation failed: ${le}`)}};return p.jsxs("aside",{className:"w-72 bg-ink-900 border-r border-ink-700 flex flex-col overflow-hidden z-30",children:[p.jsxs("div",{className:"p-6 border-b border-ink-700",children:[p.jsx("h1",{className:"font-display text-3xl tracking-widest text-ember-500 mb-1 text-center",children:"INK TRACKER"}),p.jsx("p",{className:"font-mono text-[10px] text-steel-500 uppercase tracking-tighter text-center",children:"Script System v1.7"}),dO()]}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-8 scrollbar-none",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center justify-between mb-3 px-1",children:[p.jsx("h2",{className:"text-xs font-mono text-steel-500 uppercase tracking-widest",children:"Story"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsxs("button",{onClick:()=>{const I=(l==null?void 0:l.issueType)==="issue"?"chapter":"issue";l&&t({type:"UPDATE_PROJECT",id:l.id,updates:{issueType:I}})},className:"text-[9px] font-mono text-steel-600 hover:text-ember-500 uppercase transition-colors",title:"Switch Label Type",children:["Mode: ",l==null?void 0:l.issueType]}),p.jsx("button",{onClick:n,className:"text-steel-400 hover:text-ember-500 transition-colors",children:p.jsx(ko.Folder,{})})]})]}),p.jsxs("div",{className:"p-3 bg-ink-800 rounded border border-ink-700 shadow-inner flex flex-col gap-2",children:[p.jsx("p",{className:"font-display text-lg text-steel-200 tracking-wide truncate",children:l==null?void 0:l.title}),p.jsx("button",{onClick:i,className:"w-full mt-2 py-2 text-[10px] font-mono text-cyan-500 border border-cyan-800/50 rounded-lg hover:bg-cyan-900/20 uppercase tracking-widest transition-colors",children:" Import Script"}),p.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[p.jsx("p",{className:"text-[9px] font-mono text-steel-500 uppercase tracking-widest",children:"Image Provider"}),p.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[p.jsx("button",{onClick:$,className:`text-[9px] font-mono py-2 rounded-lg transition-all ${(l==null?void 0:l.imageProvider)==="gemini"?"bg-blue-600 hover:bg-blue-500 text-white font-bold shadow-lg shadow-blue-600/30":"bg-ink-900 text-steel-500 hover:bg-ink-800 hover:text-steel-300"}`,children:"GEMINI"}),p.jsx("button",{onClick:V,className:`text-[9px] font-mono py-2 rounded-lg transition-all ${(l==null?void 0:l.imageProvider)==="leonardo"?"bg-orange-600 hover:bg-orange-500 text-white font-bold shadow-lg shadow-orange-600/30":"bg-ink-900 text-steel-500 hover:bg-ink-800 hover:text-steel-300"}`,children:"LEONARDO"}),p.jsx("button",{onClick:j,className:`text-[9px] font-mono py-2 rounded-lg transition-all ${(l==null?void 0:l.imageProvider)==="grok"?"bg-gray-600 hover:bg-gray-500 text-white font-bold shadow-lg shadow-gray-600/30":"bg-ink-900 text-steel-500 hover:bg-ink-800 hover:text-steel-300"}`,title:"xAI Grok - Image generation may be limited",children:"GROK"}),p.jsx("button",{onClick:W,className:`text-[9px] font-mono py-2 rounded-lg transition-all ${(l==null?void 0:l.imageProvider)==="fal"?"bg-ember-500 hover:bg-ember-400 text-ink-950 font-bold shadow-lg shadow-ember-500/30":"bg-ink-900 text-steel-500 hover:bg-ink-800 hover:text-steel-300"}`,children:"FAL"})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mt-1.5",children:[p.jsx("button",{onClick:X,className:`text-[9px] font-mono py-2 rounded-lg transition-all ${(l==null?void 0:l.imageProvider)==="seaart"?"bg-pink-600 hover:bg-pink-500 text-white font-bold shadow-lg shadow-pink-600/30":"bg-ink-900 text-steel-500 hover:bg-ink-800 hover:text-steel-300"}`,title:"SeaArt - Creative image generation",children:"SEAART"}),p.jsx("button",{onClick:z,className:`text-[9px] font-mono py-2 rounded-lg transition-all ${(l==null?void 0:l.imageProvider)==="openai"?"bg-green-600 hover:bg-green-500 text-white font-bold shadow-lg shadow-green-600/30":"bg-ink-900 text-steel-500 hover:bg-ink-800 hover:text-steel-300"}`,title:"OpenAI GPT Image - gpt-image-1",children:"OPENAI"})]})]}),p.jsxs("div",{className:"mt-3 pt-3 border-t border-ink-700 space-y-2",children:[p.jsxs("label",{className:"text-[9px] font-mono text-steel-500 uppercase flex justify-between items-center",children:[p.jsxs("span",{children:[(l==null?void 0:l.imageProvider)==="gemini"?"Gemini":(l==null?void 0:l.imageProvider)==="leonardo"?"Leonardo":(l==null?void 0:l.imageProvider)==="grok"?"Grok (xAI)":(l==null?void 0:l.imageProvider)==="fal"?"FAL":(l==null?void 0:l.imageProvider)==="seaart"?"SeaArt":(l==null?void 0:l.imageProvider)==="openai"?"OpenAI":"API"," Key"]}),!g&&p.jsx("span",{className:"text-red-500 font-bold animate-pulse text-[8px]",children:"REQUIRED"})]}),p.jsxs("div",{className:"flex gap-1",children:[p.jsx("input",{type:"password",placeholder:"Enter API Key...",value:g,onChange:I=>A(I.target.value),className:"flex-1 bg-ink-950 border border-ink-700 rounded-lg px-3 py-2 text-[10px] text-steel-300 focus:border-ember-500 outline-none"}),p.jsx("button",{onClick:()=>{g.trim()&&((l==null?void 0:l.imageProvider)==="gemini"?t({type:"UPDATE_PROJECT_GEMINI_KEY",projectId:l.id,apiKey:g.trim()}):(l==null?void 0:l.imageProvider)==="leonardo"?t({type:"UPDATE_PROJECT_LEONARDO_KEY",projectId:l.id,apiKey:g.trim()}):(l==null?void 0:l.imageProvider)==="grok"?t({type:"UPDATE_PROJECT_GROK_KEY",projectId:l.id,apiKey:g.trim()}):(l==null?void 0:l.imageProvider)==="fal"?t({type:"UPDATE_PROJECT_FAL_KEY",projectId:l.id,apiKey:g.trim()}):(l==null?void 0:l.imageProvider)==="seaart"?t({type:"UPDATE_PROJECT_SEAART_KEY",projectId:l.id,apiKey:g.trim()}):(l==null?void 0:l.imageProvider)==="openai"&&t({type:"UPDATE_PROJECT_OPENAI_KEY",projectId:l.id,apiKey:g.trim()}),alert("API key saved!"))},className:"bg-ember-500 hover:bg-ember-400 text-ink-950 px-4 rounded-lg text-[9px] transition-colors font-bold",children:"SET"})]}),(l==null?void 0:l.imageProvider)==="gemini"?p.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-[8px] text-steel-600 italic hover:underline hover:text-steel-400 cursor-pointer transition-colors",children:"Get key from ai.google.dev"}):(l==null?void 0:l.imageProvider)==="leonardo"?p.jsx("a",{href:"https://leonardo.ai/settings",target:"_blank",rel:"noopener noreferrer",className:"text-[8px] text-steel-600 italic hover:underline hover:text-steel-400 cursor-pointer transition-colors",children:"Get key from leonardo.ai"}):(l==null?void 0:l.imageProvider)==="grok"?p.jsx("a",{href:"https://console.x.ai",target:"_blank",rel:"noopener noreferrer",className:"text-[8px] text-steel-600 italic hover:underline hover:text-steel-400 cursor-pointer transition-colors",children:"Get key from console.x.ai (experimental)"}):(l==null?void 0:l.imageProvider)==="fal"?p.jsx("a",{href:"https://fal.ai/dashboard/keys",target:"_blank",rel:"noopener noreferrer",className:"text-[8px] text-steel-600 italic hover:underline hover:text-steel-400 cursor-pointer transition-colors",children:"Get key from fal.ai"}):(l==null?void 0:l.imageProvider)==="seaart"?p.jsx("a",{href:"https://seaart.ai/api",target:"_blank",rel:"noopener noreferrer",className:"text-[8px] text-steel-600 italic hover:underline hover:text-steel-400 cursor-pointer transition-colors",children:"Get key from seaart.ai/api"}):(l==null?void 0:l.imageProvider)==="openai"?p.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-[8px] text-steel-600 italic hover:underline hover:text-steel-400 cursor-pointer transition-colors",children:"Get key from platform.openai.com"}):null]})]})]}),p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center justify-between mb-3 px-1",children:[p.jsxs("h2",{className:"text-xs font-mono text-steel-500 uppercase tracking-widest",children:[d,"s"]}),p.jsxs("button",{onClick:()=>{if(!l){alert("No active project found. Try creating or selecting a story first."),console.log("Active project missing when adding issue:",e.activeProjectId,e.projects);return}console.log("Dispatching ADD_ISSUE for project:",l.id,l.title),t({type:"ADD_ISSUE",projectId:l.id})},className:"text-steel-400 hover:text-ember-500 transition-colors flex items-center gap-1 group",title:"Add New Issue/Chapter",children:[p.jsx(ko.Plus,{}),p.jsx("span",{className:"text-[9px] font-mono opacity-0 group-hover:opacity-100 transition-opacity",children:"NEW"})]})]}),p.jsxs("div",{className:"space-y-4",children:[l&&l.issues.length===0&&p.jsx(ff,{variant:"issues",compact:!0,onAction:()=>{l&&t({type:"ADD_ISSUE",projectId:l.id})},actionLabel:`Add ${d}`}),l==null?void 0:l.issues.map(I=>{const ie=e.activeIssueId===I.id;return p.jsxs("div",{className:`rounded-lg overflow-hidden transition-all border ${ie?"border-ember-500/30 bg-ember-500/5":"border-ink-700"}`,children:[p.jsxs("div",{onClick:()=>t({type:"SET_ACTIVE_ISSUE",id:I.id}),className:`px-3 py-2 flex items-center justify-between cursor-pointer group ${ie?"bg-ember-500/10":"hover:bg-ink-800"}`,children:[p.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[p.jsx("span",{className:`text-[10px] font-mono ${ie?"text-ember-500":"text-steel-600"}`,children:ie?"":""}),p.jsx("p",{className:`text-xs font-bold uppercase tracking-widest truncate ${ie?"text-ember-500":"text-steel-400 group-hover:text-steel-200"}`,children:I.title})]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsxs("span",{className:"text-[9px] font-mono text-steel-600",children:[I.pages.length,"P"]}),p.jsx("button",{onClick:J=>{J.stopPropagation(),confirm(`Delete ${I.title}?`)&&t({type:"DELETE_ISSUE",issueId:I.id})},className:"opacity-0 group-hover:opacity-100 p-1 text-steel-700 hover:text-red-500 transition-all",children:p.jsx(ko.Trash,{})})]})]}),ie&&p.jsxs("div",{className:"px-2 py-2 border-t border-ember-500/10 space-y-1 animate-fade-in",children:[p.jsx(Xg,{sensors:h,collisionDetection:i4,onDragEnd:v,children:p.jsx(bO,{items:I.pages.map(J=>J.id),strategy:vO,children:I.pages.map(J=>p.jsx(RO,{page:J,isActive:e.activePageId===J.id,dispatch:t,panelCount:J.panels.length},J.id))})}),p.jsx("button",{onClick:()=>t({type:"ADD_PAGE",issueId:I.id}),className:"w-full py-1 text-center text-[10px] font-mono text-steel-600 hover:text-ember-500 hover:bg-ink-800 rounded transition-all mt-1 uppercase tracking-tighter",children:"+ Add Page"})]})]},I.id)})]})]}),p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center justify-between mb-3 px-1",children:[p.jsx("h2",{className:"text-xs font-mono text-steel-500 uppercase tracking-widest",children:"Cast"}),p.jsx("button",{onClick:()=>C(!_),className:`transition-colors ${_?"text-ember-500 rotate-45":"text-steel-400 hover:text-ember-500"}`,children:p.jsx(ko.Plus,{})})]}),_&&p.jsxs("div",{className:"mb-4 p-3 bg-ink-800 border border-ember-500/30 rounded-lg space-y-3 animate-fade-in shadow-xl",children:[p.jsx("input",{autoFocus:!0,placeholder:"Name (e.g. Detective Jack)",value:E,onChange:I=>R(I.target.value),className:"w-full bg-ink-950 border border-ink-700 rounded px-3 py-1.5 text-xs text-steel-200 focus:border-ember-500 outline-none font-bold"}),p.jsx("textarea",{placeholder:"Description (age, vibe, key features...)",value:k,onChange:I=>M(I.target.value),rows:2,className:"w-full bg-ink-950 border border-ink-700 rounded px-3 py-1.5 text-xs text-steel-400 focus:border-ember-500 outline-none resize-none italic"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{onClick:P,className:"flex-1 bg-ember-500 text-ink-950 font-bold py-1.5 rounded text-[10px] uppercase tracking-widest hover:bg-ember-400 transition-colors",children:"Save Cast"}),p.jsx("button",{onClick:()=>C(!1),className:"px-3 py-1.5 border border-ink-700 text-steel-500 rounded text-[10px] uppercase hover:bg-ink-700",children:"Cancel"})]})]}),p.jsxs("div",{className:"space-y-2",children:[(U=l==null?void 0:l.characters)==null?void 0:U.map(I=>p.jsxs("div",{className:"group flex items-center justify-between p-2 bg-ink-800/50 rounded border border-ink-700/50",children:[p.jsxs("div",{className:"overflow-hidden",children:[p.jsx("p",{className:"text-[11px] text-steel-300 font-bold truncate",children:I.name}),p.jsx("p",{className:"text-[9px] text-steel-600 truncate italic",children:I.description})]}),p.jsx("button",{onClick:()=>t({type:"DELETE_CHARACTER",id:I.id}),className:"opacity-0 group-hover:opacity-100 text-red-500/50 hover:text-red-500 transition-all p-1",children:p.jsx(ko.Trash,{})})]},I.id)),!((q=l==null?void 0:l.characters)!=null&&q.length)&&!_&&p.jsx(ff,{variant:"cast",compact:!0,onAction:()=>C(!0),actionLabel:"Add Character"})]})]})]}),p.jsxs("div",{className:"p-6 border-t border-ink-700 bg-ink-950 space-y-3",children:[p.jsx("h2",{className:"text-xs font-mono text-steel-500 uppercase tracking-widest px-1",children:"Art Style"}),p.jsx("select",{value:l==null?void 0:l.style,onChange:I=>{t({type:"UPDATE_PROJECT",id:l.id,updates:{style:I.target.value}}),I.target.value!=="custom"&&(l!=null&&l.customStylePrompt)&&t({type:"UPDATE_PROJECT",id:l.id,updates:{customStylePrompt:""}})},className:"w-full bg-ink-800 border border-ink-700 rounded-lg px-2 py-2 text-xs text-steel-300 font-mono focus:outline-none focus:border-ember-500 transition-colors",children:Object.entries(b).map(([I,ie])=>p.jsx("optgroup",{label:I,children:ie.map(J=>{const Y=Ip.find(le=>le.id===J);return Y?p.jsx("option",{value:Y.id,children:Y.name},Y.id):null})},I))}),(l==null?void 0:l.style)==="custom"&&p.jsxs("div",{className:"space-y-2 animate-fade-in",children:[p.jsx("label",{className:"text-[9px] font-mono text-steel-500 uppercase",children:"Custom Style Prompt"}),p.jsx("textarea",{placeholder:"Describe your art style... (e.g., 'watercolor fantasy, soft edges, muted pastels, Studio Ghibli influence')",value:(l==null?void 0:l.customStylePrompt)||"",onChange:I=>t({type:"UPDATE_PROJECT",id:l.id,updates:{customStylePrompt:I.target.value}}),rows:3,className:"w-full bg-ink-800 border border-ink-700 rounded-lg px-3 py-2 text-xs text-steel-300 focus:outline-none focus:border-ember-500 transition-colors resize-none placeholder-steel-600"}),p.jsx("p",{className:"text-[8px] text-steel-600 italic",children:"Tip: Include artist names, techniques, color palettes, and mood descriptors."})]})]}),l&&p.jsxs("div",{className:"p-6 border-t border-ink-700 bg-ink-950 space-y-4",children:[p.jsx("h2",{className:"text-xs font-mono text-steel-500 uppercase tracking-widest px-1",children:"Panel & Text Styles"}),p.jsxs("div",{className:"space-y-1.5",children:[p.jsx("label",{className:"text-[9px] font-mono text-steel-500 uppercase",children:"Panel Frames"}),p.jsx("div",{className:"flex rounded-lg overflow-hidden border border-ink-700",children:[{value:"opaque-black",label:"Black"},{value:"opaque-white",label:"White"},{value:"translucent",label:"Translucent"}].map(I=>p.jsx("button",{onClick:()=>t({type:"UPDATE_PROJECT",id:l.id,updates:{panelFrameStyle:I.value}}),className:`flex-1 text-[9px] font-mono py-2 transition-all ${(l.panelFrameStyle||"opaque-black")===I.value?"bg-ember-500 text-ink-950 font-bold":"bg-ink-900 text-steel-500 hover:bg-ink-800 hover:text-steel-300"}`,children:I.label},I.value))})]}),p.jsxs("div",{className:"space-y-1.5",children:[p.jsx("label",{className:"text-[9px] font-mono text-steel-500 uppercase",children:"Text Elements"}),p.jsx("div",{className:"flex rounded-lg overflow-hidden border border-ink-700",children:[{value:"opaque",label:"Opaque"},{value:"semi-transparent",label:"Semi-Trans"},{value:"border-only",label:"Border Only"}].map(I=>p.jsx("button",{onClick:()=>t({type:"UPDATE_PROJECT",id:l.id,updates:{textOverlayStyle:I.value}}),className:`flex-1 text-[9px] font-mono py-2 transition-all ${(l.textOverlayStyle||"opaque")===I.value?"bg-ember-500 text-ink-950 font-bold":"bg-ink-900 text-steel-500 hover:bg-ink-800 hover:text-steel-300"}`,children:I.label},I.value))})]})]})]})},MO=({element:e,panelId:t,dispatch:n,textOverlayStyle:i="opaque"})=>{const o=de.useRef(null),a=de.useRef(null),[l,c]=de.useState(null),[u,d]=de.useState(!1),[h,v]=de.useState({x:0,y:0,startX:0,startY:0}),[b,g]=de.useState({centerX:0,centerY:0,bottomY:0}),A=e.rotation||0,_=e.tailX??e.x+15,C=e.tailY??e.y+25,E=e.tailStyle??(e.type==="thought"?"cloud":"pointy");de.useEffect(()=>{const q=()=>{if(o.current&&o.current.parentElement){const J=o.current.parentElement.getBoundingClientRect(),Y=o.current.getBoundingClientRect(),le=(Y.left-J.left+Y.width/2)/J.width*100,pe=(Y.top-J.top+Y.height/2)/J.height*100,Ie=(Y.top-J.top+Y.height)/J.height*100;g({centerX:le,centerY:pe,bottomY:Ie})}};q();const I=setTimeout(q,50);return()=>clearTimeout(I)},[e.x,e.y,e.content,e.fontSize]);const R=(q,I)=>{q.stopPropagation(),c(I),v({x:q.clientX,y:q.clientY,startX:I==="bubble"?e.x:_,startY:I==="bubble"?e.y:C});const ie=I==="bubble"?o.current:q.currentTarget;ie==null||ie.setPointerCapture(q.pointerId),d(!0)},k=q=>{var Y;if(!l)return;const I=(Y=o.current)==null?void 0:Y.parentElement;if(!I)return;const ie=(q.clientX-h.x)/I.clientWidth*100,J=(q.clientY-h.y)/I.clientHeight*100;l==="bubble"?n({type:"UPDATE_TEXT_ELEMENT",panelId:t,elementId:e.id,updates:{x:Math.max(0,Math.min(100-(e.width||0),h.startX+ie)),y:Math.max(0,Math.min(100-(e.height||0),h.startY+J))}}):l==="tail"&&n({type:"UPDATE_TEXT_ELEMENT",panelId:t,elementId:e.id,updates:{tailX:Math.max(0,Math.min(100,h.startX+ie)),tailY:Math.max(0,Math.min(100,h.startY+J))}})},M=()=>c(null),P={dialogue:"bubble-dialogue",thought:"bubble-thought",caption:"bubble-caption",phone:"bubble-phone"},{centerX:W,centerY:V,bottomY:$}=b,j=W,X=$,z=i==="border-only"?"transparent":i==="semi-transparent"?"rgba(255,255,255,0.7)":"white",U=i==="semi-transparent"?"#6b7280":"black";return p.jsxs(p.Fragment,{children:[p.jsx("svg",{className:"absolute inset-0 pointer-events-none w-full h-full overflow-visible z-[50]",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:E!=="none"&&e.type!=="caption"&&b.centerX>0&&(E==="pointy"?p.jsx("polygon",{points:`${j-2},${X-.5} ${_},${C} ${j+2},${X-.5}`,fill:z,stroke:U,strokeWidth:"0.4",strokeLinejoin:"round"}):p.jsxs(p.Fragment,{children:[p.jsx("circle",{cx:j+(_-j)*.25,cy:X+(C-X)*.25,r:"2",fill:z,stroke:U,strokeWidth:"0.3"}),p.jsx("circle",{cx:j+(_-j)*.5,cy:X+(C-X)*.5,r:"1.5",fill:z,stroke:U,strokeWidth:"0.25"}),p.jsx("circle",{cx:j+(_-j)*.75,cy:X+(C-X)*.75,r:"1",fill:z,stroke:U,strokeWidth:"0.2"})]}))}),u&&e.type!=="caption"&&p.jsx("div",{onPointerDown:q=>R(q,"tail"),onPointerMove:k,onPointerUp:M,className:"absolute w-4 h-4 bg-ember-500 border-2 border-white rounded-full z-[200] cursor-crosshair shadow-lg",style:{left:`${_}%`,top:`${C}%`,transform:"translate(-50%, -50%)"}}),p.jsxs("div",{ref:o,onPointerDown:q=>R(q,"bubble"),onPointerMove:k,onPointerUp:M,onFocusCapture:()=>d(!0),tabIndex:0,className:`comic-overlay-base ${P[e.type]} ${i==="semi-transparent"?"text-style-semi-transparent":i==="border-only"?"text-style-border-only":""} ${u?"element-selected shadow-[0_0_15px_rgba(59,130,246,0.5)]":""}`,style:{left:`${e.x}%`,top:`${e.y}%`,minWidth:"40px",maxWidth:"85%",fontSize:`${e.fontSize}px`,color:e.color,zIndex:l?200:100,transform:`rotate(${A}deg)`},children:[p.jsx("div",{ref:a,contentEditable:!0,suppressContentEditableWarning:!0,onBlur:q=>{n({type:"UPDATE_TEXT_ELEMENT",panelId:t,elementId:e.id,updates:{content:q.currentTarget.textContent||""}}),setTimeout(()=>{var I;(I=document.activeElement)!=null&&I.closest(".text-control-panel")||d(!1)},100)},className:"outline-none bg-transparent whitespace-pre-wrap break-words min-h-[1em] min-w-[1ch]",children:e.content}),u&&p.jsxs("div",{className:"text-control-panel absolute -top-16 left-1/2 -translate-x-1/2 bg-ink-900 border-2 border-ink-700 rounded-2xl p-2 flex items-center gap-2 shadow-2xl z-[300]",children:[p.jsx("div",{className:"flex flex-col gap-1",children:p.jsxs("div",{className:"flex items-center bg-ink-950 px-2 py-1 rounded-lg border border-ink-700 gap-2",children:[p.jsx("button",{onMouseDown:q=>{q.preventDefault(),n({type:"UPDATE_TEXT_ELEMENT",panelId:t,elementId:e.id,updates:{fontSize:Math.max(8,e.fontSize-2)}})},className:"w-7 h-7 flex items-center justify-center text-xs hover:bg-ember-500 hover:text-ink-950 rounded-lg text-steel-400 transition-colors",children:"A-"}),p.jsx("span",{className:"text-[10px] font-mono text-center w-6 text-ember-500 font-bold",children:e.fontSize}),p.jsx("button",{onMouseDown:q=>{q.preventDefault(),n({type:"UPDATE_TEXT_ELEMENT",panelId:t,elementId:e.id,updates:{fontSize:Math.min(80,e.fontSize+2)}})},className:"w-7 h-7 flex items-center justify-center text-xs hover:bg-ember-500 hover:text-ink-950 rounded-lg text-steel-400 transition-colors",children:"A+"})]})}),p.jsxs("div",{className:"flex items-center bg-ink-950 px-2 py-1 rounded-lg border border-ink-700 gap-2 h-full self-stretch",children:[p.jsx("span",{className:"text-[9px] font-mono text-steel-500 uppercase",children:"ROT"}),p.jsx("input",{type:"range",min:"-15",max:"15",step:"1",value:A,onChange:q=>n({type:"UPDATE_TEXT_ELEMENT",panelId:t,elementId:e.id,updates:{rotation:parseInt(q.target.value)}}),onMouseDown:q=>q.stopPropagation(),className:"w-16 accent-ember-500"})]}),p.jsxs("div",{className:"flex items-center bg-ink-950 px-2 py-1 rounded-lg border border-ink-700 gap-1 h-full self-stretch",children:[p.jsx("button",{onMouseDown:q=>{q.preventDefault(),n({type:"UPDATE_TEXT_ELEMENT",panelId:t,elementId:e.id,updates:{tailStyle:"pointy"}})},className:`w-6 h-6 rounded flex items-center justify-center ${E==="pointy"?"bg-ember-500 text-ink-950":"text-steel-400"}`,title:"Pointer",children:p.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{d:"M12 2L4 22h16L12 2z"})})}),p.jsx("button",{onMouseDown:q=>{q.preventDefault(),n({type:"UPDATE_TEXT_ELEMENT",panelId:t,elementId:e.id,updates:{tailStyle:"cloud"}})},className:`w-6 h-6 rounded flex items-center justify-center ${E==="cloud"?"bg-ember-500 text-ink-950":"text-steel-400"}`,title:"Thought",children:p.jsx("circle",{cx:"12",cy:"12",r:"8",fill:"currentColor"})}),p.jsx("button",{onMouseDown:q=>{q.preventDefault(),n({type:"UPDATE_TEXT_ELEMENT",panelId:t,elementId:e.id,updates:{tailStyle:"none"}})},className:`w-6 h-6 rounded flex items-center justify-center ${E==="none"?"bg-ember-500 text-ink-950":"text-steel-400"}`,title:"None",children:p.jsx("span",{className:"text-[9px] font-bold",children:""})})]}),p.jsx("button",{onMouseDown:q=>{q.preventDefault(),n({type:"DELETE_TEXT_ELEMENT",panelId:t,elementId:e.id})},className:"w-8 h-8 flex items-center justify-center text-xs bg-red-500 hover:bg-red-400 text-white rounded-lg transition-colors",children:p.jsx(ko.Trash,{})})]})]})]})};function Tx(e){if(!e.appearance)return e.description||"";const t=[],n=e.appearance;return n.build&&t.push(n.build),n.hairColor&&t.push(`${n.hairColor} hair`),n.eyeColor&&t.push(`${n.eyeColor} eyes`),n.distinguishingMarks&&t.push(n.distinguishingMarks),t.length===0&&e.description?e.description:t.join(", ")}function DO(e){const t=[e.name];if(e.appearance){const n=e.appearance,i=[];n.age&&i.push(n.age),n.gender&&i.push(n.gender),n.ethnicity&&i.push(n.ethnicity),n.height&&i.push(n.height),n.build&&i.push(n.build),n.skinTone&&i.push(`${n.skinTone} skin`),n.hairColor&&n.hairStyle?i.push(`${n.hairColor} ${n.hairStyle} hair`):n.hairColor?i.push(`${n.hairColor} hair`):n.hairStyle&&i.push(`${n.hairStyle} hair`),n.eyeColor&&i.push(`${n.eyeColor} eyes`),n.facialFeatures&&i.push(n.facialFeatures),n.distinguishingMarks&&i.push(n.distinguishingMarks),n.clothing&&i.push(`wearing ${n.clothing}`),n.accessories&&i.push(`with ${n.accessories}`),n.additionalNotes&&i.push(n.additionalNotes),i.length>0&&t.push(`(${i.join(", ")})`)}else e.description&&t.push(`(${e.description})`);return t.join(" ")}const PO=280,OO=200,BS=({panel:e,pageId:t,dispatch:n,project:i,characters:o,index:a,total:l,showGutters:c=!1,activePage:u,isOverlay:d=!1,isDragging:h=!1,isSelected:v=!1,onSelect:b,copiedSettings:g,onCopySettings:A,onPasteSettings:_,panelFrameStyle:C="opaque-black",textOverlayStyle:E="opaque"})=>{var He;const[R,k]=de.useState(!1),[M,P]=de.useState(!1),[W,V]=de.useState(!1),[$,j]=de.useState(!1),[X,z]=de.useState(!1),[U,q]=de.useState(!1),[I,ie]=de.useState(null),[J,Y]=de.useState(!1),le=de.useRef(null),pe=de.useRef(null),Ie=e.width||360,G=e.height||420,{attributes:O,listeners:ee,setNodeRef:te,transform:ce,isDragging:ye}=Lw({id:e.id,disabled:d||J}),we=h||ye,Te={position:"absolute",left:e.x||0,top:e.y||0,width:Ie,minHeight:G,opacity:we?.6:1,zIndex:we?1e3:v?100:1,transform:ce?`translate(${ce.x}px, ${ce.y}px)`:void 0,transition:J?"none":"box-shadow 0.2s",outline:v?"3px solid #60a5fa":void 0,outlineOffset:v?"2px":void 0};de.useEffect(()=>{(async()=>{var ze;if((ze=e.imageUrl)!=null&&ze.startsWith("idb://")){const We=e.imageUrl.replace("idb://",""),dt=await ka(We);ie(dt||null)}else e.imageUrl?ie(e.imageUrl):ie(null)})()},[e.imageUrl]);const Ce=de.useCallback(Ne=>{Ne.preventDefault(),Ne.stopPropagation(),Y(!0),le.current={startX:Ne.clientX,startY:Ne.clientY,startWidth:Ie,startHeight:G}},[Ie,G]);de.useEffect(()=>{const Ne=We=>{if(!J||!le.current)return;const dt=Math.max(PO,le.current.startWidth+(We.clientX-le.current.startX)),ft=Math.max(OO,le.current.startHeight+(We.clientY-le.current.startY));n({type:"UPDATE_PANEL",panelId:e.id,updates:{width:dt,height:ft}})},ze=()=>{Y(!1),le.current=null};return J&&(document.addEventListener("mousemove",Ne),document.addEventListener("mouseup",ze)),()=>{document.removeEventListener("mousemove",Ne),document.removeEventListener("mouseup",ze)}},[J]);const De=async()=>{var Ne;if(!((Ne=e.prompt)!=null&&Ne.trim())&&e.characterIds.length===0){alert("Please enter a prompt or select characters first.");return}k(!0);try{const ze=Ip.find(vt=>vt.id===i.style),We=i.style==="custom"?i.customStylePrompt||"":(ze==null?void 0:ze.prompt)||"",dt=o.filter(vt=>e.characterIds.includes(vt.id)),ft=dt.length>0?`Characters: ${dt.map(vt=>DO(vt)).join("; ")}.`:"",ht=nf[e.aspectRatio];let Et;if(e.referencePanelId){const vt=u.panels.find(Rt=>Rt.id===e.referencePanelId);if(vt!=null&&vt.imageUrl){const Rt=vt.imageUrl.startsWith("idb://")?vt.imageUrl.slice(6):null;Rt&&(Et=await ka(Rt)||void 0)}}const mt=Et?" Maintain strong visual and character consistency with the reference image. Same lighting, angle, style.":"",on=`${We}. ${ft} ${e.prompt||""}.${mt}`.trim();let yt;if(i.imageProvider==="gemini"&&i.geminiApiKey)yt=await Up(on,ht.ratio,i.geminiApiKey,Et,e.referenceStrength??.7);else if(i.imageProvider==="leonardo"&&i.leonardoApiKey)yt=await zp(on,e.aspectRatio,i.leonardoApiKey,Et,e.referenceStrength??.7);else if(i.imageProvider==="grok"&&i.grokApiKey)yt=await jp(on,e.aspectRatio,i.grokApiKey,Et,e.referenceStrength??.7);else if(i.imageProvider==="fal"&&i.falApiKey)yt=await Fp(on,e.aspectRatio,i.falApiKey,i.fluxModel||"fal-ai/flux-pro",Et,e.referenceStrength??.7);else if(i.imageProvider==="seaart"&&i.seaartApiKey)yt=await Bp(on,e.aspectRatio,i.seaartApiKey,Et,e.referenceStrength??.7);else if(i.imageProvider==="openai"&&i.openaiApiKey)yt=await qp(on,e.aspectRatio,i.openaiApiKey,Et,e.referenceStrength??.7);else throw new Error(`No API key configured for ${i.imageProvider}. Please add your API key in the sidebar.`);if(yt){const vt=await ss(e.id,yt);n({type:"UPDATE_PANEL",panelId:e.id,updates:{imageUrl:vt}})}}catch(ze){console.error("Image generation failed:",ze),alert(`Generation failed: ${ze.message}`)}finally{k(!1)}},$e=Ne=>{n({type:"UPDATE_PANEL",panelId:e.id,updates:{prompt:Ne.target.value}})},at=Ne=>{n({type:"UPDATE_PANEL",panelId:e.id,updates:{aspectRatio:Ne}}),P(!1)},st=Ne=>{const ze=e.characterIds.includes(Ne)?e.characterIds.filter(We=>We!==Ne):[...e.characterIds,Ne];n({type:"UPDATE_PANEL",panelId:e.id,updates:{characterIds:ze}})},B=()=>{confirm("Delete this frame?")&&n({type:"DELETE_PANEL",panelId:e.id,pageId:t})},K=()=>{n({type:"UPDATE_PANEL",panelId:e.id,updates:{imageUrl:void 0}}),ie(null)},_e=async Ne=>{var We;const ze=(We=Ne.target.files)==null?void 0:We[0];if(ze){if(!ze.type.startsWith("image/")){alert("Please select an image file");return}if(ze.size>10*1024*1024){alert("Image must be less than 10MB");return}try{const dt=new FileReader;dt.onload=async ft=>{var Et;const ht=(Et=ft.target)==null?void 0:Et.result;if(ht){const mt=await ss(e.id,ht);n({type:"UPDATE_PANEL",panelId:e.id,updates:{imageUrl:mt}})}},dt.readAsDataURL(ze)}catch(dt){console.error("Image upload failed:",dt),alert("Failed to upload image")}pe.current&&(pe.current.value="")}},he=Ne=>{const ze={id:ls(),type:Ne,content:Ne==="caption"?"Caption text...":Ne==="phone"?"Text message...":"Click to edit...",x:10+Math.random()*20,y:10+Math.random()*20,width:30,height:15,fontSize:Ne==="caption"?14:16,color:"#000000",tailStyle:Ne==="thought"?"cloud":Ne==="dialogue"?"pointy":"none"};n({type:"ADD_TEXT_ELEMENT",panelId:e.id,element:ze})},ne=()=>{const Ne={id:ls(),type:"dialogue",content:"",x:-1,y:-1,width:100,height:10,fontSize:14,color:"#000000",tailStyle:"none"};n({type:"ADD_TEXT_ELEMENT",panelId:e.id,element:Ne})},ae=nf[e.aspectRatio],be=o.filter(Ne=>e.characterIds.includes(Ne.id)),Me=e.textElements.filter(Ne=>Ne.x===-1&&Ne.y===-1),Se=e.textElements.filter(Ne=>!(Ne.x===-1&&Ne.y===-1));return p.jsxs("div",{ref:te,style:Te,onClick:Ne=>{b&&Ne.target.closest("button, input, textarea, [contenteditable]")===null&&b()},className:`group rounded-xl border transition-all flex flex-col ${c?C==="opaque-white"?"bg-white/90 border-2 border-white shadow-md hover:shadow-lg":C==="translucent"?"bg-transparent border border-gray-400/60 shadow-sm hover:shadow-md backdrop-blur-sm":"bg-white/90 border-2 border-black shadow-md hover:shadow-lg":C==="opaque-white"?"bg-white/90 border-2 border-white shadow-md hover:shadow-lg":C==="translucent"?"bg-transparent border border-gray-400/60 shadow-sm hover:shadow-md backdrop-blur-sm":"bg-ink-900 border-2 border-black shadow-2xl hover:shadow-ember-500/10"} ${we?"ring-2 ring-ember-500 shadow-2xl":""} ${J?"cursor-nwse-resize":""}`,children:[p.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b ${C==="translucent"?"border-gray-400/30 bg-white/10 backdrop-blur-sm":c?"border-gray-200 bg-gray-50":"border-ink-800 bg-ink-950/50"} rounded-t-xl`,children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{...O,...ee,className:"cursor-grab active:cursor-grabbing touch-none hover:text-ember-500 transition-colors p-1 -ml-1 rounded hover:bg-ink-800/50",title:"Drag to move",children:p.jsx(GA,{size:16,className:c?"text-gray-400":"text-steel-600"})}),p.jsxs("span",{className:`text-xs font-mono font-bold ${c?"text-gray-600":"text-steel-400"}`,children:[a+1,"/",l]})]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsxs("div",{className:"relative",children:[p.jsxs("button",{onClick:()=>P(!M),className:`text-[10px] font-mono px-2 py-1 rounded flex items-center gap-1 transition-colors ${c?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-ink-800 text-steel-500 hover:bg-ink-700"}`,children:[ae==null?void 0:ae.label.split(" ")[0],p.jsx(Wd,{size:12})]}),M&&p.jsx("div",{className:`absolute right-0 top-full mt-1 z-50 rounded-lg shadow-xl border py-1 min-w-[140px] ${c?"bg-white border-gray-200":"bg-ink-900 border-ink-700"}`,children:Object.entries(nf).map(([Ne,ze])=>p.jsx("button",{onClick:()=>at(Ne),className:`w-full text-left px-3 py-1.5 text-xs font-mono transition-colors ${e.aspectRatio===Ne?"bg-ember-500 text-ink-950":c?"text-gray-600 hover:bg-gray-100":"text-steel-400 hover:bg-ink-800"}`,children:ze.label},Ne))})]}),p.jsx("button",{onClick:B,className:"p-1 text-steel-600 hover:text-red-500 transition-colors",children:p.jsx(Tc,{size:14})})]})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-3 space-y-3 scrollbar-thin scrollbar-thumb-ink-700 scrollbar-track-transparent",children:[p.jsx("input",{ref:pe,type:"file",accept:"image/*",onChange:_e,className:"hidden"}),p.jsxs("div",{className:`relative rounded-lg overflow-hidden ${(ae==null?void 0:ae.class)||"aspect-video"} ${c?"bg-gray-100 border border-gray-200":"bg-ink-950 border border-ink-800"}`,children:[p.jsx("div",{className:"absolute top-2 left-2 z-20",children:p.jsx("div",{className:"w-8 h-8 rounded-full bg-ember-500 text-white flex items-center justify-center font-bold text-sm shadow-lg",children:a+1})}),I?p.jsxs(p.Fragment,{children:[p.jsx("img",{src:I,alt:`Panel ${a+1}`,className:"w-full h-full object-cover"}),Se.map(Ne=>p.jsx(MO,{element:Ne,panelId:e.id,dispatch:n,textOverlayStyle:E},Ne.id)),p.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[p.jsx("button",{onClick:De,disabled:R,className:"p-1.5 bg-black/60 hover:bg-ember-500 text-white rounded-full transition-colors disabled:opacity-50",title:"Regenerate",children:p.jsx(uw,{size:12,className:R?"animate-spin":""})}),p.jsx("button",{onClick:()=>{var Ne;return(Ne=pe.current)==null?void 0:Ne.click()},className:"p-1.5 bg-black/60 hover:bg-ember-500 text-white rounded-full transition-colors",title:"Upload",children:p.jsx(i2,{size:12})}),p.jsx("button",{onClick:K,className:"p-1.5 bg-black/60 hover:bg-red-600 text-white rounded-full transition-colors",title:"Clear",children:p.jsx(Tc,{size:12})})]})]}):p.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3",children:[p.jsx(iw,{size:32,className:c?"text-gray-300":"text-steel-600"}),p.jsxs("button",{onClick:()=>{var Ne;return(Ne=pe.current)==null?void 0:Ne.click()},className:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-mono bg-ember-500 hover:bg-ember-400 text-white transition-colors",children:[p.jsx(i2,{size:14}),"Upload Image"]}),p.jsx("span",{className:`text-[10px] font-mono ${c?"text-gray-400":"text-ink-700"}`,children:"No image yet"})]}),R&&p.jsx(LI,{provider:i.imageProvider})]}),Me.length>0&&p.jsxs("div",{className:`rounded-lg border ${c?"border-gray-200 bg-gray-50":"border-ink-800 bg-ink-950/50"}`,children:[p.jsx("div",{className:`px-3 py-1.5 text-[10px] font-mono uppercase tracking-wider border-b ${c?"text-gray-500 border-gray-200":"text-steel-600 border-ink-800"}`,children:"Dialogue"}),p.jsx("div",{className:"p-2 space-y-1",children:Me.map(Ne=>p.jsxs("div",{className:"flex items-start gap-1 group/line",children:[p.jsx("textarea",{value:Ne.content,onChange:ze=>n({type:"UPDATE_TEXT_ELEMENT",panelId:e.id,elementId:Ne.id,updates:{content:ze.target.value}}),placeholder:"CHARACTER: Dialogue text...",rows:1,className:`flex-1 rounded px-2 py-1 text-xs resize-none transition-colors outline-none ${c?"bg-white border border-gray-200 text-gray-800 placeholder-gray-400 focus:border-blue-400":"bg-ink-900 border border-ink-700 text-steel-200 placeholder-steel-600 focus:border-ember-500"}`,onInput:ze=>{const We=ze.target;We.style.height="auto",We.style.height=We.scrollHeight+"px"}}),p.jsx("button",{onClick:()=>n({type:"DELETE_TEXT_ELEMENT",panelId:e.id,elementId:Ne.id}),className:"p-1 text-steel-700 hover:text-red-500 transition-colors opacity-0 group-hover/line:opacity-100 flex-shrink-0",title:"Remove",children:p.jsx(Vs,{size:12})})]},Ne.id))})]}),p.jsxs("button",{onClick:ne,className:`w-full flex items-center justify-center gap-1.5 py-1.5 rounded-lg text-[10px] font-mono uppercase tracking-wider transition-colors ${c?"text-gray-400 hover:text-gray-600 hover:bg-gray-100 border border-dashed border-gray-300":"text-steel-600 hover:text-steel-400 hover:bg-ink-800/50 border border-dashed border-ink-700"}`,children:[p.jsx($u,{size:12}),"Add Dialogue"]}),p.jsx("textarea",{value:e.prompt||"",onChange:$e,placeholder:"Describe this panel... (scene, action, mood)",rows:3,className:`w-full rounded-lg px-3 py-2 text-sm resize-none transition-colors outline-none ${c?"bg-gray-50 border border-gray-200 text-gray-800 placeholder-gray-400 focus:border-blue-400":"bg-ink-950 border border-ink-800 text-steel-200 placeholder-steel-600 focus:border-ember-500"}`}),u.panels.length>1&&p.jsxs("div",{className:"relative",children:[p.jsxs("button",{onClick:()=>j(!$),className:`w-full text-left px-3 py-2 rounded-lg text-xs font-mono flex items-center justify-between transition-colors ${e.referencePanelId?"bg-cyan-500/10 border border-cyan-500/30 text-cyan-400":c?"bg-gray-50 border border-gray-200 text-gray-600 hover:bg-gray-100":"bg-ink-950 border border-ink-800 text-steel-500 hover:bg-ink-900"}`,children:[p.jsxs("span",{className:"flex items-center gap-2",children:[p.jsx(jl,{size:12}),e.referencePanelId?`Linked to Panel ${u.panels.findIndex(Ne=>Ne.id===e.referencePanelId)+1}`:"Link to previous panel..."]}),p.jsx(Wd,{size:14})]}),$&&p.jsxs("div",{className:`absolute left-0 right-0 top-full mt-1 z-50 rounded-lg shadow-xl border py-1 max-h-48 overflow-y-auto ${c?"bg-white border-gray-200":"bg-ink-900 border-ink-700"}`,children:[p.jsxs("button",{onClick:()=>{n({type:"UPDATE_PANEL",panelId:e.id,updates:{referencePanelId:void 0}}),j(!1)},className:`w-full text-left px-3 py-2 text-xs transition-colors flex items-center gap-2 ${e.referencePanelId?c?"text-gray-600 hover:bg-gray-100":"text-steel-400 hover:bg-ink-800":"bg-ember-500/20 text-ember-500"}`,children:[p.jsx(N3,{size:12}),p.jsx("span",{children:"No reference (standalone)"})]}),u.panels.filter(Ne=>Ne.id!==e.id&&Ne.imageUrl).map(Ne=>{var We;const ze=u.panels.findIndex(dt=>dt.id===Ne.id)+1;return p.jsxs("button",{onClick:()=>{n({type:"UPDATE_PANEL",panelId:e.id,updates:{referencePanelId:Ne.id}}),j(!1)},className:`w-full text-left px-3 py-2 text-xs transition-colors flex items-center gap-2 ${e.referencePanelId===Ne.id?"bg-cyan-500/20 text-cyan-400":c?"text-gray-600 hover:bg-gray-100":"text-steel-400 hover:bg-ink-800"}`,children:[p.jsx(jl,{size:12}),p.jsxs("span",{className:"font-bold",children:["Panel ",ze]}),p.jsxs("span",{className:"opacity-60 text-[10px] truncate flex-1",children:[((We=Ne.prompt)==null?void 0:We.slice(0,30))||"No prompt","..."]})]},Ne.id)}),u.panels.filter(Ne=>Ne.id!==e.id&&Ne.imageUrl).length===0&&p.jsx("div",{className:`px-3 py-2 text-xs italic ${c?"text-gray-400":"text-steel-600"}`,children:"No other panels with images yet"})]}),e.referencePanelId&&p.jsxs("div",{className:"mt-2 px-1",children:[p.jsxs("div",{className:"flex items-center justify-between mb-1",children:[p.jsx("span",{className:`text-[9px] font-mono uppercase ${c?"text-gray-500":"text-steel-600"}`,children:"Consistency Strength"}),p.jsxs("span",{className:`text-[9px] font-mono ${c?"text-gray-600":"text-steel-400"}`,children:[Math.round((e.referenceStrength||.7)*100),"%"]})]}),p.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:e.referenceStrength||.7,onChange:Ne=>n({type:"UPDATE_PANEL",panelId:e.id,updates:{referenceStrength:parseFloat(Ne.target.value)}}),className:"w-full h-1 bg-ink-800 rounded-lg appearance-none cursor-pointer accent-cyan-500"}),p.jsxs("div",{className:`flex justify-between text-[8px] font-mono mt-0.5 ${c?"text-gray-400":"text-steel-700"}`,children:[p.jsx("span",{children:"Creative"}),p.jsx("span",{children:"Consistent"})]})]})]}),p.jsxs("button",{onClick:()=>q(!U),className:`w-full flex items-center justify-center gap-1.5 py-1.5 rounded-lg text-[10px] font-mono uppercase tracking-wider transition-colors ${c?"text-gray-400 hover:text-gray-600 hover:bg-gray-100":"text-steel-600 hover:text-steel-400 hover:bg-ink-800/50"}`,children:[p.jsx(d3,{size:12}),U?"Less Options":"More Options",U?p.jsx(tw,{size:12}):p.jsx(Wd,{size:12})]}),U&&p.jsxs("div",{className:`space-y-3 pt-1 border-t ${c?"border-gray-200":"border-ink-800"}`,children:[p.jsxs("div",{className:"relative",children:[p.jsx("label",{className:`block text-[10px] font-mono uppercase mb-1 ${c?"text-gray-500":"text-steel-600"}`,children:"Characters in this panel"}),o.length>0?p.jsxs(p.Fragment,{children:[p.jsxs("button",{onClick:()=>V(!W),className:`w-full text-left px-3 py-2 rounded-lg text-xs font-mono flex items-center justify-between transition-colors ${be.length>0?"bg-ember-500/10 border border-ember-500/30 text-ember-400":c?"bg-gray-50 border border-gray-200 text-gray-600 hover:bg-gray-100":"bg-ink-950 border border-ink-800 text-steel-500 hover:bg-ink-900"}`,children:[p.jsx("span",{children:be.length>0?be.map(Ne=>Ne.name).join(", "):"Select characters..."}),p.jsx(Wd,{size:14})]}),W&&p.jsx("div",{className:`absolute left-0 right-0 top-full mt-1 z-50 rounded-lg shadow-xl border py-1 max-h-48 overflow-y-auto ${c?"bg-white border-gray-200":"bg-ink-900 border-ink-700"}`,children:o.map(Ne=>{const ze=e.characterIds.includes(Ne.id),We=Tx(Ne);return p.jsxs("button",{onClick:()=>st(Ne.id),className:`w-full text-left px-3 py-2 text-xs transition-colors ${ze?"bg-ember-500/20":c?"hover:bg-gray-100":"hover:bg-ink-800"}`,children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:`w-3 h-3 rounded border flex-shrink-0 ${ze?"bg-ember-500 border-ember-500":c?"border-gray-300":"border-ink-600"}`}),p.jsx("span",{className:`font-bold ${ze?"text-ember-400":c?"text-gray-700":"text-steel-300"}`,children:Ne.name})]}),We&&p.jsx("p",{className:`mt-1 ml-5 text-[10px] leading-tight ${c?"text-gray-500":"text-steel-600"}`,children:We})]},Ne.id)})}),be.length>0&&p.jsx("div",{className:`mt-2 space-y-1 text-[10px] ${c?"text-gray-500":"text-steel-600"}`,children:be.map(Ne=>{const ze=Tx(Ne);return ze?p.jsxs("div",{className:"flex gap-1",children:[p.jsxs("span",{className:"font-bold text-ember-500",children:[Ne.name,":"]}),p.jsx("span",{className:"truncate",children:ze})]},Ne.id):null})})]}):p.jsx("p",{className:`text-xs ${c?"text-gray-400":"text-steel-600"}`,children:"No characters defined. Use the CHARACTERS button to add some."})]}),I&&p.jsxs("div",{children:[p.jsx("label",{className:`block text-[10px] font-mono uppercase mb-1.5 ${c?"text-gray-500":"text-steel-600"}`,children:"Image Overlays"}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsxs("button",{onClick:()=>he("dialogue"),className:`flex-1 flex items-center justify-center gap-1 py-1.5 rounded-lg text-[10px] font-mono transition-colors ${c?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-ink-800 text-steel-500 hover:bg-ink-700"}`,title:"Add dialogue bubble on image",children:[p.jsx(aw,{size:12}),"Bubble"]}),p.jsxs("button",{onClick:()=>he("thought"),className:`flex-1 flex items-center justify-center gap-1 py-1.5 rounded-lg text-[10px] font-mono transition-colors ${c?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-ink-800 text-steel-500 hover:bg-ink-700"}`,title:"Add thought cloud on image",children:[p.jsx(Vm,{size:12}),"Thought"]}),p.jsxs("button",{onClick:()=>he("caption"),className:`flex-1 flex items-center justify-center gap-1 py-1.5 rounded-lg text-[10px] font-mono transition-colors ${c?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-ink-800 text-steel-500 hover:bg-ink-700"}`,title:"Add caption box on image",children:[p.jsx(w3,{size:12}),"Caption"]}),p.jsxs("button",{onClick:()=>he("phone"),className:`flex-1 flex items-center justify-center gap-1 py-1.5 rounded-lg text-[10px] font-mono transition-colors ${c?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-ink-800 text-steel-500 hover:bg-ink-700"}`,title:"Add phone/text on image",children:[p.jsx(p3,{size:12}),"Phone"]})]})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[A&&p.jsxs("button",{onClick:Ne=>{Ne.stopPropagation(),A()},className:`flex-1 flex items-center justify-center gap-1.5 py-1.5 rounded-lg text-[10px] font-mono transition-colors ${c?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-ink-800 text-steel-500 hover:bg-ink-700"}`,title:"Copy panel settings",children:[p.jsx(Og,{size:12}),"Copy Settings"]}),_&&g&&p.jsxs("button",{onClick:Ne=>{Ne.stopPropagation(),_()},className:`flex-1 flex items-center justify-center gap-1.5 py-1.5 rounded-lg text-[10px] font-mono transition-colors ${c?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-ink-800 text-steel-500 hover:bg-ink-700"}`,title:"Paste panel settings",children:[p.jsx(oA,{size:12}),"Paste Settings"]})]}),e.promptHistory&&e.promptHistory.length>0&&p.jsxs("div",{className:"relative",children:[p.jsxs("button",{onClick:()=>z(!X),className:`w-full flex items-center justify-center gap-1.5 py-1.5 rounded-lg text-[10px] font-mono transition-colors ${c?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-ink-800 text-steel-500 hover:bg-ink-700"}`,children:[p.jsx($m,{size:12}),"Prompt History (",e.promptHistory.length,")"]}),X&&p.jsx("div",{className:`mt-1 rounded-lg shadow-xl border py-1 max-h-48 overflow-y-auto ${c?"bg-white border-gray-200":"bg-ink-900 border-ink-700"}`,children:[...e.promptHistory].reverse().map((Ne,ze)=>{var We,dt;return p.jsxs("button",{onClick:()=>{$e({target:{value:Ne}}),z(!1)},className:`w-full text-left px-3 py-2 text-xs transition-colors ${c?"text-gray-700 hover:bg-gray-100":"text-steel-400 hover:bg-ink-800"}`,children:[p.jsxs("div",{className:`text-[10px] mb-1 ${c?"text-gray-500":"text-steel-600"}`,children:[(((We=e.promptHistory)==null?void 0:We.length)||0)-ze," version",(((dt=e.promptHistory)==null?void 0:dt.length)||0)-ze===1?"":"s"," ago"]}),p.jsx("div",{className:"line-clamp-3",children:Ne})]},ze)})})]})]})]}),p.jsx("div",{className:`px-3 py-2 border-t ${C==="translucent"?"border-gray-400/30 bg-white/10 backdrop-blur-sm":c?"border-gray-200 bg-gray-50":"border-ink-800 bg-ink-950/50"} rounded-b-xl`,children:p.jsx("button",{onClick:De,disabled:R||!((He=e.prompt)!=null&&He.trim())&&e.characterIds.length===0,className:`w-full py-2 rounded-lg text-xs font-mono font-bold uppercase tracking-widest flex items-center justify-center gap-2 transition-all disabled:opacity-40 disabled:cursor-not-allowed ${c?"bg-blue-600 hover:bg-blue-500 text-white":"bg-ember-500 hover:bg-ember-400 text-ink-950"}`,children:R?p.jsxs(p.Fragment,{children:[p.jsx(RA,{size:14,className:"animate-spin"}),"Generating with ",i.imageProvider==="gemini"?"Gemini":i.imageProvider==="leonardo"?"Leonardo":i.imageProvider==="grok"?"Grok":i.imageProvider==="fal"?"FAL":i.imageProvider==="seaart"?"SeaArt":i.imageProvider==="openai"?"OpenAI":"AI","..."]}):p.jsxs(p.Fragment,{children:[p.jsx(bp,{size:14}),"Generate"]})})}),p.jsx("div",{onMouseDown:Ce,className:`absolute bottom-0 right-0 w-4 h-4 cursor-nwse-resize opacity-0 group-hover:opacity-100 transition-opacity ${c?"text-gray-400":"text-steel-600"}`,style:{background:"linear-gradient(135deg, transparent 50%, currentColor 50%)",borderBottomRightRadius:"0.75rem"}})]})},UO=({zoomEnabled:e,setZoomEnabled:t,showGutters:n,setShowGutters:i})=>{var h;const o=Qg(),a=o==null?void 0:o.zoomIn,l=o==null?void 0:o.zoomOut,c=o==null?void 0:o.resetTransform,u=((h=o==null?void 0:o.state)==null?void 0:h.scale)||1,d=v=>{if(v.preventDefault(),v.stopPropagation(),e&&c)try{c()}catch{}t(!e)};return p.jsxs("div",{className:"flex items-center gap-2 bg-ink-900 border border-ink-700 rounded-full px-4 py-1.5 shadow-xl transition-all hover:border-ink-600",children:[p.jsxs("button",{onClick:d,type:"button",className:`p-1.5 rounded-full transition-all flex items-center gap-2 px-3 ${e?"text-ember-500 bg-ember-500/10 scale-105":"text-steel-600 hover:text-steel-300"}`,title:e?"Exit Canvas Navigation":"Enter Canvas Navigation (Pan/Zoom)",children:[p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"})}),e&&p.jsx("span",{className:"text-[9px] font-mono font-bold tracking-widest uppercase",children:"NAV MODE"})]}),p.jsx("div",{className:"w-px h-4 bg-ink-700 mx-1"}),p.jsx("button",{onClick:()=>i(!n),className:`p-1.5 rounded-full transition-colors ${n?"text-ember-500 bg-ember-500/10":"text-steel-600 hover:text-steel-300"}`,title:"Toggle Comic Gutter Layout",children:p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v14a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM8 4v16M16 4v16M4 8h16M4 16h16"})})}),p.jsx("div",{className:"w-px h-4 bg-ink-700 mx-1"}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("button",{onClick:()=>l&&l(),disabled:!e,className:`transition-colors p-1 ${e?"text-steel-500 hover:text-ember-500":"text-steel-700 cursor-not-allowed"}`,title:"Zoom Out",children:p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),p.jsxs("button",{onClick:()=>c&&c(),disabled:!e,className:`text-[10px] font-mono font-bold w-12 text-center transition-colors ${e?"text-steel-300 hover:text-ember-500":"text-steel-600 cursor-not-allowed"}`,title:"Reset View (100%)",children:[Math.round(u*100),"%"]}),p.jsx("button",{onClick:()=>a&&a(),disabled:!e,className:`transition-colors p-1 ${e?"text-steel-500 hover:text-ember-500":"text-steel-700 cursor-not-allowed"}`,title:"Zoom In",children:p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]})},zO=({onClose:e,dispatch:t})=>{const[n,i]=de.useState(""),[o,a]=de.useState("comic"),l=()=>{if(!n.trim()){alert("Please enter a project title");return}t({type:"ADD_PROJECT",title:n.trim(),projectType:o}),e()};return p.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-xl flex items-center justify-center z-[600] p-8",children:p.jsxs("div",{className:"w-full max-w-md bg-ink-950 border border-ink-700 rounded-2xl shadow-2xl overflow-hidden",children:[p.jsxs("div",{className:"p-6 border-b border-ink-700 flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h2",{className:"font-display text-3xl tracking-widest text-ember-500 uppercase",children:"New Project"}),p.jsx("p",{className:"text-[10px] font-mono text-steel-500 mt-1 uppercase tracking-widest",children:"Initialize Sequence"})]}),p.jsx("button",{onClick:e,className:"w-10 h-10 flex items-center justify-center rounded-full bg-ink-800 hover:bg-red-500 text-steel-400 hover:text-white transition-all text-xl font-bold",children:""})]}),p.jsxs("div",{className:"p-6 space-y-6",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-mono text-steel-400 uppercase tracking-widest mb-2",children:"Project Title"}),p.jsx("input",{type:"text",value:n,onChange:c=>i(c.target.value),placeholder:"Enter project title...",className:"w-full bg-ink-950 border border-ink-700 rounded-lg px-4 py-3 text-sm text-steel-300 font-mono outline-none focus:border-ember-500 transition-colors",autoFocus:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-mono text-steel-400 uppercase tracking-widest mb-2",children:"Project Type"}),p.jsxs("select",{value:o,onChange:c=>a(c.target.value),className:"w-full bg-ink-950 border border-ink-700 rounded-lg px-4 py-3 text-sm text-steel-300 font-mono outline-none focus:border-ember-500 transition-colors cursor-pointer",children:[p.jsx("option",{value:"comic",children:"Comic / Graphic Novel"}),p.jsx("option",{value:"screenplay",children:"Screenplay"}),p.jsx("option",{value:"stage-play",children:"Stage Play"}),p.jsx("option",{value:"tv-series",children:"TV Series"})]})]})]}),p.jsxs("div",{className:"p-6 border-t border-ink-700 flex gap-3",children:[p.jsx("button",{onClick:e,className:"flex-1 bg-ink-800 hover:bg-ink-700 text-steel-400 hover:text-steel-300 font-bold py-3 rounded-lg uppercase text-xs transition-colors border border-ink-700",children:"Cancel"}),p.jsx("button",{onClick:l,className:"flex-1 bg-ember-500 hover:bg-ember-400 text-ink-950 font-bold py-3 rounded-lg uppercase text-xs transition-colors",children:"Create"})]})]})})},jO=({state:e,dispatch:t,onClose:n})=>{const[i,o]=de.useState(null),[a,l]=de.useState(!1),[c,u]=de.useState(""),[d,h]=de.useState(""),[v,b]=de.useState(""),[g,A]=de.useState(""),[_,C]=de.useState(""),[E,R]=de.useState("");return de.useEffect(()=>{if(i){const k=e.projects.find(M=>M.id===i);u((k==null?void 0:k.geminiApiKey)||""),h((k==null?void 0:k.leonardoApiKey)||""),b((k==null?void 0:k.grokApiKey)||""),A((k==null?void 0:k.falApiKey)||""),C((k==null?void 0:k.seaartApiKey)||""),R((k==null?void 0:k.openaiApiKey)||"")}},[i,e.projects]),p.jsxs("div",{className:"fixed inset-0 z-[500] bg-black/20 backdrop-blur-xl flex items-center justify-center p-8 animate-fade-in",children:[p.jsxs("div",{className:"max-w-5xl w-full bg-ink-950 border border-ink-700 rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[p.jsxs("div",{className:"p-10 border-b border-ink-700 flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h2",{className:"font-display text-5xl tracking-widest text-steel-100 uppercase text-center",children:"Archive"}),p.jsx("p",{className:"font-mono text-xs text-ember-500 mt-2 tracking-[0.3em] uppercase text-center",children:"Storyboard Management"})]}),p.jsx("button",{onClick:n,className:"w-12 h-12 flex items-center justify-center rounded-full bg-ink-800 hover:bg-red-500 text-steel-400 hover:text-white transition-all",children:p.jsx(ko.X,{})})]}),p.jsx("div",{className:"p-10 overflow-y-auto",children:e.projects.length===0?p.jsx("div",{className:"flex flex-col items-center justify-center py-16",children:p.jsx(ff,{variant:"projects",onAction:()=>l(!0),actionLabel:"Create First Project"})}):p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[e.projects.map(k=>{var M;return p.jsxs("div",{onClick:()=>{t({type:"SET_ACTIVE_PROJECT",id:k.id}),n()},className:`p-8 rounded-2xl border-2 cursor-pointer transition-all group relative overflow-hidden flex flex-col ${e.activeProjectId===k.id?"border-ember-500 bg-ember-500/5 ring-4 ring-ember-500/10":"border-ink-700 hover:border-steel-500 bg-ink-950/50"}`,children:[p.jsxs("div",{className:"relative z-10 flex-1",children:[p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsx("h3",{className:"font-display text-3xl text-steel-100 group-hover:text-ember-500 transition-colors mb-2 uppercase truncate pr-4",children:k.title}),p.jsx("button",{onClick:P=>{P.stopPropagation(),o(k.id===i?null:k.id)},className:`p-2 rounded-full border transition-all flex-shrink-0 ${i===k.id?"bg-ember-500 text-ink-950 border-ember-500":"bg-ink-800 text-steel-500 border-ink-700 hover:border-ember-500/50"}`,children:p.jsx(ko.Edit,{})})]}),p.jsxs("div",{className:"flex items-center gap-4 text-[10px] font-mono text-steel-500 uppercase tracking-widest",children:[p.jsxs("span",{children:[k.issues.reduce((P,W)=>P+W.pages.length,0)," Pages"]}),p.jsx("div",{className:"w-1 h-1 rounded-full bg-steel-700"}),p.jsxs("span",{children:[((M=k==null?void 0:k.characters)==null?void 0:M.length)||0," Cast"]})]})]}),p.jsxs("div",{className:"mt-6 flex justify-between items-center relative z-10",children:[p.jsx("span",{className:`text-[10px] font-mono px-3 py-1 rounded-full border uppercase ${k.imageProvider==="gemini"?"bg-blue-600/20 text-blue-400 border-blue-600/50":k.imageProvider==="leonardo"?"bg-orange-600/20 text-orange-400 border-orange-600/50":k.imageProvider==="grok"?"bg-gray-600/20 text-gray-400 border-gray-600/50":k.imageProvider==="fal"?"bg-ember-500/20 text-ember-400 border-ember-500/50":k.imageProvider==="seaart"?"bg-pink-600/20 text-pink-400 border-pink-600/50":k.imageProvider==="openai"?"bg-green-600/20 text-green-400 border-green-600/50":"bg-ink-800 text-steel-600 border-ink-700"}`,children:k.imageProvider}),p.jsx("button",{onClick:P=>{P.stopPropagation(),confirm("Delete Project?")&&t({type:"DELETE_PROJECT",id:k.id})},className:"w-8 h-8 flex items-center justify-center rounded-full text-steel-700 hover:text-red-500 hover:bg-red-500/10 transition-all",children:p.jsx(ko.Trash,{})})]}),i===k.id&&p.jsxs("div",{onClick:P=>P.stopPropagation(),className:"mt-6 p-4 bg-ink-950 rounded-xl border border-ink-700 space-y-4 animate-fade-in shadow-2xl",children:[p.jsxs("div",{children:[p.jsx("label",{className:"text-[9px] font-mono text-steel-500 uppercase block mb-2",children:"Image Provider"}),p.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[p.jsx("button",{onClick:()=>t({type:"UPDATE_PROJECT",id:k.id,updates:{imageProvider:"gemini"}}),className:`text-[10px] font-mono py-2 rounded-lg border transition-all ${k.imageProvider==="gemini"?"bg-blue-600 text-white border-blue-500 font-bold":"bg-ink-900 text-steel-500 border-ink-700 hover:border-blue-600/50"}`,children:"GEMINI"}),p.jsx("button",{onClick:()=>t({type:"UPDATE_PROJECT",id:k.id,updates:{imageProvider:"leonardo"}}),className:`text-[10px] font-mono py-2 rounded-lg border transition-all ${k.imageProvider==="leonardo"?"bg-orange-600 text-white border-orange-500 font-bold":"bg-ink-900 text-steel-500 border-ink-700 hover:border-orange-600/50"}`,children:"LEONARDO"}),p.jsx("button",{onClick:()=>t({type:"UPDATE_PROJECT",id:k.id,updates:{imageProvider:"grok"}}),className:`text-[10px] font-mono py-2 rounded-lg border transition-all ${k.imageProvider==="grok"?"bg-gray-600 text-white border-gray-500 font-bold":"bg-ink-900 text-steel-500 border-ink-700 hover:border-gray-600/50"}`,children:"GROK"}),p.jsx("button",{onClick:()=>t({type:"UPDATE_PROJECT",id:k.id,updates:{imageProvider:"fal"}}),className:`text-[10px] font-mono py-2 rounded-lg border transition-all ${k.imageProvider==="fal"?"bg-ember-500 text-ink-950 border-ember-400 font-bold":"bg-ink-900 text-steel-500 border-ink-700 hover:border-ember-500/50"}`,children:"FAL"})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mt-1.5",children:[p.jsx("button",{onClick:()=>t({type:"UPDATE_PROJECT",id:k.id,updates:{imageProvider:"seaart"}}),className:`text-[10px] font-mono py-2 rounded-lg border transition-all ${k.imageProvider==="seaart"?"bg-pink-600 text-white border-pink-500 font-bold":"bg-ink-900 text-steel-500 border-ink-700 hover:border-pink-600/50"}`,children:"SEAART"}),p.jsx("button",{onClick:()=>t({type:"UPDATE_PROJECT",id:k.id,updates:{imageProvider:"openai"}}),className:`text-[10px] font-mono py-2 rounded-lg border transition-all ${k.imageProvider==="openai"?"bg-green-600 text-white border-green-500 font-bold":"bg-ink-900 text-steel-500 border-ink-700 hover:border-green-600/50"}`,children:"OPENAI"})]})]}),p.jsxs("div",{className:"mt-3 p-3 bg-ink-800 rounded-lg border border-ink-700 space-y-2",children:[p.jsxs("label",{className:"block text-[9px] font-mono text-steel-400 uppercase mb-1",children:[k.imageProvider==="gemini"?"Gemini":k.imageProvider==="leonardo"?"Leonardo":k.imageProvider==="grok"?"Grok (xAI)":k.imageProvider==="fal"?"FAL":k.imageProvider==="seaart"?"SeaArt":k.imageProvider==="openai"?"OpenAI":""," API Key"]}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{type:"password",placeholder:"Enter API key...",value:k.imageProvider==="gemini"?c:k.imageProvider==="leonardo"?d:k.imageProvider==="grok"?v:k.imageProvider==="fal"?g:k.imageProvider==="seaart"?_:k.imageProvider==="openai"?E:"",onChange:P=>{k.imageProvider==="gemini"?u(P.target.value):k.imageProvider==="leonardo"?h(P.target.value):k.imageProvider==="grok"?b(P.target.value):k.imageProvider==="fal"?A(P.target.value):k.imageProvider==="seaart"?C(P.target.value):k.imageProvider==="openai"&&R(P.target.value)},className:"flex-1 bg-ink-900 border border-ink-700 rounded-lg px-3 py-2 text-xs text-steel-300 font-mono outline-none focus:border-ember-500"}),p.jsx("button",{onClick:()=>{k.imageProvider==="gemini"&&c.trim()?(t({type:"UPDATE_PROJECT_GEMINI_KEY",projectId:k.id,apiKey:c.trim()}),alert("Gemini Key saved!")):k.imageProvider==="leonardo"&&d.trim()?(t({type:"UPDATE_PROJECT_LEONARDO_KEY",projectId:k.id,apiKey:d.trim()}),alert("Leonardo Key saved!")):k.imageProvider==="grok"&&v.trim()?(t({type:"UPDATE_PROJECT_GROK_KEY",projectId:k.id,apiKey:v.trim()}),alert("Grok Key saved!")):k.imageProvider==="fal"&&g.trim()?(t({type:"UPDATE_PROJECT_FAL_KEY",projectId:k.id,apiKey:g.trim()}),alert("FAL Key saved!")):k.imageProvider==="seaart"&&_.trim()?(t({type:"UPDATE_PROJECT_SEAART_KEY",projectId:k.id,apiKey:_.trim()}),alert("SeaArt Key saved!")):k.imageProvider==="openai"&&E.trim()&&(t({type:"UPDATE_PROJECT_OPENAI_KEY",projectId:k.id,apiKey:E.trim()}),alert("OpenAI Key saved!"))},className:"bg-ember-500 hover:bg-ember-400 text-ink-950 font-bold px-4 py-2 rounded-lg uppercase text-[9px] transition-colors",children:"Save"})]}),k.imageProvider==="gemini"?p.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-[8px] text-steel-600 italic hover:underline hover:text-steel-400 cursor-pointer transition-colors mt-1 block",children:"Get key from ai.google.dev"}):k.imageProvider==="leonardo"?p.jsx("a",{href:"https://leonardo.ai/settings",target:"_blank",rel:"noopener noreferrer",className:"text-[8px] text-steel-600 italic hover:underline hover:text-steel-400 cursor-pointer transition-colors mt-1 block",children:"Get key from leonardo.ai"}):k.imageProvider==="grok"?p.jsx("a",{href:"https://console.x.ai",target:"_blank",rel:"noopener noreferrer",className:"text-[8px] text-steel-600 italic hover:underline hover:text-steel-400 cursor-pointer transition-colors mt-1 block",children:"Get key from console.x.ai (experimental)"}):k.imageProvider==="fal"?p.jsx("a",{href:"https://fal.ai/dashboard/keys",target:"_blank",rel:"noopener noreferrer",className:"text-[8px] text-steel-600 italic hover:underline hover:text-steel-400 cursor-pointer transition-colors mt-1 block",children:"Get key from fal.ai"}):k.imageProvider==="seaart"?p.jsx("a",{href:"https://seaart.ai/api",target:"_blank",rel:"noopener noreferrer",className:"text-[8px] text-steel-600 italic hover:underline hover:text-steel-400 cursor-pointer transition-colors mt-1 block",children:"Get key from seaart.ai/api"}):k.imageProvider==="openai"?p.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-[8px] text-steel-600 italic hover:underline hover:text-steel-400 cursor-pointer transition-colors mt-1 block",children:"Get key from platform.openai.com"}):null]})]})]},k.id)}),p.jsxs("button",{onClick:()=>l(!0),className:"p-8 rounded-2xl border-2 border-dashed border-ink-700 hover:border-ember-500 hover:bg-ember-500/5 flex flex-col items-center justify-center gap-6 text-steel-500 hover:text-ember-500 transition-all group min-h-[220px]",children:[p.jsx("div",{className:"w-16 h-16 rounded-full border-2 border-dashed border-steel-800 flex items-center justify-center group-hover:scale-110 transition-transform",children:p.jsx(ko.Plus,{})}),p.jsx("span",{className:"font-display text-2xl uppercase tracking-widest text-center",children:"Initialize Sequence"})]})]})})]}),a&&p.jsx(zO,{onClose:()=>l(!1),dispatch:t})]})},Ig={age:"",gender:"",ethnicity:"",height:"",build:"",hairColor:"",hairStyle:"",eyeColor:"",skinTone:"",facialFeatures:"",distinguishingMarks:"",clothing:"",accessories:"",additionalNotes:""},Bm={name:"",description:"",appearance:{...Ig}};function FO({characters:e,dispatch:t,onClose:n}){const[i,o]=de.useState(null),[a,l]=de.useState(!1),[c,u]=de.useState(null),[d,h]=de.useState({...Bm}),v=()=>{l(!0),o(null),h({...Bm})},b=E=>{o(E.id),l(!1),h({name:E.name,description:E.description||"",appearance:E.appearance?{...Ig,...E.appearance}:{...Ig}})},g=()=>{l(!1),o(null),h({...Bm})},A=()=>{if(!d.name.trim())return;const E=BO(d.appearance),R=d.description.trim()||E;a?t({type:"ADD_CHARACTER",name:d.name.trim(),description:R,appearance:d.appearance}):i&&t({type:"UPDATE_CHARACTER",id:i,updates:{name:d.name.trim(),description:R,appearance:d.appearance}}),g()},_=E=>{confirm("Delete this character? They will be unlinked from all panels.")&&t({type:"DELETE_CHARACTER",id:E})},C=(E,R)=>{h(k=>({...k,appearance:{...k.appearance,[E]:R}}))};return p.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-[600] flex items-center justify-center p-4",children:p.jsxs("div",{className:"bg-ink-950 border border-ink-800 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[85vh] flex flex-col",children:[p.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-ink-800",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(Yu,{size:20,className:"text-ember-500"}),p.jsx("h2",{className:"font-mono text-sm uppercase tracking-widest text-steel-200",children:"Character Bank"})]}),p.jsx("button",{onClick:n,className:"p-2 hover:bg-ink-800 rounded-lg text-steel-400 hover:text-steel-200 transition-colors",children:p.jsx(Vs,{size:18})})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[!a&&!i&&p.jsxs("button",{onClick:v,className:"w-full py-3 border-2 border-dashed border-ink-700 rounded-xl text-steel-500 hover:text-ember-500 hover:border-ember-500 transition-colors flex items-center justify-center gap-2 font-mono text-sm",children:[p.jsx($u,{size:16}),"Add New Character"]}),(a||i)&&p.jsxs("div",{className:"bg-ink-900 border border-ink-700 rounded-xl p-4 space-y-4",children:[p.jsx("h3",{className:"font-mono text-xs uppercase tracking-widest text-ember-500 mb-3",children:a?"New Character":"Edit Character"}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-mono text-steel-500 uppercase mb-1",children:"Name *"}),p.jsx("input",{type:"text",value:d.name,onChange:E=>h(R=>({...R,name:E.target.value})),placeholder:"e.g., Elias",className:"w-full px-3 py-2 bg-ink-950 border border-ink-700 rounded-lg text-steel-200 text-sm placeholder:text-steel-700 focus:outline-none focus:border-ember-500"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-mono text-steel-500 uppercase mb-1",children:"Quick Description"}),p.jsx("input",{type:"text",value:d.description,onChange:E=>h(R=>({...R,description:E.target.value})),placeholder:"e.g., The protagonist",className:"w-full px-3 py-2 bg-ink-950 border border-ink-700 rounded-lg text-steel-200 text-sm placeholder:text-steel-700 focus:outline-none focus:border-ember-500"})]})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsx("p",{className:"text-[10px] font-mono text-steel-500 uppercase",children:"Physical Appearance"}),p.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[p.jsx(oo,{label:"Age",value:d.appearance.age||"",onChange:E=>C("age",E),placeholder:"e.g., mid-20s"}),p.jsx(oo,{label:"Gender",value:d.appearance.gender||"",onChange:E=>C("gender",E),placeholder:"e.g., male"}),p.jsx(oo,{label:"Ethnicity",value:d.appearance.ethnicity||"",onChange:E=>C("ethnicity",E),placeholder:"e.g., East Asian"})]}),p.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[p.jsx(oo,{label:"Height",value:d.appearance.height||"",onChange:E=>C("height",E),placeholder:"e.g., tall"}),p.jsx(oo,{label:"Build",value:d.appearance.build||"",onChange:E=>C("build",E),placeholder:"e.g., skinny"}),p.jsx(oo,{label:"Skin Tone",value:d.appearance.skinTone||"",onChange:E=>C("skinTone",E),placeholder:"e.g., olive"})]}),p.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[p.jsx(oo,{label:"Hair Color",value:d.appearance.hairColor||"",onChange:E=>C("hairColor",E),placeholder:"e.g., red"}),p.jsx(oo,{label:"Hair Style",value:d.appearance.hairStyle||"",onChange:E=>C("hairStyle",E),placeholder:"e.g., messy, short"}),p.jsx(oo,{label:"Eye Color",value:d.appearance.eyeColor||"",onChange:E=>C("eyeColor",E),placeholder:"e.g., green"})]}),p.jsx(oo,{label:"Facial Features",value:d.appearance.facialFeatures||"",onChange:E=>C("facialFeatures",E),placeholder:"e.g., sharp jawline, freckles, scar on left cheek"}),p.jsx(oo,{label:"Distinguishing Marks",value:d.appearance.distinguishingMarks||"",onChange:E=>C("distinguishingMarks",E),placeholder:"e.g., tattoo on forearm, birthmark"}),p.jsx(oo,{label:"Typical Clothing",value:d.appearance.clothing||"",onChange:E=>C("clothing",E),placeholder:"e.g., worn leather jacket, dark jeans"}),p.jsx(oo,{label:"Accessories",value:d.appearance.accessories||"",onChange:E=>C("accessories",E),placeholder:"e.g., silver ring, glasses"}),p.jsx(oo,{label:"Additional Notes",value:d.appearance.additionalNotes||"",onChange:E=>C("additionalNotes",E),placeholder:"e.g., always looks tired, nervous energy"})]}),p.jsxs("div",{className:"flex gap-2 pt-2",children:[p.jsx("button",{onClick:g,className:"px-4 py-2 text-steel-400 hover:text-steel-200 font-mono text-xs uppercase tracking-widest transition-colors",children:"Cancel"}),p.jsxs("button",{onClick:A,disabled:!d.name.trim(),className:"flex-1 py-2 bg-ember-500 hover:bg-ember-400 text-ink-950 rounded-lg font-mono text-xs uppercase tracking-widest flex items-center justify-center gap-2 transition-colors disabled:opacity-50",children:[p.jsx(Fg,{size:14}),"Save Character"]})]})]}),e.length===0&&!a?p.jsx("div",{className:"py-4",children:p.jsx(ff,{variant:"characters",onAction:v,actionLabel:"Add First Character"})}):p.jsx("div",{className:"space-y-2",children:e.map(E=>p.jsxs("div",{className:`bg-ink-900 border rounded-xl overflow-hidden transition-colors ${i===E.id?"border-ember-500":"border-ink-700"}`,children:[p.jsxs("div",{className:"flex items-center gap-3 p-3",children:[p.jsx("div",{className:"w-10 h-10 rounded-full bg-ink-800 flex items-center justify-center text-ember-500 font-bold text-lg",children:E.name.charAt(0).toUpperCase()}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("p",{className:"font-bold text-steel-200 truncate",children:E.name}),p.jsx("p",{className:"text-xs text-steel-500 truncate",children:E.description||"No description"})]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("button",{onClick:()=>u(c===E.id?null:E.id),className:"p-2 text-steel-500 hover:text-steel-200 transition-colors",title:"View details",children:c===E.id?p.jsx(tw,{size:16}):p.jsx(Wd,{size:16})}),p.jsx("button",{onClick:()=>b(E),className:"p-2 text-steel-500 hover:text-ember-500 transition-colors",title:"Edit",children:p.jsx(lw,{size:16})}),p.jsx("button",{onClick:()=>_(E.id),className:"p-2 text-steel-500 hover:text-red-500 transition-colors",title:"Delete",children:p.jsx(Tc,{size:16})})]})]}),c===E.id&&E.appearance&&p.jsx("div",{className:"px-3 pb-3 pt-0",children:p.jsxs("div",{className:"bg-ink-950 rounded-lg p-3 text-xs space-y-1",children:[p.jsx("p",{className:"font-mono text-[10px] text-steel-600 uppercase mb-2",children:"Appearance Details"}),E.appearance.age&&p.jsx(ao,{label:"Age",value:E.appearance.age}),E.appearance.gender&&p.jsx(ao,{label:"Gender",value:E.appearance.gender}),E.appearance.ethnicity&&p.jsx(ao,{label:"Ethnicity",value:E.appearance.ethnicity}),E.appearance.height&&p.jsx(ao,{label:"Height",value:E.appearance.height}),E.appearance.build&&p.jsx(ao,{label:"Build",value:E.appearance.build}),E.appearance.skinTone&&p.jsx(ao,{label:"Skin Tone",value:E.appearance.skinTone}),E.appearance.hairColor&&p.jsx(ao,{label:"Hair Color",value:E.appearance.hairColor}),E.appearance.hairStyle&&p.jsx(ao,{label:"Hair Style",value:E.appearance.hairStyle}),E.appearance.eyeColor&&p.jsx(ao,{label:"Eye Color",value:E.appearance.eyeColor}),E.appearance.facialFeatures&&p.jsx(ao,{label:"Facial Features",value:E.appearance.facialFeatures}),E.appearance.distinguishingMarks&&p.jsx(ao,{label:"Marks",value:E.appearance.distinguishingMarks}),E.appearance.clothing&&p.jsx(ao,{label:"Clothing",value:E.appearance.clothing}),E.appearance.accessories&&p.jsx(ao,{label:"Accessories",value:E.appearance.accessories}),E.appearance.additionalNotes&&p.jsx(ao,{label:"Notes",value:E.appearance.additionalNotes})]})})]},E.id))})]}),p.jsx("div",{className:"p-4 border-t border-ink-800",children:p.jsxs("p",{className:"text-[10px] text-steel-600 font-mono text-center",children:[e.length," character",e.length!==1?"s":"","  Character appearances are included in image generation prompts"]})})]})})}function oo({label:e,value:t,onChange:n,placeholder:i}){return p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-mono text-steel-600 uppercase mb-1",children:e}),p.jsx("input",{type:"text",value:t,onChange:o=>n(o.target.value),placeholder:i,className:"w-full px-2 py-1.5 bg-ink-950 border border-ink-700 rounded text-steel-300 text-xs placeholder:text-steel-700 focus:outline-none focus:border-ember-500"})]})}function ao({label:e,value:t}){return p.jsxs("div",{className:"flex",children:[p.jsxs("span",{className:"text-steel-600 w-24 flex-shrink-0",children:[e,":"]}),p.jsx("span",{className:"text-steel-300",children:t})]})}function BO(e){const t=[];return e.age&&t.push(e.age),e.gender&&t.push(e.gender),e.ethnicity&&t.push(e.ethnicity),e.build&&t.push(e.build),e.height&&t.push(e.height),e.hairColor&&e.hairStyle?t.push(`${e.hairColor} ${e.hairStyle} hair`):e.hairColor?t.push(`${e.hairColor} hair`):e.hairStyle&&t.push(`${e.hairStyle} hair`),e.eyeColor&&t.push(`${e.eyeColor} eyes`),t.join(", ")}const qO=({showGutters:e})=>p.jsx("div",{className:`flex-1 overflow-y-auto ${e?"bg-gray-100":"bg-ink-900"}`,children:p.jsx("div",{className:"max-w-5xl mx-auto px-8 py-12",children:p.jsxs("div",{className:`${e?"text-gray-900":"text-steel-100"}`,children:[p.jsxs("div",{className:"mb-12",children:[p.jsx("h1",{className:`font-display text-6xl uppercase tracking-tighter mb-4 ${e?"text-black":"text-steel-100"}`,children:"How to Use"}),p.jsx("p",{className:`text-lg font-mono ${e?"text-gray-600":"text-steel-400"}`,children:"A comprehensive guide to mastering Ink Tracker"})]}),p.jsxs("section",{className:"mb-12",children:[p.jsx("h2",{className:`font-mono text-2xl uppercase tracking-wider mb-6 ${e?"text-black":"text-ember-400"}`,children:"Getting Started"}),p.jsxs("div",{className:`space-y-4 ${e?"text-gray-800":"text-steel-300"}`,children:[p.jsxs("div",{className:"mb-6",children:[p.jsx("h3",{className:`font-mono text-lg uppercase tracking-wide mb-2 ${e?"text-gray-900":"text-steel-200"}`,children:"Create a Project"}),p.jsx("p",{children:'Click the folder icon next to "Story" in the sidebar to open the Archive (Project Hub). Click "Initialize Sequence" to create a new project with a title.'})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("h3",{className:`font-mono text-lg uppercase tracking-wide mb-2 ${e?"text-gray-900":"text-steel-200"}`,children:"Set Up Image Generation"}),p.jsx("p",{children:"In the sidebar, select your preferred AI image provider (Gemini, Leonardo, Grok, FAL, or SeaArt) and enter your API key."})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("h3",{className:`font-mono text-lg uppercase tracking-wide mb-2 ${e?"text-gray-900":"text-steel-200"}`,children:"Build Your Story"}),p.jsx("p",{children:'Create issues/chapters in the sidebar, add pages to each issue, and add panel frames to each page using the "ADD FRAME" button.'})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("h3",{className:`font-mono text-lg uppercase tracking-wide mb-2 ${e?"text-gray-900":"text-steel-200"}`,children:"Generate Art"}),p.jsx("p",{children:'Write panel descriptions, assign characters, and click the "Generate" button on each panel or use "AUTO-INK" to generate all panels at once.'})]})]})]}),p.jsxs("section",{className:"mb-12",children:[p.jsx("h2",{className:`font-mono text-2xl uppercase tracking-wider mb-6 ${e?"text-black":"text-ember-400"}`,children:"Core Features"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[p.jsx(Iu,{icon:p.jsx(Ug,{size:24}),title:"Script Import",description:"Import existing comic scripts in markdown format. The parser automatically creates pages and panels from your script.",showGutters:e}),p.jsx(Iu,{icon:p.jsx(Ys,{size:24}),title:"Character Tracker",description:"Create detailed character profiles with physical appearances. Characters are automatically included in panel prompts for consistency.",showGutters:e}),p.jsx(Iu,{icon:p.jsx(bp,{size:24}),title:"Art Styles",description:"Choose from curated art style presets like Film Noir, Superhero, Horror, or create your own custom style prompt.",showGutters:e}),p.jsx(Iu,{icon:p.jsx(Og,{size:24}),title:"Panel Linking",description:"Link panels together for visual consistency. Reference previous panels to maintain character appearances and scene continuity.",showGutters:e}),p.jsx(Iu,{icon:p.jsx(aw,{size:24}),title:"Text Elements",description:"Add dialogue bubbles, thought clouds, captions, and phone messages to your panels with adjustable positioning and styling.",showGutters:e}),p.jsx(Iu,{icon:p.jsx(WA,{size:24}),title:"Page Templates",description:"Apply pre-built layouts like 22 Grid, Manga style, or Single Splash to quickly set up your pages.",showGutters:e})]})]}),p.jsxs("section",{className:"mb-12",children:[p.jsx("h2",{className:`font-mono text-2xl uppercase tracking-wider mb-6 ${e?"text-black":"text-ember-400"}`,children:"Canvas Controls"}),p.jsx("div",{className:`rounded-2xl overflow-hidden border ${e?"bg-white border-gray-300":"bg-ink-800 border-ink-700"}`,children:p.jsxs("table",{className:"w-full",children:[p.jsx("thead",{className:`${e?"bg-gray-100":"bg-ink-900"}`,children:p.jsxs("tr",{children:[p.jsx("th",{className:`font-mono text-xs uppercase tracking-wider px-6 py-3 text-left ${e?"text-gray-700":"text-steel-400"}`,children:"Action"}),p.jsx("th",{className:`font-mono text-xs uppercase tracking-wider px-6 py-3 text-left ${e?"text-gray-700":"text-steel-400"}`,children:"How To"})]})}),p.jsxs("tbody",{children:[p.jsx(To,{showGutters:e,action:"Add Panel",howTo:'Click "ADD FRAME" button in header'}),p.jsx(To,{showGutters:e,action:"Move Panel",howTo:"Click and drag the panel move handle"}),p.jsx(To,{showGutters:e,action:"Resize Panel",howTo:"Drag the bottom-right corner of panel"}),p.jsx(To,{showGutters:e,action:"Pan Canvas",howTo:'Enable "NAV MODE" and drag canvas'}),p.jsx(To,{showGutters:e,action:"Apply Layout",howTo:'Click "TEMPLATES" and select a layout'}),p.jsx(To,{showGutters:e,action:"Toggle Appearance",howTo:'Click "GUTTERS" for light mode toggle'})]})]})})]}),p.jsxs("section",{className:"mb-12",children:[p.jsx("h2",{className:`font-mono text-2xl uppercase tracking-wider mb-6 ${e?"text-black":"text-ember-400"}`,children:"Export Options"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.jsx(zh,{icon:p.jsx(Pl,{size:20}),title:"ZIP Page Images",description:"Download all panel images from the current page as a ZIP archive",showGutters:e}),p.jsx(zh,{icon:p.jsx(Pl,{size:20}),title:"CBZ Issue",description:"Export entire issue as a CBZ comic archive format, compatible with most comic reader apps",showGutters:e}),p.jsx(zh,{icon:p.jsx(Pl,{size:20}),title:"PDF Page",description:"Export current page panels as a PDF document",showGutters:e}),p.jsx(zh,{icon:p.jsx(Pl,{size:20}),title:"PDF Issue",description:"Export entire issue as a comprehensive PDF",showGutters:e})]})]}),p.jsxs("section",{className:"mb-12",children:[p.jsx("h2",{className:`font-mono text-2xl uppercase tracking-wider mb-6 ${e?"text-black":"text-ember-400"}`,children:"Keyboard Shortcuts"}),p.jsx("div",{className:`rounded-2xl overflow-hidden border ${e?"bg-white border-gray-300":"bg-ink-800 border-ink-700"}`,children:p.jsxs("table",{className:"w-full",children:[p.jsx("thead",{className:`${e?"bg-gray-100":"bg-ink-900"}`,children:p.jsxs("tr",{children:[p.jsx("th",{className:`font-mono text-xs uppercase tracking-wider px-6 py-3 text-left ${e?"text-gray-700":"text-steel-400"}`,children:"Shortcut"}),p.jsx("th",{className:`font-mono text-xs uppercase tracking-wider px-6 py-3 text-left ${e?"text-gray-700":"text-steel-400"}`,children:"Action"})]})}),p.jsxs("tbody",{children:[p.jsx(To,{showGutters:e,action:"Ctrl+Z / Cmd+Z",howTo:"Undo last action"}),p.jsx(To,{showGutters:e,action:"Ctrl+Y / Cmd+Shift+Z",howTo:"Redo last undone action"}),p.jsx(To,{showGutters:e,action:" / ",howTo:"Navigate to previous panel"}),p.jsx(To,{showGutters:e,action:" / ",howTo:"Navigate to next panel"}),p.jsx(To,{showGutters:e,action:"Delete",howTo:"Delete selected panel"}),p.jsx(To,{showGutters:e,action:"Escape",howTo:"Deselect panel / Exit presentation"}),p.jsx(To,{showGutters:e,action:"Space (in presentation)",howTo:"Advance to next panel"})]})]})})]}),p.jsxs("section",{className:"mb-12",children:[p.jsx("h2",{className:`font-mono text-2xl uppercase tracking-wider mb-6 ${e?"text-black":"text-ember-400"}`,children:"Tips"}),p.jsxs("div",{className:`space-y-4 ${e?"text-gray-800":"text-steel-300"}`,children:[p.jsx(jh,{title:"Use Reference Panels",description:"Link subsequent panels to an initial establishing shot for visual consistency. Adjust the consistency strength slider based on how much variation you want.",showGutters:e}),p.jsx(jh,{title:"Build Your Cast First",description:"Create detailed character profiles before generating panels. The more detail you provide, the more consistent your character appearances will be.",showGutters:e}),p.jsx(jh,{title:"Export Regularly",description:"Don't rely solely on browser storage. Export your work as CBZ or PDF regularly to avoid data loss.",showGutters:e}),p.jsx(jh,{title:"Experiment with Custom Styles",description:"Create your own art style prompts by combining techniques, color palettes, and artist influences for unique results.",showGutters:e})]})]}),p.jsxs("section",{className:"mb-12",children:[p.jsx("h2",{className:`font-mono text-2xl uppercase tracking-wider mb-6 ${e?"text-black":"text-ember-400"}`,children:"Storage"}),p.jsxs("div",{className:`p-6 rounded-2xl border ${e?"bg-white border-gray-300":"bg-ink-800 border-ink-700"}`,children:[p.jsx("p",{className:`mb-4 ${e?"text-gray-800":"text-steel-300"}`,children:"Ink Tracker stores your projects and data locally in your browser using two mechanisms:"}),p.jsxs("ul",{className:`space-y-2 ml-6 list-disc ${e?"text-gray-800":"text-steel-300"}`,children:[p.jsxs("li",{children:[p.jsx("span",{className:"font-mono",children:"localStorage"})," - Stores project metadata, pages, and panel information"]}),p.jsxs("li",{children:[p.jsx("span",{className:"font-mono",children:"IndexedDB"})," - Stores generated images for better performance"]})]}),p.jsx("p",{className:`mt-4 ${e?"text-gray-700":"text-steel-400"} text-sm`,children:"Note: Clearing your browser data will delete all projects and images. Always export important work."})]})]})]})})}),Iu=({icon:e,title:t,description:n,showGutters:i})=>p.jsxs("div",{className:`p-6 rounded-2xl border ${i?"bg-white border-gray-300":"bg-ink-800 border-ink-700"}`,children:[p.jsx("div",{className:`mb-3 ${i?"text-gray-900":"text-ember-400"}`,children:e}),p.jsx("h3",{className:`font-mono text-sm uppercase tracking-wider mb-2 ${i?"text-gray-900":"text-steel-200"}`,children:t}),p.jsx("p",{className:`text-sm ${i?"text-gray-700":"text-steel-400"}`,children:n})]}),zh=({icon:e,title:t,description:n,showGutters:i})=>p.jsx("div",{className:`p-4 rounded-xl border ${i?"bg-white border-gray-300":"bg-ink-800 border-ink-700"}`,children:p.jsxs("div",{className:"flex items-start gap-3",children:[p.jsx("div",{className:`mt-1 ${i?"text-gray-900":"text-ember-400"}`,children:e}),p.jsxs("div",{children:[p.jsx("h3",{className:`font-mono text-sm uppercase tracking-wide mb-1 ${i?"text-gray-900":"text-steel-200"}`,children:t}),p.jsx("p",{className:`text-xs ${i?"text-gray-700":"text-steel-400"}`,children:n})]})]})}),To=({showGutters:e,action:t,howTo:n})=>p.jsxs("tr",{className:`border-t ${e?"border-gray-200":"border-ink-700"}`,children:[p.jsx("td",{className:`px-6 py-3 font-mono text-sm ${e?"text-gray-900":"text-steel-200"}`,children:t}),p.jsx("td",{className:`px-6 py-3 text-sm ${e?"text-gray-700":"text-steel-400"}`,children:n})]}),jh=({title:e,description:t,showGutters:n})=>p.jsxs("div",{className:`p-4 rounded-xl border ${n?"bg-white border-gray-300":"bg-ink-800 border-ink-700"}`,children:[p.jsx("h3",{className:`font-mono text-sm uppercase tracking-wide mb-2 ${n?"text-gray-900":"text-steel-200"}`,children:e}),p.jsx("p",{className:`text-sm ${n?"text-gray-700":"text-steel-400"}`,children:t})]});function HO(e){const t=[],n=[...e.pages].sort((i,o)=>i.number-o.number);for(const i of n)i.panels.forEach((o,a)=>{t.push({panel:o,pageNumber:i.number,panelIndexInPage:a+1,totalPanelsInPage:i.panels.length})});return t}const GO=({issue:e,onClose:t,textOverlayStyle:n="opaque"})=>{const i=kn.useMemo(()=>HO(e),[e]),[o,a]=de.useState(0),[l,c]=de.useState(!1),[u,d]=de.useState(!1),[h,v]=de.useState(3),[b,g]=de.useState(!0),[A,_]=de.useState(!1),[C,E]=de.useState(1),[R,k]=de.useState(0),[M,P]=de.useState(!0),W=de.useRef(Date.now()),V=de.useRef(null),$=de.useCallback(()=>{var Ie;if(A)return;const Y=o+1;if(Y>=i.length)return;const le=(Ie=i[o])==null?void 0:Ie.pageNumber,pe=i[Y].pageNumber;P(!1),le!==pe&&o>0?setTimeout(()=>{_(!0),E(pe),setTimeout(()=>{_(!1),a(Y),k(G=>G+1),requestAnimationFrame(()=>P(!0))},700)},300):setTimeout(()=>{a(Y),k(G=>G+1),requestAnimationFrame(()=>P(!0))},300)},[o,i,A]),j=de.useCallback(()=>{if(A)return;const Y=o-1;Y<0||(P(!1),setTimeout(()=>{a(Y),k(le=>le+1),requestAnimationFrame(()=>P(!0))},300))},[o,A]);if(de.useEffect(()=>{const Y=le=>{if(!(le.target instanceof HTMLInputElement||le.target instanceof HTMLTextAreaElement))switch(le.key){case"Escape":le.preventDefault(),le.stopPropagation(),t();break;case"ArrowLeft":le.preventDefault(),le.stopPropagation(),j();break;case"ArrowRight":le.preventDefault(),le.stopPropagation(),$();break;case" ":le.preventDefault(),le.stopPropagation(),d(pe=>!pe);break;case"t":case"T":le.preventDefault(),le.stopPropagation(),c(pe=>!pe);break}};return window.addEventListener("keydown",Y,!0),()=>window.removeEventListener("keydown",Y,!0)},[t,$,j]),de.useEffect(()=>{if(!u||A)return;const Y=setTimeout(()=>{$()},h*1e3);return()=>clearTimeout(Y)},[u,h,o,A,$]),de.useEffect(()=>{const Y=()=>{W.current=Date.now(),g(!0)};return window.addEventListener("mousemove",Y),()=>window.removeEventListener("mousemove",Y)},[]),de.useEffect(()=>{const Y=()=>{Date.now()-W.current>=3e3&&g(!1),V.current=setTimeout(Y,1e3)};return V.current=setTimeout(Y,3e3),()=>{V.current&&clearTimeout(V.current)}},[]),i.length===0)return p.jsxs("div",{className:"fixed inset-0 bg-ink-950 z-[9999] flex items-center justify-center",children:[p.jsx("p",{className:"text-steel-400 font-mono text-lg",children:"No panels to present."}),p.jsx("button",{onClick:t,className:"absolute top-6 right-6 p-3 bg-ink-900/80 hover:bg-ink-800 rounded-full text-steel-300 transition-colors",children:p.jsx(Vs,{size:24})})]});const X=i[o];if(!X)return null;const{panel:z,pageNumber:U,panelIndexInPage:q,totalPanelsInPage:I}=X,ie=i.length,J=ie<=1?100:o/(ie-1)*100;return p.jsxs("div",{className:"fixed inset-0 bg-ink-950 z-[9999] flex items-center justify-center select-none",style:{isolation:"isolate"},children:[p.jsx("button",{onClick:t,className:"absolute top-6 right-6 p-3 bg-ink-900/80 hover:bg-ink-800 rounded-full text-steel-300 transition-colors z-[10001] backdrop-blur-sm",title:"Exit presentation (Escape)",children:p.jsx(Vs,{size:24})}),A&&p.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-[10000] bg-ink-950 animate-fade-in",children:p.jsxs("div",{className:"text-center",children:[p.jsx("p",{className:"text-steel-600 text-sm font-mono uppercase tracking-widest mb-2",children:"Turning to"}),p.jsxs("p",{className:"text-steel-200 text-5xl font-display tracking-wider",children:["Page ",C]})]})}),!A&&p.jsx("div",{className:"relative max-w-[90vw] max-h-[90vh] flex items-center justify-center cursor-pointer",style:{opacity:M?1:0,transition:"opacity 300ms ease-in-out"},onClick:$,children:p.jsxs("div",{className:"relative",children:[p.jsx(VO,{panelId:z.id,imageUrl:z.imageUrl,prompt:z.prompt}),z.imageUrl&&z.textElements&&z.textElements.length>0&&p.jsx("div",{className:"absolute inset-0 pointer-events-none",children:z.textElements.map(Y=>p.jsx($O,{element:Y,textOverlayStyle:n},Y.id))}),l&&z.prompt&&p.jsx("div",{className:"absolute bottom-0 left-0 right-0 pointer-events-none",children:p.jsx("div",{className:"px-6 py-4 rounded-b-2xl",style:{background:"linear-gradient(to top, rgba(0,0,0,0.85) 0%, rgba(0,0,0,0.6) 60%, transparent 100%)"},children:p.jsx("p",{className:"text-white text-sm leading-relaxed font-sans max-w-[700px]",children:z.prompt})})})]})},R),p.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-ink-900 z-[10000]",children:p.jsx("div",{className:"h-full bg-ember-500 transition-all duration-500 ease-out",style:{width:`${J}%`}})}),p.jsxs("div",{className:`absolute bottom-8 left-1/2 -translate-x-1/2 bg-ink-900/85 backdrop-blur-lg rounded-2xl px-6 py-4 flex items-center gap-5 shadow-2xl border border-ink-700 z-[10001] transition-opacity duration-300 ${b?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:Y=>Y.stopPropagation(),children:[p.jsx("button",{onClick:Y=>{Y.stopPropagation(),j()},disabled:o===0,className:"p-2 hover:bg-ember-500 hover:text-ink-950 rounded-lg text-steel-300 transition-colors disabled:opacity-30 disabled:hover:bg-transparent disabled:hover:text-steel-300",title:"Previous panel ()",children:p.jsx(ew,{size:22})}),p.jsxs("div",{className:"flex items-center gap-3 font-mono text-xs text-steel-400 min-w-[220px] justify-center",children:[p.jsxs("span",{className:"text-ember-500",children:["Page ",U,"  Panel ",q,"/",I]}),p.jsx("span",{className:"text-steel-700",children:"|"}),p.jsxs("span",{children:[o+1," of ",ie]})]}),p.jsx("button",{onClick:Y=>{Y.stopPropagation(),$()},disabled:o>=ie-1,className:"p-2 hover:bg-ember-500 hover:text-ink-950 rounded-lg text-steel-300 transition-colors disabled:opacity-30 disabled:hover:bg-transparent disabled:hover:text-steel-300",title:"Next panel ()",children:p.jsx(mf,{size:22})}),p.jsx("div",{className:"h-6 w-px bg-ink-700"}),p.jsx("button",{onClick:Y=>{Y.stopPropagation(),d(le=>!le)},className:`p-2 rounded-lg transition-colors ${u?"bg-ember-500 text-ink-950 hover:bg-ember-400":"text-steel-300 hover:bg-ink-800 hover:text-steel-200"}`,title:u?"Pause auto-advance (Space)":"Play auto-advance (Space)",children:u?p.jsx(JA,{size:18}):p.jsx(cw,{size:18})}),p.jsxs("div",{className:"flex items-center gap-1.5",children:[p.jsx("input",{type:"number",min:"1",max:"15",value:h,onChange:Y=>v(Math.max(1,Math.min(15,parseInt(Y.target.value)||3))),onClick:Y=>Y.stopPropagation(),className:"w-12 px-2 py-1 bg-ink-800 border border-ink-700 rounded text-steel-300 text-xs font-mono text-center focus:outline-none focus:border-ember-500"}),p.jsx("span",{className:"font-mono text-xs text-steel-500",children:"s"})]}),p.jsx("div",{className:"h-6 w-px bg-ink-700"}),p.jsx("button",{onClick:Y=>{Y.stopPropagation(),c(le=>!le)},className:`px-3 py-1.5 rounded-lg font-mono text-xs transition-colors ${l?"bg-ember-500 text-ink-950 hover:bg-ember-400":"text-steel-400 hover:bg-ink-800 hover:text-steel-200"}`,title:"Toggle script text overlay (T)",children:"TXT"})]})]})};function VO({panelId:e,imageUrl:t,prompt:n}){const[i,o]=de.useState(null),[a,l]=de.useState(!0);return de.useEffect(()=>{if(l(!0),o(null),!t){l(!1);return}if(t.startsWith("data:")||t.startsWith("http"))o(t),l(!1);else if(t.startsWith("idb://")){const c=t.replace("idb://","");ka(c).then(u=>{u&&o(u),l(!1)})}else ka(t).then(c=>{c&&o(c),l(!1)})},[t,e]),a?p.jsx("div",{className:"w-[800px] h-[500px] bg-ink-800 rounded-2xl flex items-center justify-center",children:p.jsx("div",{className:"w-8 h-8 border-2 border-ember-500 border-t-transparent rounded-full animate-spin"})}):i?p.jsx("img",{src:i,alt:"",className:"max-w-full max-h-[85vh] rounded-2xl shadow-2xl",draggable:!1}):p.jsx("div",{className:"w-[800px] h-[500px] bg-ink-800 rounded-2xl flex items-center justify-center p-8",children:p.jsx("p",{className:"text-steel-400 font-mono text-sm text-center max-w-[600px]",children:n||"No image generated"})})}function $O({element:e,textOverlayStyle:t="opaque"}){const n={dialogue:"bubble-dialogue",thought:"bubble-thought",caption:"bubble-caption",phone:"bubble-phone"},i=t==="semi-transparent"?"text-style-semi-transparent":t==="border-only"?"text-style-border-only":"";return p.jsx("div",{className:`absolute ${n[e.type]} ${i} pointer-events-none`,style:{left:`${e.x}%`,top:`${e.y}%`,fontSize:`${e.fontSize}px`,color:e.color,padding:"8px 12px",fontFamily:"'Comic Sans MS', 'Chalkboard', sans-serif",textAlign:"center",lineHeight:1.2,minWidth:"40px",maxWidth:"85%",transform:`rotate(${e.rotation||0}deg)`},children:e.content})}function YO(e,t){const n=getComputedStyle(e),i=parseFloat(n.fontSize);return t*i}function WO(e,t){const n=getComputedStyle(e.ownerDocument.body),i=parseFloat(n.fontSize);return t*i}function XO(e){return e/100*window.innerHeight}function JO(e){return e/100*window.innerWidth}function KO(e){switch(typeof e){case"number":return[e,"px"];case"string":{const t=parseFloat(e);return e.endsWith("%")?[t,"%"]:e.endsWith("px")?[t,"px"]:e.endsWith("rem")?[t,"rem"]:e.endsWith("em")?[t,"em"]:e.endsWith("vh")?[t,"vh"]:e.endsWith("vw")?[t,"vw"]:[t,"%"]}}}function Fh({groupSize:e,panelElement:t,styleProp:n}){let i;const[o,a]=KO(n);switch(a){case"%":{i=o/100*e;break}case"px":{i=o;break}case"rem":{i=WO(t,o);break}case"em":{i=YO(t,o);break}case"vh":{i=XO(o);break}case"vw":{i=JO(o);break}}return i}function Ra(e){return parseFloat(e.toFixed(3))}function Xu({group:e}){const{orientation:t,panels:n}=e;return n.reduce((i,o)=>(i+=t==="horizontal"?o.element.offsetWidth:o.element.offsetHeight,i),0)}function Rg(e){const{panels:t}=e,n=Xu({group:e});return n===0?t.map(i=>({collapsedSize:0,collapsible:i.panelConstraints.collapsible===!0,defaultSize:void 0,disabled:i.panelConstraints.disabled,minSize:0,maxSize:100,panelId:i.id})):t.map(i=>{const{element:o,panelConstraints:a}=i;let l=0;if(a.collapsedSize!==void 0){const h=Fh({groupSize:n,panelElement:o,styleProp:a.collapsedSize});l=Ra(h/n*100)}let c;if(a.defaultSize!==void 0){const h=Fh({groupSize:n,panelElement:o,styleProp:a.defaultSize});c=Ra(h/n*100)}let u=0;if(a.minSize!==void 0){const h=Fh({groupSize:n,panelElement:o,styleProp:a.minSize});u=Ra(h/n*100)}let d=100;if(a.maxSize!==void 0){const h=Fh({groupSize:n,panelElement:o,styleProp:a.maxSize});d=Ra(h/n*100)}return{collapsedSize:l,collapsible:a.collapsible===!0,defaultSize:c,disabled:a.disabled,minSize:u,maxSize:d,panelId:i.id}})}function Bn(e,t="Assertion error"){if(!e)throw Error(t)}function Lg(e,t){return Array.from(t).sort(e==="horizontal"?ZO:QO)}function ZO(e,t){const n=e.element.offsetLeft-t.element.offsetLeft;return n!==0?n:e.element.offsetWidth-t.element.offsetWidth}function QO(e,t){const n=e.element.offsetTop-t.element.offsetTop;return n!==0?n:e.element.offsetHeight-t.element.offsetHeight}function qS(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}function HS(e,t){return{x:e.x>=t.left&&e.x<=t.right?0:Math.min(Math.abs(e.x-t.left),Math.abs(e.x-t.right)),y:e.y>=t.top&&e.y<=t.bottom?0:Math.min(Math.abs(e.y-t.top),Math.abs(e.y-t.bottom))}}function eU({orientation:e,rects:t,targetRect:n}){const i={x:n.x+n.width/2,y:n.y+n.height/2};let o,a=Number.MAX_VALUE;for(const l of t){const{x:c,y:u}=HS(i,l),d=e==="horizontal"?c:u;d<a&&(a=d,o=l)}return Bn(o,"No rect found"),o}let Bh;function tU(){return Bh===void 0&&(typeof matchMedia=="function"?Bh=!!matchMedia("(pointer:coarse)").matches:Bh=!1),Bh}function GS(e){const{element:t,orientation:n,panels:i,separators:o}=e,a=Lg(n,Array.from(t.children).filter(qS).map(A=>({element:A}))).map(({element:A})=>A),l=[];let c=!1,u=!1,d=-1,h=-1,v=0,b,g=[];{let A=-1;for(const _ of a)_.hasAttribute("data-panel")&&(A++,_.ariaDisabled===null&&(v++,d===-1&&(d=A),h=A))}if(v>1){let A=-1;for(const _ of a)if(_.hasAttribute("data-panel")){A++;const C=i.find(E=>E.element===_);if(C){if(b){const E=b.element.getBoundingClientRect(),R=_.getBoundingClientRect();let k;if(u){const M=n==="horizontal"?new DOMRect(E.right,E.top,0,E.height):new DOMRect(E.left,E.bottom,E.width,0),P=n==="horizontal"?new DOMRect(R.left,R.top,0,R.height):new DOMRect(R.left,R.top,R.width,0);switch(g.length){case 0:{k=[M,P];break}case 1:{const W=g[0],V=eU({orientation:n,rects:[E,R],targetRect:W.element.getBoundingClientRect()});k=[W,V===E?P:M];break}default:{k=g;break}}}else g.length?k=g:k=[n==="horizontal"?new DOMRect(E.right,R.top,R.left-E.right,R.height):new DOMRect(R.left,E.bottom,R.width,R.top-E.bottom)];for(const M of k){let P="width"in M?M:M.element.getBoundingClientRect();const W=tU()?e.resizeTargetMinimumSize.coarse:e.resizeTargetMinimumSize.fine;if(P.width<W){const $=W-P.width;P=new DOMRect(P.x-$/2,P.y,P.width+$,P.height)}if(P.height<W){const $=W-P.height;P=new DOMRect(P.x,P.y-$/2,P.width,P.height+$)}const V=A<=d||A>h;!c&&!V&&l.push({group:e,groupSize:Xu({group:e}),panels:[b,C],separator:"width"in M?void 0:M,rect:P}),c=!1}}u=!1,b=C,g=[]}}else if(_.hasAttribute("data-separator")){_.ariaDisabled!==null&&(c=!0);const C=o.find(E=>E.element===_);C?g.push(C):(b=void 0,g=[])}else u=!0}return l}var Dl;class nU{constructor(){Fy(this,Dl,{})}addListener(t,n){const i=Fd(this,Dl)[t];return i===void 0?Fd(this,Dl)[t]=[n]:i.includes(n)||i.push(n),()=>{this.removeListener(t,n)}}emit(t,n){const i=Fd(this,Dl)[t];if(i!==void 0)if(i.length===1)i[0].call(null,n);else{let o=!1,a=null;const l=Array.from(i);for(let c=0;c<l.length;c++){const u=l[c];try{u.call(null,n)}catch(d){a===null&&(o=!0,a=d)}}if(o)throw a}}removeAllListeners(){By(this,Dl,{})}removeListener(t,n){const i=Fd(this,Dl)[t];if(i!==void 0){const o=i.indexOf(n);o>=0&&i.splice(o,1)}}}Dl=new WeakMap;function Ur(e,t,n=0){return Math.abs(Ra(e)-Ra(t))<=n}let Wo={cursorFlags:0,interactionState:{state:"inactive"},mountedGroups:new Map};const Gs=new nU;function zr(){return Wo}function jr(e){const t=typeof e=="function"?e(Wo):e;if(Wo===t)return Wo;const n=Wo;return Wo={...Wo,...t},t.cursorFlags!==void 0&&Gs.emit("cursorFlagsChange",Wo.cursorFlags),t.interactionState!==void 0&&Gs.emit("interactionStateChange",Wo.interactionState),t.mountedGroups!==void 0&&(Wo.mountedGroups.forEach((i,o)=>{i.derivedPanelConstraints.forEach(a=>{if(a.collapsible){const{layout:l}=n.mountedGroups.get(o)??{};if(l){const c=Ur(a.collapsedSize,i.layout[a.panelId]),u=Ur(a.collapsedSize,l[a.panelId]);c&&!u&&(o.inMemoryLastExpandedPanelSizes[a.panelId]=l[a.panelId])}}})}),Gs.emit("mountedGroupsChange",Wo.mountedGroups)),Wo}function iU(e,t,n){let i,o={x:1/0,y:1/0};for(const a of t){const l=HS(n,a.rect);switch(e){case"horizontal":{l.x<=o.x&&(i=a,o=l);break}case"vertical":{l.y<=o.y&&(i=a,o=l);break}}}return i?{distance:o,hitRegion:i}:void 0}function rU(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE}function oU(e,t){if(e===t)throw new Error("Cannot compare node with itself");const n={a:Rx(e),b:Rx(t)};let i;for(;n.a.at(-1)===n.b.at(-1);)i=n.a.pop(),n.b.pop();Bn(i,"Stacking order can only be calculated for elements with a common ancestor");const o={a:Ix(kx(n.a)),b:Ix(kx(n.b))};if(o.a===o.b){const a=i.childNodes,l={a:n.a.at(-1),b:n.b.at(-1)};let c=a.length;for(;c--;){const u=a[c];if(u===l.a)return 1;if(u===l.b)return-1}}return Math.sign(o.a-o.b)}const aU=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function sU(e){const t=getComputedStyle(VS(e)??e).display;return t==="flex"||t==="inline-flex"}function lU(e){const t=getComputedStyle(e);return!!(t.position==="fixed"||t.zIndex!=="auto"&&(t.position!=="static"||sU(e))||+t.opacity<1||"transform"in t&&t.transform!=="none"||"webkitTransform"in t&&t.webkitTransform!=="none"||"mixBlendMode"in t&&t.mixBlendMode!=="normal"||"filter"in t&&t.filter!=="none"||"webkitFilter"in t&&t.webkitFilter!=="none"||"isolation"in t&&t.isolation==="isolate"||aU.test(t.willChange)||t.webkitOverflowScrolling==="touch")}function kx(e){let t=e.length;for(;t--;){const n=e[t];if(Bn(n,"Missing node"),lU(n))return n}return null}function Ix(e){return e&&Number(getComputedStyle(e).zIndex)||0}function Rx(e){const t=[];for(;e;)t.push(e),e=VS(e);return t}function VS(e){const{parentNode:t}=e;return rU(t)?t.host:t}function cU(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function uU({groupElement:e,hitRegion:t,pointerEventTarget:n}){if(!qS(n)||n.contains(e)||e.contains(n))return!0;if(oU(n,e)>0){let i=n;for(;i;){if(i.contains(e))return!0;if(cU(i.getBoundingClientRect(),t))return!1;i=i.parentElement}}return!0}function v1(e,t){const n=[];return t.forEach((i,o)=>{if(o.disabled)return;const a=GS(o),l=iU(o.orientation,a,{x:e.clientX,y:e.clientY});l&&l.distance.x<=0&&l.distance.y<=0&&uU({groupElement:o.element,hitRegion:l.hitRegion.rect,pointerEventTarget:e.target})&&n.push(l.hitRegion)}),n}function dU(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function as(e,t){return Ur(e,t)?0:e>t?1:-1}function zu({overrideDisabledPanels:e,panelConstraints:t,prevSize:n,size:i}){const{collapsedSize:o=0,collapsible:a,disabled:l,maxSize:c=100,minSize:u=0}=t;if(l&&!e)return n;if(as(i,u)<0)if(a){const d=(o+u)/2;as(i,d)<0?i=o:i=u}else i=u;return i=Math.min(c,i),i=Ra(i),i}function pf({delta:e,initialLayout:t,panelConstraints:n,pivotIndices:i,prevLayout:o,trigger:a}){if(Ur(e,0))return t;const l=a==="imperative-api",c=Object.values(t),u=Object.values(o),d=[...c],[h,v]=i;Bn(h!=null,"Invalid first pivot index"),Bn(v!=null,"Invalid second pivot index");let b=0;switch(a){case"keyboard":{{const _=e<0?v:h,C=n[_];Bn(C,`Panel constraints not found for index ${_}`);const{collapsedSize:E=0,collapsible:R,minSize:k=0}=C;if(R){const M=c[_];if(Bn(M!=null,`Previous layout not found for panel index ${_}`),Ur(M,E)){const P=k-M;as(P,Math.abs(e))>0&&(e=e<0?0-P:P)}}}{const _=e<0?h:v,C=n[_];Bn(C,`No panel constraints found for index ${_}`);const{collapsedSize:E=0,collapsible:R,minSize:k=0}=C;if(R){const M=c[_];if(Bn(M!=null,`Previous layout not found for panel index ${_}`),Ur(M,k)){const P=M-E;as(P,Math.abs(e))>0&&(e=e<0?0-P:P)}}}break}default:{const _=e<0?v:h,C=n[_];Bn(C,`Panel constraints not found for index ${_}`);const E=c[_],{collapsible:R,collapsedSize:k,minSize:M}=C;if(R&&as(E,M)<0)if(e>0){const P=M-k,W=P/2,V=E+e;as(V,M)<0&&(e=as(e,W)<=0?0:P)}else{const P=M-k,W=100-P/2,V=E-e;as(V,M)<0&&(e=as(100+e,W)>0?0:-P)}break}}{const _=e<0?1:-1;let C=e<0?v:h,E=0;for(;;){const k=c[C];Bn(k!=null,`Previous layout not found for panel index ${C}`);const M=zu({overrideDisabledPanels:l,panelConstraints:n[C],prevSize:k,size:100})-k;if(E+=M,C+=_,C<0||C>=n.length)break}const R=Math.min(Math.abs(e),Math.abs(E));e=e<0?0-R:R}{let _=e<0?h:v;for(;_>=0&&_<n.length;){const C=Math.abs(e)-Math.abs(b),E=c[_];Bn(E!=null,`Previous layout not found for panel index ${_}`);const R=E-C,k=zu({overrideDisabledPanels:l,panelConstraints:n[_],prevSize:E,size:R});if(!Ur(E,k)&&(b+=E-k,d[_]=k,b.toFixed(3).localeCompare(Math.abs(e).toFixed(3),void 0,{numeric:!0})>=0))break;e<0?_--:_++}}if(dU(u,d))return o;{const _=e<0?v:h,C=c[_];Bn(C!=null,`Previous layout not found for panel index ${_}`);const E=C+b,R=zu({overrideDisabledPanels:l,panelConstraints:n[_],prevSize:C,size:E});if(d[_]=R,!Ur(R,E)){let k=E-R,M=e<0?v:h;for(;M>=0&&M<n.length;){const P=d[M];Bn(P!=null,`Previous layout not found for panel index ${M}`);const W=P+k,V=zu({overrideDisabledPanels:l,panelConstraints:n[M],prevSize:P,size:W});if(Ur(P,V)||(k-=V-P,d[M]=V),Ur(k,0))break;e>0?M--:M++}}}const g=Object.values(d).reduce((_,C)=>C+_,0);if(!Ur(g,100,.1))return o;const A=Object.keys(o);return d.reduce((_,C,E)=>(_[A[E]]=C,_),{})}function Rc(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(t[n]===void 0||as(e[n],t[n])!==0)return!1;return!0}function Lc({layout:e,panelConstraints:t}){const n=Object.values(e),i=[...n],o=i.reduce((c,u)=>c+u,0);if(i.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${i.map(c=>`${c}%`).join(", ")}`);if(!Ur(o,100)&&i.length>0)for(let c=0;c<t.length;c++){const u=i[c];Bn(u!=null,`No layout data found for index ${c}`);const d=100/o*u;i[c]=d}let a=0;for(let c=0;c<t.length;c++){const u=n[c];Bn(u!=null,`No layout data found for index ${c}`);const d=i[c];Bn(d!=null,`No layout data found for index ${c}`);const h=zu({overrideDisabledPanels:!0,panelConstraints:t[c],prevSize:u,size:d});d!=h&&(a+=d-h,i[c]=h)}if(!Ur(a,0))for(let c=0;c<t.length;c++){const u=i[c];Bn(u!=null,`No layout data found for index ${c}`);const d=u+a,h=zu({overrideDisabledPanels:!0,panelConstraints:t[c],prevSize:u,size:d});if(u!==h&&(a-=h-u,i[c]=h,Ur(a,0)))break}const l=Object.keys(e);return i.reduce((c,u,d)=>(c[l[d]]=u,c),{})}function $S({groupId:e,panelId:t}){const n=()=>{const{mountedGroups:c}=zr();for(const[u,{defaultLayoutDeferred:d,derivedPanelConstraints:h,layout:v,separatorToPanels:b}]of c)if(u.id===e)return{defaultLayoutDeferred:d,derivedPanelConstraints:h,group:u,layout:v,separatorToPanels:b};throw Error(`Group ${e} not found`)},i=()=>{const c=n().derivedPanelConstraints.find(u=>u.panelId===t);if(c!==void 0)return c;throw Error(`Panel constraints not found for Panel ${t}`)},o=()=>{const c=n().group.panels.find(u=>u.id===t);if(c!==void 0)return c;throw Error(`Layout not found for Panel ${t}`)},a=()=>{const c=n().layout[t];if(c!==void 0)return c;throw Error(`Layout not found for Panel ${t}`)},l=c=>{const u=a();if(c===u)return;const{defaultLayoutDeferred:d,derivedPanelConstraints:h,group:v,layout:b,separatorToPanels:g}=n(),A=v.panels.findIndex(R=>R.id===t),_=A===v.panels.length-1,C=pf({delta:_?u-c:c-u,initialLayout:b,panelConstraints:h,pivotIndices:_?[A-1,A]:[A,A+1],prevLayout:b,trigger:"imperative-api"}),E=Lc({layout:C,panelConstraints:h});Rc(b,E)||jr(R=>({mountedGroups:new Map(R.mountedGroups).set(v,{defaultLayoutDeferred:d,derivedPanelConstraints:h,layout:E,separatorToPanels:g})}))};return{collapse:()=>{const{collapsible:c,collapsedSize:u}=i(),{mutableValues:d}=o(),h=a();c&&h!==u&&(d.expandToSize=h,l(u))},expand:()=>{const{collapsible:c,collapsedSize:u,minSize:d}=i(),{mutableValues:h}=o(),v=a();if(c&&v===u){let b=h.expandToSize??d;b===0&&(b=1),l(b)}},getSize:()=>{const{group:c}=n(),u=a(),{element:d}=o(),h=c.orientation==="horizontal"?d.offsetWidth:d.offsetHeight;return{asPercentage:u,inPixels:h}},isCollapsed:()=>{const{collapsible:c,collapsedSize:u}=i(),d=a();return c&&Ur(u,d)},resize:c=>{if(a()!==c){let u;switch(typeof c){case"number":{const{group:d}=n(),h=Xu({group:d});u=Ra(c/h*100);break}case"string":{u=parseFloat(c);break}}l(u)}}}}function Lx(e){if(e.defaultPrevented)return;const{mountedGroups:t}=zr();v1(e,t).forEach(n=>{if(n.separator){const i=n.panels.find(o=>o.panelConstraints.defaultSize!==void 0);if(i){const o=i.panelConstraints.defaultSize,a=$S({groupId:n.group.id,panelId:i.id});a&&o!==void 0&&(a.resize(o),e.preventDefault())}}})}function Zh(e){const{mountedGroups:t}=zr();for(const[n]of t)if(n.separators.some(i=>i.element===e))return n;throw Error("Could not find parent Group for separator element")}function YS({groupId:e}){const t=()=>{const{mountedGroups:n}=zr();for(const[i,o]of n)if(i.id===e)return{group:i,...o};throw Error(`Could not find Group with id "${e}"`)};return{getLayout(){const{defaultLayoutDeferred:n,layout:i}=t();return n?{}:i},setLayout(n){const{defaultLayoutDeferred:i,derivedPanelConstraints:o,group:a,layout:l,separatorToPanels:c}=t(),u=Lc({layout:n,panelConstraints:o});if(i)return l;if(!Rc(l,u)){jr(h=>({mountedGroups:new Map(h.mountedGroups).set(a,{defaultLayoutDeferred:i,derivedPanelConstraints:o,layout:u,separatorToPanels:c})}));const d=a.panels.map(({id:h})=>h).join(",");a.inMemoryLayouts[d]=u}return u}}}function WS(e){const{mountedGroups:t}=zr(),n=t.get(e);return Bn(n,`Mounted Group ${e.id} not found`),n}function _c(e,t){const n=Zh(e),i=WS(n),o=n.separators.find(h=>h.element===e);Bn(o,"Matching separator not found");const a=i.separatorToPanels.get(o);Bn(a,"Matching panels not found");const l=a.map(h=>n.panels.indexOf(h)),c=YS({groupId:n.id}).getLayout(),u=pf({delta:t,initialLayout:c,panelConstraints:i.derivedPanelConstraints,pivotIndices:l,prevLayout:c,trigger:"keyboard"}),d=Lc({layout:u,panelConstraints:i.derivedPanelConstraints});Rc(c,d)||jr(h=>({mountedGroups:new Map(h.mountedGroups).set(n,{defaultLayoutDeferred:i.defaultLayoutDeferred,derivedPanelConstraints:i.derivedPanelConstraints,layout:d,separatorToPanels:i.separatorToPanels})}))}function Mx(e){if(e.defaultPrevented)return;const t=e.currentTarget,n=Zh(t);if(!n.disabled)switch(e.key){case"ArrowDown":{e.preventDefault(),n.orientation==="vertical"&&_c(t,5);break}case"ArrowLeft":{e.preventDefault(),n.orientation==="horizontal"&&_c(t,-5);break}case"ArrowRight":{e.preventDefault(),n.orientation==="horizontal"&&_c(t,5);break}case"ArrowUp":{e.preventDefault(),n.orientation==="vertical"&&_c(t,-5);break}case"End":{e.preventDefault(),_c(t,100);break}case"Enter":{e.preventDefault();const i=Zh(t),{derivedPanelConstraints:o,layout:a,separatorToPanels:l}=WS(i),c=i.separators.find(v=>v.element===t);Bn(c,"Matching separator not found");const u=l.get(c);Bn(u,"Matching panels not found");const d=u[0],h=o.find(v=>v.panelId===d.id);if(Bn(h,"Panel metadata not found"),h.collapsible){const v=a[d.id],b=h.collapsedSize===v?i.inMemoryLastExpandedPanelSizes[d.id]??h.minSize:h.collapsedSize;_c(t,b-v)}break}case"F6":{e.preventDefault();const i=Zh(t).separators.map(l=>l.element),o=Array.from(i).findIndex(l=>l===e.currentTarget);Bn(o!==null,"Index not found");const a=e.shiftKey?o>0?o-1:i.length-1:o+1<i.length?o+1:0;i[a].focus();break}case"Home":{e.preventDefault(),_c(t,-100);break}}}function Dx(e){if(e.defaultPrevented||e.pointerType==="mouse"&&e.button>0)return;const{mountedGroups:t}=zr(),n=v1(e,t),i=new Map;let o=!1;n.forEach(a=>{a.separator&&(o||(o=!0,a.separator.element.focus()));const l=t.get(a.group);l&&i.set(a.group,l.layout)}),jr({interactionState:{hitRegions:n,initialLayoutMap:i,pointerDownAtPoint:{x:e.clientX,y:e.clientY},state:"active"}}),n.length&&e.preventDefault()}const fU=e=>e,qm=()=>{},XS=1,JS=2,KS=4,ZS=8,Px=3,Ox=12;let qh;function Ux(){return qh===void 0&&(qh=!1,typeof window<"u"&&(window.navigator.userAgent.includes("Chrome")||window.navigator.userAgent.includes("Firefox"))&&(qh=!0)),qh}function hU({cursorFlags:e,groups:t,state:n}){let i=0,o=0;switch(n){case"active":case"hover":t.forEach(a=>{if(!a.disableCursor)switch(a.orientation){case"horizontal":{i++;break}case"vertical":{o++;break}}})}if(!(i===0&&o===0)){switch(n){case"active":{if(e&&Ux()){const a=(e&XS)!==0,l=(e&JS)!==0,c=(e&KS)!==0,u=(e&ZS)!==0;if(a)return c?"se-resize":u?"ne-resize":"e-resize";if(l)return c?"sw-resize":u?"nw-resize":"w-resize";if(c)return"s-resize";if(u)return"n-resize"}break}}return Ux()?i>0&&o>0?"move":i>0?"ew-resize":"ns-resize":i>0&&o>0?"grab":i>0?"col-resize":"row-resize"}}const zx=new WeakMap;function y1(e){if(e.defaultView===null||e.defaultView===void 0)return;let{prevStyle:t,styleSheet:n}=zx.get(e)??{};n===void 0&&(n=new e.defaultView.CSSStyleSheet,e.adoptedStyleSheets.push(n));const{cursorFlags:i,interactionState:o}=zr();switch(o.state){case"active":case"hover":{const a=hU({cursorFlags:i,groups:o.hitRegions.map(c=>c.group),state:o.state}),l=`*, *:hover {cursor: ${a} !important; ${o.state==="active"?"touch-action: none;":""} }`;if(t===l)return;t=l,a?n.cssRules.length===0?n.insertRule(l):n.replaceSync(l):n.cssRules.length===1&&n.deleteRule(0);break}case"inactive":{t=void 0,n.cssRules.length===1&&n.deleteRule(0);break}}zx.set(e,{prevStyle:t,styleSheet:n})}function QS({document:e,event:t,hitRegions:n,initialLayoutMap:i,mountedGroups:o,pointerDownAtPoint:a,prevCursorFlags:l}){let c=0;const u=new Map(o);n.forEach(h=>{const{group:v,groupSize:b}=h,{disableCursor:g,orientation:A,panels:_}=v;let C=0;a?A==="horizontal"?C=(t.clientX-a.x)/b*100:C=(t.clientY-a.y)/b*100:A==="horizontal"?C=t.clientX<0?-100:100:C=t.clientY<0?-100:100;const E=i.get(v),{defaultLayoutDeferred:R,derivedPanelConstraints:k,layout:M,separatorToPanels:P}=o.get(v)??{defaultLayoutDeferred:!1};if(k&&E&&M&&P){const W=pf({delta:C,initialLayout:E,panelConstraints:k,pivotIndices:h.panels.map(V=>_.indexOf(V)),prevLayout:M,trigger:"mouse-or-touch"});if(Rc(W,M)){if(C!==0&&!g)switch(A){case"horizontal":{c|=C<0?XS:JS;break}case"vertical":{c|=C<0?KS:ZS;break}}}else{u.set(h.group,{defaultLayoutDeferred:R,derivedPanelConstraints:k,layout:W,separatorToPanels:P});const V=h.group.panels.map(({id:$})=>$).join(",");h.group.inMemoryLayouts[V]=W}}});let d=0;t.movementX===0?d|=l&Px:d|=c&Px,t.movementY===0?d|=l&Ox:d|=c&Ox,jr({cursorFlags:d,mountedGroups:u}),y1(e)}function jx(e){const{cursorFlags:t,interactionState:n,mountedGroups:i}=zr();switch(n.state){case"active":QS({document:e.currentTarget,event:e,hitRegions:n.hitRegions,initialLayoutMap:n.initialLayoutMap,mountedGroups:i,prevCursorFlags:t})}}function Fx(e){if(e.defaultPrevented)return;const{cursorFlags:t,interactionState:n,mountedGroups:i}=zr();switch(n.state){case"active":{if(e.buttons===0){jr(o=>o.interactionState.state==="inactive"?o:{cursorFlags:0,interactionState:{state:"inactive"}}),jr(o=>({mountedGroups:new Map(o.mountedGroups)}));return}QS({document:e.currentTarget,event:e,hitRegions:n.hitRegions,initialLayoutMap:n.initialLayoutMap,mountedGroups:i,pointerDownAtPoint:n.pointerDownAtPoint,prevCursorFlags:t});break}default:{const o=v1(e,i);o.length===0?n.state!=="inactive"&&jr({interactionState:{state:"inactive"}}):jr({interactionState:{hitRegions:o,state:"hover"}}),y1(e.currentTarget);break}}}function Bx(e){if(e.relatedTarget instanceof HTMLIFrameElement){const{interactionState:t}=zr();switch(t.state){case"hover":jr({interactionState:{state:"inactive"}})}}}function qx(e){if(e.defaultPrevented||e.pointerType==="mouse"&&e.button>0)return;const{interactionState:t}=zr();switch(t.state){case"active":jr({cursorFlags:0,interactionState:{state:"inactive"}}),t.hitRegions.length>0&&(y1(e.currentTarget),jr(n=>({mountedGroups:new Map(n.mountedGroups)})),e.preventDefault())}}function Hx(e){let t=0,n=0;const i={};for(const a of e)if(a.defaultSize!==void 0){t++;const l=Ra(a.defaultSize);n+=l,i[a.panelId]=l}else i[a.panelId]=void 0;const o=e.length-t;if(o!==0){const a=Ra((100-n)/o);for(const l of e)l.defaultSize===void 0&&(i[l.panelId]=a)}return i}function pU(e,t,n){if(!n[0])return;const i=e.panels.find(u=>u.element===t);if(!i||!i.onResize)return;const o=Xu({group:e}),a=e.orientation==="horizontal"?i.element.offsetWidth:i.element.offsetHeight,l=i.mutableValues.prevSize,c={asPercentage:Ra(a/o*100),inPixels:a};i.mutableValues.prevSize=c,i.onResize(c,i.id,l)}function mU(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function gU(e,t){const n=e.map(o=>o.id),i=Object.keys(t);if(n.length!==i.length)return!1;for(const o of n)if(!i.includes(o))return!1;return!0}const Ru=new Map;function vU(e){let t=!0;Bn(e.element.ownerDocument.defaultView,"Cannot register an unmounted Group");const n=e.element.ownerDocument.defaultView.ResizeObserver,i=new Set,o=new Set,a=new n(A=>{for(const _ of A){const{borderBoxSize:C,target:E}=_;if(E===e.element){if(t){if(Xu({group:e})===0)return;jr(R=>{const k=R.mountedGroups.get(e);if(k){const M=Rg(e),P=k.defaultLayoutDeferred?Hx(M):k.layout,W=Lc({layout:P,panelConstraints:M});return!k.defaultLayoutDeferred&&Rc(P,W)&&mU(k.derivedPanelConstraints,M)?R:{mountedGroups:new Map(R.mountedGroups).set(e,{defaultLayoutDeferred:!1,derivedPanelConstraints:M,layout:W,separatorToPanels:k.separatorToPanels})}}return R})}}else pU(e,E,C)}});a.observe(e.element),e.panels.forEach(A=>{Bn(!i.has(A.id),`Panel ids must be unique; id "${A.id}" was used more than once`),i.add(A.id),A.onResize&&a.observe(A.element)});const l=Xu({group:e}),c=Rg(e),u=e.panels.map(({id:A})=>A).join(",");let d=e.defaultLayout;d&&(gU(e.panels,d)||(d=void 0));const h=e.inMemoryLayouts[u]??d??Hx(c),v=Lc({layout:h,panelConstraints:c}),b=GS(e),g=e.element.ownerDocument;return jr(A=>{const _=new Map;return Ru.set(g,(Ru.get(g)??0)+1),b.forEach(C=>{C.separator&&_.set(C.separator,C.panels)}),{mountedGroups:new Map(A.mountedGroups).set(e,{defaultLayoutDeferred:l===0,derivedPanelConstraints:c,layout:v,separatorToPanels:_})}}),e.separators.forEach(A=>{Bn(!o.has(A.id),`Separator ids must be unique; id "${A.id}" was used more than once`),o.add(A.id),A.element.addEventListener("keydown",Mx)}),Ru.get(g)===1&&(g.addEventListener("dblclick",Lx,!0),g.addEventListener("pointerdown",Dx,!0),g.addEventListener("pointerleave",jx),g.addEventListener("pointermove",Fx),g.addEventListener("pointerout",Bx),g.addEventListener("pointerup",qx,!0)),function(){t=!1,Ru.set(g,Math.max(0,(Ru.get(g)??0)-1)),jr(A=>{const _=new Map(A.mountedGroups);return _.delete(e),{mountedGroups:_}}),e.separators.forEach(A=>{A.element.removeEventListener("keydown",Mx)}),Ru.get(g)||(g.removeEventListener("dblclick",Lx,!0),g.removeEventListener("pointerdown",Dx,!0),g.removeEventListener("pointerleave",jx),g.removeEventListener("pointermove",Fx),g.removeEventListener("pointerout",Bx),g.removeEventListener("pointerup",qx,!0)),a.disconnect()}}function yU(){const[e,t]=de.useState({}),n=de.useCallback(()=>t({}),[]);return[e,n]}function b1(e){const t=de.useId();return`${e??t}`}const Oc=typeof window<"u"?de.useLayoutEffect:de.useEffect;function rf(e){const t=de.useRef(e);return Oc(()=>{t.current=e},[e]),de.useCallback((...n)=>{var i;return(i=t.current)==null?void 0:i.call(t,...n)},[t])}function x1(...e){return rf(t=>{e.forEach(n=>{if(n)switch(typeof n){case"function":{n(t);break}case"object":{n.current=t;break}}})})}function w1(e){const t=de.useRef({...e});return Oc(()=>{for(const n in e)t.current[n]=e[n]},[e]),t.current}const eE=de.createContext(null);function bU(e,t){const n=de.useRef({getLayout:()=>({}),setLayout:fU});de.useImperativeHandle(t,()=>n.current,[]),Oc(()=>{Object.assign(n.current,YS({groupId:e}))})}function tE({children:e,className:t,defaultLayout:n,disableCursor:i,disabled:o,elementRef:a,groupRef:l,id:c,onLayoutChange:u,onLayoutChanged:d,orientation:h="horizontal",resizeTargetMinimumSize:v={coarse:20,fine:10},style:b,...g}){const A=de.useRef({onLayoutChange:{},onLayoutChanged:{}}),_=rf(z=>{Rc(A.current.onLayoutChange,z)||(A.current.onLayoutChange=z,u==null||u(z))}),C=rf(z=>{Rc(A.current.onLayoutChanged,z)||(A.current.onLayoutChanged=z,d==null||d(z))}),E=b1(c),R=de.useRef(null),[k,M]=yU(),P=de.useRef({lastExpandedPanelSizes:{},layouts:{},panels:[],resizeTargetMinimumSize:v,separators:[]}),W=x1(R,a);bU(E,l);const V=rf((z,U)=>{const{interactionState:q,mountedGroups:I}=zr();for(const ie of I.keys())if(ie.id===z){const J=I.get(ie);if(J){let Y=!1;switch(q.state){case"active":{Y=q.hitRegions.some(le=>le.group===ie);break}}return{flexGrow:J.layout[U]??1,pointerEvents:Y?"none":void 0}}}return{flexGrow:(n==null?void 0:n[U])??1}}),$=w1({defaultLayout:n,disableCursor:i}),j=de.useMemo(()=>({get disableCursor(){return!!$.disableCursor},getPanelStyles:V,id:E,orientation:h,registerPanel:z=>{const U=P.current;return U.panels=Lg(h,[...U.panels,z]),M(),()=>{U.panels=U.panels.filter(q=>q!==z),M()}},registerSeparator:z=>{const U=P.current;return U.separators=Lg(h,[...U.separators,z]),M(),()=>{U.separators=U.separators.filter(q=>q!==z),M()}},togglePanelDisabled:(z,U)=>{const q=P.current.panels.find(ie=>ie.id===z);q&&(q.panelConstraints.disabled=U);const{mountedGroups:I}=zr();for(const ie of I.keys())if(ie.id===E){const J=I.get(ie);J&&(J.derivedPanelConstraints=Rg(ie))}},toggleSeparatorDisabled:(z,U)=>{const q=P.current.separators.find(I=>I.id===z);q&&(q.disabled=U)}}),[V,E,M,h,$]),X=de.useRef(null);return Oc(()=>{const z=R.current;if(z===null)return;const U=P.current;let q;if($.defaultLayout!==void 0&&Object.keys($.defaultLayout).length===U.panels.length){q={};for(const pe of U.panels){const Ie=$.defaultLayout[pe.id];Ie!==void 0&&(q[pe.id]=Ie)}}const I={defaultLayout:q,disableCursor:!!$.disableCursor,disabled:!!o,element:z,id:E,inMemoryLastExpandedPanelSizes:P.current.lastExpandedPanelSizes,inMemoryLayouts:P.current.layouts,orientation:h,panels:U.panels,resizeTargetMinimumSize:U.resizeTargetMinimumSize,separators:U.separators};X.current=I;const ie=vU(I),J=zr().mountedGroups.get(I);if(J){const{defaultLayoutDeferred:pe,derivedPanelConstraints:Ie,layout:G}=J;!pe&&Ie.length>0&&(_(G),C(G))}const Y=Gs.addListener("interactionStateChange",pe=>{pe.state}),le=Gs.addListener("mountedGroupsChange",pe=>{const Ie=pe.get(I);if(Ie){const{defaultLayoutDeferred:G,derivedPanelConstraints:O,layout:ee}=Ie;if(G||O.length===0)return;const{interactionState:te}=zr(),ce=te.state!=="active";_(ee),ce&&C(ee)}});return()=>{X.current=null,ie(),Y(),le()}},[o,E,C,_,h,k,$]),de.useEffect(()=>{const z=X.current;z&&(z.defaultLayout=n,z.disableCursor=!!i)}),p.jsx(eE.Provider,{value:j,children:p.jsx("div",{...g,className:t,"data-group":!0,"data-testid":E,id:E,ref:W,style:{height:"100%",width:"100%",overflow:"hidden",...b,display:"flex",flexDirection:h==="horizontal"?"row":"column",flexWrap:"nowrap"},children:e})})}tE.displayName="Group";function _1(){const e=de.useContext(eE);return Bn(e,"Group Context not found; did you render a Panel or Separator outside of a Group?"),e}function xU(e,t){const{id:n}=_1(),i=de.useRef({collapse:qm,expand:qm,getSize:()=>({asPercentage:0,inPixels:0}),isCollapsed:()=>!1,resize:qm});de.useImperativeHandle(t,()=>i.current,[]),Oc(()=>{Object.assign(i.current,$S({groupId:n,panelId:e}))})}function Mg({children:e,className:t,collapsedSize:n="0%",collapsible:i=!1,defaultSize:o,disabled:a,elementRef:l,id:c,maxSize:u="100%",minSize:d="0%",onResize:h,panelRef:v,style:b,...g}){const A=!!c,_=b1(c),C=w1({disabled:a}),E=de.useRef(null),R=x1(E,l),{getPanelStyles:k,id:M,registerPanel:P,togglePanelDisabled:W}=_1(),V=h!==null,$=rf((X,z,U)=>{h==null||h(X,c,U)});Oc(()=>{const X=E.current;if(X!==null){const z={element:X,id:_,idIsStable:A,mutableValues:{expandToSize:void 0,prevSize:void 0},onResize:V?$:void 0,panelConstraints:{collapsedSize:n,collapsible:i,defaultSize:o,disabled:C.disabled,maxSize:u,minSize:d}};return P(z)}},[n,i,o,V,_,A,u,d,$,P,C]),de.useEffect(()=>{W(_,!!a)},[a,_,W]),xU(_,v);const j=de.useSyncExternalStore(X=>(Gs.addListener("mountedGroupsChange",X),()=>{Gs.removeListener("mountedGroupsChange",X)}),()=>JSON.stringify(k(M,_)),()=>JSON.stringify(k(M,_)));return p.jsx("div",{...g,"aria-disabled":a||void 0,"data-panel":!0,"data-testid":_,id:_,ref:R,style:{...wU,display:"flex",flexBasis:0,flexShrink:1,overflow:"hidden",...JSON.parse(j)},children:p.jsx("div",{className:t,style:{maxHeight:"100%",maxWidth:"100%",flexGrow:1,...b},children:e})})}Mg.displayName="Panel";const wU={minHeight:0,maxHeight:"100%",height:"auto",minWidth:0,maxWidth:"100%",width:"auto",border:"none",borderWidth:0,padding:0,margin:0};function _U({layout:e,panelConstraints:t,panelId:n,panelIndex:i}){let o,a;const l=e[n],c=t.find(u=>u.panelId===n);if(c){const u=c.maxSize,d=c.collapsible?c.collapsedSize:c.minSize,h=[i,i+1];a=Lc({layout:pf({delta:d-l,initialLayout:e,panelConstraints:t,pivotIndices:h,prevLayout:e}),panelConstraints:t})[n],o=Lc({layout:pf({delta:u-l,initialLayout:e,panelConstraints:t,pivotIndices:h,prevLayout:e}),panelConstraints:t})[n]}return{valueControls:n,valueMax:o,valueMin:a,valueNow:l}}function nE({children:e,className:t,disabled:n,elementRef:i,id:o,style:a,...l}){const c=b1(o),u=w1({disabled:n}),[d,h]=de.useState({}),[v,b]=de.useState("inactive"),g=de.useRef(null),A=x1(g,i),{disableCursor:_,id:C,orientation:E,registerSeparator:R,toggleSeparatorDisabled:k}=_1(),M=E==="horizontal"?"vertical":"horizontal";Oc(()=>{const W=g.current;if(W!==null){const V={disabled:u.disabled,element:W,id:c},$=R(V),j=Gs.addListener("interactionStateChange",z=>{b(z.state!=="inactive"&&z.hitRegions.some(U=>U.separator===V)?z.state:"inactive")}),X=Gs.addListener("mountedGroupsChange",z=>{z.forEach(({derivedPanelConstraints:U,layout:q,separatorToPanels:I},ie)=>{if(ie.id===C){const J=I.get(V);if(J){const Y=J[0],le=ie.panels.indexOf(Y);h(_U({layout:q,panelConstraints:U,panelId:Y.id,panelIndex:le}))}}})});return()=>{j(),X(),$()}}},[C,c,R,u]),de.useEffect(()=>{k(c,!!n)},[n,c,k]);let P;return n&&!_&&(P="not-allowed"),p.jsx("div",{...l,"aria-controls":d.valueControls,"aria-disabled":n||void 0,"aria-orientation":M,"aria-valuemax":d.valueMax,"aria-valuemin":d.valueMin,"aria-valuenow":d.valueNow,children:e,className:t,"data-separator":n?"disabled":v,"data-testid":c,id:c,ref:A,role:"separator",style:{flexBasis:"auto",cursor:P,...a,flexGrow:0,flexShrink:0},tabIndex:n?void 0:0})}nE.displayName="Separator";function SU({issue:e,onClose:t,onApplyChanges:n}){const[i,o]=de.useState([]),[a,l]=de.useState(new Set),[c,u]=de.useState(!1);de.useEffect(()=>{if(!e.scriptText)return;u(!0);const _=j_(e.scriptText);if(!_.success){alert("Failed to re-parse script: "+_.errors.join(", ")),u(!1);return}const C=[],E=new Map;e.pages.forEach(k=>{k.panels.forEach(M=>{if(M.scriptRef){const P=`${M.scriptRef.pageNumber}-${M.scriptRef.panelNumber}`;E.set(P,M)}})});const R=new Map;_.pages.forEach(k=>{k.panels.forEach(M=>{const P=`${k.pageNumber}-${M.panelNumber}`;R.set(P,{page:k.pageNumber,panel:M})})}),R.forEach((k,M)=>{const P=E.get(M),W=k.panel;P?P.prompt!==W.description&&C.push({type:"modified",pageNumber:k.page,panelNumber:W.panelNumber,oldPanel:P,oldDescription:P.prompt,newDescription:W.description,newPanel:{description:W.description,aspectRatio:W.aspectRatio,visualMarker:W.visualMarker}}):C.push({type:"added",pageNumber:k.page,panelNumber:W.panelNumber,newPanel:{description:W.description,aspectRatio:W.aspectRatio,visualMarker:W.visualMarker}})}),E.forEach((k,M)=>{!R.has(M)&&k.scriptRef&&C.push({type:"removed",pageNumber:k.scriptRef.pageNumber,panelNumber:k.scriptRef.panelNumber,oldPanel:k,oldDescription:k.prompt})}),C.sort((k,M)=>k.pageNumber!==M.pageNumber?k.pageNumber-M.pageNumber:k.panelNumber-M.panelNumber),o(C),u(!1)},[e]);const d=()=>{const _=new Set(i.map((C,E)=>E));l(_)},h=()=>{l(new Set)},v=_=>{const C=new Set(a);C.has(_)?C.delete(_):C.add(_),l(C)},b=()=>{const _=Array.from(a).map(E=>i[E]),C=e.pages.map(E=>({...E}));console.log("Applying changes:",_),n(C)},g=_=>{switch(_){case"added":return"bg-green-950/30 border-green-700";case"removed":return"bg-red-950/30 border-red-700";case"modified":return"bg-yellow-950/30 border-yellow-700";default:return"bg-ink-800 border-ink-700"}},A=_=>{switch(_){case"added":return"+";case"removed":return"";case"modified":return"";default:return""}};return p.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-xl flex items-center justify-center z-[700] p-8",children:p.jsxs("div",{className:"w-full max-w-6xl bg-ink-950 border border-ink-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[p.jsxs("div",{className:"p-6 border-b border-ink-700 flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h2",{className:"font-display text-3xl tracking-widest text-ember-500 uppercase",children:"Script Re-parse"}),p.jsx("p",{className:"text-[10px] font-mono text-steel-500 mt-1 uppercase tracking-widest",children:"Review changes detected in script"})]}),p.jsx("button",{onClick:t,className:"w-10 h-10 flex items-center justify-center rounded-full bg-ink-800 hover:bg-red-500 text-steel-400 hover:text-white transition-all text-xl font-bold",children:p.jsx(Vs,{size:20})})]}),p.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:c?p.jsxs("div",{className:"flex flex-col items-center gap-4 py-12 text-steel-400",children:[p.jsx("div",{className:"w-10 h-10 rounded-full border-[3px] border-cyan-500 border-t-transparent animate-spin"}),p.jsx("p",{className:"text-sm font-mono text-steel-300 font-bold uppercase tracking-widest",children:"Analyzing Script Changes"}),p.jsxs("div",{className:"flex flex-col gap-2 w-56",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"w-5 h-5 rounded-full bg-green-500 text-white flex items-center justify-center text-[10px] font-bold",children:""}),p.jsx("span",{className:"text-xs font-mono text-green-400",children:"Re-parsing script..."})]}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"w-5 h-5 rounded-full bg-cyan-500 text-white flex items-center justify-center text-[10px] font-bold animate-pulse",children:"2"}),p.jsx("span",{className:"text-xs font-mono text-cyan-400",children:"Comparing panels..."})]}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"w-5 h-5 rounded-full bg-ink-800 text-steel-600 flex items-center justify-center text-[10px] font-bold",children:"3"}),p.jsx("span",{className:"text-xs font-mono text-steel-600",children:"Building diff view..."})]})]})]}):i.length===0?p.jsx("div",{className:"text-center py-12 text-steel-400",children:"No changes detected in the script."}):i.map((_,C)=>p.jsxs("div",{className:`border-2 rounded-lg p-4 transition-all ${g(_.type)} ${a.has(C)?"ring-2 ring-ember-500":""}`,children:[p.jsxs("div",{className:"flex items-start justify-between mb-2",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-full font-bold ${_.type==="added"?"bg-green-500 text-white":_.type==="removed"?"bg-red-500 text-white":"bg-yellow-500 text-ink-950"}`,children:A(_.type)}),p.jsxs("div",{children:[p.jsxs("div",{className:"font-mono text-sm font-bold text-steel-200",children:["Page ",_.pageNumber,", Panel ",_.panelNumber]}),p.jsx("div",{className:"text-[10px] font-mono uppercase tracking-widest text-steel-500",children:_.type})]})]}),p.jsx("button",{onClick:()=>v(C),className:`px-4 py-2 rounded-lg text-xs font-bold transition-all ${a.has(C)?"bg-ember-500 text-ink-950":"bg-ink-800 text-steel-400 hover:bg-ink-700"}`,children:a.has(C)?"SELECTED":"SELECT"})]}),_.type==="added"&&_.newPanel&&p.jsxs("div",{className:"mt-3 p-3 bg-green-950/50 rounded-lg",children:[p.jsx("div",{className:"text-xs font-mono text-green-400 mb-1",children:"New Description:"}),p.jsx("div",{className:"text-sm text-steel-200",children:_.newPanel.description})]}),_.type==="removed"&&_.oldDescription&&p.jsxs("div",{className:"mt-3 p-3 bg-red-950/50 rounded-lg",children:[p.jsx("div",{className:"text-xs font-mono text-red-400 mb-1",children:"Removed Description:"}),p.jsx("div",{className:"text-sm text-steel-200 line-through",children:_.oldDescription})]}),_.type==="modified"&&p.jsxs("div",{className:"mt-3 space-y-2",children:[p.jsxs("div",{className:"p-3 bg-red-950/50 rounded-lg",children:[p.jsx("div",{className:"text-xs font-mono text-red-400 mb-1",children:"Before:"}),p.jsx("div",{className:"text-sm text-steel-200",children:_.oldDescription})]}),p.jsxs("div",{className:"p-3 bg-green-950/50 rounded-lg",children:[p.jsx("div",{className:"text-xs font-mono text-green-400 mb-1",children:"After:"}),p.jsx("div",{className:"text-sm text-steel-200",children:_.newDescription})]})]})]},C))}),p.jsxs("div",{className:"p-6 border-t border-ink-700 flex items-center justify-between gap-4",children:[p.jsxs("div",{className:"flex gap-3",children:[p.jsx("button",{onClick:d,disabled:i.length===0,className:"px-6 py-3 bg-green-600 hover:bg-green-500 text-white font-bold text-sm uppercase tracking-widest rounded-lg transition-all disabled:opacity-30",children:"Accept All"}),p.jsx("button",{onClick:h,disabled:i.length===0,className:"px-6 py-3 bg-red-600 hover:bg-red-500 text-white font-bold text-sm uppercase tracking-widest rounded-lg transition-all disabled:opacity-30",children:"Reject All"})]}),p.jsxs("button",{onClick:b,disabled:a.size===0,className:"px-8 py-3 bg-ember-500 hover:bg-ember-400 text-ink-950 font-bold text-sm uppercase tracking-widest rounded-lg transition-all disabled:opacity-30",children:["Apply ",a.size," Changes"]})]})]})})}const EU={standard:"bg-ink-800/20",echo:"bg-red-500/10 border-l-4 border-red-500",hitch:"bg-cyan-500/10 border-l-4 border-cyan-500",overflow:"bg-purple-500/10 border-l-4 border-purple-500",shattered:"bg-red-400/10 border-l-4 border-red-400",split:"bg-amber-500/10 border-l-4 border-amber-500",splash:"bg-emerald-500/10 border-l-4 border-emerald-500",inset:"bg-sky-400/10 border-l-4 border-sky-400",large:"bg-lime-500/10 border-l-4 border-lime-500","full-width":"bg-pink-500/10 border-l-4 border-pink-500"};function NU({issue:e,activePanelId:t,onPanelClick:n,onScriptSectionClick:i,onSyncPrompt:o,onReparseApply:a,children:l}){const[c,u]=de.useState(null),[d,h]=de.useState(new Map),[v,b]=de.useState(!1),g=de.useRef(null);de.useEffect(()=>{if(t&&e.scriptText){const R=A(e,t);R!=null&&R.scriptRef&&(u({start:R.scriptRef.startOffset,end:R.scriptRef.endOffset}),_(R.scriptRef.startOffset,R.scriptRef.endOffset))}},[t,e]);const A=(R,k)=>{for(const M of R.pages){const P=M.panels.find(W=>W.id===k);if(P)return P}return null},_=(R,k)=>{if(!g.current||!e.scriptText)return;const M=g.current.querySelectorAll("[data-offset]");for(const P of Array.from(M)){const W=parseInt(P.getAttribute("data-offset")||"0");if(W>=R&&W<=k){P.scrollIntoView({behavior:"smooth",block:"center"});break}}},C=R=>{for(const k of e.pages)for(const M of k.panels)if(M.scriptRef&&R>=M.scriptRef.startOffset&&R<=M.scriptRef.endOffset){i(M.id);return}},E=()=>{if(!e.scriptText)return null;const R=e.scriptText,k=[];for(const W of e.pages)for(const V of W.panels)V.scriptRef&&k.push({start:V.scriptRef.startOffset,end:V.scriptRef.endOffset,panelId:V.id,visualMarker:V.scriptRef.visualMarker||"standard",text:R.substring(V.scriptRef.startOffset,V.scriptRef.endOffset)});k.sort((W,V)=>W.start-V.start);const M=[];let P=0;if(k.forEach((W,V)=>{if(W.start>P){const z=R.substring(P,W.start);M.push(p.jsx("div",{className:"text-steel-400 p-2",children:z},`between-${V}`))}const j=c&&W.start>=c.start&&W.end<=c.end?"bg-ember-500/10 border-l-4 border-ember-500":"",X=EU[W.visualMarker]||"";M.push(p.jsxs("div",{"data-offset":W.start,className:`p-3 rounded-lg cursor-pointer transition-all ${X} ${j} hover:bg-ember-500/5`,onClick:()=>C(W.start),children:[p.jsx("div",{className:"text-steel-300 whitespace-pre-wrap",children:W.text}),d.has(W.panelId)&&p.jsx("button",{onClick:z=>{z.stopPropagation();const U=d.get(W.panelId);o(W.panelId,U);const q=new Map(d);q.delete(W.panelId),h(q)},className:"mt-2 px-3 py-1 bg-ember-500 hover:bg-ember-400 text-ink-950 text-xs font-bold rounded transition-all",children:"Sync "})]},`section-${V}`)),P=W.end}),P<R.length){const W=R.substring(P);M.push(p.jsx("div",{className:"text-steel-400 p-2",children:W},"remaining"))}return M};return e.scriptText?p.jsxs(p.Fragment,{children:[p.jsxs(tE,{orientation:"horizontal",className:"h-full",children:[p.jsx(Mg,{defaultSize:40,minSize:20,className:"bg-ink-950",children:p.jsxs("div",{className:"h-full flex flex-col",children:[p.jsxs("div",{className:"p-4 border-b border-ink-700 flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h2",{className:"font-display text-xl tracking-widest text-ember-500 uppercase",children:"Script"}),p.jsx("p",{className:"text-[10px] font-mono text-steel-500 mt-1 uppercase tracking-widest",children:"Click sections to navigate panels"})]}),p.jsxs("button",{onClick:()=>b(!0),className:"px-3 py-2 bg-ink-800 hover:bg-ember-500 text-steel-400 hover:text-ink-950 rounded-lg transition-all flex items-center gap-2 text-xs font-bold uppercase",title:"Re-parse script",children:[p.jsx(uw,{size:14}),"Re-parse"]})]}),p.jsx("div",{ref:g,className:"flex-1 overflow-y-auto p-4 font-mono text-xs",children:E()})]})}),p.jsx(nE,{className:"w-1 bg-ink-700 hover:bg-ember-500 transition-colors cursor-col-resize"}),p.jsx(Mg,{defaultSize:60,minSize:20,children:p.jsx("div",{className:"h-full bg-ink-900",children:l})})]}),v&&p.jsx(SU,{issue:e,onClose:()=>b(!1),onApplyChanges:R=>{a(R),b(!1)}})]}):p.jsx(p.Fragment,{children:l})}const AU=(e,t)=>{const{user:n}=g1(),[i,o]=de.useState({status:"idle"});de.useRef(null),de.useRef(""),de.useRef(!1);const a=de.useRef(e);de.useEffect(()=>{a.current=e},[e]);const l=de.useMemo(()=>e!=null&&e.projects?JSON.stringify(e.projects):"",[e==null?void 0:e.projects]);de.useEffect(()=>{},[n==null?void 0:n.id,t]),de.useEffect(()=>{},[n==null?void 0:n.id,l,e]);const c=de.useCallback(async()=>{},[n==null?void 0:n.id,e]);return{syncStatus:i,saveAllProjects:c}},CU=({status:e})=>{const t=()=>{switch(e.status){case"saving":return p.jsx("svg",{className:"w-4 h-4 animate-spin",viewBox:"0 0 24 24",fill:"none",children:p.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"32",strokeLinecap:"round"})});case"saved":return p.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:p.jsx("path",{d:"M5 13l4 4L19 7"})});case"error":return p.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[p.jsx("circle",{cx:"12",cy:"12",r:"10"}),p.jsx("path",{d:"M12 8v4M12 16h.01"})]});default:return p.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:p.jsx("path",{d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})})}},n=()=>{switch(e.status){case"saving":return"Saving...";case"saved":return"Saved";case"error":return"Sync error";default:return"Ready"}},i=()=>{switch(e.status){case"saving":return"text-ember-400";case"saved":return"text-green-400";case"error":return"text-red-400";default:return"text-steel-500"}};return p.jsxs("div",{className:`flex items-center gap-2 text-xs ${i()}`,title:e.error,children:[t(),p.jsx("span",{children:n()})]})};function TU(e){const t=[e.name];if(e.appearance){const n=e.appearance,i=[];n.age&&i.push(n.age),n.gender&&i.push(n.gender),n.ethnicity&&i.push(n.ethnicity),n.height&&i.push(n.height),n.build&&i.push(n.build),n.skinTone&&i.push(`${n.skinTone} skin`),n.hairColor&&n.hairStyle?i.push(`${n.hairColor} ${n.hairStyle} hair`):n.hairColor?i.push(`${n.hairColor} hair`):n.hairStyle&&i.push(`${n.hairStyle} hair`),n.eyeColor&&i.push(`${n.eyeColor} eyes`),n.facialFeatures&&i.push(n.facialFeatures),n.distinguishingMarks&&i.push(n.distinguishingMarks),n.clothing&&i.push(`wearing ${n.clothing}`),n.accessories&&i.push(`with ${n.accessories}`),n.additionalNotes&&i.push(n.additionalNotes),i.length>0&&t.push(`(${i.join(", ")})`)}else e.description&&t.push(`(${e.description})`);return t.join(" ")}function kU(e){return{generateImage:async(n,i,o=[],a,l=.7)=>{try{const c=Ip.find(A=>A.id===e.style),u=e.style==="custom"?e.customStylePrompt||"":(c==null?void 0:c.prompt)||"",d=o.length>0?`Characters: ${o.map(A=>TU(A)).join("; ")}.`:"",h=nf[i],b=`${u}. ${d} ${n}.${a?" Maintain strong visual and character consistency with the reference image. Same lighting, angle, style.":""}`.trim();let g;if(e.imageProvider==="gemini"&&e.geminiApiKey)g=await Up(b,h.ratio,e.geminiApiKey,a,l);else if(e.imageProvider==="leonardo"&&e.leonardoApiKey)g=await zp(b,i,e.leonardoApiKey,a,l);else if(e.imageProvider==="grok"&&e.grokApiKey)g=await jp(b,i,e.grokApiKey,a,l);else if(e.imageProvider==="fal"&&e.falApiKey)g=await Fp(b,i,e.falApiKey,e.fluxModel||"fal-ai/flux-pro",a,l);else if(e.imageProvider==="seaart"&&e.seaartApiKey)g=await Bp(b,i,e.seaartApiKey,a,l);else if(e.imageProvider==="openai"&&e.openaiApiKey)g=await qp(b,i,e.openaiApiKey,a,l);else throw new Error(`No API key configured for provider: ${e.imageProvider}`);return g}catch(c){throw console.error("Image generation failed:",c),c}}}}function Ju(e){return e.toLowerCase().trim().replace(/\s+/g," ")}function Qh(e,t){if(!e||!t)return!1;const n=Ju(e),o=Ju(t).replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return new RegExp(`\\b${o}\\b`,"i").test(n)}function IU(e,t){const n=Ju(e);return t.find(i=>Ju(i.name)===n)||null}function RU(e,t){const n=[],i=[],o=new Map;for(const a of e){const l=IU(a.name,t);if(l)i.push(l),o.set(Ju(a.name),l.id);else{const c=Date.now(),u={id:ls(),createdAt:c,updatedAt:c,name:a.name,role:LU(a),archetype:"",eras:[Ym("Default")],voice_profile:{samples:[],style:""},smart_tags:{Status:"Active"},gallery:[],loreEntryIds:[],description:a.description||a.firstAppearance||""};n.push(u),o.set(Ju(a.name),u.id)}}return{created:n,existing:i,nameToId:o}}function LU(e){return e.lineCount>=20?"Protagonist":e.lineCount>=10||e.lineCount>=3?"Supporting":"Minor"}function MU(e,t){const n=new Map;let i=0;for(const o of e.pages)for(const a of o.panels){const l=[];for(const c of t){if(!c.name||c.name.length<2)continue;const u=Qh(a.prompt||"",c.name),d=a.textElements.some(v=>Qh(v.content,c.name)),h=Qh(a.notes||"",c.name);(u||d||h)&&(a.characterIds.includes(c.id)||(l.push(c.id),i++))}l.length>0&&n.set(a.id,l)}return{panelLinks:n,newLinkCount:i}}function DU(e,t){const n=[],i=t.filter(o=>o.name.length>=3);for(const o of e.pages)for(const a of o.panels){const c=[a.prompt||"",a.notes||"",...a.textElements.map(u=>u.content)].filter(Boolean).join(" ");for(const u of i)if(Qh(c,u.name)){const d=c.toLowerCase().indexOf(u.name.toLowerCase()),h=Math.max(0,d-30),v=Math.min(c.length,d+u.name.length+30),b=(h>0?"...":"")+c.slice(h,v)+(v<c.length?"...":"");n.push({loreEntryId:u.id,loreEntryName:u.name,panelId:a.id,pageNumber:o.number,context:b})}}return n}function PU(e){const t=[e.name];if(e.appearance){const n=e.appearance,i=[];n.age&&i.push(n.age),n.gender&&i.push(n.gender),n.ethnicity&&i.push(n.ethnicity),n.height&&i.push(n.height),n.build&&i.push(n.build),n.skinTone&&i.push(`${n.skinTone} skin`),n.hairColor&&n.hairStyle?i.push(`${n.hairColor} ${n.hairStyle} hair`):n.hairColor?i.push(`${n.hairColor} hair`):n.hairStyle&&i.push(`${n.hairStyle} hair`),n.eyeColor&&i.push(`${n.eyeColor} eyes`),n.facialFeatures&&i.push(n.facialFeatures),n.distinguishingMarks&&i.push(n.distinguishingMarks),n.clothing&&i.push(`wearing ${n.clothing}`),n.accessories&&i.push(`with ${n.accessories}`),n.additionalNotes&&i.push(n.additionalNotes),i.length>0&&t.push(`(${i.join(", ")})`)}else e.description&&t.push(`(${e.description})`);return t.join(" ")}const iE=e=>({transform:t})=>({...t,x:t.x/e,y:t.y/e}),ep=2e3,tp=1500,OU=()=>{const{inkState:e,inkDispatch:t,inkCanUndo:n,inkCanRedo:i,characters:o}=xi(),a=e,l=t,{user:c,signOut:u,loading:d}=g1(),h=de.useRef(a.activeProjectId);de.useEffect(()=>{h.current=a.activeProjectId},[a.activeProjectId]);const v=de.useCallback(Le=>{var ut,wt,lt,et;if(!Le.length)return;const nt=h.current&&Le.some(pt=>pt.id===h.current)?h.current:(ut=Le[0])==null?void 0:ut.id,Qe=Le.find(pt=>pt.id===nt);l({type:"HYDRATE",payload:{projects:Le,activeProjectId:nt||null,activeIssueId:((wt=Qe==null?void 0:Qe.issues[0])==null?void 0:wt.id)||null,activePageId:((et=(lt=Qe==null?void 0:Qe.issues[0])==null?void 0:lt.pages[0])==null?void 0:et.id)||null}})},[l]),{syncStatus:b}=AU(a,v),[g,A]=de.useState(!1),[_,C]=de.useState(!1),[E,R]=de.useState(!1),[k,M]=de.useState(!1),[P,W]=de.useState(null),[V,$]=de.useState(!1),[j,X]=de.useState(!1),[z,U]=de.useState(!1),[q,I]=de.useState(!1),[ie,J]=de.useState(!1),[Y,le]=de.useState(!1),[pe,Ie]=de.useState(!1),[G,O]=de.useState(null),[ee,te]=de.useState(null),[ce,ye]=de.useState(!1),[we,Te]=de.useState("canvas"),[Ce,De]=de.useState(!1),[$e,at]=de.useState(!1),[st,B]=de.useState(0),[K,_e]=de.useState(0),he=de.useRef(!1),ne=a.projects.find(Le=>Le.id===a.activeProjectId),ae=ne==null?void 0:ne.issues.find(Le=>Le.id===a.activeIssueId),be=ae==null?void 0:ae.pages.find(Le=>Le.id===a.activePageId),Me=ne?kU(ne):null;de.useEffect(()=>{const Le=nt=>{var Qe;if(!(nt.target instanceof HTMLInputElement||nt.target instanceof HTMLTextAreaElement||(Qe=nt.target)!=null&&Qe.isContentEditable)&&!pe&&((nt.ctrlKey||nt.metaKey)&&nt.key==="z"&&!nt.shiftKey&&(nt.preventDefault(),n&&l({type:"UNDO"})),(nt.ctrlKey||nt.metaKey)&&(nt.key==="y"||nt.key==="z"&&nt.shiftKey)&&(nt.preventDefault(),i&&l({type:"REDO"})),be&&be.panels.length>0)){const ut=G?be.panels.findIndex(wt=>wt.id===G):-1;if(nt.key==="ArrowLeft"||nt.key==="ArrowUp"){nt.preventDefault();const wt=ut<=0?be.panels.length-1:ut-1;O(be.panels[wt].id)}if(nt.key==="ArrowRight"||nt.key==="ArrowDown"){nt.preventDefault();const wt=ut>=be.panels.length-1?0:ut+1;O(be.panels[wt].id)}nt.key==="Delete"&&G&&(nt.preventDefault(),confirm("Delete this panel?")&&(l({type:"DELETE_PANEL",panelId:G,pageId:be.id}),O(null))),nt.key==="Escape"&&O(null)}};return window.addEventListener("keydown",Le),()=>window.removeEventListener("keydown",Le)},[n,i,be,G,pe]);const Se=gw(Jm(_p,{activationConstraint:{distance:8}})),He=de.useRef(null),Ne=Le=>{const nt=Le.active.id;W(nt);const Qe=be==null?void 0:be.panels.find(ut=>ut.id===nt);Qe&&(He.current={x:Qe.x||0,y:Qe.y||0})},ze=Le=>{const{active:nt,delta:Qe}=Le;if(W(null),nt&&He.current&&be){const ut=nt.id,wt=Math.max(0,He.current.x+Qe.x),lt=Math.max(0,He.current.y+Qe.y);l({type:"UPDATE_PANEL",panelId:ut,updates:{x:wt,y:lt}})}He.current=null},We=de.useMemo(()=>be==null?void 0:be.panels.find(Le=>Le.id===P),[P,be]),dt=async()=>{if(be){R(!0),M(!1);try{const Le=new T2,nt=Le.folder(`Page_${be.number}`);for(let lt=0;lt<be.panels.length;lt++){const et=be.panels[lt];if(et.imageUrl){let pt=et.imageUrl;if(pt.startsWith("idb://")){const Bt=pt.replace("idb://","");pt=await ka(Bt)||""}if(pt){const Bt=pt.split(",")[1];nt==null||nt.file(`panel_${lt+1}.png`,Bt,{base64:!0})}}}const Qe=await Le.generateAsync({type:"blob"}),ut=window.URL.createObjectURL(Qe),wt=document.createElement("a");wt.href=ut,wt.download=`Page_${be.number}_Ink.zip`,wt.click(),window.URL.revokeObjectURL(ut)}catch(Le){alert("Export failed: "+Le)}finally{R(!1)}}},ft=async()=>{if(ae){R(!0),M(!1);try{const Le=new T2;for(const wt of ae.pages)for(let lt=0;lt<wt.panels.length;lt++){const et=wt.panels[lt];if(et.imageUrl){let pt=et.imageUrl;if(pt.startsWith("idb://")){const Bt=pt.replace("idb://","");pt=await ka(Bt)||""}if(pt){const Bt=pt.split(",")[1],Vt=`pg${String(wt.number).padStart(3,"0")}_p${String(lt+1).padStart(2,"0")}.png`;Le.file(Vt,Bt,{base64:!0})}}}const nt=await Le.generateAsync({type:"blob"}),Qe=window.URL.createObjectURL(nt),ut=document.createElement("a");ut.href=Qe,ut.download=`${ae.title.replace(/\s+/g,"_")}.cbz`,ut.click(),window.URL.revokeObjectURL(Qe)}catch(Le){alert("Export failed: "+Le)}finally{R(!1)}}},ht=async()=>{if(be){R(!0),M(!1);try{const Le=new Dt({orientation:"landscape",unit:"mm",format:"a4"}),nt=Le.internal.pageSize.getWidth(),Qe=Le.internal.pageSize.getHeight();let ut=!1;for(let wt=0;wt<be.panels.length;wt++){const lt=be.panels[wt];if(lt.imageUrl){let et=lt.imageUrl;if(et.startsWith("idb://")){const pt=et.replace("idb://","");et=await ka(pt)||""}if(et){ut&&Le.addPage(),ut=!0;const pt=new Image;await new Promise(sn=>{pt.onload=()=>sn(),pt.src=et});const Bt=pt.width/pt.height,Vt=nt/Qe;let zt,Jt;Bt>Vt?(zt=nt-20,Jt=zt/Bt):(Jt=Qe-20,zt=Jt*Bt);const bt=(nt-zt)/2,jt=(Qe-Jt)/2;Le.addImage(et,"PNG",bt,jt,zt,Jt),Le.setFontSize(10),Le.setTextColor(150),Le.text(`Panel ${wt+1}`,10,10)}}}ut?Le.save(`Page_${be.number}.pdf`):alert("No images to export")}catch(Le){alert("PDF export failed: "+Le)}finally{R(!1)}}},Et=async()=>{if(ae){R(!0),M(!1);try{const Le=new Dt({orientation:"landscape",unit:"mm",format:"a4"}),nt=Le.internal.pageSize.getWidth(),Qe=Le.internal.pageSize.getHeight();let ut=!1;for(const wt of ae.pages)for(let lt=0;lt<wt.panels.length;lt++){const et=wt.panels[lt];if(et.imageUrl){let pt=et.imageUrl;if(pt.startsWith("idb://")){const Bt=pt.replace("idb://","");pt=await ka(Bt)||""}if(pt){ut&&Le.addPage(),ut=!0;const Bt=new Image;await new Promise(Nn=>{Bt.onload=()=>Nn(),Bt.src=pt});const Vt=Bt.width/Bt.height,zt=nt/Qe;let Jt,bt;Vt>zt?(Jt=nt-20,bt=Jt/Vt):(bt=Qe-20,Jt=bt*Vt);const jt=(nt-Jt)/2,sn=(Qe-bt)/2;Le.addImage(pt,"PNG",jt,sn,Jt,bt),Le.setFontSize(10),Le.setTextColor(150),Le.text(`Page ${wt.number} - Panel ${lt+1}`,10,10)}}}ut?Le.save(`${ae.title.replace(/\s+/g,"_")}.pdf`):alert("No images to export")}catch(Le){alert("PDF export failed: "+Le)}finally{R(!1)}}},mt=(Le,nt)=>{var bt;if(!Le.success||!ne)return;const Qe=RU(Le.characters,o);for(const jt of Qe.created)xi.getState().addCharacter({name:jt.name,role:jt.role,archetype:jt.archetype,eras:jt.eras,voice_profile:jt.voice_profile,smart_tags:jt.smart_tags,gallery:jt.gallery,loreEntryIds:jt.loreEntryIds,description:jt.description});const ut=xi.getState().characters,wt=new Map;for(const jt of Le.characters){const sn=ut.find(Nn=>Nn.name.toLowerCase().trim()===jt.name.toLowerCase().trim());sn&&wt.set(jt.name.toLowerCase().trim(),sn.id)}const lt=Le.pages.map(jt=>({id:ls(),number:jt.pageNumber,panels:jt.panels.map((sn,Nn)=>{const Xn=[sn.description,...sn.bubbles.map(rn=>`${rn.character||""} ${rn.text}`)].join(" "),mn=[];for(const[rn,wn]of wt.entries()){const Qi=rn.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");new RegExp(`\\b${Qi}\\b`,"i").test(Xn)&&mn.push(wn)}return{id:ls(),prompt:sn.description,aspectRatio:sn.aspectRatio,characterIds:[...new Set(mn)],x:Nn%3*400,y:Math.floor(Nn/3)*500,textElements:sn.bubbles.map((rn,wn)=>({id:ls(),type:rn.type==="dialogue"?"dialogue":rn.type==="thought"?"thought":"caption",content:rn.character?`${rn.character}: ${rn.text}`:rn.text,x:10,y:10+wn*15,width:30,height:10,fontSize:18,color:"#000000",rotation:0,tailX:15,tailY:10+wn*15+15,tailStyle:rn.type==="thought"?"cloud":rn.type==="caption"?"none":"pointy"})),scriptRef:sn.startOffset!==void 0&&sn.endOffset!==void 0?{pageNumber:jt.pageNumber,panelNumber:sn.panelNumber,startOffset:sn.startOffset,endOffset:sn.endOffset,visualMarker:sn.visualMarker}:void 0}})})),et=xi.getState().loreEntries,Bt=DU({pages:lt},et),Vt=Le.characters.map(jt=>({id:ls(),name:jt.name,description:jt.firstAppearance||`${jt.lineCount} lines`})),zt={id:ls(),title:(bt=Le.issue)!=null&&bt.title?`${Le.issue.title}${Le.issue.issueNumber?` #${Le.issue.issueNumber}`:""}`:`Imported: ${Le.pages.length} Pages`,pages:lt,scriptText:nt};l({type:"IMPORT_ISSUE",projectId:ne.id,issue:zt,characters:Vt}),$(!1),le(!0);const Jt=[Qe.created.length>0?`${Qe.created.length} new character${Qe.created.length>1?"s":""} added`:null,Qe.existing.length>0?`${Qe.existing.length} existing matched`:null,Bt.length>0?`${Bt.length} lore mention${Bt.length>1?"s":""} detected`:null].filter(Boolean).join("  ");Jt&&console.log(`[LIT Sync] ${Jt}`)},on=()=>{if(!ae||!ne)return;const Le=xi.getState().characters,nt=MU(ae,Le);if(nt.newLinkCount===0){alert("All panels are already linked. No new character matches found.");return}if(confirm(`Found ${nt.newLinkCount} new character link${nt.newLinkCount>1?"s":""} across ${nt.panelLinks.size} panel${nt.panelLinks.size>1?"s":""}. Apply?`))for(const[Qe,ut]of nt.panelLinks){const wt=ae.pages.flatMap(lt=>lt.panels).find(lt=>lt.id===Qe);wt&&l({type:"UPDATE_PANEL",panelId:Qe,updates:{characterIds:[...new Set([...wt.characterIds,...ut])]}})}},yt=async()=>{if(!(!be||_||!ne)){C(!0);try{for(const Le of be.panels){if(!Le.prompt&&Le.characterIds.length===0||Le.imageUrl)continue;const nt=Ip.find(zt=>zt.id===(ne==null?void 0:ne.style)),Qe=(nt==null?void 0:nt.prompt)||"",ut=o.filter(zt=>Le.characterIds.includes(zt.id)),wt=ut.length>0?`Characters: ${ut.map(zt=>PU(zt)).join("; ")}.`:"",lt=nf[Le.aspectRatio];let et;if(Le.referencePanelId){const zt=be.panels.find(Jt=>Jt.id===Le.referencePanelId);if(zt!=null&&zt.imageUrl){const Jt=zt.imageUrl.startsWith("idb://")?zt.imageUrl.slice(6):null;Jt&&(et=await ka(Jt)||void 0)}}const Bt=`${Qe}. ${wt} ${Le.prompt}.${et?" Maintain strong visual and character consistency with the reference image. Same lighting, angle, style.":""}`.trim();let Vt;try{ne.imageProvider==="gemini"&&ne.geminiApiKey?Vt=await Up(Bt,lt.ratio,ne.geminiApiKey,et,Le.referenceStrength??.7):ne.imageProvider==="leonardo"&&ne.leonardoApiKey?Vt=await zp(Bt,Le.aspectRatio,ne.leonardoApiKey,et,Le.referenceStrength??.7):ne.imageProvider==="grok"&&ne.grokApiKey?Vt=await jp(Bt,Le.aspectRatio,ne.grokApiKey,et,Le.referenceStrength??.7):ne.imageProvider==="fal"&&ne.falApiKey?Vt=await Fp(Bt,Le.aspectRatio,ne.falApiKey,ne.fluxModel||"fal-ai/flux-pro",et,Le.referenceStrength??.7):ne.imageProvider==="seaart"&&ne.seaartApiKey?Vt=await Bp(Bt,Le.aspectRatio,ne.seaartApiKey,et,Le.referenceStrength??.7):ne.imageProvider==="openai"&&ne.openaiApiKey?Vt=await qp(Bt,Le.aspectRatio,ne.openaiApiKey,et,Le.referenceStrength??.7):console.warn(`No API key configured for provider: ${ne.imageProvider}`)}catch(zt){console.error(zt)}if(Vt){const zt=await ss(Le.id,Vt);l({type:"UPDATE_PANEL",panelId:Le.id,updates:{imageUrl:zt}})}await new Promise(zt=>setTimeout(zt,q5))}}catch(Le){alert(`Batch Failed: ${Le.message}`)}finally{C(!1)}}},vt=async()=>{if(!be||!ne||!Me)return;const Le=be.panels.filter(nt=>{var Qe;return(((Qe=nt.prompt)==null?void 0:Qe.trim())||nt.characterIds.length>0)&&!nt.imageUrl});if(Le.length===0){alert("No panels to generate. All panels either have images or lack prompts.");return}at(!0),_e(Le.length),he.current=!1;for(let nt=0;nt<Le.length;nt++){if(he.current){console.log("Generation cancelled by user");break}B(nt+1);const Qe=Le[nt];try{const ut=o.filter(et=>Qe.characterIds.includes(et.id));let wt;if(Qe.referencePanelId){const et=be.panels.find(pt=>pt.id===Qe.referencePanelId);if(et!=null&&et.imageUrl){const pt=et.imageUrl.startsWith("idb://")?et.imageUrl.slice(6):null;pt&&(wt=await ka(pt)||void 0)}}const lt=await Me.generateImage(Qe.prompt||"",Qe.aspectRatio,ut,wt,Qe.referenceStrength??.7);if(lt){const et=await ss(Qe.id,lt);l({type:"UPDATE_PANEL",panelId:Qe.id,updates:{imageUrl:et}})}await new Promise(et=>setTimeout(et,q5))}catch(ut){console.error(`Failed to generate panel ${nt+1}:`,ut)}}at(!1),B(0),_e(0)},Rt=()=>{if(!ae||!be)return;const Le=ae.pages.findIndex(ut=>ut.id===be.id),Qe=Math.max(0,Le-(q?2:1));Qe!==Le&&l({type:"SET_ACTIVE_PAGE",id:ae.pages[Qe].id})},Ft=()=>{if(!ae||!be)return;const Le=ae.pages.findIndex(ut=>ut.id===be.id),nt=q?2:1,Qe=Math.min(ae.pages.length-1,Le+nt);Qe!==Le&&l({type:"SET_ACTIVE_PAGE",id:ae.pages[Qe].id})};return p.jsxs("div",{className:`flex-1 flex overflow-hidden font-sans selection:bg-ember-500/30 ${z?"bg-amber-50/60":"bg-ink-950"}`,children:[p.jsx(LO,{state:a,dispatch:l,onOpenProjects:()=>A(!0),onOpenScriptImport:()=>$(!0)}),p.jsx(yT,{disabled:!j,initialScale:1,minScale:.1,maxScale:3,centerOnInit:!0,limitToBounds:!1,panning:{disabled:!j,velocityDisabled:!0},wheel:{disabled:!j},children:p.jsxs("main",{className:`flex-1 flex flex-col overflow-hidden relative transition-colors ${z?"bg-amber-50/60":"bg-ink-950"} ${j?"cursor-grab active:cursor-grabbing":""}`,children:[p.jsxs("header",{className:`border-b flex flex-col z-[100] backdrop-blur-xl transition-all shrink-0 ${z?"bg-amber-50/80 border-amber-200":"bg-ink-900/40 border-ink-750"}`,children:[p.jsxs("div",{className:"flex items-center justify-between px-6 py-3",children:[p.jsx("div",{className:"flex items-center gap-5 overflow-hidden",children:p.jsxs("div",{className:"hidden md:flex flex-col gap-0.5 min-w-0",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:`w-2 h-2 rounded-full ${z?"bg-black":"bg-ember-500"}`}),p.jsx("h1",{className:`text-lg font-display font-bold tracking-tight ${z?"text-black":"text-steel-100"}`,children:"Storyboard"})]}),p.jsxs("div",{className:`flex items-center gap-1.5 text-[9px] font-mono uppercase tracking-[0.15em] pl-4 ${z?"text-gray-500":"text-steel-600"}`,children:[p.jsx("span",{children:ne==null?void 0:ne.title}),p.jsx("span",{className:"opacity-30",children:"/"}),p.jsx("span",{className:z?"text-gray-700":"text-ember-400",children:ae==null?void 0:ae.title}),p.jsx("span",{className:"opacity-30",children:"/"}),p.jsx("span",{className:z?"text-black":"text-steel-300",children:we==="canvas"?`Page ${(be==null?void 0:be.number)||"-"}`:"Guide"})]})]})}),p.jsxs("div",{className:"flex items-center gap-3",children:[c&&p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(CU,{status:b}),p.jsx("button",{onClick:u,className:`text-[10px] font-mono uppercase tracking-widest transition-colors ${z?"text-gray-500 hover:text-black":"text-steel-500 hover:text-ember-500"}`,title:"Sign out",children:"Logout"})]}),p.jsxs("div",{className:`flex items-center gap-1 rounded-full border p-1 ${z?"bg-gray-100 border-gray-300":"bg-ink-900 border-ink-700"}`,children:[p.jsx("button",{onClick:()=>Te("canvas"),className:`font-mono text-[10px] px-5 py-1.5 tracking-widest transition-all rounded-full ${we==="canvas"?z?"bg-white text-black shadow-sm":"bg-ember-500 text-ink-950 shadow-lg":z?"text-gray-600 hover:text-black":"text-steel-400 hover:text-steel-200"}`,children:"CANVAS"}),p.jsx("button",{onClick:()=>Te("guide"),className:`font-mono text-[10px] px-5 py-1.5 tracking-widest transition-all rounded-full ${we==="guide"?z?"bg-white text-black shadow-sm":"bg-ember-500 text-ink-950 shadow-lg":z?"text-gray-600 hover:text-black":"text-steel-400 hover:text-steel-200"}`,children:"GUIDE"})]})]})]}),p.jsxs("div",{className:"flex items-center justify-between gap-4 px-6 py-2 border-t border-ink-800/50",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs("div",{className:`flex items-center gap-0.5 rounded-lg border p-0.5 ${z?"border-gray-300 bg-gray-100":"border-ink-700 bg-ink-850"}`,children:[p.jsx("button",{onClick:()=>l({type:"UNDO"}),disabled:!n,className:`p-1.5 rounded transition-all disabled:opacity-20 disabled:cursor-not-allowed ${z?"hover:bg-gray-200 text-gray-600":"hover:bg-ink-700 text-steel-400 hover:text-steel-200"}`,title:"Undo (Ctrl+Z)",children:p.jsx(S3,{size:16})}),p.jsx("button",{onClick:()=>l({type:"REDO"}),disabled:!i,className:`p-1.5 rounded transition-all disabled:opacity-20 disabled:cursor-not-allowed ${z?"hover:bg-gray-200 text-gray-600":"hover:bg-ink-700 text-steel-400 hover:text-steel-200"}`,title:"Redo (Ctrl+Y)",children:p.jsx(o3,{size:16})})]}),p.jsxs("div",{className:`flex items-center gap-0.5 rounded-lg border p-0.5 ${z?"border-gray-300 bg-gray-100":"border-ink-700 bg-ink-850"}`,children:[p.jsx(UO,{zoomEnabled:j,setZoomEnabled:X,showGutters:z,setShowGutters:U}),p.jsx("button",{onClick:()=>I(!q),className:`p-1.5 rounded transition-all ${q?z?"bg-ember-500 text-white":"bg-ember-500 text-ink-950":z?"hover:bg-gray-200 text-gray-600":"hover:bg-ink-700 text-steel-400 hover:text-steel-200"}`,title:"Spread View",children:p.jsx(Ku,{size:16})}),(ae==null?void 0:ae.scriptText)&&p.jsx("button",{onClick:()=>De(!Ce),className:`p-1.5 rounded transition-all ${Ce?z?"bg-ember-500 text-white":"bg-ember-500 text-ink-950":z?"hover:bg-gray-200 text-gray-600":"hover:bg-ink-700 text-steel-400 hover:text-steel-200"}`,title:"Script Split View",children:p.jsx(t2,{size:16})})]})]}),p.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end relative pointer-events-auto",children:[p.jsxs("div",{className:"relative",children:[p.jsxs("button",{onClick:()=>M(!k),className:`font-mono text-[10px] px-3 py-1.5 tracking-widest transition-all rounded-lg border flex items-center gap-2 active:scale-95 ${z?"bg-white border-gray-300 text-gray-600 hover:bg-gray-100":"bg-ink-850 border-ink-700 text-steel-400 hover:bg-ink-800 hover:text-steel-200"}`,children:[E?p.jsx(ko.Loader,{}):p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),E?"EXPORTING...":"EXPORT"]}),k&&p.jsxs("div",{className:`absolute top-full right-0 mt-2 w-56 rounded-2xl shadow-2xl overflow-hidden z-50 animate-fade-in py-1 ${z?"bg-white border border-gray-300":"bg-ink-900 border border-ink-700"}`,children:[p.jsx("div",{className:`px-4 py-2 text-[9px] font-mono uppercase tracking-widest ${z?"text-gray-400 border-b border-gray-200":"text-steel-600 border-b border-ink-800"}`,children:"Images"}),p.jsxs("button",{onClick:dt,className:`w-full text-left px-4 py-2.5 text-xs font-mono transition-colors uppercase tracking-widest flex items-center gap-3 ${z?"text-gray-700 hover:bg-gray-100":"text-steel-300 hover:bg-ember-500 hover:text-ink-950"}`,children:[p.jsx(Pl,{size:14}),p.jsx("span",{children:"ZIP Page Images"})]}),p.jsxs("button",{onClick:ft,className:`w-full text-left px-4 py-2.5 text-xs font-mono transition-colors uppercase tracking-widest flex items-center gap-3 ${z?"text-gray-700 hover:bg-gray-100":"text-steel-300 hover:bg-ember-500 hover:text-ink-950"}`,children:[p.jsx(Pl,{size:14}),p.jsx("span",{children:"CBZ Issue"})]}),p.jsx("div",{className:`px-4 py-2 text-[9px] font-mono uppercase tracking-widest ${z?"text-gray-400 border-y border-gray-200":"text-steel-600 border-y border-ink-800"}`,children:"PDF"}),p.jsxs("button",{onClick:ht,className:`w-full text-left px-4 py-2.5 text-xs font-mono transition-colors uppercase tracking-widest flex items-center gap-3 ${z?"text-gray-700 hover:bg-gray-100":"text-steel-300 hover:bg-ember-500 hover:text-ink-950"}`,children:[p.jsx(Pl,{size:14}),p.jsx("span",{children:"PDF Page"})]}),p.jsxs("button",{onClick:Et,className:`w-full text-left px-4 py-2.5 text-xs font-mono transition-colors uppercase tracking-widest flex items-center gap-3 ${z?"text-gray-700 hover:bg-gray-100":"text-steel-300 hover:bg-ember-500 hover:text-ink-950"}`,children:[p.jsx(Pl,{size:14}),p.jsx("span",{children:"PDF Issue"})]})]})]}),p.jsxs("button",{disabled:_||!(be!=null&&be.panels.length),onClick:yt,className:`font-mono text-[10px] px-4 py-1.5 tracking-widest transition-all rounded-lg border flex items-center gap-2 disabled:opacity-20 active:scale-95 ${z?"bg-black border-black text-white hover:bg-gray-800":"bg-ember-500 border-ember-500 text-ink-950 hover:bg-ember-400 shadow-lg shadow-ember-500/20"}`,children:[_?p.jsx(ko.Loader,{}):p.jsx(ko.Magic,{}),_?`INKING WITH ${((ne==null?void 0:ne.imageProvider)||"AI").toUpperCase()}...`:"AUTO-INK"]}),be&&be.panels.some(Le=>{var nt;return(((nt=Le.prompt)==null?void 0:nt.trim())||Le.characterIds.length>0)&&!Le.imageUrl})&&p.jsx("div",{className:"flex flex-col items-center gap-1",children:$e&&ne?p.jsx(MI,{provider:ne.imageProvider,current:st,total:K,onCancel:()=>{he.current=!0}}):p.jsxs(p.Fragment,{children:[p.jsxs("button",{onClick:vt,disabled:$e||_,className:`font-mono text-[10px] px-3 py-1.5 tracking-widest transition-all rounded-lg border flex items-center gap-2 disabled:opacity-20 active:scale-95 ${z?"bg-white border-gray-300 text-gray-600 hover:bg-gray-100":"bg-ink-850 border-ink-700 text-steel-400 hover:bg-ink-800 hover:text-steel-200"}`,children:[p.jsx(bp,{className:"w-4 h-4"}),"GENERATE ALL"]}),p.jsx("p",{className:"text-[9px] font-mono text-steel-600 mt-1 max-w-[200px] text-center",children:"Batch generation may consume significant API credits depending on your provider and plan. Review the panel count before proceeding."})]})}),p.jsxs("div",{className:"relative",children:[p.jsxs("button",{onClick:()=>J(!ie),className:`font-mono text-[10px] px-3 py-1.5 tracking-widest transition-all rounded-lg border flex items-center gap-2 active:scale-95 ${z?"bg-white border-gray-300 text-gray-600 hover:bg-gray-100":"bg-ink-850 border-ink-700 text-steel-400 hover:bg-ink-800 hover:text-steel-200"}`,title:"Apply page template",children:[p.jsx(sm,{size:16}),"TEMPLATES"]}),ie&&p.jsxs("div",{className:`absolute top-full right-0 mt-2 w-48 rounded-2xl shadow-2xl overflow-hidden z-50 animate-fade-in py-1 ${z?"bg-white border border-gray-300":"bg-ink-900 border border-ink-700"}`,children:[p.jsxs("button",{onClick:()=>{be&&l({type:"APPLY_PAGE_TEMPLATE",pageId:be.id,template:"2x2"}),J(!1)},className:`w-full text-left px-4 py-2.5 text-xs font-mono transition-colors flex items-center gap-3 ${z?"text-gray-700 hover:bg-gray-100":"text-steel-300 hover:bg-ember-500 hover:text-ink-950"}`,children:[p.jsx(yA,{size:16})," 22 Grid"]}),p.jsxs("button",{onClick:()=>{be&&l({type:"APPLY_PAGE_TEMPLATE",pageId:be.id,template:"3x3"}),J(!1)},className:`w-full text-left px-4 py-2.5 text-xs font-mono transition-colors flex items-center gap-3 ${z?"text-gray-700 hover:bg-gray-100":"text-steel-300 hover:bg-ember-500 hover:text-ink-950"}`,children:[p.jsx(xA,{size:16})," 33 Grid"]}),p.jsxs("button",{onClick:()=>{be&&l({type:"APPLY_PAGE_TEMPLATE",pageId:be.id,template:"2x3"}),J(!1)},className:`w-full text-left px-4 py-2.5 text-xs font-mono transition-colors flex items-center gap-3 ${z?"text-gray-700 hover:bg-gray-100":"text-steel-300 hover:bg-ember-500 hover:text-ink-950"}`,children:[p.jsx(t2,{size:16})," 23 Rows"]}),p.jsxs("button",{onClick:()=>{be&&l({type:"APPLY_PAGE_TEMPLATE",pageId:be.id,template:"manga-right"}),J(!1)},className:`w-full text-left px-4 py-2.5 text-xs font-mono transition-colors flex items-center gap-3 ${z?"text-gray-700 hover:bg-gray-100":"text-steel-300 hover:bg-ember-500 hover:text-ink-950"}`,children:[p.jsx(sm,{size:16})," Manga (RL)"]}),p.jsxs("button",{onClick:()=>{be&&l({type:"APPLY_PAGE_TEMPLATE",pageId:be.id,template:"manga-left"}),J(!1)},className:`w-full text-left px-4 py-2.5 text-xs font-mono transition-colors flex items-center gap-3 ${z?"text-gray-700 hover:bg-gray-100":"text-steel-300 hover:bg-ember-500 hover:text-ink-950"}`,children:[p.jsx(sm,{size:16})," Manga (LR)"]}),p.jsxs("button",{onClick:()=>{be&&l({type:"APPLY_PAGE_TEMPLATE",pageId:be.id,template:"single"}),J(!1)},className:`w-full text-left px-4 py-2.5 text-xs font-mono transition-colors flex items-center gap-3 ${z?"text-gray-700 hover:bg-gray-100":"text-steel-300 hover:bg-ember-500 hover:text-ink-950"}`,children:[p.jsx(v3,{size:16})," Single Splash"]}),p.jsxs("button",{onClick:()=>{be&&l({type:"APPLY_PAGE_TEMPLATE",pageId:be.id,template:"double-wide"}),J(!1)},className:`w-full text-left px-4 py-2.5 text-xs font-mono transition-colors flex items-center gap-3 ${z?"text-gray-700 hover:bg-gray-100":"text-steel-300 hover:bg-ember-500 hover:text-ink-950"}`,children:[p.jsx(i3,{size:16})," Double Wide"]})]})]}),(ae==null?void 0:ae.scriptText)&&p.jsxs("button",{onClick:()=>le(!Y),className:`font-mono text-xs px-4 py-2 tracking-widest transition-all rounded-full border flex items-center gap-2 active:scale-95 shadow-lg ${Y?"bg-ember-500 border-ember-400 text-ink-950":z?"bg-white border-black text-black hover:bg-gray-100":"bg-ink-800 border-ink-700 text-steel-200 hover:bg-ink-700"}`,title:"Toggle script reference panel",children:[p.jsx(Ug,{size:16}),"SCRIPT"]}),p.jsxs("button",{onClick:()=>ye(!0),className:`font-mono text-xs px-4 py-2 tracking-widest transition-all rounded-full border flex items-center gap-2 active:scale-95 shadow-lg ${z?"bg-white border-black text-black hover:bg-gray-100":"bg-ink-800 border-ink-700 text-steel-200 hover:bg-ink-700"}`,title:"Manage characters",children:[p.jsx(Ys,{size:16}),"CHARACTERS"]}),(()=>{const Le=(ae==null?void 0:ae.pages.reduce((nt,Qe)=>nt+Qe.panels.length,0))||0;return p.jsxs("button",{onClick:()=>Ie(!0),disabled:Le===0,className:`font-mono text-xs px-4 py-2 tracking-widest transition-all rounded-full border flex items-center gap-2 active:scale-95 shadow-lg disabled:opacity-30 ${z?"bg-white border-black text-black hover:bg-gray-100":"bg-ink-800 border-ink-700 text-steel-200 hover:bg-ink-700"}`,title:"Cinematic presentation mode",children:[p.jsx(cw,{size:16}),"PRESENT",Le>0?` (${Le})`:""]})})(),ae&&o.length>0&&p.jsxs("button",{onClick:on,className:`font-mono text-[10px] px-3 py-1.5 tracking-widest transition-all rounded-lg border flex items-center gap-2 active:scale-95 ${z?"bg-white border-gray-300 text-gray-600 hover:bg-gray-100":"bg-ink-850 border-ink-700 text-steel-400 hover:bg-ink-800 hover:text-steel-200"}`,title:"Scan panels and auto-link characters by name",children:[p.jsx(jl,{size:14}),"AUTO-LINK"]}),p.jsx("button",{onClick:()=>{if(be)l({type:"ADD_PANEL",pageId:be.id});else if(ae&&ae.pages.length>0){const Le=ae.pages[0];l({type:"SET_ACTIVE_PAGE",id:Le.id}),l({type:"ADD_PANEL",pageId:Le.id})}else ae&&l({type:"ADD_PAGE",issueId:ae.id})},className:`font-display text-xl px-6 py-2 tracking-widest transition-all rounded-full shadow-lg active:translate-y-1 ${z?"bg-black text-white hover:bg-gray-800":"bg-ember-500 hover:bg-ember-400 text-ink-950"}`,children:"ADD FRAME"})]})]}),p.jsx("div",{className:`h-[1px] ${z?"bg-gray-300":"header-gradient-ember"}`})]}),we==="canvas"?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:`flex-1 ${j?"overflow-hidden":"overflow-scroll"}`,children:Ce&&ae?p.jsx(NU,{issue:ae,activePanelId:G,onPanelClick:Le=>O(Le),onScriptSectionClick:Le=>O(Le),onSyncPrompt:(Le,nt)=>{l({type:"UPDATE_PANEL",panelId:Le,updates:{prompt:nt}})},onReparseApply:Le=>{ae&&l({type:"UPDATE_ISSUE",issueId:ae.id,updates:{pages:Le}})},children:p.jsx(A2,{wrapperClass:"w-full h-full",contentClass:"",children:q?p.jsx(Vx,{activePage:be,activeProject:ne,activeIssue:ae,dispatch:l,sensors:Se,handleDragStart:Ne,handleDragEnd:ze,activeId:P,activePanelForOverlay:We,showGutters:z,zoomEnabled:j,selectedPanelId:G,setSelectedPanelId:O,copiedPanelSettings:ee,setCopiedPanelSettings:te}):p.jsx(Gx,{activePage:be,activeProject:ne,dispatch:l,sensors:Se,handleDragStart:Ne,handleDragEnd:ze,activeId:P,activePanelForOverlay:We,showGutters:z,zoomEnabled:j,selectedPanelId:G,setSelectedPanelId:O,copiedPanelSettings:ee,setCopiedPanelSettings:te})})}):p.jsx(A2,{wrapperClass:"w-full h-full",contentClass:"",children:q?p.jsx(Vx,{activePage:be,activeProject:ne,activeIssue:ae,dispatch:l,sensors:Se,handleDragStart:Ne,handleDragEnd:ze,activeId:P,activePanelForOverlay:We,showGutters:z,zoomEnabled:j,selectedPanelId:G,setSelectedPanelId:O,copiedPanelSettings:ee,setCopiedPanelSettings:te}):p.jsx(Gx,{activePage:be,activeProject:ne,dispatch:l,sensors:Se,handleDragStart:Ne,handleDragEnd:ze,activeId:P,activePanelForOverlay:We,showGutters:z,zoomEnabled:j,selectedPanelId:G,setSelectedPanelId:O,copiedPanelSettings:ee,setCopiedPanelSettings:te})})}),p.jsxs("div",{className:`absolute bottom-8 left-1/2 -translate-x-1/2 border border-white/10 rounded-full px-8 py-4 flex items-center gap-10 shadow-2xl z-[400] transition-all ${z?"bg-white border-black text-black":"bg-ink-900/95 backdrop-blur-2xl text-steel-400"}`,children:[p.jsx("div",{className:"flex items-center gap-4",children:p.jsx(OI,{batching:_,exporting:E,isGeneratingAll:$e,provider:ne==null?void 0:ne.imageProvider,currentPanel:st,totalPanels:K,showGutters:z})}),p.jsx("div",{className:`h-5 w-px ${z?"bg-black/20":"bg-ink-700"}`}),p.jsx("div",{className:"flex gap-8",children:p.jsxs("div",{className:"flex flex-col",children:[p.jsx("span",{className:"text-[9px] font-mono uppercase mb-0.5 opacity-60",children:"Project"}),p.jsx("span",{className:`text-[11px] font-mono uppercase font-bold truncate max-w-[120px] ${z?"text-black":"text-steel-200"}`,children:ne==null?void 0:ne.title})]})}),p.jsx("div",{className:`h-5 w-px ${z?"bg-black/20":"bg-ink-700"}`}),p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("button",{onClick:Rt,disabled:!ae||ae.pages.findIndex(Le=>Le.id===(be==null?void 0:be.id))===0,className:`p-2 rounded-lg transition-all disabled:opacity-30 disabled:cursor-not-allowed ${z?"hover:bg-gray-200 text-gray-600":"hover:bg-ink-800 text-steel-400 hover:text-steel-200"}`,title:"Previous Page",children:p.jsx(ew,{size:20})}),p.jsx("span",{className:"text-[10px] font-mono uppercase tracking-wide",children:q&&ae&&be?(()=>{const Le=ae.pages.findIndex(ut=>ut.id===be.id),nt=be.number%2===0?be:Le>0?ae.pages[Le-1]:null,Qe=be.number%2===0?Le<ae.pages.length-1?ae.pages[Le+1]:null:be;return nt&&Qe?`Pages ${nt.number}-${Qe.number}`:Qe?`Page ${Qe.number}`:nt?`Page ${nt.number}`:"Page 1"})():`Page ${(be==null?void 0:be.number)||1}`}),p.jsx("button",{onClick:Ft,disabled:!ae||!be||ae.pages.findIndex(Le=>Le.id===be.id)>=ae.pages.length-1,className:`p-2 rounded-lg transition-all disabled:opacity-30 disabled:cursor-not-allowed ${z?"hover:bg-gray-200 text-gray-600":"hover:bg-ink-800 text-steel-400 hover:text-steel-200"}`,title:"Next Page",children:p.jsx(mf,{size:20})})]})]})]}):p.jsx(qO,{showGutters:z})]})}),g&&p.jsx(jO,{state:a,dispatch:l,onClose:()=>A(!1)}),V&&ne&&p.jsx(UI,{project:ne,onClose:()=>$(!1),onImport:mt}),ce&&ne&&p.jsx(FO,{characters:o,dispatch:l,onClose:()=>ye(!1)}),Y&&(ae==null?void 0:ae.scriptText)&&p.jsxs("div",{className:"fixed right-0 top-0 h-full w-[400px] bg-ink-950 border-l border-ink-800 shadow-2xl z-[500] flex flex-col animate-slide-in",children:[p.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-ink-800",children:[p.jsx("h3",{className:"font-mono text-xs uppercase tracking-widest text-steel-300",children:"Script Reference"}),p.jsx("button",{onClick:()=>le(!1),className:"p-2 hover:bg-ink-800 rounded-lg text-steel-400 hover:text-steel-200 transition-colors",children:p.jsx(Vs,{size:18})})]}),p.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:p.jsx("pre",{className:"text-steel-300 text-sm font-mono whitespace-pre-wrap leading-relaxed",children:ae.scriptText})})]}),pe&&ae&&ae.pages.some(Le=>Le.panels.length>0)&&p.jsx(GO,{issue:ae,onClose:()=>Ie(!1),textOverlayStyle:(ne==null?void 0:ne.textOverlayStyle)||"opaque"})]})};function Gx({activePage:e,activeProject:t,dispatch:n,sensors:i,handleDragStart:o,handleDragEnd:a,activeId:l,activePanelForOverlay:c,showGutters:u,zoomEnabled:d,selectedPanelId:h,setSelectedPanelId:v,copiedPanelSettings:b,setCopiedPanelSettings:g}){const{characters:A}=xi(),{state:_}=Qg(),C=(_==null?void 0:_.scale)||1,E=de.useMemo(()=>[iE(C)],[C]),R=de.useMemo(()=>{if(!(e!=null&&e.panels.length))return{width:ep,height:tp};let k=ep,M=tp;return e.panels.forEach(P=>{const W=(P.x||0)+(P.width||360)+100,V=(P.y||0)+(P.height||420)+100;W>k&&(k=W),V>M&&(M=V)}),{width:Math.max(ep,k),height:Math.max(tp,M)}},[e==null?void 0:e.panels]);return p.jsx("div",{className:`relative transition-all ${d?"pointer-events-none [&>*]:pointer-events-auto":""}`,style:{width:R.width,height:R.height,minWidth:"100%",minHeight:"100%",background:u?"repeating-linear-gradient(0deg, transparent, transparent 39px, #e5e5e5 39px, #e5e5e5 40px), repeating-linear-gradient(90deg, transparent, transparent 39px, #e5e5e5 39px, #e5e5e5 40px)":"repeating-linear-gradient(0deg, transparent, transparent 39px, #1e1e26 39px, #1e1e26 40px), repeating-linear-gradient(90deg, transparent, transparent 39px, #1e1e26 39px, #1e1e26 40px)"},children:!e||e.panels.length===0?p.jsx("div",{className:"sticky top-4 right-0 w-full flex justify-start pl-2 pointer-events-none",style:{zIndex:10},children:p.jsx("p",{className:`font-mono text-sm tracking-wide pointer-events-auto ${u?"text-gray-500":"text-white/50"}`,children:" Click the  in the sidebar to start storyboarding"})}):p.jsx(Xg,{sensors:i,onDragStart:o,onDragEnd:a,modifiers:E,children:e.panels.map((k,M)=>p.jsx(BS,{panel:k,pageId:e.id,dispatch:n,project:t,characters:A,index:M,total:e.panels.length,showGutters:u,activePage:e,isDragging:l===k.id,isSelected:h===k.id,onSelect:()=>v(k.id),copiedSettings:b,onCopySettings:()=>g({aspectRatio:k.aspectRatio,characterIds:k.characterIds}),onPasteSettings:()=>{b&&n({type:"UPDATE_PANEL",panelId:k.id,updates:{aspectRatio:b.aspectRatio,characterIds:b.characterIds}})},panelFrameStyle:(t==null?void 0:t.panelFrameStyle)||"opaque-black",textOverlayStyle:(t==null?void 0:t.textOverlayStyle)||"opaque"},k.id))})})}function Vx({activePage:e,activeProject:t,dispatch:n,sensors:i,handleDragStart:o,handleDragEnd:a,activeId:l,activePanelForOverlay:c,showGutters:u,zoomEnabled:d,selectedPanelId:h,setSelectedPanelId:v,copiedPanelSettings:b,setCopiedPanelSettings:g,activeIssue:A}){const{characters:_}=xi(),{state:C}=Qg(),E=(C==null?void 0:C.scale)||1,R=de.useMemo(()=>[iE(E)],[E]);if(!e||!A)return null;const k=A.pages.findIndex(V=>V.id===e.id);let M=null,P=null;e.number%2===0?(M=e,P=k<A.pages.length-1?A.pages[k+1]:null):(M=k>0?A.pages[k-1]:null,P=e);const W=(V,$)=>{if(!V)return p.jsx("div",{className:`flex-1 flex items-center justify-center ${u?"bg-gray-100":"bg-ink-900/50"}`,children:p.jsx("p",{className:`font-mono text-sm ${u?"text-gray-400":"text-steel-600"}`,children:"No page"})});const j={width:ep,height:tp};return V.panels.forEach(X=>{const z=(X.x||0)+(X.width||360)+100,U=(X.y||0)+(X.height||420)+100;j.width=Math.max(j.width,z),j.height=Math.max(j.height,U)}),p.jsxs("div",{className:"flex-1 flex flex-col",children:[p.jsx("div",{className:`relative transition-all ${d?"pointer-events-none [&>*]:pointer-events-auto":""}`,style:{width:j.width,height:j.height,minWidth:"100%",minHeight:"100%",background:u?"repeating-linear-gradient(0deg, transparent, transparent 39px, #e5e5e5 39px, #e5e5e5 40px), repeating-linear-gradient(90deg, transparent, transparent 39px, #e5e5e5 39px, #e5e5e5 40px)":"repeating-linear-gradient(0deg, transparent, transparent 39px, #1e1e26 39px, #1e1e26 40px), repeating-linear-gradient(90deg, transparent, transparent 39px, #1e1e26 39px, #1e1e26 40px)"},children:V.panels.length===0?p.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:p.jsx(ff,{variant:"page-spread",showGutters:u,onAction:()=>n({type:"ADD_PANEL",pageId:V.id}),actionLabel:"Add Frame"})}):p.jsx(Xg,{sensors:i,onDragStart:o,onDragEnd:a,modifiers:R,children:V.panels.map((X,z)=>p.jsx(BS,{panel:X,pageId:V.id,dispatch:n,project:t,characters:_,index:z,total:V.panels.length,showGutters:u,activePage:V,isDragging:l===X.id,isSelected:h===X.id,onSelect:()=>v(X.id),copiedSettings:b,onCopySettings:()=>g({aspectRatio:X.aspectRatio,characterIds:X.characterIds}),onPasteSettings:()=>{b&&n({type:"UPDATE_PANEL",panelId:X.id,updates:{aspectRatio:b.aspectRatio,characterIds:b.characterIds}})},panelFrameStyle:(t==null?void 0:t.panelFrameStyle)||"opaque-black",textOverlayStyle:(t==null?void 0:t.textOverlayStyle)||"opaque"},X.id))})}),p.jsxs("div",{className:`text-center py-2 text-xs font-mono ${u?"text-gray-600 bg-gray-50":"text-steel-500 bg-ink-900/50"}`,children:["Page ",V.number]})]})};return p.jsxs("div",{className:"flex-1 flex",children:[p.jsx("div",{className:"flex-1 flex flex-col border-r-2",style:{borderColor:u?"#d1d5db":"#2a2a35",boxShadow:u?"inset -8px 0 12px -8px rgba(0,0,0,0.15)":"inset -8px 0 12px -8px rgba(0,0,0,0.4)"},children:W(M)}),p.jsx("div",{className:"w-1",style:{background:u?"linear-gradient(90deg, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.05) 50%, rgba(0,0,0,0.1) 100%)":"linear-gradient(90deg, rgba(0,0,0,0.4) 0%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.4) 100%)"}}),p.jsx("div",{className:"flex-1 flex flex-col border-l-2",style:{borderColor:u?"#d1d5db":"#2a2a35",boxShadow:u?"inset 8px 0 12px -8px rgba(0,0,0,0.15)":"inset 8px 0 12px -8px rgba(0,0,0,0.4)"},children:W(P)})]})}const $x={Protagonist:"bg-blue-100 text-blue-700 border-blue-300",Antagonist:"bg-red-100 text-red-700 border-red-300",Supporting:"bg-emerald-100 text-emerald-700 border-emerald-300",Minor:"bg-gray-100 text-gray-600 border-gray-300"},UU=({character:e})=>{var b,g,A;const{setActiveCharacter:t,setCharacterEditorOpen:n,deleteCharacter:i,setCharacterChatOpen:o,openDetail:a}=xi(),l=((g=(b=e.eras)==null?void 0:b[0])==null?void 0:g.visual_tags)||[],c=(A=e.gallery)==null?void 0:A[0],u=_=>{_.stopPropagation(),t(e.id),n(!0)},d=()=>{a({kind:"character",id:e.id})},h=_=>{_.stopPropagation(),o(!0,e.id)},v=_=>{_.stopPropagation(),confirm(`Delete ${e.name}?`)&&i(e.id)};return p.jsxs("div",{onClick:d,className:"group relative bg-ink-900 border border-ink-700 rounded-xl overflow-hidden hover:border-ember-500/40 transition-all duration-300 flex flex-col cursor-pointer shadow-sm hover:shadow-lg hover:-translate-y-1",children:[p.jsxs("div",{className:"aspect-[3/4] bg-ink-800 relative overflow-hidden flex items-center justify-center",children:[c?p.jsx("img",{src:c,alt:e.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}):p.jsxs("div",{className:"flex flex-col items-center gap-3 text-steel-500",children:[p.jsx(Yu,{size:40}),p.jsx("span",{className:"text-[10px] font-mono uppercase tracking-widest text-steel-600",children:"No Reference"})]}),p.jsx("div",{className:"absolute top-2 left-2",children:p.jsx("span",{className:`text-[9px] uppercase font-bold px-2 py-0.5 rounded border ${$x[e.role]||$x.Minor}`,children:e.role})}),p.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/10 to-transparent opacity-80"}),p.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:[p.jsx("h3",{className:"font-display text-xl font-bold text-white truncate leading-tight drop-shadow-sm",children:e.name||"Unnamed"}),p.jsx("p",{className:"text-white/70 text-[10px] mt-0.5 uppercase tracking-[0.15em] font-mono",children:e.archetype||"No Archetype"})]}),p.jsxs("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col gap-1",children:[p.jsx("button",{onClick:h,title:"Interview",className:"p-2 bg-ember-600/90 hover:bg-ember-500 text-white rounded-lg backdrop-blur-md border border-ember-500/50 transition-colors",children:p.jsx(FA,{size:13})}),p.jsx("button",{onClick:u,className:"p-2 bg-white/80 hover:bg-white text-steel-200 rounded-lg backdrop-blur-md border border-ink-700 transition-colors",children:p.jsx(sw,{size:13})}),p.jsx("button",{onClick:v,className:"p-2 bg-red-50/80 hover:bg-red-100 text-red-600 rounded-lg backdrop-blur-md border border-red-200/50 transition-colors",children:p.jsx(Tc,{size:13})})]})]}),p.jsxs("div",{className:"p-3 flex flex-wrap gap-1.5 min-h-[2.5rem]",children:[l.length>0?l.slice(0,3).map((_,C)=>p.jsxs("span",{className:"flex items-center gap-1 text-[9px] bg-ink-700/60 text-steel-400 px-2 py-0.5 rounded-full border border-ink-600/50",children:[p.jsx(Bg,{size:8}),_]},C)):p.jsx("span",{className:"text-steel-600 text-[9px] italic",children:"No visual tags"}),l.length>3&&p.jsxs("span",{className:"text-steel-600 text-[9px]",children:["+",l.length-3]}),e.loreEntryIds.length>0&&p.jsxs("span",{className:"ml-auto text-lore-400 text-[9px] font-mono",children:[e.loreEntryIds.length," lore"]})]})]})},zU=()=>{var U;const{isCharacterEditorOpen:e,setCharacterEditorOpen:t,activeCharacterId:n,activeEraId:i,setActiveEra:o,characters:a,updateCharacter:l,addCharacter:c,loreEntries:u,linkCharacterToLore:d,unlinkCharacterFromLore:h,linkLoreToCharacter:v,unlinkLoreFromCharacter:b}=xi(),[g,A]=de.useState({}),[_,C]=de.useState(!1),[E,R]=de.useState(""),k=de.useMemo(()=>{var q;return((q=g.eras)==null?void 0:q.find(I=>I.id===i))||null},[g.eras,i]);de.useEffect(()=>{if(n){const q=a.find(I=>I.id===n);q&&(A({...q}),!i&&q.eras.length>0&&o(q.eras[0].id))}else{const q=Ym();A({name:"",role:"Supporting",archetype:"",eras:[q],voice_profile:{samples:[],style:""},smart_tags:{Faction:"",Status:"Active"},gallery:[],loreEntryIds:[]}),o(q.id)}},[n,e]);const M=()=>{g.name&&(n?l(n,g):c(g),t(!1))},P=(q,I)=>{A(ie=>{var J;return{...ie,eras:(J=ie.eras)==null?void 0:J.map(Y=>Y.id===q?{...Y,...I}:Y)}})},W=()=>{const q=Ym("New Era");A(I=>({...I,eras:[...I.eras||[],q]})),o(q.id)},V=q=>{var I,ie;A(J=>{var Y;return{...J,eras:(Y=J.eras)==null?void 0:Y.filter(le=>le.id!==q)}}),i===q&&o(((ie=(I=g.eras)==null?void 0:I[0])==null?void 0:ie.id)||null)},$=()=>{navigator.clipboard.writeText(r2(g,i)),C(!0),setTimeout(()=>C(!1),2e3)},j=q=>{var ie;((ie=g.loreEntryIds)==null?void 0:ie.includes(q))?(A(J=>{var Y;return{...J,loreEntryIds:(Y=J.loreEntryIds)==null?void 0:Y.filter(le=>le!==q)}}),n&&(h(n,q),b(q,n))):(A(J=>({...J,loreEntryIds:[...J.loreEntryIds||[],q]})),n&&(d(n,q),v(q,n)))},X=()=>{E.trim()&&(A(q=>({...q,smart_tags:{...q.smart_tags,[E.trim()]:""}})),R(""))},z=q=>{A(I=>{const ie={...I.smart_tags};return delete ie[q],{...I,smart_tags:ie}})};return e?p.jsxs("div",{className:"fixed inset-0 z-[100] flex justify-end",children:[p.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm",onClick:()=>t(!1)}),p.jsxs("div",{className:"relative w-full max-w-5xl bg-ink-950 border-l border-ink-700 h-full flex flex-col animate-slide-in shadow-2xl",children:[p.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-ink-700 bg-ink-900 flex-shrink-0",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("div",{className:"w-11 h-11 bg-char-500 rounded-xl flex items-center justify-center text-white shadow-lg shadow-char-500/20",children:p.jsx(Yu,{size:22})}),p.jsxs("div",{children:[p.jsx("h2",{className:"text-lg font-display font-bold text-steel-100",children:n?"Edit Dossier":"New Dossier"}),p.jsx("p",{className:"text-[9px] text-steel-600 font-mono uppercase tracking-[0.15em]",children:n?`ID: ${n.split("-")[0]}`:"CREATING"})]})]}),p.jsx("button",{onClick:()=>t(!1),className:"p-2 text-steel-500 hover:text-white hover:bg-ink-700 rounded-full transition-all",children:p.jsx(Vs,{size:22})})]}),p.jsxs("div",{className:"flex-1 overflow-hidden flex",children:[p.jsxs("div",{className:"w-[320px] border-r border-ink-700 overflow-y-auto p-5 space-y-6 custom-scrollbar bg-ink-900/30 flex-shrink-0",children:[p.jsxs("section",{className:"space-y-3",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-[9px] font-bold text-steel-600 uppercase tracking-[0.2em] mb-1.5",children:"Full Name"}),p.jsx("input",{type:"text",value:g.name||"",onChange:q=>A({...g,name:q.target.value}),className:"w-full bg-ink-950 border border-ink-700 rounded-lg px-3.5 py-2 text-steel-100 text-sm focus:border-char-400 focus:outline-none transition-all",placeholder:"Character Name"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[9px] font-bold text-steel-600 uppercase tracking-[0.2em] mb-1.5",children:"Archetype"}),p.jsx("input",{type:"text",value:g.archetype||"",onChange:q=>A({...g,archetype:q.target.value}),className:"w-full bg-ink-950 border border-ink-700 rounded-lg px-3.5 py-2 text-steel-100 text-sm focus:border-char-400 focus:outline-none",placeholder:"e.g. The Reluctant Hero"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[9px] font-bold text-steel-600 uppercase tracking-[0.2em] mb-1.5",children:"Role"}),p.jsxs("select",{value:g.role||"Supporting",onChange:q=>A({...g,role:q.target.value}),className:"w-full bg-ink-950 border border-ink-700 rounded-lg px-3.5 py-2 text-steel-100 text-sm cursor-pointer",children:[p.jsx("option",{value:"Protagonist",children:"Protagonist"}),p.jsx("option",{value:"Antagonist",children:"Antagonist"}),p.jsx("option",{value:"Supporting",children:"Supporting"}),p.jsx("option",{value:"Minor",children:"Minor"})]})]})]}),p.jsxs("section",{className:"space-y-3",children:[p.jsxs("label",{className:"flex items-center gap-1.5 text-[9px] font-bold text-steel-600 uppercase tracking-[0.2em]",children:[p.jsx(EA,{size:10})," Smart Tags"]}),p.jsxs("div",{className:"space-y-2",children:[Object.entries(g.smart_tags||{}).map(([q,I])=>p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"text-[9px] text-steel-500 font-bold w-16 truncate flex-shrink-0",children:q}),p.jsx("input",{type:"text",value:I,onChange:ie=>A({...g,smart_tags:{...g.smart_tags,[q]:ie.target.value}}),className:"flex-1 bg-ink-950 border border-ink-700 rounded px-2.5 py-1 text-xs text-steel-200"}),p.jsx("button",{onClick:()=>z(q),className:"text-steel-600 hover:text-red-400 p-0.5",children:p.jsx(Tc,{size:10})})]},q)),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{type:"text",value:E,onChange:q=>R(q.target.value),onKeyDown:q=>q.key==="Enter"&&X(),placeholder:"Add tag key...",className:"flex-1 bg-ink-950 border border-ink-700 rounded px-2.5 py-1 text-xs text-steel-200"}),p.jsx("button",{onClick:X,className:"text-char-400 hover:text-char-500 p-1",children:p.jsx($u,{size:14})})]})]})]}),p.jsxs("section",{className:"space-y-2",children:[p.jsxs("label",{className:"flex items-center gap-1.5 text-[9px] font-bold text-steel-600 uppercase tracking-[0.2em]",children:[p.jsx(qA,{size:10})," Voice Profile"]}),p.jsx("textarea",{rows:3,value:((U=g.voice_profile)==null?void 0:U.style)||"",onChange:q=>A({...g,voice_profile:{...g.voice_profile,style:q.target.value}}),placeholder:"Describe their speaking style, accent, verbal tics...",className:"w-full bg-ink-950 border border-ink-700 rounded-lg p-3 text-xs text-steel-200 resize-none"})]}),p.jsxs("section",{className:"space-y-2",children:[p.jsxs("label",{className:"flex items-center gap-1.5 text-[9px] font-bold text-steel-600 uppercase tracking-[0.2em]",children:[p.jsx(jl,{size:10})," Lore Connections"]}),p.jsx("div",{className:"bg-ink-950 border border-ink-700 rounded-lg p-2 max-h-44 overflow-y-auto custom-scrollbar space-y-1",children:u.length===0?p.jsx("p",{className:"text-[10px] text-steel-600 italic text-center py-4",children:"No lore entries yet"}):u.map(q=>{var J;const I=(J=g.loreEntryIds)==null?void 0:J.includes(q.id),ie=Ia[q.type];return p.jsxs("button",{onClick:()=>j(q.id),className:`w-full flex items-center gap-2.5 p-2 rounded-lg text-left transition-all text-xs ${I?"bg-lore-500/10 border border-lore-500/30":"hover:bg-ink-900 border border-transparent"}`,children:[p.jsx("span",{className:ie.color,children:ie.icon}),p.jsx("span",{className:"text-steel-200 flex-1 truncate",children:q.name}),I&&p.jsx(Gm,{size:12,className:"text-lore-400"})]},q.id)})})]})]}),p.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 custom-scrollbar",children:p.jsxs("div",{className:"flex items-start gap-6",children:[p.jsxs("div",{className:"w-44 flex-shrink-0",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("label",{className:"text-[9px] font-bold text-steel-600 uppercase tracking-[0.2em]",children:"Eras"}),p.jsx("button",{onClick:W,className:"p-1 hover:bg-ink-700 rounded text-char-400",children:p.jsx($u,{size:13})})]}),p.jsx("div",{className:"space-y-1",children:(g.eras||[]).map(q=>{var I;return p.jsxs("div",{onClick:()=>o(q.id),className:`group flex items-center justify-between px-3 py-2 rounded-lg cursor-pointer transition-all border text-xs ${i===q.id?"bg-char-500/10 border-char-400 text-char-400 font-bold":"bg-ink-950 border-ink-700 text-steel-400 hover:border-steel-600"}`,children:[p.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[p.jsx($m,{size:11}),p.jsx("span",{className:"truncate",children:q.name||"Untitled"})]}),(((I=g.eras)==null?void 0:I.length)||0)>1&&p.jsx("button",{onClick:ie=>{ie.stopPropagation(),V(q.id)},className:"opacity-0 group-hover:opacity-100 p-0.5 hover:text-red-400",children:p.jsx(Tc,{size:11})})]},q.id)})})]}),p.jsx("div",{className:"flex-1 space-y-5",children:k?p.jsxs("div",{className:"animate-fade-in space-y-5",children:[p.jsxs("div",{className:"flex gap-4",children:[p.jsxs("div",{className:"flex-1",children:[p.jsx("label",{className:"block text-[9px] font-bold text-steel-600 uppercase tracking-[0.2em] mb-1.5",children:"Era Name"}),p.jsx("input",{type:"text",value:k.name,onChange:q=>P(k.id,{name:q.target.value}),className:"w-full bg-ink-950 border border-ink-700 rounded-lg px-3.5 py-2 text-steel-100 text-sm"})]}),p.jsxs("div",{className:"w-28",children:[p.jsx("label",{className:"block text-[9px] font-bold text-steel-600 uppercase tracking-[0.2em] mb-1.5",children:"Age App."}),p.jsx("input",{type:"text",value:k.age_appearance,onChange:q=>P(k.id,{age_appearance:q.target.value}),placeholder:"e.g. 40s",className:"w-full bg-ink-950 border border-ink-700 rounded-lg px-3.5 py-2 text-steel-100 text-sm"})]})]}),p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[p.jsx("label",{className:"text-[9px] font-bold text-steel-600 uppercase tracking-[0.2em]",children:"Visual Prompt Tags"}),p.jsxs("button",{className:"text-[8px] text-char-400 font-bold flex items-center gap-1 hover:underline",children:[p.jsx(bp,{size:9})," Suggest"]})]}),p.jsx("textarea",{rows:4,value:k.visual_tags.join(", "),onChange:q=>P(k.id,{visual_tags:q.target.value.split(",").map(I=>I.trim()).filter(Boolean)}),placeholder:"red hair past collar, black glasses, DBS scar at temple...",className:"w-full bg-ink-950 border border-ink-700 rounded-lg p-3 text-xs text-steel-200 font-mono leading-relaxed"})]}),p.jsxs("div",{className:"bg-ink-900 border border-ink-700 p-4 rounded-xl",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("p",{className:"text-[9px] font-bold text-steel-600 uppercase tracking-[0.2em]",children:"Master Prompt Preview"}),p.jsxs("button",{onClick:$,className:"flex items-center gap-1.5 px-3 py-1 bg-ink-800 border border-ink-700 rounded-lg text-[10px] font-bold text-steel-400 hover:text-white transition-all",children:[_?p.jsx(Gm,{size:12,className:"text-emerald-500"}):p.jsx(Og,{size:12}),_?"Copied":"Copy"]})]}),p.jsx("p",{className:"text-xs text-char-400 font-mono italic p-3 bg-ink-950 rounded border border-char-400/20 leading-relaxed",children:r2(g,i)})]})]}):p.jsxs("div",{className:"h-64 flex flex-col items-center justify-center text-steel-600 opacity-40",children:[p.jsx($m,{size:40,className:"mb-3"}),p.jsx("p",{className:"text-sm",children:"Select an era to edit"})]})})]})})]}),p.jsxs("div",{className:"p-5 border-t border-ink-700 bg-ink-900/50 flex items-center justify-between flex-shrink-0",children:[p.jsx("button",{onClick:()=>t(!1),className:"px-5 py-2 text-steel-400 hover:text-white font-medium transition-colors text-sm",children:"Cancel"}),p.jsxs("button",{onClick:M,className:"flex items-center gap-2 bg-char-500 hover:bg-char-400 text-white px-7 py-2 rounded-lg font-bold shadow-lg shadow-char-500/20 transition-all hover:-translate-y-0.5 text-sm",children:[p.jsx(Fg,{size:16})," Save Dossier"]})]})]})]}):null},Yx=()=>{const{characters:e,characterSearchTerm:t,setCharacterSearchTerm:n,setActiveCharacter:i,setCharacterEditorOpen:o,characterView:a,setCharacterView:l}=xi(),c=()=>{i(null),o(!0)},u=e.filter(d=>{const h=t.toLowerCase();return h?d.name.toLowerCase().includes(h)||d.archetype.toLowerCase().includes(h)||d.role.toLowerCase().includes(h)||d.eras.some(v=>v.visual_tags.some(b=>b.toLowerCase().includes(h)))||Object.values(d.smart_tags).some(v=>v.toLowerCase().includes(h)):!0});return p.jsxs("div",{className:"flex-1 flex flex-col min-w-0 bg-ink-950",children:[p.jsxs("header",{className:"flex-shrink-0 border-b border-ink-750 bg-ink-900/40 backdrop-blur-md sticky top-0 z-40",children:[p.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[p.jsxs("div",{className:"flex items-center gap-5 flex-1",children:[p.jsxs("div",{className:"hidden md:flex flex-col gap-0.5 min-w-0",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"w-2 h-2 rounded-full bg-char-500"}),p.jsx("h1",{className:"text-lg font-display font-bold text-steel-100 tracking-tight",children:"Character Tracker"})]}),p.jsxs("p",{className:"text-[9px] font-mono text-steel-600 uppercase tracking-[0.15em] pl-4",children:[e.length," dossier",e.length!==1?"s":""," on file"]})]}),p.jsxs("div",{className:"relative flex-1 max-w-md group",children:[p.jsx(dw,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-steel-600 group-focus-within:text-char-400 transition-colors",size:15}),p.jsx("input",{type:"text",placeholder:"Search characters, archetypes, tags...",value:t,onChange:d=>n(d.target.value),className:"w-full bg-ink-950 border border-ink-700 rounded-lg pl-9 pr-4 py-2 text-sm text-steel-100 placeholder:text-steel-600 focus:outline-none focus:border-char-500/50 focus:ring-1 focus:ring-char-500/20 transition-all"})]}),p.jsx("div",{className:"hidden md:flex items-center bg-ink-900 border border-ink-700 rounded-lg p-0.5",children:[{id:"grid",icon:p.jsx(Ys,{size:14}),label:"Grid"},{id:"graph",icon:p.jsx($A,{size:14}),label:"Graph"},{id:"writer",icon:p.jsx(jg,{size:14}),label:"Writer"}].map(d=>p.jsxs("button",{onClick:()=>l(d.id),className:`px-3 py-1.5 rounded text-[10px] font-bold uppercase tracking-wider transition-all flex items-center gap-1.5 ${a===d.id?"bg-char-500/15 text-char-400":"text-steel-500 hover:text-steel-200"}`,children:[d.icon,p.jsx("span",{className:"hidden lg:inline",children:d.label})]},d.id))})]}),p.jsxs("button",{onClick:c,className:"ml-4 bg-char-500 hover:bg-char-400 text-white px-5 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-char-500/20 transition-all active:scale-95 text-sm",children:[p.jsx($u,{size:16}),p.jsx("span",{className:"hidden sm:inline",children:"New Dossier"})]})]}),p.jsx("div",{className:"h-[1px] header-gradient-char"})]}),p.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-5 lg:p-8",children:e.length===0?p.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center max-w-md mx-auto py-20 animate-fade-in",children:[p.jsx("div",{className:"w-20 h-20 bg-char-900/30 border border-char-500/20 rounded-3xl flex items-center justify-center mb-6 text-char-400",children:p.jsx(T3,{size:32})}),p.jsx("h2",{className:"text-2xl font-display font-bold text-steel-100 mb-3",children:"Character Tracker is Empty"}),p.jsx("p",{className:"text-steel-400 mb-8 leading-relaxed text-sm",children:"Begin your narrative journey by defining your first character. Archetypes, visual traits, eras, and story arcs start here."}),p.jsx("button",{onClick:c,className:"bg-char-500 hover:bg-char-400 text-white px-8 py-3 rounded-xl font-bold transition-all text-sm shadow-lg shadow-char-500/20 active:scale-95",children:"Create First Character"})]}):u.length===0?p.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-fade-in",children:[p.jsxs("p",{className:"text-steel-500 text-base",children:['No dossiers matching "',t,'"']}),p.jsx("button",{onClick:()=>n(""),className:"mt-3 text-char-400 hover:underline text-xs font-bold uppercase tracking-widest",children:"Clear Filter"})]}):p.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-5 animate-fade-in",children:u.map(d=>p.jsx(UU,{character:d},d.id))})}),p.jsx(zU,{})]})},jU=({entry:e,onEdit:t})=>{const{deleteLoreEntry:n,characters:i,openDetail:o}=xi(),a=Ia[e.type],l=i.filter(d=>e.characterIds.includes(d.id)),c=d=>{d.stopPropagation(),confirm(`Delete "${e.name}"?`)&&n(e.id)},u=()=>{o({kind:"lore",id:e.id})};return p.jsxs("div",{onClick:u,className:`group relative flex flex-col h-full bg-ink-950 border ${a.borderColor} rounded-xl overflow-hidden hover:shadow-lg transition-all duration-300 hover:-translate-y-1 cursor-pointer`,children:[p.jsx("div",{className:"h-1 w-full",style:{background:a.accentHex}}),p.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[p.jsxs("div",{className:"flex justify-between items-start mb-3",children:[p.jsxs("div",{className:`px-2 py-0.5 rounded text-[9px] font-bold uppercase tracking-wider flex items-center gap-1.5 ${a.bgColor} ${a.color}`,children:[a.icon,a.label]}),p.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[p.jsx("button",{onClick:d=>{d.stopPropagation(),t(e)},className:"p-1.5 hover:bg-ink-800 rounded transition-colors text-steel-500 hover:text-steel-100",children:p.jsx(lw,{size:13})}),p.jsx("button",{onClick:c,className:"p-1.5 hover:bg-ink-800 rounded transition-colors text-steel-500 hover:text-red-400",children:p.jsx(Tc,{size:13})})]})]}),p.jsx("h3",{className:"text-base font-display font-bold text-steel-100 mb-1.5 group-hover:text-ember-400 transition-colors leading-tight",children:e.name}),p.jsx("p",{className:"text-xs text-steel-400 line-clamp-3 mb-3 flex-grow leading-relaxed",children:e.description||"No description provided."}),p.jsxs("div",{className:"space-y-1.5 mb-3 text-[11px] border-t border-ink-800/50 pt-3",children:[e.type===xn.FACTION&&p.jsxs("div",{className:"flex items-center gap-2 text-steel-300",children:[p.jsx(fw,{size:12,className:"text-blue-400/70"}),p.jsx("span",{className:"text-steel-500",children:"Leader:"})," ",e.leader||"???"]}),e.type===xn.LOCATION&&p.jsxs("div",{className:"flex items-center gap-2 text-steel-300",children:[p.jsx(ow,{size:12,className:"text-emerald-400/70"}),p.jsx("span",{className:"text-steel-500",children:"Region:"})," ",e.region||"???"]}),e.type===xn.EVENT&&p.jsxs("div",{className:"flex items-center gap-2 text-steel-300",children:[p.jsx(Qx,{size:12,className:"text-amber-400/70"}),p.jsx("span",{className:"text-steel-500",children:"Date:"})," ",e.date||"Unknown"]}),e.type===xn.CONCEPT&&p.jsxs("div",{className:"flex items-center gap-2 text-steel-300",children:[p.jsx(JN,{size:12,className:"text-purple-400/70"}),p.jsx("span",{className:"text-steel-500",children:"Origin:"})," ",e.origin||"???"]}),e.type===xn.ARTIFACT&&p.jsxs("div",{className:"flex items-center gap-2 text-steel-300",children:[p.jsx("span",{className:"text-steel-500",children:"Holder:"})," ",e.currentHolder||"???"]}),e.type===xn.RULE&&p.jsxs("div",{className:"flex items-center gap-2 text-steel-300",children:[p.jsx(zg,{size:12,className:e.canonLocked?"text-amber-400":"text-steel-600"}),p.jsx("span",{className:"text-steel-500",children:e.canonLocked?"Canon Locked":"Unlocked"})]})]}),p.jsxs("div",{className:"flex flex-wrap gap-1 mt-auto items-center",children:[e.tags.slice(0,3).map(d=>p.jsxs("span",{className:"text-[9px] bg-ink-950 border border-ink-800 text-steel-500 px-1.5 py-0.5 rounded uppercase tracking-tighter",children:["#",d]},d)),e.tags.length>3&&p.jsxs("span",{className:"text-[9px] text-steel-600",children:["+",e.tags.length-3]}),p.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[l.length>0&&p.jsxs("div",{className:"flex items-center gap-1 text-char-400 text-[9px]",title:l.map(d=>d.name).join(", "),children:[p.jsx(Ys,{size:10}),l.length]}),e.relatedEntryIds.length>0&&p.jsxs("div",{className:"flex items-center gap-1 text-steel-600 text-[9px]",children:[p.jsx(jl,{size:10}),e.relatedEntryIds.length]})]})]})]})]})};function Wx(){return{id:ls(),name:"",type:xn.CONCEPT,description:"",tags:[],relatedEntryIds:[],characterIds:[],origin:"",rules:"",complexity:"Low",createdAt:Date.now(),updatedAt:Date.now()}}const FU=({entry:e,onClose:t})=>{const{addLoreEntry:n,updateLoreEntry:i,loreEntries:o,characters:a,linkLoreToCharacter:l,unlinkLoreFromCharacter:c}=xi(),[u,d]=de.useState(e||Wx()),[h,v]=de.useState("");de.useEffect(()=>{if(e)d({...e}),v(e.tags.join(", "));else{const M=Wx();d(M),v("")}},[e]);const b=M=>{d(P=>({...P,[M.target.name]:M.target.value}))},g=M=>{const P={...u,type:M},W={[xn.FACTION]:{ideology:"",leader:"",influence:5},[xn.LOCATION]:{region:"",climate:"",importance:""},[xn.EVENT]:{date:"",participants:"",consequences:""},[xn.CONCEPT]:{origin:"",rules:"",complexity:"Low"},[xn.ARTIFACT]:{origin:"",currentHolder:"",properties:""},[xn.RULE]:{scope:"",exceptions:"",canonLocked:!1}};d({...P,...W[M]})},A=()=>{var W;if(!((W=u.name)!=null&&W.trim()))return;const M=h.split(",").map(V=>V.trim()).filter(Boolean),P={...u,tags:M,updatedAt:Date.now()};e?i(e.id,P):n({...P,createdAt:Date.now()}),t()},_=M=>{d(P=>({...P,relatedEntryIds:P.relatedEntryIds.includes(M)?P.relatedEntryIds.filter(W=>W!==M):[...P.relatedEntryIds,M]}))},C=M=>{var W;const P=(W=u.characterIds)==null?void 0:W.includes(M);d(V=>({...V,characterIds:P?V.characterIds.filter($=>$!==M):[...V.characterIds||[],M]})),e&&(P?c(e.id,M):l(e.id,M))},E=Ia[u.type],R="w-full bg-ink-950 border border-ink-800 rounded-lg px-3.5 py-2 text-sm text-steel-100 focus:outline-none focus:border-lore-400 transition-colors",k="text-[9px] font-bold text-steel-600 uppercase tracking-[0.2em] mb-1.5 block";return p.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/20 backdrop-blur-sm animate-fade-in",children:p.jsxs("div",{className:"bg-ink-950 border border-ink-700 w-full max-w-2xl max-h-[90vh] rounded-2xl overflow-hidden flex flex-col shadow-2xl",children:[p.jsxs("div",{className:"px-6 py-4 border-b border-ink-700 flex justify-between items-center bg-ink-900 flex-shrink-0",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:`p-2 rounded-lg ${E.bgColor} ${E.color}`,children:E.icon}),p.jsxs("div",{children:[p.jsx("h2",{className:"text-base font-display font-bold text-steel-100",children:e?`Edit: ${u.name||"Untitled"}`:"New Lore Entry"}),p.jsx("p",{className:"text-[9px] text-steel-600 uppercase tracking-[0.15em] font-mono",children:"Lore Tracker"})]})]}),p.jsx("button",{onClick:t,className:"p-2 hover:bg-ink-800 rounded-full text-steel-500 hover:text-steel-100 transition-colors",children:p.jsx(Vs,{size:20})})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-5 custom-scrollbar",children:[p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:k,children:"Entry Name"}),p.jsx("input",{type:"text",name:"name",value:u.name||"",onChange:b,className:R,placeholder:"e.g., Drain Metaphysics"})]}),p.jsxs("div",{children:[p.jsx("label",{className:k,children:"Type"}),p.jsx("select",{value:u.type,onChange:M=>g(M.target.value),className:`${R} cursor-pointer capitalize`,children:Object.values(xn).map(M=>p.jsx("option",{value:M,children:Ia[M].label},M))})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:k,children:"Description"}),p.jsx("textarea",{name:"description",value:u.description||"",onChange:b,rows:3,className:`${R} resize-none`,placeholder:"Core description of this entry..."})]}),p.jsxs("div",{className:"bg-ink-950/30 border border-ink-800/50 rounded-xl p-4 space-y-3",children:[p.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[p.jsx("div",{className:"w-1 h-4 rounded-full",style:{background:E.accentHex}}),p.jsxs("h3",{className:"text-xs font-bold text-steel-300 capitalize",children:[Ia[u.type].label," Details"]})]}),u.type===xn.FACTION&&p.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[p.jsxs("div",{children:[p.jsx("label",{className:k,children:"Ideology"}),p.jsx("input",{name:"ideology",value:u.ideology||"",onChange:b,className:R})]}),p.jsxs("div",{children:[p.jsx("label",{className:k,children:"Leader"}),p.jsx("input",{name:"leader",value:u.leader||"",onChange:b,className:R})]})]}),u.type===xn.LOCATION&&p.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[p.jsxs("div",{children:[p.jsx("label",{className:k,children:"Region"}),p.jsx("input",{name:"region",value:u.region||"",onChange:b,className:R})]}),p.jsxs("div",{children:[p.jsx("label",{className:k,children:"Climate / Vibe"}),p.jsx("input",{name:"climate",value:u.climate||"",onChange:b,className:R})]})]}),u.type===xn.EVENT&&p.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[p.jsxs("div",{children:[p.jsx("label",{className:k,children:"Date/Timeline"}),p.jsx("input",{name:"date",value:u.date||"",onChange:b,className:R})]}),p.jsxs("div",{children:[p.jsx("label",{className:k,children:"Key Participants"}),p.jsx("input",{name:"participants",value:u.participants||"",onChange:b,className:R})]}),p.jsxs("div",{className:"col-span-2",children:[p.jsx("label",{className:k,children:"Consequences"}),p.jsx("textarea",{name:"consequences",value:u.consequences||"",onChange:b,rows:2,className:`${R} resize-none`})]})]}),u.type===xn.CONCEPT&&p.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[p.jsxs("div",{children:[p.jsx("label",{className:k,children:"Origin Point"}),p.jsx("input",{name:"origin",value:u.origin||"",onChange:b,className:R})]}),p.jsxs("div",{children:[p.jsx("label",{className:k,children:"Complexity"}),p.jsxs("select",{name:"complexity",value:u.complexity||"Low",onChange:b,className:`${R} cursor-pointer`,children:[p.jsx("option",{value:"Low",children:"Low"}),p.jsx("option",{value:"Medium",children:"Medium"}),p.jsx("option",{value:"High",children:"High"}),p.jsx("option",{value:"Extreme",children:"Extreme"})]})]}),p.jsxs("div",{className:"col-span-2",children:[p.jsx("label",{className:k,children:"Rules / Mechanics"}),p.jsx("textarea",{name:"rules",value:u.rules||"",onChange:b,rows:2,className:`${R} resize-none`})]})]}),u.type===xn.ARTIFACT&&p.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[p.jsxs("div",{children:[p.jsx("label",{className:k,children:"Origin"}),p.jsx("input",{name:"origin",value:u.origin||"",onChange:b,className:R})]}),p.jsxs("div",{children:[p.jsx("label",{className:k,children:"Current Holder"}),p.jsx("input",{name:"currentHolder",value:u.currentHolder||"",onChange:b,className:R})]}),p.jsxs("div",{className:"col-span-2",children:[p.jsx("label",{className:k,children:"Properties"}),p.jsx("textarea",{name:"properties",value:u.properties||"",onChange:b,rows:2,className:`${R} resize-none`})]})]}),u.type===xn.RULE&&p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[p.jsxs("div",{children:[p.jsx("label",{className:k,children:"Scope"}),p.jsx("input",{name:"scope",value:u.scope||"",onChange:b,className:R})]}),p.jsx("div",{className:"flex items-end pb-1",children:p.jsxs("button",{onClick:()=>d(M=>({...M,canonLocked:!M.canonLocked})),className:`flex items-center gap-2 px-4 py-2 rounded-lg border text-xs font-bold transition-all ${u.canonLocked?"bg-amber-500/10 border-amber-500/30 text-amber-400":"bg-ink-900 border-ink-700 text-steel-500"}`,children:[u.canonLocked?p.jsx(zg,{size:13}):p.jsx(MA,{size:13}),u.canonLocked?"Canon Locked":"Unlocked"]})})]}),p.jsxs("div",{children:[p.jsx("label",{className:k,children:"Exceptions"}),p.jsx("textarea",{name:"exceptions",value:u.exceptions||"",onChange:b,rows:2,className:`${R} resize-none`})]})]})]}),p.jsxs("div",{children:[p.jsxs("label",{className:"flex items-center gap-1.5 text-[9px] font-bold text-steel-600 uppercase tracking-[0.2em] mb-1.5",children:[p.jsx(Bg,{size:10})," Tags (comma separated)"]}),p.jsx("input",{type:"text",value:h,onChange:M=>v(M.target.value),className:R,placeholder:"mythology, drain, canon..."})]}),p.jsxs("div",{children:[p.jsxs("label",{className:"flex items-center gap-1.5 text-[9px] font-bold text-steel-600 uppercase tracking-[0.2em] mb-1.5",children:[p.jsx(Ys,{size:10})," Character Connections"]}),p.jsx("div",{className:"bg-ink-950 border border-ink-800 rounded-lg p-2.5 max-h-36 overflow-y-auto custom-scrollbar space-y-1",children:a.length===0?p.jsx("p",{className:"text-[10px] text-steel-600 italic text-center py-3",children:"No characters created yet"}):a.map(M=>{var P,W;return p.jsxs("button",{onClick:()=>C(M.id),className:`w-full flex items-center gap-2.5 p-2 rounded-lg text-left transition-all text-xs ${(P=u.characterIds)!=null&&P.includes(M.id)?"bg-char-500/10 border border-char-400/30":"hover:bg-ink-900 border border-transparent"}`,children:[p.jsx("div",{className:"w-2 h-2 rounded-full bg-char-500/60"}),p.jsx("span",{className:"text-steel-200 flex-1 truncate",children:M.name}),p.jsx("span",{className:"text-[9px] text-steel-600",children:M.role}),((W=u.characterIds)==null?void 0:W.includes(M.id))&&p.jsx(Gm,{size:12,className:"text-char-400"})]},M.id)})})]}),p.jsxs("div",{children:[p.jsxs("label",{className:"flex items-center gap-1.5 text-[9px] font-bold text-steel-600 uppercase tracking-[0.2em] mb-1.5",children:[p.jsx(jl,{size:10})," Related Lore Entries"]}),p.jsxs("div",{className:"bg-ink-950 border border-ink-800 rounded-lg p-2.5 max-h-36 overflow-y-auto custom-scrollbar space-y-1",children:[o.filter(M=>M.id!==u.id).map(M=>{var W,V;const P=Ia[M.type];return p.jsxs("button",{onClick:()=>_(M.id),className:`w-full flex items-center gap-2.5 p-2 rounded-lg text-left transition-all text-xs ${(W=u.relatedEntryIds)!=null&&W.includes(M.id)?"bg-lore-500/10 border border-lore-500/30":"hover:bg-ink-900 border border-transparent"}`,children:[p.jsx("span",{className:P.color,children:P.icon}),p.jsx("span",{className:"text-steel-200 flex-1 truncate",children:M.name}),((V=u.relatedEntryIds)==null?void 0:V.includes(M.id))&&p.jsx(mf,{size:12,className:"text-lore-400"})]},M.id)}),o.length<=1&&p.jsx("p",{className:"text-[10px] text-steel-600 italic text-center py-3",children:"Create more entries to establish connections"})]})]})]}),p.jsxs("div",{className:"px-6 py-4 border-t border-ink-800 bg-ink-950/50 flex justify-end gap-3 flex-shrink-0",children:[p.jsx("button",{onClick:t,className:"px-5 py-2 text-steel-400 hover:text-white transition-colors text-sm font-medium",children:"Cancel"}),p.jsxs("button",{onClick:A,className:"px-6 py-2 bg-lore-500 hover:bg-lore-400 text-white rounded-lg flex items-center gap-2 font-bold transition-all shadow-lg shadow-lore-500/10 text-sm",children:[p.jsx(Fg,{size:15})," Save Entry"]})]})]})})},BU=()=>{const{loreEntries:e,loreSearchTerm:t,setLoreSearchTerm:n,loreFilterType:i,setLoreFilterType:o}=xi(),[a,l]=de.useState(null),[c,u]=de.useState(!1),d=de.useMemo(()=>e.filter(g=>{const A=t.toLowerCase(),_=!A||g.name.toLowerCase().includes(A)||g.description.toLowerCase().includes(A)||g.tags.some(E=>E.toLowerCase().includes(A)),C=i==="all"||g.type===i;return _&&C}).sort((g,A)=>A.updatedAt-g.updatedAt),[e,t,i]),h=()=>{l(null),u(!0)},v=g=>{l(g),u(!0)},b=de.useMemo(()=>{const g={};return e.forEach(A=>{g[A.type]=(g[A.type]||0)+1}),g},[e]);return p.jsxs("div",{className:"flex-1 flex flex-col min-w-0 bg-ink-950",children:[p.jsxs("header",{className:"flex-shrink-0 border-b border-ink-750 bg-ink-900/40 backdrop-blur-md sticky top-0 z-40",children:[p.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[p.jsxs("div",{className:"flex items-center gap-5 flex-1",children:[p.jsxs("div",{className:"hidden md:flex flex-col gap-0.5 min-w-0",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"w-2 h-2 rounded-full bg-lore-500"}),p.jsx("h1",{className:"text-lg font-display font-bold text-steel-100 tracking-tight",children:"Lore Tracker"})]}),p.jsxs("p",{className:"text-[9px] font-mono text-steel-600 uppercase tracking-[0.15em] pl-4",children:[e.length," entr",e.length!==1?"ies":"y"," cataloged"]})]}),p.jsxs("div",{className:"relative flex-1 max-w-md group",children:[p.jsx(dw,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-steel-600 group-focus-within:text-lore-400 transition-colors",size:15}),p.jsx("input",{type:"text",placeholder:"Search lore entries, tags...",value:t,onChange:g=>n(g.target.value),className:"w-full bg-ink-950 border border-ink-700 rounded-lg pl-9 pr-4 py-2 text-sm text-steel-100 placeholder:text-steel-600 focus:outline-none focus:border-lore-500/50 focus:ring-1 focus:ring-lore-500/20 transition-all"})]}),p.jsxs("div",{className:"hidden md:flex items-center gap-1 bg-ink-900 border border-ink-700 rounded-lg p-0.5",children:[p.jsx("button",{onClick:()=>o("all"),className:`px-2.5 py-1.5 rounded text-[9px] font-bold uppercase tracking-wider transition-all ${i==="all"?"bg-lore-500/15 text-lore-400":"text-steel-500 hover:text-steel-200"}`,children:"All"}),Object.values(xn).map(g=>{const A=Ia[g],_=b[g]||0;return p.jsxs("button",{onClick:()=>o(g),className:`px-2 py-1.5 rounded text-[9px] font-bold uppercase tracking-wider transition-all flex items-center gap-1 ${i===g?`${A.bgColor} ${A.color}`:"text-steel-500 hover:text-steel-200"}`,children:[A.icon,_>0&&p.jsx("span",{className:"hidden lg:inline",children:_})]},g)})]})]}),p.jsxs("button",{onClick:h,className:"ml-4 bg-lore-500 hover:bg-lore-400 text-white px-5 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-lore-500/20 transition-all active:scale-95 text-sm",children:[p.jsx($u,{size:16}),p.jsx("span",{className:"hidden sm:inline",children:"New Entry"})]})]}),p.jsx("div",{className:"h-[1px] header-gradient-lore"})]}),p.jsx("div",{className:"md:hidden px-5 py-2 border-b border-ink-700 bg-ink-900/20",children:p.jsxs("select",{value:i,onChange:g=>o(g.target.value),className:"w-full bg-ink-900 border border-ink-800 rounded-lg px-3 py-2 text-sm text-steel-200 cursor-pointer",children:[p.jsx("option",{value:"all",children:"All Types"}),Object.values(xn).map(g=>p.jsxs("option",{value:g,children:[Ia[g].label," (",b[g]||0,")"]},g))]})}),p.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-5 lg:p-8",children:e.length===0?p.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center max-w-md mx-auto py-20 animate-fade-in",children:[p.jsx("div",{className:"w-20 h-20 bg-lore-900/30 border border-lore-500/20 rounded-3xl flex items-center justify-center mb-6 text-lore-400",children:p.jsx(Ku,{size:32})}),p.jsx("h2",{className:"text-2xl font-display font-bold text-steel-100 mb-3",children:"Lore Tracker is Empty"}),p.jsx("p",{className:"text-steel-400 mb-8 leading-relaxed text-sm",children:"Build your universe from the ground up. Factions, locations, events, concepts, artifacts, and canon rules  everything lives here."}),p.jsx("button",{onClick:h,className:"bg-lore-500 hover:bg-lore-400 text-white px-8 py-3 rounded-xl font-bold transition-all text-sm shadow-lg shadow-lore-500/20 active:scale-95",children:"Create First Entry"})]}):d.length===0?p.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-fade-in",children:[p.jsx("p",{className:"text-steel-500",children:"No entries matching your filter"}),p.jsx("button",{onClick:()=>{n(""),o("all")},className:"mt-3 text-lore-400 hover:underline text-xs font-bold uppercase tracking-widest",children:"Clear Filters"})]}):p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5 animate-fade-in",children:d.map(g=>p.jsx(jU,{entry:g,onEdit:v},g.id))})}),c&&p.jsx(FU,{entry:a,onClose:()=>u(!1)})]})};function qU(){const{activeModule:e}=xi();de.useEffect(()=>{const n=i=>{i.altKey&&i.key==="1"&&xi.getState().setActiveModule("ink"),i.altKey&&i.key==="2"&&xi.getState().setActiveModule("characters"),i.altKey&&i.key==="3"&&xi.getState().setActiveModule("lore"),i.key==="Escape"&&xi.getState().detailTarget&&xi.getState().closeDetail()};return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[]);const t=()=>{switch(e){case"ink":return p.jsx(OU,{});case"characters":return p.jsx(Yx,{});case"lore":return p.jsx(BU,{});default:return p.jsx(Yx,{})}};return p.jsxs("div",{className:"flex h-screen bg-ink-950 text-steel-200 overflow-hidden",children:[p.jsx(O3,{}),t(),p.jsx(B3,{})]})}const HU=()=>p.jsx(fO,{children:p.jsx(qU,{})});_N.createRoot(document.getElementById("root")).render(p.jsx(kn.StrictMode,{children:p.jsx(HU,{})}));export{qn as _,ph as c,Dg as g};
